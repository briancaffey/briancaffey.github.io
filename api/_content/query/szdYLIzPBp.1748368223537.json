[{"_path":"/2021/01/02/using-the-stripe-api-for-recurring-monthly-saas-subscription-payments-in-django-and-vue-application","_dir":"02","_draft":false,"_partial":false,"_locale":"","title":"Using Stripe for recurring monthly SaaS subscriptions in a Django + Vue application","description":"This article shares my experience learning and implementing the Stripe API for recurring monthly SaaS subscription payments in an application using Django and Vue.js","date":"2021-01-02T00:00:00.000Z","image":"/static/django_vue_stripe.png","tags":["django","vue","drf","stripe"],"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"using-stripe-for-recurring-monthly-payments-to-a-paid-saas-subscription-in-a-django-vuejs-application"},"children":[{"type":"text","value":"Using Stripe for recurring monthly payments to a paid SaaS subscription in a Django + Vue.js application"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This diagram shows the flow of data for the lifecycle of a paid customer subscription in a Django application with a Vue.js client. There are four stages:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I. Account setup, configuration, model and object creation\nII. Logic and data flow for starting a customer's premium monthly subscription\nIII. Automatic subscription renewal\nIV. Cancelling a premium subscription"}]},{"type":"element","tag":"h2","props":{"id":"context"},"children":[{"type":"text","value":"Context"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This is my first attempt at using Stripe, or any other online payment service API. Most of what I have diagramed here comes from this article from the Stripe documentation: "},{"type":"element","tag":"a","props":{"href":"https://stripe.com/docs/billing/subscriptions/fixed-price","rel":["nofollow"]},"children":[{"type":"text","value":"https://stripe.com/docs/billing/subscriptions/fixed-price"}]},{"type":"text","value":". Knowing almost nothing about what is needed to create a SaaS subscription, I found this article very helpful. It was a lot to read at once, but each call to to the Stripe API is very clear and straightforward."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I made some modifications and additions to this walk-through for my use case, which is an API service called Open SEC Data, an open source project that I'm working on ("},{"type":"element","tag":"a","props":{"href":"https://gitlab.com/briancaffey/sec-filings-app","rel":["nofollow"]},"children":[{"type":"text","value":"https://gitlab.com/briancaffey/sec-filings-app"}]},{"type":"text","value":")."}]},{"type":"element","tag":"h2","props":{"id":"diagram"},"children":[{"type":"text","value":"Diagram"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here's a read-only link to the diagram: "},{"type":"element","tag":"a","props":{"href":"https://drive.google.com/file/d/1oH2b0W-c-dI5oXzc_jvCGvXx9sJagr4a/view?usp=sharing","rel":["nofollow"]},"children":[{"type":"text","value":"https://drive.google.com/file/d/1oH2b0W-c-dI5oXzc_jvCGvXx9sJagr4a/view?usp=sharing"}]},{"type":"text","value":". This diagram is made with "},{"type":"element","tag":"a","props":{"href":"https://www.diagrams.net/","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.diagrams.net/"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"png","src":"/static/django_vue_stripe_diagram.png"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"legend"},"children":[{"type":"text","value":"Legend"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here's a detailed description of each part of the diagram, starting with the first section."}]},{"type":"element","tag":"h3","props":{"id":"i-account-setup-configuration-model-and-object-creation"},"children":[{"type":"text","value":"I. Account setup, configuration, model and object creation"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Setup a Stripe account. For local development, make sure you turn on "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"View test data"}]},{"type":"text","value":". On your local machine, install the stripe CLI and authenticate with your Stripe account"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Create a Product in Stripe (mine is called "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Open SEC Data Premium Subscription"}]},{"type":"text","value":")"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Create a Price in Stripe that references the Product."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"Instead of creating these objects in the Stripe Dashboard, you can also create them with the Stripe CLI or the Python SDK. I created a Django management command called "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"create_stripe_data"}]},{"type":"text","value":" that will create a Product and related Price in Stripe. We will need the id of the Price, it looks like this: "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"price_1Hx0goL67dRDwyuDh9yEWsBo"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Add the Price ID as an environment variable "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"SUBSCRIPTION_PRICE_ID"}]},{"type":"text","value":" to the backend. This will be used later when we make API calls to Stripe from inside of Django views."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"For production environments, you will need to a register a Stripe webhook. This is an endpoint in Django that Stripe will POST to in order to inform the Django application of events that have happened in Stripe."},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"For local development we need to run "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stripe listen --forward-to localhost/api/stripe-webhooks/"}]},{"type":"text","value":" in order to forward webhook events to the local Django application. This works really well for local development."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"In both local and production environments we need to add an environment variables to the Django application that will be used to validate the webhook event."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"You will need to create a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Subscription"}]},{"type":"text","value":" model or similar in your Django models. This model should be related to your user model in some way. At a minimum it should have the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"subscription_id"}]},{"type":"text","value":" (the ID of the Stripe Subscription) and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"current_period_end"}]},{"type":"text","value":" (also from the Stripe Subscription object). We will use this model in the next sections."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/stripe-webhooks/"}]},{"type":"text","value":" is the endpoint in the Django application that Stripe will send POST requests to in order to inform the Django application of events that happen in Stripe. The URL can be called anything you want, as long as you register it with that URL. In local development, you need to specify this URL in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stipe listen"}]},{"type":"text","value":" command (for example, "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stripe listen forward-to localhost/api/stripe-webhooks/"}]},{"type":"text","value":")."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"STRIPE_SECRET_KEY"}]},{"type":"text","value":" is the name of the secret API key that should only be accessible by the backend. In local development, this key looks like "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sk_test_Abc123"}]},{"type":"text","value":". In production, this key will look like "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sk_Abc123"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stripe"}]},{"type":"text","value":" is the name of the PyPI package that we need to add to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"requirements.txt"}]},{"type":"text","value":" ("},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"requirements/base.txt"}]},{"type":"text","value":")."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"STRIPE_PUBLISHABLE_KEY"}]},{"type":"text","value":" is the value of the Stripe API key that can be made public and is used in the Vue application to instantiate Stripe."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The Stripe library is included in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"index.html"}]},{"type":"text","value":" via CDN so that it is accessible anywhere in the Vue application. Stripe object is instantiated in the Vue application with:"},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"let stripe = Stripe(process.env.STRIPE_PUBLISHABLE_KEY)"}]}]}]}]}]},{"type":"element","tag":"h3","props":{"id":"ii-logic-and-data-flow-for-starting-a-customers-premium-monthly-subscription"},"children":[{"type":"text","value":"II. Logic and data flow for starting a customer's premium monthly subscription"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"With everything setup and configured properly in Stripe, the backend Django application and the frontend Vue application, customers can now start paying for monthly subscriptions. In my application, a user can sign up for an account first without having a premium subscription. In other scenarios, having an active account may require a premium subscription."}]},{"type":"element","tag":"ol","props":{"start":13},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When a logged-in user visits their "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/account"}]},{"type":"text","value":" page, they will see the status of their account: Basic (free) or Premium (paid subscription). Users on a Basic plan will see the option to upgrade to Premium. They will be redirected to a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/premium"}]},{"type":"text","value":" page where they will be presented with a credit card form. This credit card form is generated by "},{"type":"element","tag":"a","props":{"href":"https://stripe.com/payments/elements","rel":["nofollow"]},"children":[{"type":"text","value":"Stripe Elements"}]},{"type":"text","value":". The user fills out their credit card, expiration date, card security code and billing ZIP code and then clicks "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Purchase"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Clicking on "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Purchase"}]},{"type":"text","value":" calls a method "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"purchase"}]},{"type":"text","value":" that calls "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stripe.CreatePaymentMethod"}]},{"type":"text","value":". The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"paymentMethodId"}]},{"type":"text","value":" token returned from "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stripe.CreatePaymentMethod"}]},{"type":"text","value":" is then passed to the method called "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"createSubscription"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Stripe creates this object and returns a response that contains a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"paymentMethodId"}]},{"type":"text","value":" token."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"createSubscription"}]},{"type":"text","value":" sends a POST request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/stripe/create-subscription/"}]},{"type":"text","value":" in the Django application with the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"paymentMethodId"}]},{"type":"text","value":" that we generated in the previous step."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/stripe/create-subscription/"}]},{"type":"text","value":" calls a view called "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"create_subscription"}]},{"type":"text","value":" which makes a number of API calls to Stripe and then finally saves some data in the application's Postgres database."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The first API call creates the Customer object in Stripe if it does not exist. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"email=request.user.email"}]},{"type":"text","value":" is used in the API call to associate the Stripe customer with the user's email."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Next the payment method is attached to Stripe Customer model."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Next the Stripe payment method is set as the default payment method for Stripe customer for future billing."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The Stripe subscription model is created with the customer ID that was created in the earlier and the price ID corresponding to the premium subscription (added in the setup stage)."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Once these Stripe API calls have finished, a new Subscription is saved in the Postgres database. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stripe_subscription_id"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stripe_customer_id"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"valid_through"}]},{"type":"text","value":" (DateTimeField that keeps track of the date through which the user's subscription has been paid for) are saved to the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Subscription"}]},{"type":"text","value":" model and then the subscription model is saved to the user model's "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"subscription"}]},{"type":"text","value":" field."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"createSubscription"}]},{"type":"text","value":" method's POST requests returns successfully, the user's account is fetched again from "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The browser makes a request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]},{"type":"text","value":" returns information on the user and their subscription."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Data from "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]},{"type":"text","value":" is updated in Vuex "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"user"}]},{"type":"text","value":" store."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The user is now able to make requests to resources for premium features."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"In this application, one such example is the ability to request an API key for making for making API calls."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"A user makes a request to an API endpoint for a premium feature."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When determining permissions for resources that should only be accessible to customers with valid subscriptions, we need to compare "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"request.user.subscription.valid_through"}]},{"type":"text","value":" to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"timezone.now()"}]},{"type":"text","value":" and make sure that "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"valid_through"}]},{"type":"text","value":" is greater than "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"timezone.now()"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Requests for protected resources are successfully returned to the browser."}]}]},{"type":"element","tag":"h3","props":{"id":"iii-automatic-subscription-renewal"},"children":[{"type":"text","value":"III. Automatic subscription renewal"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The customer's credit card is charged once each month that they are subscribed to the service. This action happens in Stripe. This section assumes that the customer's primary payment method is still valid (it has not been canceled expired or not able to be charged for some other reason)."}]},{"type":"element","tag":"ol","props":{"start":32},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The customer's card is charged in Stripe and an event is sent to the Django backend via a webhook that we registered in the setup stage."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The webhook view checks "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"event.type"}]},{"type":"text","value":" and if the event is of type "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"invoice.paid"}]},{"type":"text","value":" we extend the user's subscription by one month."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"To extend the user's subscription, we modify the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DateTimeField"}]},{"type":"text","value":" field on the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Subscription"}]},{"type":"text","value":" that tracks the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"current_period_end"}]},{"type":"text","value":" which is included in the webhook data object. The model field in my code is called "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"valid_through"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"h3","props":{"id":"iv-cancelling-a-premium-subscription"},"children":[{"type":"text","value":"IV. Cancelling a premium subscription"}]},{"type":"element","tag":"ol","props":{"start":35},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When a user decides to cancel their payed subscription service, they click on the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Cancel My Subscription"}]},{"type":"text","value":" button."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"This makes a POST request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/stripe/cancel-subscription"}]},{"type":"text","value":" which calls the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"cancel_subscription"}]},{"type":"text","value":" view. This view calls "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stripe.Subscription.delete(subscriptionId)"}]},{"type":"text","value":", where the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"subscriptionId"}]},{"type":"text","value":" is retrieved from "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"request.user.subscription"}]},{"type":"text","value":" (the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Subscription"}]},{"type":"text","value":" model created in the setup section)."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The subscription is deleted in Stripe through the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stripe.Subscription.delete"}]},{"type":"text","value":" API call."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The user's subscription is deleted from the user model with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"request.user.subscription.delete()"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The frontend responds to the deleted subscription by fetching "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]},{"type":"text","value":" again, refresh, or redirecting and the user no longer has access to their premium subscription."}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"context","depth":2,"text":"Context"},{"id":"diagram","depth":2,"text":"Diagram"},{"id":"legend","depth":2,"text":"Legend","children":[{"id":"i-account-setup-configuration-model-and-object-creation","depth":3,"text":"I. Account setup, configuration, model and object creation"},{"id":"ii-logic-and-data-flow-for-starting-a-customers-premium-monthly-subscription","depth":3,"text":"II. Logic and data flow for starting a customer's premium monthly subscription"},{"id":"iii-automatic-subscription-renewal","depth":3,"text":"III. Automatic subscription renewal"},{"id":"iv-cancelling-a-premium-subscription","depth":3,"text":"IV. Cancelling a premium subscription"}]}]}},"_type":"markdown","_id":"content:2021:01:02:using-the-stripe-api-for-recurring-monthly-saas-subscription-payments-in-django-and-vue-application.md","_source":"content","_file":"2021/01/02/using-the-stripe-api-for-recurring-monthly-saas-subscription-payments-in-django-and-vue-application.md","_stem":"2021/01/02/using-the-stripe-api-for-recurring-monthly-saas-subscription-payments-in-django-and-vue-application","_extension":"md"},{"_path":"/2021/01/01/session-authentication-with-django-django-rest-framework-and-nuxt","_dir":"01","_draft":false,"_partial":false,"_locale":"","title":"Session Authentication with Django, Django REST Framework and Nuxt","description":"This article shows how to use session authentication with Django + Nuxt.js applications","date":"2021-01-01T00:00:00.000Z","image":"/static/django_nuxt_auth_og.png","tags":["django","vue","nuxt","drf","authentication"],"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This will be a continuation of the discussion about how data flows in Django + Nuxt applications, looking specifically at session authentication."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here's a GitLab repo that where you can find the source code and other diagrams related to this project:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://gitlab.com/briancaffey/django-nuxt-starter","rel":["nofollow"]},"children":[{"type":"text","value":"https://gitlab.com/briancaffey/django-nuxt-starter"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This diagram focuses on the interactions between:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I. The browser"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"II. The Nuxt server (Node process)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"III. The Django backend API server (gunicorn process)"}]},{"type":"element","tag":"h2","props":{"id":"context"},"children":[{"type":"text","value":"Context"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For illustration purposes, I'm using a simple CRUD application that has two models: Users and (blog) Posts. Users can log in with email and password credentials and create, read, update and delete blog posts (CRUD). Currently I'm only doing the R (read) of CRUD: listing and viewing blog posts. Creating, updating and delete will be added later. For now, users must be logged in to see posts."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I'm still learning a lot about Nuxt and how it can be used with Django and Django REST Framework. This project is an effort at documenting my learning process, learning in public and learning from mistakes, so any feedback or guidance on what I have written here would be highly appreciated!"}]},{"type":"element","tag":"h2","props":{"id":"why-nuxt"},"children":[{"type":"text","value":"Why Nuxt?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Using Nuxt (with Server Side Rendering, or SSR) is one of many ways to use Vue.js with Django. Vue is a progressive framework, which means that it can be gradually adopted into a project--you don't have to go all-in on the framework or rewrite the application from scratch to fit with how Vue works."}]},{"type":"element","tag":"h3","props":{"id":"different-ways-to-use-vue-with-django"},"children":[{"type":"text","value":"Different ways to use Vue with Django"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In terms of Django, here are some ways that you can use Vue:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Vue as a jQuery replacement for adding basic interactivity in views served by Django templates"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Build a static Vue application and serve it as a set of static assets in a Django project alongside routes that are served by other normal Django templates views."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Build a Vue SPA which consumes a Django API (usually built with Django REST Framework or similar), and serve it over a content delivery network (CDN)."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Use Vue to build an Electron desktop app that uses Django as an API"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In these scenarios, Vue is served as either static assets (such as in the case of serving a SPA over a CDN), or Vue code is included in an HTML response from a server (where the view library, not your application, is served over a CDN), similar to how jQuery is used."}]},{"type":"element","tag":"h3","props":{"id":"different-ways-to-use-nuxt"},"children":[{"type":"text","value":"Different ways to use Nuxt"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nuxt is a Framework that can be used in a few different ways, I'll briefly discus three ways in which Nuxt can be used. Common to all three of these ways of using Nuxt is the directory structure. No matter how you use Nuxt, it provides a great way to organize Vue code."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Static mode: this mode allows you to write Vue code which is built into a static HTML, and then that HTML is deployed to a CDN or webserver like NGINX. The developer (or CI/CD process) runs a command to generate HTML files for each page in the application, and these pages are served as-is when accessed by a user. I recently migrated my personal blog from Jekyll to Nuxt with full-static mode. Check it out at ("},{"type":"element","tag":"a","props":{"href":"https://briancaffey.github.io","rel":["nofollow"]},"children":[{"type":"text","value":"briancaffey.github.io"}]},{"type":"text","value":")."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"SPA mode: This is similar to what you might use if you started a Vue project with Vue CLI. The project is also generated as in Static Mode, but what is generated is primarily Javascript code that is executed on the browser."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"SSR mode: Server Side Rendering is the mode that I'll be focusing on here. Unlike the other ways of using Vue that have already been discussed, this mode involves a Node.js server that will handle our requests. For example, a web request for "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]},{"type":"text","value":" is sent to our Nuxt Server (a Node.js server process) and Node.js is responsible for returning HTML that contains all of the blog Posts that we want to show (or a paginated selection of all blog posts, which is how my example blog app is built). So the Nuxt app has to make a request to our Django API server before returning fully rendered HTML page for the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]},{"type":"text","value":" page. The user then gets the page from Nuxt, reads all of the blog posts and then decides to check out the blog posts on the second page of posts. When the user clicks on page 2, we request the second page of data from our Django API directly, not from Nuxt. The user then sees a short loading animation followed by the second page of blog posts that are loaded in using AJAX (usually with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" or axios)."}]}]},{"type":"element","tag":"h3","props":{"id":"nuxt-benefits"},"children":[{"type":"text","value":"Nuxt Benefits"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The main reason for using Nuxt is to render the first page loads on the server, returning a complete HTML response that can be beneficial for SEO, social sharing, and other scenarios where you need control over how a website's pages are delivered (specifically, the initial request made to the server)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This type of control is not possible for applications that serve Vue over CDN since they can only request backend API data once the JS client has been requested from a CDN."}]},{"type":"element","tag":"h3","props":{"id":"nuxt-downsides-and-tradeoffs"},"children":[{"type":"text","value":"Nuxt Downsides and Tradeoffs"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Using Nuxt for SSR introduces quite a bit of complexity in both the application deployment and our Vue code. The backend API won't have to change at all when moving to Nuxt from a static Vue SPA."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Django alone is capable of returning fully generated, SEO-optimized HTML for each request, but applications built with Vue and Django templates may be difficult to work on as the project grows larger and larger. The Django/DRF + Nuxt approach may be more appropriate for projects with dedicated backend and frontend teams."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"One other potential downside is added latency because of the \"double request\". If the Nuxt server and the Django server are on the same machine, then this latency will probably be a non-issue."}]},{"type":"element","tag":"h2","props":{"id":"diagram"},"children":[{"type":"text","value":"Diagram"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Nuxt Django Auth","src":"/static/django_nuxt_auth.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This diagram looks at session authentication with a focus on the browser, the Nuxt server and the Django server. It looks at two simple user stories, ordered from top to bottom in the diagram."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I. An existing application user visits the site in a new browser, navigates to the Login page, logs in with credentials and then visits a protected page: "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]},{"type":"text","value":".\nII. The user closes the browser and then comes back directly to the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]},{"type":"text","value":" page."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"These two user stories sound simple, but they touch on a lot of the features of Nuxt that make it powerful, and complicated at first (for Vue users). These include:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"asyncData"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxtServerInit"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Vuex on the client and server"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Custom plugin for axios"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Some important parts of Nuxt that this diagram does not (yet) touch on are:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Nuxt auth module (I don't know if this is relevant for my use case)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Nuxt fetch property (different from the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"fetch"}]},{"type":"text","value":" web API)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Nuxt middleware (I'm also not sure if this would be helpful for anything I am doing in this example project)"}]}]},{"type":"element","tag":"h3","props":{"id":"user-story-i-a-user-tries-to-open-posts-is-redirected-to-login-logs-in-then-navigate-to-posts-and-sees-blog-posts"},"children":[{"type":"text","value":"User story I.: A user tries to open "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]},{"type":"text","value":", is redirected to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/login"}]},{"type":"text","value":", logs in, then navigate to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]},{"type":"text","value":" and sees blog posts"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"User navigates to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://domain.com/"}]},{"type":"text","value":". This request is handled by the Nuxt server."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxtServerInit"}]},{"type":"text","value":" action is called ("},{"type":"element","tag":"a","props":{"href":"https://nuxtjs.org/docs/2.x/directory-structure/store#the-nuxtserverinit-action","rel":["nofollow"]},"children":[{"type":"text","value":"read more on nuxtServerInit"}]},{"type":"text","value":"). This is a special Vuex action that, if defined in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"store/index.js"}]},{"type":"text","value":", will be called once per request to the Nuxt Server (when a page is initially visited or refreshed in the browser)."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxtServerInit"}]},{"type":"text","value":" dispatches a Vuex action in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"user"}]},{"type":"text","value":" module called "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"fetchData"}]},{"type":"text","value":". This action makes an GET request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]},{"type":"text","value":" in the Django application."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"An API call to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]},{"type":"text","value":" is made to the Django backend directly from the Nuxt container over the docker network ("},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"backend:8000"}]},{"type":"text","value":")"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"If the request is made by an anonymous user (no user is logged in), a 403 response is returned to the Nuxt server and no account data is set in the Vuex store (on the server)."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Since the user is currently not logged in, the request returns a 403 response."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"authMiddleware"}]},{"type":"text","value":" (on the Nuxt server) redirects the user to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/login"}]},{"type":"text","value":" based on the value of "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"authenticated"}]},{"type":"text","value":" in the Vuex store. The Original request for "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]},{"type":"text","value":" returns a fully-rendered "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/login/"}]},{"type":"text","value":" page instead."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"User is now on the Login page"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"created"}]},{"type":"text","value":" hook for the Login page makes a GET request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/login-set-cookie/"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"10, 11. This endpoint calls a simple view that is decorated with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@ensure_csrf_token"}]},{"type":"text","value":"."}]},{"type":"element","tag":"ol","props":{"start":12},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When the response returns to the browser, the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"csrftoken"}]},{"type":"text","value":" is set in the browser."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The $apiCall function is defined in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"plugins/axios.js"}]},{"type":"text","value":", and it adds the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"csrftoken"}]},{"type":"text","value":" cookie to the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"X-CSRFToken"}]},{"type":"text","value":" header of API requests. This is important for POST request where the CSRF token is required. When the user fills out their email and password in the login form, the $apiCall function is called with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/login/"}]},{"type":"text","value":" and the email/password as credentials."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The email and password are sent as data in the POST request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/login/"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"15, 16. The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/login/"}]},{"type":"text","value":" URL calls the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"login_view"}]},{"type":"text","value":" which makes use of two functions from "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"django.contrib.auth"}]},{"type":"text","value":": "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"authenticate"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"login"}]},{"type":"text","value":". "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"authenticate"}]},{"type":"text","value":" gets a user from the provided email/password, and the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"login"}]},{"type":"text","value":" function sets an HttpOnly "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sessionid"}]},{"type":"text","value":" session cookie on the response."}]},{"type":"element","tag":"ol","props":{"start":17},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The HttpOnly "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sessionid"}]},{"type":"text","value":" cookie is automatically set on the browser when the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/login/"}]},{"type":"text","value":" request returns successfully."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When this "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/login/"}]},{"type":"text","value":" request returns successfully, a value in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"auth"}]},{"type":"text","value":" Vuex module is set to keep track of the current user's logged in state."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Next, a GET request is made to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"20, 21. Since the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sessionid"}]},{"type":"text","value":" cookie is set and sent along with the request automatically, this request will succeed."}]},{"type":"element","tag":"ol","props":{"start":22},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]},{"type":"text","value":" request returns, the user's account information is saved to the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"user"}]},{"type":"text","value":" Vuex module. At this point, the client may redirect automatically to the home page, or user account page, dashboard, etc."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Now logged in, the user navigates (again via Vue router) to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]},{"type":"text","value":", a page that shows a paginated view of all blog posts."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"This page has an "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":" method which is called when the page component is created and it dispatches a Vuex action "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"posts/fetchData"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"This Vuex action makes a GET request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/posts/"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"26, 27. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/posts/"}]},{"type":"text","value":" uses a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ModelViewSet"}]},{"type":"text","value":" and returns a paginated list of blog posts"}]},{"type":"element","tag":"ol","props":{"start":28},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/posts/"}]},{"type":"text","value":" request returns successfully, the blog post data is saved to the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"blog"}]},{"type":"text","value":" Vuex module."}]}]},{"type":"element","tag":"h3","props":{"id":"user-story-ii-logged-in-user-opens-new-browser-window-and-revisits-posts"},"children":[{"type":"text","value":"User story II.: Logged in user opens new browser window and revisits "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]}]},{"type":"element","tag":"ol","props":{"start":29},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The user closes their browser and then opens a new browser window and navigates to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxtServerInit"}]},{"type":"text","value":" is called as usual,"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"user/fetchData"}]},{"type":"text","value":" action is called. This action makes a GET request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]},{"type":"text","value":" request returns successfully. The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sessionid"}]},{"type":"text","value":" cookie is passed along from the browser to the API request that is made from the Nuxt server to the backend API ("},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/account/"}]},{"type":"text","value":").  User account data is then set on the Vuex "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"user"}]},{"type":"text","value":" module."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":" method for the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]},{"type":"text","value":" pages is called."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":" dispatches a Vuex action "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"posts/fetchData"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"posts/fetchData"}]},{"type":"text","value":" makes an API request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/posts/"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/posts/"}]},{"type":"text","value":" request is handled by a "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ModelViewSet"}]},{"type":"text","value":" for the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Post"}]},{"type":"text","value":" model that gets blog posts and then sets them to the Vuex store (on the server) when the request returns a response (to the Nuxt server)."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Once the async data fetching is compete ("},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxtServerInit"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":" for the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts"}]},{"type":"text","value":" page), the page HTML is rendered using the Vuex store data stored on the server. The Vuex data is sent back with the rendered HTML (I think this is how it works)."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Finally, the user sees the list of blog posts. The page is loaded \"at once\"; there is no waiting for data to load after loading the page initially."}]}]},{"type":"element","tag":"h2","props":{"id":"discussion"},"children":[{"type":"text","value":"Discussion"}]},{"type":"element","tag":"h3","props":{"id":"complexity"},"children":[{"type":"text","value":"Complexity"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Is this authentication process overly complicated? When I make these diagrams, I try to make simple concept as detailed as possible, but there are a lot of distinct actions being taken in many different parts of the application and getting them all into one diagram was tricky."}]},{"type":"element","tag":"h3","props":{"id":"httponly-session-cookies"},"children":[{"type":"text","value":"HttpOnly Session Cookies"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Session authentication is the officially recommended way to do authentication with Django REST Framework for clients that run in the browser. However, there seem to be lots of people using JWT with DRF and Javascript clients that run in the browser. The main argument against doing this is that the JWT must be stored in a Javascript-accessible store (localStorage or Cookies) so it can be passed with each request. Many people are also interested in trying to store JWT for authentication in HttpOnly cookies to harden client-side security. I'm very curious to know if anyone is actually doing this, and what the implementation looks like. While "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"djangorestframework_simplejwt"}]},{"type":"text","value":" doesn't support HttpOnly, there seems to be lots of interest in doing this. I think it might be possible with a special middleware, so let me know if anyone is interested in proof-of-concept/diagram for that."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Some use cases for JWT and other token authentication methods with DRF might include native mobile apps or Desktop apps. For most cases, I think session authentication with Django's built in session cookies for DRF authentication is the best option. JWTs also have no clear solution for logging out, which may be important for some security considerations. The concept of stateless authentication is interesting, but for most use cases I would argue that it is not worth doing. Let me know if anyone has thoughts on this, I'm curious to see what everyone thinks."}]},{"type":"element","tag":"h3","props":{"id":"next-steps"},"children":[{"type":"text","value":"Next Steps"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"My next steps for this project/repo are to deploy this to a production environment as soon as I have time to do so. My local setup has been working well, and I think it should work well for a simple DigitalOcean docker swarm deployment like I have done with other Django + Vue projects."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I also want to add the create, update and delete functionality for posts, improve error handling with API calls, add form validation, and maybe write some tests with Jest."}]},{"type":"element","tag":"h2","props":{"id":"questions"},"children":[{"type":"text","value":"Questions"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here are some questions and areas that I still need to investigate."}]},{"type":"element","tag":"h3","props":{"id":"nuxt-composition-api"},"children":[{"type":"text","value":"Nuxt Composition API"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I have seen that there is a Composition API module for Nuxt. I have only just now started looking at Composition API examples and documentation for \"vanilla\" Vue, but I have heard that the Nuxt Composition API module has some additional features specifically for use with Nuxt, so I'm curious to learn what these are."}]},{"type":"element","tag":"h3","props":{"id":"nuxt-v3-and-vue-3"},"children":[{"type":"text","value":"Nuxt v3 and Vue 3"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nuxt looks like it has plans to support Vue 3, so I am interested to learn more about Vue 3 as it is adopted by Vue frameworks such as Nuxt and Quasar."}]},{"type":"element","tag":"h3","props":{"id":"nuxts-fetch-method-server-middleware-nuxt-auth-module"},"children":[{"type":"text","value":"Nuxt's fetch method, server middleware, Nuxt auth module"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I think I am using server middleware correctly, it can be improved by redirecting to the initial requested route after successful login. I'm not sure if I should use the Nuxt auth module in this application, I have read that it doesn't support HttpOnly cookie use cases, but I could be wrong."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"context","depth":2,"text":"Context"},{"id":"why-nuxt","depth":2,"text":"Why Nuxt?","children":[{"id":"different-ways-to-use-vue-with-django","depth":3,"text":"Different ways to use Vue with Django"},{"id":"different-ways-to-use-nuxt","depth":3,"text":"Different ways to use Nuxt"},{"id":"nuxt-benefits","depth":3,"text":"Nuxt Benefits"},{"id":"nuxt-downsides-and-tradeoffs","depth":3,"text":"Nuxt Downsides and Tradeoffs"}]},{"id":"diagram","depth":2,"text":"Diagram","children":[{"id":"user-story-i-a-user-tries-to-open-posts-is-redirected-to-login-logs-in-then-navigate-to-posts-and-sees-blog-posts","depth":3,"text":"User story I.: A user tries to open /posts, is redirected to /login, logs in, then navigate to /posts and sees blog posts"},{"id":"user-story-ii-logged-in-user-opens-new-browser-window-and-revisits-posts","depth":3,"text":"User story II.: Logged in user opens new browser window and revisits /posts"}]},{"id":"discussion","depth":2,"text":"Discussion","children":[{"id":"complexity","depth":3,"text":"Complexity"},{"id":"httponly-session-cookies","depth":3,"text":"HttpOnly Session Cookies"},{"id":"next-steps","depth":3,"text":"Next Steps"}]},{"id":"questions","depth":2,"text":"Questions","children":[{"id":"nuxt-composition-api","depth":3,"text":"Nuxt Composition API"},{"id":"nuxt-v3-and-vue-3","depth":3,"text":"Nuxt v3 and Vue 3"},{"id":"nuxts-fetch-method-server-middleware-nuxt-auth-module","depth":3,"text":"Nuxt's fetch method, server middleware, Nuxt auth module"}]}]}},"_type":"markdown","_id":"content:2021:01:01:session-authentication-with-django-django-rest-framework-and-nuxt.md","_source":"content","_file":"2021/01/01/session-authentication-with-django-django-rest-framework-and-nuxt.md","_stem":"2021/01/01/session-authentication-with-django-django-rest-framework-and-nuxt","_extension":"md"},{"_path":"/2020/12/27/building-web-applications-with-django-drf-and-nuxt","_dir":"27","_draft":false,"_partial":false,"_locale":"","title":"Building web applications with Django, Django REST Framework, Nuxt.js and docker","description":"This article documents my progress combining the Django web framework with Nuxt JS to build applications that have both great SEO and a smooth SPA user experience.","date":"2020-12-27T00:00:00.000Z","image":"/static/django_nuxt_app_diagram.png","tags":["django","vue","nuxt","drf","docker"],"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Over the holidays between lots of big meals and many naps, I tried to tackle one more goal of mine before this year come to an end: building an application with Django and Nuxt.js."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This year I rebuilt my personal blog ("},{"type":"element","tag":"a","props":{"href":"https://briancaffey.github.io/","rel":["nofollow"]},"children":[{"type":"text","value":"briancaffey.github.io"}]},{"type":"text","value":") with Nuxt.js, the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@nuxt/content"}]},{"type":"text","value":" headless git-based CMS and TailwindCSS. It is statically generated with Nuxt's full-static mode and has been really enjoyable to work with. I have also learned a lot more about SEO and how Nuxt helps improve Vue applications' SEO. I have also been working a lot with Django and Vue.js applications where Django serves as an API to a Vue.js SPA. This combination of technologies works well for a lot of use cases, but it falls short in SEO. Nuxt also provides a great way to organize large Vue.js projects which I have been finding very helpful. For these reasons, combining Django and Nuxt has been something that I have wanted to try for a while, so this article will share some of my experiences in recent efforts to build with these two frameworks. I took "},{"type":"element","tag":"a","props":{"href":"https://gitlab.com/briancaffey/django-nuxt-starter/-/blob/develop/STEP_BY_STEP.md","rel":["nofollow"]},"children":[{"type":"text","value":"detailed notes of each step of the project setup"}]},{"type":"text","value":" starting from an empty repository, and I put together a diagram of my understanding of how data flows in the application."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here's the link to the project repository that I'll be referencing: "},{"type":"element","tag":"a","props":{"href":"https://gitlab.com/briancaffey/django-nuxt-starter","rel":["nofollow"]},"children":[{"type":"text","value":"https://gitlab.com/briancaffey/django-nuxt-starter"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This article will focus on explaining the project through the diagram shown below. I added two types of labels: letters and numbers. The letters will introduce each component of the application and its role in the application as a whole. The numbers summarize how data flows through the different components in my sample blog application."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Diagram","src":"/static/django_nuxt_app_diagram.png"},"children":[]}]},{"type":"element","tag":"h2","props":{"id":"diagram-components"},"children":[{"type":"text","value":"Diagram components"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A. Your computer - Possibly also your development machine which is running the application in docker containers with docker-compose."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"B. NGINX - This is the \"front desk\" of the application that does a few different things. It is the first component that web requests come to. It serves as a reverse proxy which does path-based routing. It looks at the URL request and determines where to send it. For example: "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/posts/1"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/dashboard/"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/admin/"}]},{"type":"text","value":" could all be routed differently depending on the NGINX configuration file. We will look at this again in the next section. This  component, like most of the other things in the diagram, runs in a container. NGINX can also serve static files for our Django app and do TLS termination to make our application available over a secure HTTPS connection."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"C. Nuxt.JS server - The first \"S\" in SSR (server side rendering). It is a Node.js process that renders HTML from Vue components that we define in our Nuxt app, as well as data fetched from other servers/APIs before returning HTML back to the client."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"D. Django server - This runs the WSGI application with a gunicorn process in a container."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"E. Django REST Framework is a Django package the facilitates the creation of REST API endpoints. This is part of the Django application, it primarily takes care of data serialization (which can be thought of as translating between JSON and Python objects that represent rows of data in our Postgres database)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"F. This is the Postgres database, also a containerized service. It is on the same docker network as the Django/gunicorn application, so the Django application can connect to the Postgres database using the hostname "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"postgres"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"G. docker-compose is used to orchestrate the docker network, containers and volumes that make up the application."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"H. This box represents the docker network that allows for easy networking between services. We will come back to this the significance of this in the next section."}]},{"type":"element","tag":"h2","props":{"id":"data-flow-in-the-application"},"children":[{"type":"text","value":"Data flow in the application"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The simple application I have built for this demonstration is a blog. There is only a list view and a detail view for simple blog post model with three fields: title, body and created date. For the list view, the frontend (Nuxt) route is "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts/"}]},{"type":"text","value":" and the backend route is "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/posts/"}]},{"type":"text","value":" for the detail view the frontend route is "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts/_id"}]},{"type":"text","value":" and the API route is "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/posts/_id/"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The data flow shown here will walk through what happens when a user visits "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://localhost/posts/"}]},{"type":"text","value":", and then show what happens when the user clicks on one of the listed posts to see the detail view of the post ("},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://localhost/posts/2"}]},{"type":"text","value":")."}]},{"type":"element","tag":"ol","props":{"start":0},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"docker-compose up"}]},{"type":"text","value":" is one command that is used to start the entire application in local development. This exposes the NGINX process on port 80 of the host machine (your laptop)."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When the application is running on your machine and you navigate to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://localhost/posts/"}]},{"type":"text","value":", the request is first handled by NGINX."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"As we mentioned earlier, NGINX's path-based routing sends all requests that do not start with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/*"}]},{"type":"text","value":" or "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/admin/*"}]},{"type":"text","value":" to the Nuxt.js server."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When the request gets to the Nuxt server, the Nuxt lifecycle methods start. The important one that I'm using so far is "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":". This property is used to request data that will be used in the rendering of our HTML response."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Inside of "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"asyncData"}]},{"type":"text","value":", the application uses axios to make a request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/posts/"}]},{"type":"text","value":" (for example). In "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxt.config.js"}]},{"type":"text","value":", the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"privateRuntimeConfig"}]},{"type":"text","value":" sets a baseUrl value for axios to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://backend:8000"}]},{"type":"text","value":". Since the Nuxt server is on the same docker network as the backend Django/gunicorn server, the Nuxt server is able to resolve "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://backend"}]},{"type":"text","value":" to the address of the backend server."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Django processes this endpoint, using the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"PostViewSet"}]},{"type":"text","value":", the views of which have been added to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"urlpatterns"}]},{"type":"text","value":" in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"blog/urls.py"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"PostViewSet"}]},{"type":"text","value":" makes a database query on the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"posts"}]},{"type":"text","value":" which is used to serialize the data."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The Django server returns the response to the original axios call."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The data returned from Django is used to render the HTML response."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The HTML response from the Nuxt server is sent back to the browser that originally navigated to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://localhost/posts/"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The user is presented with page that lists blog posts. Each blog posts lists to a detail view. When a blog post (let's say the post with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"id"}]},{"type":"text","value":" of 2) is clicked on, a request for "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/posts/2/"}]},{"type":"text","value":" is made directly to the Django backend. The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"browserBaseURL"}]},{"type":"text","value":" value in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"axios"}]},{"type":"text","value":" settings under "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"publicRuntimeConfig"}]},{"type":"text","value":" defined in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nuxt.config.js"}]},{"type":"text","value":" is set to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://localhost"}]},{"type":"text","value":", so the request is made to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://localhost/api/posts/2/"}]},{"type":"text","value":". To clarify, since we are making this request using axios in the browser, we can't make a request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://backend:8000/api/posts/2/"}]},{"type":"text","value":" like we did in step 4 ("},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://backend:8000/api/posts/"}]},{"type":"text","value":") because the browser doesn't know how to resolve the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"backend"}]},{"type":"text","value":" hostname."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"This request to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://localhost/api/posts/2/"}]},{"type":"text","value":", like all others, first goes to NGINX which sends it to the backend since the path starts with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/api/"}]},{"type":"text","value":". At this point the application functions like a regular Vue SPA making axios calls to a backend service. This is because we used "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"<nuxt-link>"}]},{"type":"text","value":" for the posts listed in the posts list view. If we used "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"<a>"}]},{"type":"text","value":" tags, we would go through the same process as in step 4 where the HTML is rendered on the Nuxt server and sent back to the browser all at once."}]}]},{"type":"element","tag":"h2","props":{"id":"discussion"},"children":[{"type":"text","value":"Discussion"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"My main takeaway is that using Nuxt and Django together can give you good SEO and a great SPA experience at the same time. Using Django alone, or Django with traditional non SSR Vue makes this harder to do. Being a progressive framework, there are a lot of ways to use Vue with any other backend. From what I have heard, most people use Vue via CDN similar to how jQuery was and still is delivered for use in the browser."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There is additional work in setting up 3 servers for a single application (Nuxt, Django and NGINX), but the tradeoff is that I am (at least I feel) very productive writing frontend logic in Vue and backend logic with DRF. I have never liked working with Django templates and I used to know a lot more about them than I do now."}]},{"type":"element","tag":"h2","props":{"id":"spotlight-for-baserowios-awesome-open-source-django-nuxt-application"},"children":[{"type":"text","value":"Spotlight for baserow.io's awesome open-source Django Nuxt application"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Lastly I want to mention that there are some great resources in the "},{"type":"element","tag":"a","props":{"href":"https://github.com/nuxt-community/awesome-nuxt","rel":["nofollow"]},"children":[{"type":"text","value":"nuxt-community/awesome-nuxt"}]},{"type":"text","value":" GitHub repo. There's one project that really stood out to me when I searched for \"django\" projects in the README, and that project is called "},{"type":"element","tag":"a","props":{"href":"https://baserow.io/","rel":["nofollow"]},"children":[{"type":"text","value":"baserow.io"}]},{"type":"text","value":" (repo: "},{"type":"element","tag":"a","props":{"href":"https://gitlab.com/bramw/baserow","rel":["nofollow"]},"children":[{"type":"text","value":"https://gitlab.com/bramw/baserow"}]},{"type":"text","value":"). Please check this repo our if you are interested in Django and Nuxt. This company is building an open source no-code database, similar to Airtable which I have worked with before."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Their entire product is open source and I have been very impressed with what I have seen. Please go give that project a star or consider becoming a Github sponsor if you are interested. I'm not affiliated with that project in any way, but I'll be referencing how they use Django and Nuxt to build their application."}]},{"type":"element","tag":"h2","props":{"id":"next-steps"},"children":[{"type":"text","value":"Next steps"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There is a still a lot I have to learn about Nuxt. I'm still very new to the Framework and this is my first time using Nuxt's SSR mode. Nuxt seems to have its own way of doing lots of things that I'm used to doing in Vue. There is a very supportive community and well-maintained official packages to help with lots of things, like the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"@nuxt/axios"}]},{"type":"text","value":" package that I'm using."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"My next step is to keep expanding my blog application. One thing I didn't mention is authentication. I plan on using Django session authentication for authenticating request to Django. It seems that it already works correctly in my application (logging in through Django admin and then navigating to Nuxt routes that make Django requests are working only when I'm logged in.) I think I have an idea about how Vuex, authentication and route guards will work together, but I haven't gotten there yet. If anyone has some good reference projects or recommendations on how to expand on what I already have, please let me know!"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"I know that Nuxt has an auth module, so I need to see if that is relevant for what I want need in my application. I also need to continue reading the Nuxt documentation. I still don't know what I don't know about Nuxt and the plugins and modules that it makes available. I also noticed that Nuxt has it's own version of the Vue 3 Composition API, something I am just now starting to learn more about, so that it another area I'll need to dig into eventually."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"diagram-components","depth":2,"text":"Diagram components"},{"id":"data-flow-in-the-application","depth":2,"text":"Data flow in the application"},{"id":"discussion","depth":2,"text":"Discussion"},{"id":"spotlight-for-baserowios-awesome-open-source-django-nuxt-application","depth":2,"text":"Spotlight for baserow.io's awesome open-source Django Nuxt application"},{"id":"next-steps","depth":2,"text":"Next steps"}]}},"_type":"markdown","_id":"content:2020:12:27:building-web-applications-with-django-drf-and-nuxt.md","_source":"content","_file":"2020/12/27/building-web-applications-with-django-drf-and-nuxt.md","_stem":"2020/12/27/building-web-applications-with-django-drf-and-nuxt","_extension":"md"}]