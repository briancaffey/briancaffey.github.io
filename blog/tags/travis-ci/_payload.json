[{"data":1,"prerenderedAt":9554},["ShallowReactive",2],{"/blog/tags/travis-ci/":3},[4],{"_path":5,"_dir":6,"_draft":7,"_partial":7,"_locale":8,"title":9,"description":8,"layout":10,"date":11,"comments":12,"image":13,"disqus_id":14,"tags":15,"body":22,"_type":9548,"_id":9549,"_source":9550,"_file":9551,"_stem":9552,"_extension":9553},"/2018/02/19/leaflet-maps-with-django","19",false,"","Display, filter and export geographical data in a Django app with Leaflet, Mapbox, DataTables, Bootstrap 4 and Travis-CI","post","2018-02-19T00:00:00.000Z",true,"/static/map_homepage.png","/2018/02/19/leaflet-maps-with-django.html",[16,17,18,19,20,21],"leaflet","django","mapbox","data-tables","bootstrap","travis-ci",{"type":23,"children":24,"toc":9536},"root",[25,36,51,65,74,87,110,115,282,287,292,299,304,316,524,529,535,548,561,566,1006,1019,1070,1082,1363,1368,1373,1377,2538,2542,2548,2561,2566,2945,2957,2961,3251,3255,3282,3303,3317,3336,3342,3355,3443,3462,3482,3961,3966,3979,3983,4081,4085,4098,4104,4139,4144,4663,4692,4728,5511,5523,5722,5728,5733,5763,6070,6082,6086,7002,7006,7042,7062,7070,7096,7101,7373,7378,7406,7412,7417,7425,7432,7437,7826,7831,7839,7852,7967,7979,8442,8551,8556,8562,8567,8587,8791,8796,8819,8832,8838,8843,8873,8882,9278,9286,9500,9505,9513,9518,9530],{"type":26,"tag":27,"props":28,"children":29},"element","p",{},[30],{"type":26,"tag":31,"props":32,"children":35},"img",{"alt":33,"src":34},"png","/static/map_entire.png",[],{"type":26,"tag":37,"props":38,"children":40},"h3",{"id":39},"live-demo-on-digitalocean",[41],{"type":26,"tag":42,"props":43,"children":47},"a",{"href":44,"rel":45},"http://159.89.235.193/books/",[46],"nofollow",[48],{"type":49,"value":50},"text","Live Demo on DigitalOcean",{"type":26,"tag":27,"props":52,"children":53},{},[54,56,63],{"type":49,"value":55},"This post is a review of my first attempt at using geographical data in a Django project. I have been interested in working with map APIs, and I once looked into the Google Maps API. For this project I chose to use ",{"type":26,"tag":42,"props":57,"children":60},{"href":58,"rel":59},"http://leafletjs.com/",[46],[61],{"type":49,"value":62},"Leaflet",{"type":49,"value":64},":",{"type":26,"tag":66,"props":67,"children":68},"blockquote",{},[69],{"type":26,"tag":27,"props":70,"children":71},{},[72],{"type":49,"value":73},"an open-source JavaScript library for mobile-friendly interactive maps",{"type":26,"tag":27,"props":75,"children":76},{},[77,79,85],{"type":49,"value":78},"Getting started with Leaflet is easy. All you need to do is request a public Mapbox API key which is free (with no credit card required). You can get a key from ",{"type":26,"tag":42,"props":80,"children":83},{"href":81,"rel":82},"https://www.mapbox.com/account/access-tokens/",[46],[84],{"type":49,"value":81},{"type":49,"value":86},".",{"type":26,"tag":27,"props":88,"children":89},{},[90,92,99,101,108],{"type":49,"value":91},"Then you will follow steps on the ",{"type":26,"tag":42,"props":93,"children":96},{"href":94,"rel":95},"http://leafletjs.com/examples/quick-start/",[46],[97],{"type":49,"value":98},"quickstart guide",{"type":49,"value":100}," and replace ",{"type":26,"tag":102,"props":103,"children":105},"code",{"className":104},[],[106],{"type":49,"value":107},"your.mapbox.access.token",{"type":49,"value":109}," with your Mapbox API key.",{"type":26,"tag":27,"props":111,"children":112},{},[113],{"type":49,"value":114},"{% raw %}",{"type":26,"tag":116,"props":117,"children":121},"pre",{"code":118,"language":119,"meta":8,"className":120,"style":8},"L.tileLayer(\n  'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}',\n  {\n    attribution:\n      'Map data &copy; \u003Ca href=\"http://openstreetmap.org\">OpenStreetMap\u003C/a> contributors, \u003Ca href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA\u003C/a>, Imagery © \u003Ca href=\"http://mapbox.com\">Mapbox\u003C/a>',\n    maxZoom: 18,\n    id: 'mapbox.streets',\n    accessToken: 'your.mapbox.access.token',\n  }\n).addTo(mymap)\n","javascript","language-javascript shiki shiki-themes github-light github-dark monokai",[122],{"type":26,"tag":102,"props":123,"children":124},{"__ignoreMap":8},[125,153,168,177,186,199,218,236,254,263],{"type":26,"tag":126,"props":127,"children":130},"span",{"class":128,"line":129},"line",1,[131,137,142,148],{"type":26,"tag":126,"props":132,"children":134},{"style":133},"--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2",[135],{"type":49,"value":136},"L",{"type":26,"tag":126,"props":138,"children":140},{"style":139},"--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2",[141],{"type":49,"value":86},{"type":26,"tag":126,"props":143,"children":145},{"style":144},"--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E",[146],{"type":49,"value":147},"tileLayer",{"type":26,"tag":126,"props":149,"children":150},{"style":139},[151],{"type":49,"value":152},"(\n",{"type":26,"tag":126,"props":154,"children":156},{"class":128,"line":155},2,[157,163],{"type":26,"tag":126,"props":158,"children":160},{"style":159},"--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74",[161],{"type":49,"value":162},"  'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}'",{"type":26,"tag":126,"props":164,"children":165},{"style":139},[166],{"type":49,"value":167},",\n",{"type":26,"tag":126,"props":169,"children":171},{"class":128,"line":170},3,[172],{"type":26,"tag":126,"props":173,"children":174},{"style":139},[175],{"type":49,"value":176},"  {\n",{"type":26,"tag":126,"props":178,"children":180},{"class":128,"line":179},4,[181],{"type":26,"tag":126,"props":182,"children":183},{"style":139},[184],{"type":49,"value":185},"    attribution:\n",{"type":26,"tag":126,"props":187,"children":189},{"class":128,"line":188},5,[190,195],{"type":26,"tag":126,"props":191,"children":192},{"style":159},[193],{"type":49,"value":194},"      'Map data &copy; \u003Ca href=\"http://openstreetmap.org\">OpenStreetMap\u003C/a> contributors, \u003Ca href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA\u003C/a>, Imagery © \u003Ca href=\"http://mapbox.com\">Mapbox\u003C/a>'",{"type":26,"tag":126,"props":196,"children":197},{"style":139},[198],{"type":49,"value":167},{"type":26,"tag":126,"props":200,"children":202},{"class":128,"line":201},6,[203,208,214],{"type":26,"tag":126,"props":204,"children":205},{"style":139},[206],{"type":49,"value":207},"    maxZoom: ",{"type":26,"tag":126,"props":209,"children":211},{"style":210},"--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF",[212],{"type":49,"value":213},"18",{"type":26,"tag":126,"props":215,"children":216},{"style":139},[217],{"type":49,"value":167},{"type":26,"tag":126,"props":219,"children":221},{"class":128,"line":220},7,[222,227,232],{"type":26,"tag":126,"props":223,"children":224},{"style":139},[225],{"type":49,"value":226},"    id: ",{"type":26,"tag":126,"props":228,"children":229},{"style":159},[230],{"type":49,"value":231},"'mapbox.streets'",{"type":26,"tag":126,"props":233,"children":234},{"style":139},[235],{"type":49,"value":167},{"type":26,"tag":126,"props":237,"children":239},{"class":128,"line":238},8,[240,245,250],{"type":26,"tag":126,"props":241,"children":242},{"style":139},[243],{"type":49,"value":244},"    accessToken: ",{"type":26,"tag":126,"props":246,"children":247},{"style":159},[248],{"type":49,"value":249},"'your.mapbox.access.token'",{"type":26,"tag":126,"props":251,"children":252},{"style":139},[253],{"type":49,"value":167},{"type":26,"tag":126,"props":255,"children":257},{"class":128,"line":256},9,[258],{"type":26,"tag":126,"props":259,"children":260},{"style":139},[261],{"type":49,"value":262},"  }\n",{"type":26,"tag":126,"props":264,"children":266},{"class":128,"line":265},10,[267,272,277],{"type":26,"tag":126,"props":268,"children":269},{"style":139},[270],{"type":49,"value":271},").",{"type":26,"tag":126,"props":273,"children":274},{"style":144},[275],{"type":49,"value":276},"addTo",{"type":26,"tag":126,"props":278,"children":279},{"style":139},[280],{"type":49,"value":281},"(mymap)\n",{"type":26,"tag":27,"props":283,"children":284},{},[285],{"type":49,"value":286},"{% endraw %}",{"type":26,"tag":27,"props":288,"children":289},{},[290],{"type":49,"value":291},"I'll come back to using Leaflet later on, and also show how to use Leaflet plugins that can be used to add functionality such as aggregating markers on a map.",{"type":26,"tag":293,"props":294,"children":296},"h2",{"id":295},"django-model",[297],{"type":49,"value":298},"Django model",{"type":26,"tag":27,"props":300,"children":301},{},[302],{"type":49,"value":303},"Next, let's look at the Django setup. For now I'm simply working with a local project and SQLite3 backend.",{"type":26,"tag":27,"props":305,"children":306},{},[307,309,315],{"type":49,"value":308},"To store latitude and longitude data, we can use ",{"type":26,"tag":102,"props":310,"children":312},{"className":311},[],[313],{"type":49,"value":314},"DecimalField",{"type":49,"value":64},{"type":26,"tag":116,"props":317,"children":321},{"code":318,"language":319,"meta":8,"className":320,"style":8},"class Book(models.Model):\n    title = models.CharField(max_length=300)\n    lat = models.DecimalField(max_digits=9, decimal_places=6)\n    lon = models.DecimalField(max_digits=9, decimal_places=6)\n    [...]\n","python","language-python shiki shiki-themes github-light github-dark monokai",[322],{"type":26,"tag":102,"props":323,"children":324},{"__ignoreMap":8},[325,365,404,458,506],{"type":26,"tag":126,"props":326,"children":327},{"class":128,"line":129},[328,334,340,345,351,355,360],{"type":26,"tag":126,"props":329,"children":331},{"style":330},"--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[332],{"type":49,"value":333},"class",{"type":26,"tag":126,"props":335,"children":337},{"style":336},"--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline",[338],{"type":49,"value":339}," Book",{"type":26,"tag":126,"props":341,"children":342},{"style":139},[343],{"type":49,"value":344},"(",{"type":26,"tag":126,"props":346,"children":348},{"style":347},"--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline",[349],{"type":49,"value":350},"models",{"type":26,"tag":126,"props":352,"children":353},{"style":139},[354],{"type":49,"value":86},{"type":26,"tag":126,"props":356,"children":357},{"style":347},[358],{"type":49,"value":359},"Model",{"type":26,"tag":126,"props":361,"children":362},{"style":139},[363],{"type":49,"value":364},"):\n",{"type":26,"tag":126,"props":366,"children":367},{"class":128,"line":155},[368,373,379,384,390,394,399],{"type":26,"tag":126,"props":369,"children":370},{"style":139},[371],{"type":49,"value":372},"    title ",{"type":26,"tag":126,"props":374,"children":376},{"style":375},"--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672",[377],{"type":49,"value":378},"=",{"type":26,"tag":126,"props":380,"children":381},{"style":139},[382],{"type":49,"value":383}," models.CharField(",{"type":26,"tag":126,"props":385,"children":387},{"style":386},"--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[388],{"type":49,"value":389},"max_length",{"type":26,"tag":126,"props":391,"children":392},{"style":375},[393],{"type":49,"value":378},{"type":26,"tag":126,"props":395,"children":396},{"style":210},[397],{"type":49,"value":398},"300",{"type":26,"tag":126,"props":400,"children":401},{"style":139},[402],{"type":49,"value":403},")\n",{"type":26,"tag":126,"props":405,"children":406},{"class":128,"line":170},[407,412,416,421,426,430,435,440,445,449,454],{"type":26,"tag":126,"props":408,"children":409},{"style":139},[410],{"type":49,"value":411},"    lat ",{"type":26,"tag":126,"props":413,"children":414},{"style":375},[415],{"type":49,"value":378},{"type":26,"tag":126,"props":417,"children":418},{"style":139},[419],{"type":49,"value":420}," models.DecimalField(",{"type":26,"tag":126,"props":422,"children":423},{"style":386},[424],{"type":49,"value":425},"max_digits",{"type":26,"tag":126,"props":427,"children":428},{"style":375},[429],{"type":49,"value":378},{"type":26,"tag":126,"props":431,"children":432},{"style":210},[433],{"type":49,"value":434},"9",{"type":26,"tag":126,"props":436,"children":437},{"style":139},[438],{"type":49,"value":439},", ",{"type":26,"tag":126,"props":441,"children":442},{"style":386},[443],{"type":49,"value":444},"decimal_places",{"type":26,"tag":126,"props":446,"children":447},{"style":375},[448],{"type":49,"value":378},{"type":26,"tag":126,"props":450,"children":451},{"style":210},[452],{"type":49,"value":453},"6",{"type":26,"tag":126,"props":455,"children":456},{"style":139},[457],{"type":49,"value":403},{"type":26,"tag":126,"props":459,"children":460},{"class":128,"line":179},[461,466,470,474,478,482,486,490,494,498,502],{"type":26,"tag":126,"props":462,"children":463},{"style":139},[464],{"type":49,"value":465},"    lon ",{"type":26,"tag":126,"props":467,"children":468},{"style":375},[469],{"type":49,"value":378},{"type":26,"tag":126,"props":471,"children":472},{"style":139},[473],{"type":49,"value":420},{"type":26,"tag":126,"props":475,"children":476},{"style":386},[477],{"type":49,"value":425},{"type":26,"tag":126,"props":479,"children":480},{"style":375},[481],{"type":49,"value":378},{"type":26,"tag":126,"props":483,"children":484},{"style":210},[485],{"type":49,"value":434},{"type":26,"tag":126,"props":487,"children":488},{"style":139},[489],{"type":49,"value":439},{"type":26,"tag":126,"props":491,"children":492},{"style":386},[493],{"type":49,"value":444},{"type":26,"tag":126,"props":495,"children":496},{"style":375},[497],{"type":49,"value":378},{"type":26,"tag":126,"props":499,"children":500},{"style":210},[501],{"type":49,"value":453},{"type":26,"tag":126,"props":503,"children":504},{"style":139},[505],{"type":49,"value":403},{"type":26,"tag":126,"props":507,"children":508},{"class":128,"line":188},[509,514,519],{"type":26,"tag":126,"props":510,"children":511},{"style":139},[512],{"type":49,"value":513},"    [",{"type":26,"tag":126,"props":515,"children":516},{"style":210},[517],{"type":49,"value":518},"...",{"type":26,"tag":126,"props":520,"children":521},{"style":139},[522],{"type":49,"value":523},"]\n",{"type":26,"tag":27,"props":525,"children":526},{},[527],{"type":49,"value":528},"This allows us to store numbers to six decimal places. The difference between 0 and 0.00001 is about 3 feet, so this gives us plenty of accuracy for our geographical coordinate data.",{"type":26,"tag":293,"props":530,"children":532},{"id":531},"plotting-books-on-a-map",[533],{"type":49,"value":534},"Plotting books on a map",{"type":26,"tag":27,"props":536,"children":537},{},[538,540,546],{"type":49,"value":539},"Plotting our books on a map is fairly straightforward, but there were a few obstacles to work around. Initially I setup an additional endpoint that returned an AJAX response with the longitude, latitude, title and link for each book. The ",{"type":26,"tag":102,"props":541,"children":543},{"className":542},[],[544],{"type":49,"value":545},"success",{"type":49,"value":547}," function in the AJAX call then passed the returned JSON into a function that populated the book data in the map.",{"type":26,"tag":27,"props":549,"children":550},{},[551,553,559],{"type":49,"value":552},"The main ",{"type":26,"tag":102,"props":554,"children":556},{"className":555},[],[557],{"type":49,"value":558},"books",{"type":49,"value":560}," page displays book data in two places: on the map and on the DataTable below the map. Since I was already making one database query for DataTables, I decided to reuse this data for the map and not use a separate request and database query. There are a few helpful idioms in Python and JavaScript to accomplish this.",{"type":26,"tag":27,"props":562,"children":563},{},[564],{"type":49,"value":565},"First, let's look at the request with some added comments:",{"type":26,"tag":116,"props":567,"children":569},{"code":568,"language":319,"meta":8,"className":320,"style":8},"def all_books(request):\n    \"\"\"\n    Main view for books. request.GET parameters are used to filter books\n    \"\"\"\n    books = Book.objects.all()\n    form = QueryForm(request.GET or None)\n    paramDict = request.GET\n\n    books = filter_books(books, paramDict)\n\n    page_count = books.aggregate(Sum('pages'))\n\n    # This takes the first book query an reformats the data so it can be read\n    # by the map script on the frontend.\n    map_books = [{'loc':[float(book.lon), float(book.lat)],\n                  'title':book.title,\n                  'url':book.get_absolute_url()} for book in books]\n    context = {\n        'books':books,\n        # Here, we apply `json.dumps`, `escapejs` and `marksafe` for security\n        # and proper formatting\n        'map_books': mark_safe(escapejs(json.dumps(map_books))),\n        'page_count':page_count['pages__sum'],\n        'form':form}\n    return render(request, 'books/books.html', context)\n\n",[570],{"type":26,"tag":102,"props":571,"children":572},{"__ignoreMap":8},[573,600,608,616,623,640,676,698,706,722,729,757,765,775,784,832,846,880,898,912,921,930,944,968,982],{"type":26,"tag":126,"props":574,"children":575},{"class":128,"line":129},[576,581,586,590,596],{"type":26,"tag":126,"props":577,"children":578},{"style":330},[579],{"type":49,"value":580},"def",{"type":26,"tag":126,"props":582,"children":583},{"style":144},[584],{"type":49,"value":585}," all_books",{"type":26,"tag":126,"props":587,"children":588},{"style":139},[589],{"type":49,"value":344},{"type":26,"tag":126,"props":591,"children":593},{"style":592},"--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[594],{"type":49,"value":595},"request",{"type":26,"tag":126,"props":597,"children":598},{"style":139},[599],{"type":49,"value":364},{"type":26,"tag":126,"props":601,"children":602},{"class":128,"line":155},[603],{"type":26,"tag":126,"props":604,"children":605},{"style":159},[606],{"type":49,"value":607},"    \"\"\"\n",{"type":26,"tag":126,"props":609,"children":610},{"class":128,"line":170},[611],{"type":26,"tag":126,"props":612,"children":613},{"style":159},[614],{"type":49,"value":615},"    Main view for books. request.GET parameters are used to filter books\n",{"type":26,"tag":126,"props":617,"children":618},{"class":128,"line":179},[619],{"type":26,"tag":126,"props":620,"children":621},{"style":159},[622],{"type":49,"value":607},{"type":26,"tag":126,"props":624,"children":625},{"class":128,"line":188},[626,631,635],{"type":26,"tag":126,"props":627,"children":628},{"style":139},[629],{"type":49,"value":630},"    books ",{"type":26,"tag":126,"props":632,"children":633},{"style":375},[634],{"type":49,"value":378},{"type":26,"tag":126,"props":636,"children":637},{"style":139},[638],{"type":49,"value":639}," Book.objects.all()\n",{"type":26,"tag":126,"props":641,"children":642},{"class":128,"line":201},[643,648,652,657,662,667,672],{"type":26,"tag":126,"props":644,"children":645},{"style":139},[646],{"type":49,"value":647},"    form ",{"type":26,"tag":126,"props":649,"children":650},{"style":375},[651],{"type":49,"value":378},{"type":26,"tag":126,"props":653,"children":654},{"style":139},[655],{"type":49,"value":656}," QueryForm(request.",{"type":26,"tag":126,"props":658,"children":659},{"style":210},[660],{"type":49,"value":661},"GET",{"type":26,"tag":126,"props":663,"children":664},{"style":375},[665],{"type":49,"value":666}," or",{"type":26,"tag":126,"props":668,"children":669},{"style":210},[670],{"type":49,"value":671}," None",{"type":26,"tag":126,"props":673,"children":674},{"style":139},[675],{"type":49,"value":403},{"type":26,"tag":126,"props":677,"children":678},{"class":128,"line":220},[679,684,688,693],{"type":26,"tag":126,"props":680,"children":681},{"style":139},[682],{"type":49,"value":683},"    paramDict ",{"type":26,"tag":126,"props":685,"children":686},{"style":375},[687],{"type":49,"value":378},{"type":26,"tag":126,"props":689,"children":690},{"style":139},[691],{"type":49,"value":692}," request.",{"type":26,"tag":126,"props":694,"children":695},{"style":210},[696],{"type":49,"value":697},"GET\n",{"type":26,"tag":126,"props":699,"children":700},{"class":128,"line":238},[701],{"type":26,"tag":126,"props":702,"children":703},{"emptyLinePlaceholder":12},[704],{"type":49,"value":705},"\n",{"type":26,"tag":126,"props":707,"children":708},{"class":128,"line":256},[709,713,717],{"type":26,"tag":126,"props":710,"children":711},{"style":139},[712],{"type":49,"value":630},{"type":26,"tag":126,"props":714,"children":715},{"style":375},[716],{"type":49,"value":378},{"type":26,"tag":126,"props":718,"children":719},{"style":139},[720],{"type":49,"value":721}," filter_books(books, paramDict)\n",{"type":26,"tag":126,"props":723,"children":724},{"class":128,"line":265},[725],{"type":26,"tag":126,"props":726,"children":727},{"emptyLinePlaceholder":12},[728],{"type":49,"value":705},{"type":26,"tag":126,"props":730,"children":732},{"class":128,"line":731},11,[733,738,742,747,752],{"type":26,"tag":126,"props":734,"children":735},{"style":139},[736],{"type":49,"value":737},"    page_count ",{"type":26,"tag":126,"props":739,"children":740},{"style":375},[741],{"type":49,"value":378},{"type":26,"tag":126,"props":743,"children":744},{"style":139},[745],{"type":49,"value":746}," books.aggregate(Sum(",{"type":26,"tag":126,"props":748,"children":749},{"style":159},[750],{"type":49,"value":751},"'pages'",{"type":26,"tag":126,"props":753,"children":754},{"style":139},[755],{"type":49,"value":756},"))\n",{"type":26,"tag":126,"props":758,"children":760},{"class":128,"line":759},12,[761],{"type":26,"tag":126,"props":762,"children":763},{"emptyLinePlaceholder":12},[764],{"type":49,"value":705},{"type":26,"tag":126,"props":766,"children":768},{"class":128,"line":767},13,[769],{"type":26,"tag":126,"props":770,"children":772},{"style":771},"--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F",[773],{"type":49,"value":774},"    # This takes the first book query an reformats the data so it can be read\n",{"type":26,"tag":126,"props":776,"children":778},{"class":128,"line":777},14,[779],{"type":26,"tag":126,"props":780,"children":781},{"style":771},[782],{"type":49,"value":783},"    # by the map script on the frontend.\n",{"type":26,"tag":126,"props":785,"children":787},{"class":128,"line":786},15,[788,793,797,802,807,812,818,823,827],{"type":26,"tag":126,"props":789,"children":790},{"style":139},[791],{"type":49,"value":792},"    map_books ",{"type":26,"tag":126,"props":794,"children":795},{"style":375},[796],{"type":49,"value":378},{"type":26,"tag":126,"props":798,"children":799},{"style":139},[800],{"type":49,"value":801}," [{",{"type":26,"tag":126,"props":803,"children":804},{"style":159},[805],{"type":49,"value":806},"'loc'",{"type":26,"tag":126,"props":808,"children":809},{"style":139},[810],{"type":49,"value":811},":[",{"type":26,"tag":126,"props":813,"children":815},{"style":814},"--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic",[816],{"type":49,"value":817},"float",{"type":26,"tag":126,"props":819,"children":820},{"style":139},[821],{"type":49,"value":822},"(book.lon), ",{"type":26,"tag":126,"props":824,"children":825},{"style":814},[826],{"type":49,"value":817},{"type":26,"tag":126,"props":828,"children":829},{"style":139},[830],{"type":49,"value":831},"(book.lat)],\n",{"type":26,"tag":126,"props":833,"children":835},{"class":128,"line":834},16,[836,841],{"type":26,"tag":126,"props":837,"children":838},{"style":159},[839],{"type":49,"value":840},"                  'title'",{"type":26,"tag":126,"props":842,"children":843},{"style":139},[844],{"type":49,"value":845},":book.title,\n",{"type":26,"tag":126,"props":847,"children":849},{"class":128,"line":848},17,[850,855,860,865,870,875],{"type":26,"tag":126,"props":851,"children":852},{"style":159},[853],{"type":49,"value":854},"                  'url'",{"type":26,"tag":126,"props":856,"children":857},{"style":139},[858],{"type":49,"value":859},":book.get_absolute_url()} ",{"type":26,"tag":126,"props":861,"children":862},{"style":375},[863],{"type":49,"value":864},"for",{"type":26,"tag":126,"props":866,"children":867},{"style":139},[868],{"type":49,"value":869}," book ",{"type":26,"tag":126,"props":871,"children":872},{"style":375},[873],{"type":49,"value":874},"in",{"type":26,"tag":126,"props":876,"children":877},{"style":139},[878],{"type":49,"value":879}," books]\n",{"type":26,"tag":126,"props":881,"children":883},{"class":128,"line":882},18,[884,889,893],{"type":26,"tag":126,"props":885,"children":886},{"style":139},[887],{"type":49,"value":888},"    context ",{"type":26,"tag":126,"props":890,"children":891},{"style":375},[892],{"type":49,"value":378},{"type":26,"tag":126,"props":894,"children":895},{"style":139},[896],{"type":49,"value":897}," {\n",{"type":26,"tag":126,"props":899,"children":901},{"class":128,"line":900},19,[902,907],{"type":26,"tag":126,"props":903,"children":904},{"style":159},[905],{"type":49,"value":906},"        'books'",{"type":26,"tag":126,"props":908,"children":909},{"style":139},[910],{"type":49,"value":911},":books,\n",{"type":26,"tag":126,"props":913,"children":915},{"class":128,"line":914},20,[916],{"type":26,"tag":126,"props":917,"children":918},{"style":771},[919],{"type":49,"value":920},"        # Here, we apply `json.dumps`, `escapejs` and `marksafe` for security\n",{"type":26,"tag":126,"props":922,"children":924},{"class":128,"line":923},21,[925],{"type":26,"tag":126,"props":926,"children":927},{"style":771},[928],{"type":49,"value":929},"        # and proper formatting\n",{"type":26,"tag":126,"props":931,"children":933},{"class":128,"line":932},22,[934,939],{"type":26,"tag":126,"props":935,"children":936},{"style":159},[937],{"type":49,"value":938},"        'map_books'",{"type":26,"tag":126,"props":940,"children":941},{"style":139},[942],{"type":49,"value":943},": mark_safe(escapejs(json.dumps(map_books))),\n",{"type":26,"tag":126,"props":945,"children":947},{"class":128,"line":946},23,[948,953,958,963],{"type":26,"tag":126,"props":949,"children":950},{"style":159},[951],{"type":49,"value":952},"        'page_count'",{"type":26,"tag":126,"props":954,"children":955},{"style":139},[956],{"type":49,"value":957},":page_count[",{"type":26,"tag":126,"props":959,"children":960},{"style":159},[961],{"type":49,"value":962},"'pages__sum'",{"type":26,"tag":126,"props":964,"children":965},{"style":139},[966],{"type":49,"value":967},"],\n",{"type":26,"tag":126,"props":969,"children":971},{"class":128,"line":970},24,[972,977],{"type":26,"tag":126,"props":973,"children":974},{"style":159},[975],{"type":49,"value":976},"        'form'",{"type":26,"tag":126,"props":978,"children":979},{"style":139},[980],{"type":49,"value":981},":form}\n",{"type":26,"tag":126,"props":983,"children":985},{"class":128,"line":984},25,[986,991,996,1001],{"type":26,"tag":126,"props":987,"children":988},{"style":375},[989],{"type":49,"value":990},"    return",{"type":26,"tag":126,"props":992,"children":993},{"style":139},[994],{"type":49,"value":995}," render(request, ",{"type":26,"tag":126,"props":997,"children":998},{"style":159},[999],{"type":49,"value":1000},"'books/books.html'",{"type":26,"tag":126,"props":1002,"children":1003},{"style":139},[1004],{"type":49,"value":1005},", context)\n",{"type":26,"tag":27,"props":1007,"children":1008},{},[1009,1011,1017],{"type":49,"value":1010},"On the frontend, I passed the ",{"type":26,"tag":102,"props":1012,"children":1014},{"className":1013},[],[1015],{"type":49,"value":1016},"map_books",{"type":49,"value":1018}," variable to the template like this:",{"type":26,"tag":116,"props":1020,"children":1022},{"code":1021,"language":119,"meta":8,"className":120,"style":8},"var map_books = JSON.parse('{{ map_books }}')\n",[1023],{"type":26,"tag":102,"props":1024,"children":1025},{"__ignoreMap":8},[1026],{"type":26,"tag":126,"props":1027,"children":1028},{"class":128,"line":129},[1029,1034,1039,1043,1048,1052,1057,1061,1066],{"type":26,"tag":126,"props":1030,"children":1031},{"style":330},[1032],{"type":49,"value":1033},"var",{"type":26,"tag":126,"props":1035,"children":1036},{"style":139},[1037],{"type":49,"value":1038}," map_books ",{"type":26,"tag":126,"props":1040,"children":1041},{"style":375},[1042],{"type":49,"value":378},{"type":26,"tag":126,"props":1044,"children":1045},{"style":133},[1046],{"type":49,"value":1047}," JSON",{"type":26,"tag":126,"props":1049,"children":1050},{"style":139},[1051],{"type":49,"value":86},{"type":26,"tag":126,"props":1053,"children":1054},{"style":144},[1055],{"type":49,"value":1056},"parse",{"type":26,"tag":126,"props":1058,"children":1059},{"style":139},[1060],{"type":49,"value":344},{"type":26,"tag":126,"props":1062,"children":1063},{"style":159},[1064],{"type":49,"value":1065},"'{{ map_books }}'",{"type":26,"tag":126,"props":1067,"children":1068},{"style":139},[1069],{"type":49,"value":403},{"type":26,"tag":27,"props":1071,"children":1072},{},[1073,1075,1080],{"type":49,"value":1074},"Now that I have ",{"type":26,"tag":102,"props":1076,"children":1078},{"className":1077},[],[1079],{"type":49,"value":1016},{"type":49,"value":1081}," as a JavaScript object, I can simply pass it into the map function that populates data in the Leaflet map. Here's the function that does that:",{"type":26,"tag":116,"props":1083,"children":1085},{"code":1084,"language":119,"meta":8,"className":120,"style":8},"function populateMap(data) {\n  for (i in data) {\n    var title = data[i].title, //value searched\n      loc = data[i].loc, //position found\n      url = data[i].url,\n      marker = new L.Marker(new L.latLng(loc), { title: title, icon: bookIcon }) //se property searched\n    marker.bindPopup('\u003Cp>\u003Ca href=\"' + url + '\">' + title + '\u003C/a>\u003C/p>')\n    markersLayer.addLayer(marker)\n  }\n}\n",[1086],{"type":26,"tag":102,"props":1087,"children":1088},{"__ignoreMap":8},[1089,1116,1138,1165,1187,1204,1267,1330,1348,1355],{"type":26,"tag":126,"props":1090,"children":1091},{"class":128,"line":129},[1092,1097,1102,1106,1111],{"type":26,"tag":126,"props":1093,"children":1094},{"style":330},[1095],{"type":49,"value":1096},"function",{"type":26,"tag":126,"props":1098,"children":1099},{"style":144},[1100],{"type":49,"value":1101}," populateMap",{"type":26,"tag":126,"props":1103,"children":1104},{"style":139},[1105],{"type":49,"value":344},{"type":26,"tag":126,"props":1107,"children":1108},{"style":386},[1109],{"type":49,"value":1110},"data",{"type":26,"tag":126,"props":1112,"children":1113},{"style":139},[1114],{"type":49,"value":1115},") {\n",{"type":26,"tag":126,"props":1117,"children":1118},{"class":128,"line":155},[1119,1124,1129,1133],{"type":26,"tag":126,"props":1120,"children":1121},{"style":375},[1122],{"type":49,"value":1123},"  for",{"type":26,"tag":126,"props":1125,"children":1126},{"style":139},[1127],{"type":49,"value":1128}," (i ",{"type":26,"tag":126,"props":1130,"children":1131},{"style":375},[1132],{"type":49,"value":874},{"type":26,"tag":126,"props":1134,"children":1135},{"style":139},[1136],{"type":49,"value":1137}," data) {\n",{"type":26,"tag":126,"props":1139,"children":1140},{"class":128,"line":170},[1141,1146,1151,1155,1160],{"type":26,"tag":126,"props":1142,"children":1143},{"style":330},[1144],{"type":49,"value":1145},"    var",{"type":26,"tag":126,"props":1147,"children":1148},{"style":139},[1149],{"type":49,"value":1150}," title ",{"type":26,"tag":126,"props":1152,"children":1153},{"style":375},[1154],{"type":49,"value":378},{"type":26,"tag":126,"props":1156,"children":1157},{"style":139},[1158],{"type":49,"value":1159}," data[i].title, ",{"type":26,"tag":126,"props":1161,"children":1162},{"style":771},[1163],{"type":49,"value":1164},"//value searched\n",{"type":26,"tag":126,"props":1166,"children":1167},{"class":128,"line":179},[1168,1173,1177,1182],{"type":26,"tag":126,"props":1169,"children":1170},{"style":139},[1171],{"type":49,"value":1172},"      loc ",{"type":26,"tag":126,"props":1174,"children":1175},{"style":375},[1176],{"type":49,"value":378},{"type":26,"tag":126,"props":1178,"children":1179},{"style":139},[1180],{"type":49,"value":1181}," data[i].loc, ",{"type":26,"tag":126,"props":1183,"children":1184},{"style":771},[1185],{"type":49,"value":1186},"//position found\n",{"type":26,"tag":126,"props":1188,"children":1189},{"class":128,"line":188},[1190,1195,1199],{"type":26,"tag":126,"props":1191,"children":1192},{"style":139},[1193],{"type":49,"value":1194},"      url ",{"type":26,"tag":126,"props":1196,"children":1197},{"style":375},[1198],{"type":49,"value":378},{"type":26,"tag":126,"props":1200,"children":1201},{"style":139},[1202],{"type":49,"value":1203}," data[i].url,\n",{"type":26,"tag":126,"props":1205,"children":1206},{"class":128,"line":201},[1207,1212,1216,1221,1226,1230,1235,1239,1244,1248,1252,1257,1262],{"type":26,"tag":126,"props":1208,"children":1209},{"style":139},[1210],{"type":49,"value":1211},"      marker ",{"type":26,"tag":126,"props":1213,"children":1214},{"style":375},[1215],{"type":49,"value":378},{"type":26,"tag":126,"props":1217,"children":1218},{"style":375},[1219],{"type":49,"value":1220}," new",{"type":26,"tag":126,"props":1222,"children":1223},{"style":133},[1224],{"type":49,"value":1225}," L",{"type":26,"tag":126,"props":1227,"children":1228},{"style":139},[1229],{"type":49,"value":86},{"type":26,"tag":126,"props":1231,"children":1232},{"style":144},[1233],{"type":49,"value":1234},"Marker",{"type":26,"tag":126,"props":1236,"children":1237},{"style":139},[1238],{"type":49,"value":344},{"type":26,"tag":126,"props":1240,"children":1241},{"style":375},[1242],{"type":49,"value":1243},"new",{"type":26,"tag":126,"props":1245,"children":1246},{"style":133},[1247],{"type":49,"value":1225},{"type":26,"tag":126,"props":1249,"children":1250},{"style":139},[1251],{"type":49,"value":86},{"type":26,"tag":126,"props":1253,"children":1254},{"style":144},[1255],{"type":49,"value":1256},"latLng",{"type":26,"tag":126,"props":1258,"children":1259},{"style":139},[1260],{"type":49,"value":1261},"(loc), { title: title, icon: bookIcon }) ",{"type":26,"tag":126,"props":1263,"children":1264},{"style":771},[1265],{"type":49,"value":1266},"//se property searched\n",{"type":26,"tag":126,"props":1268,"children":1269},{"class":128,"line":220},[1270,1275,1280,1284,1289,1294,1299,1304,1309,1313,1317,1321,1326],{"type":26,"tag":126,"props":1271,"children":1272},{"style":139},[1273],{"type":49,"value":1274},"    marker.",{"type":26,"tag":126,"props":1276,"children":1277},{"style":144},[1278],{"type":49,"value":1279},"bindPopup",{"type":26,"tag":126,"props":1281,"children":1282},{"style":139},[1283],{"type":49,"value":344},{"type":26,"tag":126,"props":1285,"children":1286},{"style":159},[1287],{"type":49,"value":1288},"'\u003Cp>\u003Ca href=\"'",{"type":26,"tag":126,"props":1290,"children":1291},{"style":375},[1292],{"type":49,"value":1293}," +",{"type":26,"tag":126,"props":1295,"children":1296},{"style":139},[1297],{"type":49,"value":1298}," url ",{"type":26,"tag":126,"props":1300,"children":1301},{"style":375},[1302],{"type":49,"value":1303},"+",{"type":26,"tag":126,"props":1305,"children":1306},{"style":159},[1307],{"type":49,"value":1308}," '\">'",{"type":26,"tag":126,"props":1310,"children":1311},{"style":375},[1312],{"type":49,"value":1293},{"type":26,"tag":126,"props":1314,"children":1315},{"style":139},[1316],{"type":49,"value":1150},{"type":26,"tag":126,"props":1318,"children":1319},{"style":375},[1320],{"type":49,"value":1303},{"type":26,"tag":126,"props":1322,"children":1323},{"style":159},[1324],{"type":49,"value":1325}," '\u003C/a>\u003C/p>'",{"type":26,"tag":126,"props":1327,"children":1328},{"style":139},[1329],{"type":49,"value":403},{"type":26,"tag":126,"props":1331,"children":1332},{"class":128,"line":238},[1333,1338,1343],{"type":26,"tag":126,"props":1334,"children":1335},{"style":139},[1336],{"type":49,"value":1337},"    markersLayer.",{"type":26,"tag":126,"props":1339,"children":1340},{"style":144},[1341],{"type":49,"value":1342},"addLayer",{"type":26,"tag":126,"props":1344,"children":1345},{"style":139},[1346],{"type":49,"value":1347},"(marker)\n",{"type":26,"tag":126,"props":1349,"children":1350},{"class":128,"line":256},[1351],{"type":26,"tag":126,"props":1352,"children":1353},{"style":139},[1354],{"type":49,"value":262},{"type":26,"tag":126,"props":1356,"children":1357},{"class":128,"line":265},[1358],{"type":26,"tag":126,"props":1359,"children":1360},{"style":139},[1361],{"type":49,"value":1362},"}\n",{"type":26,"tag":27,"props":1364,"children":1365},{},[1366],{"type":49,"value":1367},"This adds our markers to the map, and also passes link and title data to the popup box when a marker is clicked.",{"type":26,"tag":27,"props":1369,"children":1370},{},[1371],{"type":49,"value":1372},"Here's the entire script that is used to populate map data:",{"type":26,"tag":27,"props":1374,"children":1375},{},[1376],{"type":49,"value":114},{"type":26,"tag":116,"props":1378,"children":1382},{"code":1379,"language":1380,"meta":8,"className":1381,"style":8},"\u003Cscript>\n  var mymap = new L.Map('mapid', { zoom: 9, center: new L.latLng([40, 13]) }) //set center from first location\n\n  L.tileLayer(\n    'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}',\n    {\n      attribution:\n        'Map data &copy; \u003Ca href=\"http://openstreetmap.org\">OpenStreetMap\u003C/a> contributors, \u003Ca href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA\u003C/a>, Imagery © \u003Ca href=\"http://mapbox.com\">Mapbox\u003C/a>',\n      maxZoom: 18,\n      id: 'mapbox.streets',\n      accessToken:\n        'pk.eyJ1IjoiYnJpYW5jYWZmZXkiLCJhIjoiY2pkczJycjl5MmhqbTMzbzQ3bHJuaHA3aiJ9.cvRYYPNjQJVpFjdUcmIHzA',\n    }\n  ).addTo(mymap)\n\n  var bookIcon = L.icon({\n    iconUrl: '/static/images/marker-icon.png',\n    iconSize: [35, 35], // size of the icon\n    iconAnchor: [17, 35], // point of the icon which will correspond to marker's location\n    popupAnchor: [0, -30], // point from which the popup should open relative to the iconAnchor\n  })\n\n  var markersLayer = L.markerClusterGroup()\n\n  mymap.addLayer(markersLayer)\n\n  var controlSearch = new L.Control.Search({\n    position: 'topright',\n    layer: markersLayer,\n    initial: false,\n    zoom: 12,\n    marker: false,\n  })\n\n  mymap.addControl(controlSearch)\n\n  function populateMap(data) {\n    for (i in data) {\n      var title = data[i].title, //value searched\n        loc = data[i].loc, //position found\n        url = data[i].url,\n        marker = new L.Marker(new L.latLng(loc), {\n          title: title,\n          icon: bookIcon,\n        }) //se property searched\n      marker.bindPopup('\u003Cp>\u003Ca href=\"' + url + '\">' + title + '\u003C/a>\u003C/p>')\n      markersLayer.addLayer(marker)\n    }\n  }\n\n  // use context variable instead of making AJAX call\n  var map_books = JSON.parse('{{ map_books }}')\n  var new_lat = map_books[0].loc[0]\n  var new_lon = map_books[0].loc[1]\n  mymap.setView([0, 0], 2)\n  populateMap(map_books)\n\u003C/script>\n","html","language-html shiki shiki-themes github-light github-dark monokai",[1383],{"type":26,"tag":102,"props":1384,"children":1385},{"__ignoreMap":8},[1386,1405,1507,1514,1534,1546,1554,1562,1574,1590,1606,1614,1626,1634,1650,1657,1691,1708,1739,1769,1805,1813,1820,1854,1861,1878,1886,1925,1943,1952,1970,1988,2005,2013,2021,2039,2047,2072,2093,2118,2139,2156,2210,2219,2228,2241,2298,2315,2323,2331,2339,2348,2388,2427,2465,2507,2521],{"type":26,"tag":126,"props":1387,"children":1388},{"class":128,"line":129},[1389,1394,1400],{"type":26,"tag":126,"props":1390,"children":1391},{"style":139},[1392],{"type":49,"value":1393},"\u003C",{"type":26,"tag":126,"props":1395,"children":1397},{"style":1396},"--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672",[1398],{"type":49,"value":1399},"script",{"type":26,"tag":126,"props":1401,"children":1402},{"style":139},[1403],{"type":49,"value":1404},">\n",{"type":26,"tag":126,"props":1406,"children":1407},{"class":128,"line":155},[1408,1413,1418,1422,1426,1430,1434,1439,1443,1448,1453,1457,1462,1466,1470,1474,1478,1483,1488,1492,1497,1502],{"type":26,"tag":126,"props":1409,"children":1410},{"style":330},[1411],{"type":49,"value":1412},"  var",{"type":26,"tag":126,"props":1414,"children":1415},{"style":139},[1416],{"type":49,"value":1417}," mymap ",{"type":26,"tag":126,"props":1419,"children":1420},{"style":375},[1421],{"type":49,"value":378},{"type":26,"tag":126,"props":1423,"children":1424},{"style":375},[1425],{"type":49,"value":1220},{"type":26,"tag":126,"props":1427,"children":1428},{"style":133},[1429],{"type":49,"value":1225},{"type":26,"tag":126,"props":1431,"children":1432},{"style":139},[1433],{"type":49,"value":86},{"type":26,"tag":126,"props":1435,"children":1436},{"style":144},[1437],{"type":49,"value":1438},"Map",{"type":26,"tag":126,"props":1440,"children":1441},{"style":139},[1442],{"type":49,"value":344},{"type":26,"tag":126,"props":1444,"children":1445},{"style":159},[1446],{"type":49,"value":1447},"'mapid'",{"type":26,"tag":126,"props":1449,"children":1450},{"style":139},[1451],{"type":49,"value":1452},", { zoom: ",{"type":26,"tag":126,"props":1454,"children":1455},{"style":210},[1456],{"type":49,"value":434},{"type":26,"tag":126,"props":1458,"children":1459},{"style":139},[1460],{"type":49,"value":1461},", center: ",{"type":26,"tag":126,"props":1463,"children":1464},{"style":375},[1465],{"type":49,"value":1243},{"type":26,"tag":126,"props":1467,"children":1468},{"style":133},[1469],{"type":49,"value":1225},{"type":26,"tag":126,"props":1471,"children":1472},{"style":139},[1473],{"type":49,"value":86},{"type":26,"tag":126,"props":1475,"children":1476},{"style":144},[1477],{"type":49,"value":1256},{"type":26,"tag":126,"props":1479,"children":1480},{"style":139},[1481],{"type":49,"value":1482},"([",{"type":26,"tag":126,"props":1484,"children":1485},{"style":210},[1486],{"type":49,"value":1487},"40",{"type":26,"tag":126,"props":1489,"children":1490},{"style":139},[1491],{"type":49,"value":439},{"type":26,"tag":126,"props":1493,"children":1494},{"style":210},[1495],{"type":49,"value":1496},"13",{"type":26,"tag":126,"props":1498,"children":1499},{"style":139},[1500],{"type":49,"value":1501},"]) }) ",{"type":26,"tag":126,"props":1503,"children":1504},{"style":771},[1505],{"type":49,"value":1506},"//set center from first location\n",{"type":26,"tag":126,"props":1508,"children":1509},{"class":128,"line":170},[1510],{"type":26,"tag":126,"props":1511,"children":1512},{"emptyLinePlaceholder":12},[1513],{"type":49,"value":705},{"type":26,"tag":126,"props":1515,"children":1516},{"class":128,"line":179},[1517,1522,1526,1530],{"type":26,"tag":126,"props":1518,"children":1519},{"style":133},[1520],{"type":49,"value":1521},"  L",{"type":26,"tag":126,"props":1523,"children":1524},{"style":139},[1525],{"type":49,"value":86},{"type":26,"tag":126,"props":1527,"children":1528},{"style":144},[1529],{"type":49,"value":147},{"type":26,"tag":126,"props":1531,"children":1532},{"style":139},[1533],{"type":49,"value":152},{"type":26,"tag":126,"props":1535,"children":1536},{"class":128,"line":188},[1537,1542],{"type":26,"tag":126,"props":1538,"children":1539},{"style":159},[1540],{"type":49,"value":1541},"    'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}'",{"type":26,"tag":126,"props":1543,"children":1544},{"style":139},[1545],{"type":49,"value":167},{"type":26,"tag":126,"props":1547,"children":1548},{"class":128,"line":201},[1549],{"type":26,"tag":126,"props":1550,"children":1551},{"style":139},[1552],{"type":49,"value":1553},"    {\n",{"type":26,"tag":126,"props":1555,"children":1556},{"class":128,"line":220},[1557],{"type":26,"tag":126,"props":1558,"children":1559},{"style":139},[1560],{"type":49,"value":1561},"      attribution:\n",{"type":26,"tag":126,"props":1563,"children":1564},{"class":128,"line":238},[1565,1570],{"type":26,"tag":126,"props":1566,"children":1567},{"style":159},[1568],{"type":49,"value":1569},"        'Map data &copy; \u003Ca href=\"http://openstreetmap.org\">OpenStreetMap\u003C/a> contributors, \u003Ca href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA\u003C/a>, Imagery © \u003Ca href=\"http://mapbox.com\">Mapbox\u003C/a>'",{"type":26,"tag":126,"props":1571,"children":1572},{"style":139},[1573],{"type":49,"value":167},{"type":26,"tag":126,"props":1575,"children":1576},{"class":128,"line":256},[1577,1582,1586],{"type":26,"tag":126,"props":1578,"children":1579},{"style":139},[1580],{"type":49,"value":1581},"      maxZoom: ",{"type":26,"tag":126,"props":1583,"children":1584},{"style":210},[1585],{"type":49,"value":213},{"type":26,"tag":126,"props":1587,"children":1588},{"style":139},[1589],{"type":49,"value":167},{"type":26,"tag":126,"props":1591,"children":1592},{"class":128,"line":265},[1593,1598,1602],{"type":26,"tag":126,"props":1594,"children":1595},{"style":139},[1596],{"type":49,"value":1597},"      id: ",{"type":26,"tag":126,"props":1599,"children":1600},{"style":159},[1601],{"type":49,"value":231},{"type":26,"tag":126,"props":1603,"children":1604},{"style":139},[1605],{"type":49,"value":167},{"type":26,"tag":126,"props":1607,"children":1608},{"class":128,"line":731},[1609],{"type":26,"tag":126,"props":1610,"children":1611},{"style":139},[1612],{"type":49,"value":1613},"      accessToken:\n",{"type":26,"tag":126,"props":1615,"children":1616},{"class":128,"line":759},[1617,1622],{"type":26,"tag":126,"props":1618,"children":1619},{"style":159},[1620],{"type":49,"value":1621},"        'pk.eyJ1IjoiYnJpYW5jYWZmZXkiLCJhIjoiY2pkczJycjl5MmhqbTMzbzQ3bHJuaHA3aiJ9.cvRYYPNjQJVpFjdUcmIHzA'",{"type":26,"tag":126,"props":1623,"children":1624},{"style":139},[1625],{"type":49,"value":167},{"type":26,"tag":126,"props":1627,"children":1628},{"class":128,"line":767},[1629],{"type":26,"tag":126,"props":1630,"children":1631},{"style":139},[1632],{"type":49,"value":1633},"    }\n",{"type":26,"tag":126,"props":1635,"children":1636},{"class":128,"line":777},[1637,1642,1646],{"type":26,"tag":126,"props":1638,"children":1639},{"style":139},[1640],{"type":49,"value":1641},"  ).",{"type":26,"tag":126,"props":1643,"children":1644},{"style":144},[1645],{"type":49,"value":276},{"type":26,"tag":126,"props":1647,"children":1648},{"style":139},[1649],{"type":49,"value":281},{"type":26,"tag":126,"props":1651,"children":1652},{"class":128,"line":786},[1653],{"type":26,"tag":126,"props":1654,"children":1655},{"emptyLinePlaceholder":12},[1656],{"type":49,"value":705},{"type":26,"tag":126,"props":1658,"children":1659},{"class":128,"line":834},[1660,1664,1669,1673,1677,1681,1686],{"type":26,"tag":126,"props":1661,"children":1662},{"style":330},[1663],{"type":49,"value":1412},{"type":26,"tag":126,"props":1665,"children":1666},{"style":139},[1667],{"type":49,"value":1668}," bookIcon ",{"type":26,"tag":126,"props":1670,"children":1671},{"style":375},[1672],{"type":49,"value":378},{"type":26,"tag":126,"props":1674,"children":1675},{"style":133},[1676],{"type":49,"value":1225},{"type":26,"tag":126,"props":1678,"children":1679},{"style":139},[1680],{"type":49,"value":86},{"type":26,"tag":126,"props":1682,"children":1683},{"style":144},[1684],{"type":49,"value":1685},"icon",{"type":26,"tag":126,"props":1687,"children":1688},{"style":139},[1689],{"type":49,"value":1690},"({\n",{"type":26,"tag":126,"props":1692,"children":1693},{"class":128,"line":848},[1694,1699,1704],{"type":26,"tag":126,"props":1695,"children":1696},{"style":139},[1697],{"type":49,"value":1698},"    iconUrl: ",{"type":26,"tag":126,"props":1700,"children":1701},{"style":159},[1702],{"type":49,"value":1703},"'/static/images/marker-icon.png'",{"type":26,"tag":126,"props":1705,"children":1706},{"style":139},[1707],{"type":49,"value":167},{"type":26,"tag":126,"props":1709,"children":1710},{"class":128,"line":882},[1711,1716,1721,1725,1729,1734],{"type":26,"tag":126,"props":1712,"children":1713},{"style":139},[1714],{"type":49,"value":1715},"    iconSize: [",{"type":26,"tag":126,"props":1717,"children":1718},{"style":210},[1719],{"type":49,"value":1720},"35",{"type":26,"tag":126,"props":1722,"children":1723},{"style":139},[1724],{"type":49,"value":439},{"type":26,"tag":126,"props":1726,"children":1727},{"style":210},[1728],{"type":49,"value":1720},{"type":26,"tag":126,"props":1730,"children":1731},{"style":139},[1732],{"type":49,"value":1733},"], ",{"type":26,"tag":126,"props":1735,"children":1736},{"style":771},[1737],{"type":49,"value":1738},"// size of the icon\n",{"type":26,"tag":126,"props":1740,"children":1741},{"class":128,"line":900},[1742,1747,1752,1756,1760,1764],{"type":26,"tag":126,"props":1743,"children":1744},{"style":139},[1745],{"type":49,"value":1746},"    iconAnchor: [",{"type":26,"tag":126,"props":1748,"children":1749},{"style":210},[1750],{"type":49,"value":1751},"17",{"type":26,"tag":126,"props":1753,"children":1754},{"style":139},[1755],{"type":49,"value":439},{"type":26,"tag":126,"props":1757,"children":1758},{"style":210},[1759],{"type":49,"value":1720},{"type":26,"tag":126,"props":1761,"children":1762},{"style":139},[1763],{"type":49,"value":1733},{"type":26,"tag":126,"props":1765,"children":1766},{"style":771},[1767],{"type":49,"value":1768},"// point of the icon which will correspond to marker's location\n",{"type":26,"tag":126,"props":1770,"children":1771},{"class":128,"line":914},[1772,1777,1782,1786,1791,1796,1800],{"type":26,"tag":126,"props":1773,"children":1774},{"style":139},[1775],{"type":49,"value":1776},"    popupAnchor: [",{"type":26,"tag":126,"props":1778,"children":1779},{"style":210},[1780],{"type":49,"value":1781},"0",{"type":26,"tag":126,"props":1783,"children":1784},{"style":139},[1785],{"type":49,"value":439},{"type":26,"tag":126,"props":1787,"children":1788},{"style":375},[1789],{"type":49,"value":1790},"-",{"type":26,"tag":126,"props":1792,"children":1793},{"style":210},[1794],{"type":49,"value":1795},"30",{"type":26,"tag":126,"props":1797,"children":1798},{"style":139},[1799],{"type":49,"value":1733},{"type":26,"tag":126,"props":1801,"children":1802},{"style":771},[1803],{"type":49,"value":1804},"// point from which the popup should open relative to the iconAnchor\n",{"type":26,"tag":126,"props":1806,"children":1807},{"class":128,"line":923},[1808],{"type":26,"tag":126,"props":1809,"children":1810},{"style":139},[1811],{"type":49,"value":1812},"  })\n",{"type":26,"tag":126,"props":1814,"children":1815},{"class":128,"line":932},[1816],{"type":26,"tag":126,"props":1817,"children":1818},{"emptyLinePlaceholder":12},[1819],{"type":49,"value":705},{"type":26,"tag":126,"props":1821,"children":1822},{"class":128,"line":946},[1823,1827,1832,1836,1840,1844,1849],{"type":26,"tag":126,"props":1824,"children":1825},{"style":330},[1826],{"type":49,"value":1412},{"type":26,"tag":126,"props":1828,"children":1829},{"style":139},[1830],{"type":49,"value":1831}," markersLayer ",{"type":26,"tag":126,"props":1833,"children":1834},{"style":375},[1835],{"type":49,"value":378},{"type":26,"tag":126,"props":1837,"children":1838},{"style":133},[1839],{"type":49,"value":1225},{"type":26,"tag":126,"props":1841,"children":1842},{"style":139},[1843],{"type":49,"value":86},{"type":26,"tag":126,"props":1845,"children":1846},{"style":144},[1847],{"type":49,"value":1848},"markerClusterGroup",{"type":26,"tag":126,"props":1850,"children":1851},{"style":139},[1852],{"type":49,"value":1853},"()\n",{"type":26,"tag":126,"props":1855,"children":1856},{"class":128,"line":970},[1857],{"type":26,"tag":126,"props":1858,"children":1859},{"emptyLinePlaceholder":12},[1860],{"type":49,"value":705},{"type":26,"tag":126,"props":1862,"children":1863},{"class":128,"line":984},[1864,1869,1873],{"type":26,"tag":126,"props":1865,"children":1866},{"style":139},[1867],{"type":49,"value":1868},"  mymap.",{"type":26,"tag":126,"props":1870,"children":1871},{"style":144},[1872],{"type":49,"value":1342},{"type":26,"tag":126,"props":1874,"children":1875},{"style":139},[1876],{"type":49,"value":1877},"(markersLayer)\n",{"type":26,"tag":126,"props":1879,"children":1881},{"class":128,"line":1880},26,[1882],{"type":26,"tag":126,"props":1883,"children":1884},{"emptyLinePlaceholder":12},[1885],{"type":49,"value":705},{"type":26,"tag":126,"props":1887,"children":1889},{"class":128,"line":1888},27,[1890,1894,1899,1903,1907,1911,1916,1921],{"type":26,"tag":126,"props":1891,"children":1892},{"style":330},[1893],{"type":49,"value":1412},{"type":26,"tag":126,"props":1895,"children":1896},{"style":139},[1897],{"type":49,"value":1898}," controlSearch ",{"type":26,"tag":126,"props":1900,"children":1901},{"style":375},[1902],{"type":49,"value":378},{"type":26,"tag":126,"props":1904,"children":1905},{"style":375},[1906],{"type":49,"value":1220},{"type":26,"tag":126,"props":1908,"children":1909},{"style":133},[1910],{"type":49,"value":1225},{"type":26,"tag":126,"props":1912,"children":1913},{"style":139},[1914],{"type":49,"value":1915},".Control.",{"type":26,"tag":126,"props":1917,"children":1918},{"style":144},[1919],{"type":49,"value":1920},"Search",{"type":26,"tag":126,"props":1922,"children":1923},{"style":139},[1924],{"type":49,"value":1690},{"type":26,"tag":126,"props":1926,"children":1928},{"class":128,"line":1927},28,[1929,1934,1939],{"type":26,"tag":126,"props":1930,"children":1931},{"style":139},[1932],{"type":49,"value":1933},"    position: ",{"type":26,"tag":126,"props":1935,"children":1936},{"style":159},[1937],{"type":49,"value":1938},"'topright'",{"type":26,"tag":126,"props":1940,"children":1941},{"style":139},[1942],{"type":49,"value":167},{"type":26,"tag":126,"props":1944,"children":1946},{"class":128,"line":1945},29,[1947],{"type":26,"tag":126,"props":1948,"children":1949},{"style":139},[1950],{"type":49,"value":1951},"    layer: markersLayer,\n",{"type":26,"tag":126,"props":1953,"children":1955},{"class":128,"line":1954},30,[1956,1961,1966],{"type":26,"tag":126,"props":1957,"children":1958},{"style":139},[1959],{"type":49,"value":1960},"    initial: ",{"type":26,"tag":126,"props":1962,"children":1963},{"style":210},[1964],{"type":49,"value":1965},"false",{"type":26,"tag":126,"props":1967,"children":1968},{"style":139},[1969],{"type":49,"value":167},{"type":26,"tag":126,"props":1971,"children":1973},{"class":128,"line":1972},31,[1974,1979,1984],{"type":26,"tag":126,"props":1975,"children":1976},{"style":139},[1977],{"type":49,"value":1978},"    zoom: ",{"type":26,"tag":126,"props":1980,"children":1981},{"style":210},[1982],{"type":49,"value":1983},"12",{"type":26,"tag":126,"props":1985,"children":1986},{"style":139},[1987],{"type":49,"value":167},{"type":26,"tag":126,"props":1989,"children":1991},{"class":128,"line":1990},32,[1992,1997,2001],{"type":26,"tag":126,"props":1993,"children":1994},{"style":139},[1995],{"type":49,"value":1996},"    marker: ",{"type":26,"tag":126,"props":1998,"children":1999},{"style":210},[2000],{"type":49,"value":1965},{"type":26,"tag":126,"props":2002,"children":2003},{"style":139},[2004],{"type":49,"value":167},{"type":26,"tag":126,"props":2006,"children":2008},{"class":128,"line":2007},33,[2009],{"type":26,"tag":126,"props":2010,"children":2011},{"style":139},[2012],{"type":49,"value":1812},{"type":26,"tag":126,"props":2014,"children":2016},{"class":128,"line":2015},34,[2017],{"type":26,"tag":126,"props":2018,"children":2019},{"emptyLinePlaceholder":12},[2020],{"type":49,"value":705},{"type":26,"tag":126,"props":2022,"children":2024},{"class":128,"line":2023},35,[2025,2029,2034],{"type":26,"tag":126,"props":2026,"children":2027},{"style":139},[2028],{"type":49,"value":1868},{"type":26,"tag":126,"props":2030,"children":2031},{"style":144},[2032],{"type":49,"value":2033},"addControl",{"type":26,"tag":126,"props":2035,"children":2036},{"style":139},[2037],{"type":49,"value":2038},"(controlSearch)\n",{"type":26,"tag":126,"props":2040,"children":2042},{"class":128,"line":2041},36,[2043],{"type":26,"tag":126,"props":2044,"children":2045},{"emptyLinePlaceholder":12},[2046],{"type":49,"value":705},{"type":26,"tag":126,"props":2048,"children":2050},{"class":128,"line":2049},37,[2051,2056,2060,2064,2068],{"type":26,"tag":126,"props":2052,"children":2053},{"style":330},[2054],{"type":49,"value":2055},"  function",{"type":26,"tag":126,"props":2057,"children":2058},{"style":144},[2059],{"type":49,"value":1101},{"type":26,"tag":126,"props":2061,"children":2062},{"style":139},[2063],{"type":49,"value":344},{"type":26,"tag":126,"props":2065,"children":2066},{"style":386},[2067],{"type":49,"value":1110},{"type":26,"tag":126,"props":2069,"children":2070},{"style":139},[2071],{"type":49,"value":1115},{"type":26,"tag":126,"props":2073,"children":2075},{"class":128,"line":2074},38,[2076,2081,2085,2089],{"type":26,"tag":126,"props":2077,"children":2078},{"style":375},[2079],{"type":49,"value":2080},"    for",{"type":26,"tag":126,"props":2082,"children":2083},{"style":139},[2084],{"type":49,"value":1128},{"type":26,"tag":126,"props":2086,"children":2087},{"style":375},[2088],{"type":49,"value":874},{"type":26,"tag":126,"props":2090,"children":2091},{"style":139},[2092],{"type":49,"value":1137},{"type":26,"tag":126,"props":2094,"children":2096},{"class":128,"line":2095},39,[2097,2102,2106,2110,2114],{"type":26,"tag":126,"props":2098,"children":2099},{"style":330},[2100],{"type":49,"value":2101},"      var",{"type":26,"tag":126,"props":2103,"children":2104},{"style":139},[2105],{"type":49,"value":1150},{"type":26,"tag":126,"props":2107,"children":2108},{"style":375},[2109],{"type":49,"value":378},{"type":26,"tag":126,"props":2111,"children":2112},{"style":139},[2113],{"type":49,"value":1159},{"type":26,"tag":126,"props":2115,"children":2116},{"style":771},[2117],{"type":49,"value":1164},{"type":26,"tag":126,"props":2119,"children":2121},{"class":128,"line":2120},40,[2122,2127,2131,2135],{"type":26,"tag":126,"props":2123,"children":2124},{"style":139},[2125],{"type":49,"value":2126},"        loc ",{"type":26,"tag":126,"props":2128,"children":2129},{"style":375},[2130],{"type":49,"value":378},{"type":26,"tag":126,"props":2132,"children":2133},{"style":139},[2134],{"type":49,"value":1181},{"type":26,"tag":126,"props":2136,"children":2137},{"style":771},[2138],{"type":49,"value":1186},{"type":26,"tag":126,"props":2140,"children":2142},{"class":128,"line":2141},41,[2143,2148,2152],{"type":26,"tag":126,"props":2144,"children":2145},{"style":139},[2146],{"type":49,"value":2147},"        url ",{"type":26,"tag":126,"props":2149,"children":2150},{"style":375},[2151],{"type":49,"value":378},{"type":26,"tag":126,"props":2153,"children":2154},{"style":139},[2155],{"type":49,"value":1203},{"type":26,"tag":126,"props":2157,"children":2159},{"class":128,"line":2158},42,[2160,2165,2169,2173,2177,2181,2185,2189,2193,2197,2201,2205],{"type":26,"tag":126,"props":2161,"children":2162},{"style":139},[2163],{"type":49,"value":2164},"        marker ",{"type":26,"tag":126,"props":2166,"children":2167},{"style":375},[2168],{"type":49,"value":378},{"type":26,"tag":126,"props":2170,"children":2171},{"style":375},[2172],{"type":49,"value":1220},{"type":26,"tag":126,"props":2174,"children":2175},{"style":133},[2176],{"type":49,"value":1225},{"type":26,"tag":126,"props":2178,"children":2179},{"style":139},[2180],{"type":49,"value":86},{"type":26,"tag":126,"props":2182,"children":2183},{"style":144},[2184],{"type":49,"value":1234},{"type":26,"tag":126,"props":2186,"children":2187},{"style":139},[2188],{"type":49,"value":344},{"type":26,"tag":126,"props":2190,"children":2191},{"style":375},[2192],{"type":49,"value":1243},{"type":26,"tag":126,"props":2194,"children":2195},{"style":133},[2196],{"type":49,"value":1225},{"type":26,"tag":126,"props":2198,"children":2199},{"style":139},[2200],{"type":49,"value":86},{"type":26,"tag":126,"props":2202,"children":2203},{"style":144},[2204],{"type":49,"value":1256},{"type":26,"tag":126,"props":2206,"children":2207},{"style":139},[2208],{"type":49,"value":2209},"(loc), {\n",{"type":26,"tag":126,"props":2211,"children":2213},{"class":128,"line":2212},43,[2214],{"type":26,"tag":126,"props":2215,"children":2216},{"style":139},[2217],{"type":49,"value":2218},"          title: title,\n",{"type":26,"tag":126,"props":2220,"children":2222},{"class":128,"line":2221},44,[2223],{"type":26,"tag":126,"props":2224,"children":2225},{"style":139},[2226],{"type":49,"value":2227},"          icon: bookIcon,\n",{"type":26,"tag":126,"props":2229,"children":2231},{"class":128,"line":2230},45,[2232,2237],{"type":26,"tag":126,"props":2233,"children":2234},{"style":139},[2235],{"type":49,"value":2236},"        }) ",{"type":26,"tag":126,"props":2238,"children":2239},{"style":771},[2240],{"type":49,"value":1266},{"type":26,"tag":126,"props":2242,"children":2244},{"class":128,"line":2243},46,[2245,2250,2254,2258,2262,2266,2270,2274,2278,2282,2286,2290,2294],{"type":26,"tag":126,"props":2246,"children":2247},{"style":139},[2248],{"type":49,"value":2249},"      marker.",{"type":26,"tag":126,"props":2251,"children":2252},{"style":144},[2253],{"type":49,"value":1279},{"type":26,"tag":126,"props":2255,"children":2256},{"style":139},[2257],{"type":49,"value":344},{"type":26,"tag":126,"props":2259,"children":2260},{"style":159},[2261],{"type":49,"value":1288},{"type":26,"tag":126,"props":2263,"children":2264},{"style":375},[2265],{"type":49,"value":1293},{"type":26,"tag":126,"props":2267,"children":2268},{"style":139},[2269],{"type":49,"value":1298},{"type":26,"tag":126,"props":2271,"children":2272},{"style":375},[2273],{"type":49,"value":1303},{"type":26,"tag":126,"props":2275,"children":2276},{"style":159},[2277],{"type":49,"value":1308},{"type":26,"tag":126,"props":2279,"children":2280},{"style":375},[2281],{"type":49,"value":1293},{"type":26,"tag":126,"props":2283,"children":2284},{"style":139},[2285],{"type":49,"value":1150},{"type":26,"tag":126,"props":2287,"children":2288},{"style":375},[2289],{"type":49,"value":1303},{"type":26,"tag":126,"props":2291,"children":2292},{"style":159},[2293],{"type":49,"value":1325},{"type":26,"tag":126,"props":2295,"children":2296},{"style":139},[2297],{"type":49,"value":403},{"type":26,"tag":126,"props":2299,"children":2301},{"class":128,"line":2300},47,[2302,2307,2311],{"type":26,"tag":126,"props":2303,"children":2304},{"style":139},[2305],{"type":49,"value":2306},"      markersLayer.",{"type":26,"tag":126,"props":2308,"children":2309},{"style":144},[2310],{"type":49,"value":1342},{"type":26,"tag":126,"props":2312,"children":2313},{"style":139},[2314],{"type":49,"value":1347},{"type":26,"tag":126,"props":2316,"children":2318},{"class":128,"line":2317},48,[2319],{"type":26,"tag":126,"props":2320,"children":2321},{"style":139},[2322],{"type":49,"value":1633},{"type":26,"tag":126,"props":2324,"children":2326},{"class":128,"line":2325},49,[2327],{"type":26,"tag":126,"props":2328,"children":2329},{"style":139},[2330],{"type":49,"value":262},{"type":26,"tag":126,"props":2332,"children":2334},{"class":128,"line":2333},50,[2335],{"type":26,"tag":126,"props":2336,"children":2337},{"emptyLinePlaceholder":12},[2338],{"type":49,"value":705},{"type":26,"tag":126,"props":2340,"children":2342},{"class":128,"line":2341},51,[2343],{"type":26,"tag":126,"props":2344,"children":2345},{"style":771},[2346],{"type":49,"value":2347},"  // use context variable instead of making AJAX call\n",{"type":26,"tag":126,"props":2349,"children":2351},{"class":128,"line":2350},52,[2352,2356,2360,2364,2368,2372,2376,2380,2384],{"type":26,"tag":126,"props":2353,"children":2354},{"style":330},[2355],{"type":49,"value":1412},{"type":26,"tag":126,"props":2357,"children":2358},{"style":139},[2359],{"type":49,"value":1038},{"type":26,"tag":126,"props":2361,"children":2362},{"style":375},[2363],{"type":49,"value":378},{"type":26,"tag":126,"props":2365,"children":2366},{"style":133},[2367],{"type":49,"value":1047},{"type":26,"tag":126,"props":2369,"children":2370},{"style":139},[2371],{"type":49,"value":86},{"type":26,"tag":126,"props":2373,"children":2374},{"style":144},[2375],{"type":49,"value":1056},{"type":26,"tag":126,"props":2377,"children":2378},{"style":139},[2379],{"type":49,"value":344},{"type":26,"tag":126,"props":2381,"children":2382},{"style":159},[2383],{"type":49,"value":1065},{"type":26,"tag":126,"props":2385,"children":2386},{"style":139},[2387],{"type":49,"value":403},{"type":26,"tag":126,"props":2389,"children":2391},{"class":128,"line":2390},53,[2392,2396,2401,2405,2410,2414,2419,2423],{"type":26,"tag":126,"props":2393,"children":2394},{"style":330},[2395],{"type":49,"value":1412},{"type":26,"tag":126,"props":2397,"children":2398},{"style":139},[2399],{"type":49,"value":2400}," new_lat ",{"type":26,"tag":126,"props":2402,"children":2403},{"style":375},[2404],{"type":49,"value":378},{"type":26,"tag":126,"props":2406,"children":2407},{"style":139},[2408],{"type":49,"value":2409}," map_books[",{"type":26,"tag":126,"props":2411,"children":2412},{"style":210},[2413],{"type":49,"value":1781},{"type":26,"tag":126,"props":2415,"children":2416},{"style":139},[2417],{"type":49,"value":2418},"].loc[",{"type":26,"tag":126,"props":2420,"children":2421},{"style":210},[2422],{"type":49,"value":1781},{"type":26,"tag":126,"props":2424,"children":2425},{"style":139},[2426],{"type":49,"value":523},{"type":26,"tag":126,"props":2428,"children":2430},{"class":128,"line":2429},54,[2431,2435,2440,2444,2448,2452,2456,2461],{"type":26,"tag":126,"props":2432,"children":2433},{"style":330},[2434],{"type":49,"value":1412},{"type":26,"tag":126,"props":2436,"children":2437},{"style":139},[2438],{"type":49,"value":2439}," new_lon ",{"type":26,"tag":126,"props":2441,"children":2442},{"style":375},[2443],{"type":49,"value":378},{"type":26,"tag":126,"props":2445,"children":2446},{"style":139},[2447],{"type":49,"value":2409},{"type":26,"tag":126,"props":2449,"children":2450},{"style":210},[2451],{"type":49,"value":1781},{"type":26,"tag":126,"props":2453,"children":2454},{"style":139},[2455],{"type":49,"value":2418},{"type":26,"tag":126,"props":2457,"children":2458},{"style":210},[2459],{"type":49,"value":2460},"1",{"type":26,"tag":126,"props":2462,"children":2463},{"style":139},[2464],{"type":49,"value":523},{"type":26,"tag":126,"props":2466,"children":2468},{"class":128,"line":2467},55,[2469,2473,2478,2482,2486,2490,2494,2498,2503],{"type":26,"tag":126,"props":2470,"children":2471},{"style":139},[2472],{"type":49,"value":1868},{"type":26,"tag":126,"props":2474,"children":2475},{"style":144},[2476],{"type":49,"value":2477},"setView",{"type":26,"tag":126,"props":2479,"children":2480},{"style":139},[2481],{"type":49,"value":1482},{"type":26,"tag":126,"props":2483,"children":2484},{"style":210},[2485],{"type":49,"value":1781},{"type":26,"tag":126,"props":2487,"children":2488},{"style":139},[2489],{"type":49,"value":439},{"type":26,"tag":126,"props":2491,"children":2492},{"style":210},[2493],{"type":49,"value":1781},{"type":26,"tag":126,"props":2495,"children":2496},{"style":139},[2497],{"type":49,"value":1733},{"type":26,"tag":126,"props":2499,"children":2500},{"style":210},[2501],{"type":49,"value":2502},"2",{"type":26,"tag":126,"props":2504,"children":2505},{"style":139},[2506],{"type":49,"value":403},{"type":26,"tag":126,"props":2508,"children":2510},{"class":128,"line":2509},56,[2511,2516],{"type":26,"tag":126,"props":2512,"children":2513},{"style":144},[2514],{"type":49,"value":2515},"  populateMap",{"type":26,"tag":126,"props":2517,"children":2518},{"style":139},[2519],{"type":49,"value":2520},"(map_books)\n",{"type":26,"tag":126,"props":2522,"children":2524},{"class":128,"line":2523},57,[2525,2530,2534],{"type":26,"tag":126,"props":2526,"children":2527},{"style":139},[2528],{"type":49,"value":2529},"\u003C/",{"type":26,"tag":126,"props":2531,"children":2532},{"style":1396},[2533],{"type":49,"value":1399},{"type":26,"tag":126,"props":2535,"children":2536},{"style":139},[2537],{"type":49,"value":1404},{"type":26,"tag":27,"props":2539,"children":2540},{},[2541],{"type":49,"value":286},{"type":26,"tag":293,"props":2543,"children":2545},{"id":2544},"login-redirect",[2546],{"type":49,"value":2547},"Login Redirect",{"type":26,"tag":27,"props":2549,"children":2550},{},[2551,2553,2559],{"type":49,"value":2552},"I wanted to include a small note on a simple issue that I previously had trouble with, which is using the ",{"type":26,"tag":102,"props":2554,"children":2556},{"className":2555},[],[2557],{"type":49,"value":2558},"next",{"type":49,"value":2560}," parameter to do a redirect to a page that an unauthenticated user will be redirected to after they successfully login.",{"type":26,"tag":27,"props":2562,"children":2563},{},[2564],{"type":49,"value":2565},"Here's the login view:",{"type":26,"tag":116,"props":2567,"children":2569},{"code":2568,"language":319,"meta":8,"className":320,"style":8},"def login_view(request):\n    next_redirect = request.GET.get('next')\n    form = UserLoginForm(request.POST or None)\n    if form.is_valid():\n        next_redirect = request.POST.get('next')\n        username = form.cleaned_data.get('username')\n        password = form.cleaned_data.get('password')\n        user = authenticate(username=username, password=password)\n        login(request, user)\n        print(next_redirect)\n        if next_redirect != 'None':\n            return redirect(next_redirect)\n        return redirect('books:all')\n    context = { 'form':form, 'next':next_redirect }\n    return render(request, 'accounts/login_form.html', context)\n",[2570],{"type":26,"tag":102,"props":2571,"children":2572},{"__ignoreMap":8},[2573,2597,2631,2664,2677,2709,2735,2760,2805,2813,2827,2855,2868,2890,2925],{"type":26,"tag":126,"props":2574,"children":2575},{"class":128,"line":129},[2576,2580,2585,2589,2593],{"type":26,"tag":126,"props":2577,"children":2578},{"style":330},[2579],{"type":49,"value":580},{"type":26,"tag":126,"props":2581,"children":2582},{"style":144},[2583],{"type":49,"value":2584}," login_view",{"type":26,"tag":126,"props":2586,"children":2587},{"style":139},[2588],{"type":49,"value":344},{"type":26,"tag":126,"props":2590,"children":2591},{"style":592},[2592],{"type":49,"value":595},{"type":26,"tag":126,"props":2594,"children":2595},{"style":139},[2596],{"type":49,"value":364},{"type":26,"tag":126,"props":2598,"children":2599},{"class":128,"line":155},[2600,2605,2609,2613,2617,2622,2627],{"type":26,"tag":126,"props":2601,"children":2602},{"style":139},[2603],{"type":49,"value":2604},"    next_redirect ",{"type":26,"tag":126,"props":2606,"children":2607},{"style":375},[2608],{"type":49,"value":378},{"type":26,"tag":126,"props":2610,"children":2611},{"style":139},[2612],{"type":49,"value":692},{"type":26,"tag":126,"props":2614,"children":2615},{"style":210},[2616],{"type":49,"value":661},{"type":26,"tag":126,"props":2618,"children":2619},{"style":139},[2620],{"type":49,"value":2621},".get(",{"type":26,"tag":126,"props":2623,"children":2624},{"style":159},[2625],{"type":49,"value":2626},"'next'",{"type":26,"tag":126,"props":2628,"children":2629},{"style":139},[2630],{"type":49,"value":403},{"type":26,"tag":126,"props":2632,"children":2633},{"class":128,"line":170},[2634,2638,2642,2647,2652,2656,2660],{"type":26,"tag":126,"props":2635,"children":2636},{"style":139},[2637],{"type":49,"value":647},{"type":26,"tag":126,"props":2639,"children":2640},{"style":375},[2641],{"type":49,"value":378},{"type":26,"tag":126,"props":2643,"children":2644},{"style":139},[2645],{"type":49,"value":2646}," UserLoginForm(request.",{"type":26,"tag":126,"props":2648,"children":2649},{"style":210},[2650],{"type":49,"value":2651},"POST",{"type":26,"tag":126,"props":2653,"children":2654},{"style":375},[2655],{"type":49,"value":666},{"type":26,"tag":126,"props":2657,"children":2658},{"style":210},[2659],{"type":49,"value":671},{"type":26,"tag":126,"props":2661,"children":2662},{"style":139},[2663],{"type":49,"value":403},{"type":26,"tag":126,"props":2665,"children":2666},{"class":128,"line":179},[2667,2672],{"type":26,"tag":126,"props":2668,"children":2669},{"style":375},[2670],{"type":49,"value":2671},"    if",{"type":26,"tag":126,"props":2673,"children":2674},{"style":139},[2675],{"type":49,"value":2676}," form.is_valid():\n",{"type":26,"tag":126,"props":2678,"children":2679},{"class":128,"line":188},[2680,2685,2689,2693,2697,2701,2705],{"type":26,"tag":126,"props":2681,"children":2682},{"style":139},[2683],{"type":49,"value":2684},"        next_redirect ",{"type":26,"tag":126,"props":2686,"children":2687},{"style":375},[2688],{"type":49,"value":378},{"type":26,"tag":126,"props":2690,"children":2691},{"style":139},[2692],{"type":49,"value":692},{"type":26,"tag":126,"props":2694,"children":2695},{"style":210},[2696],{"type":49,"value":2651},{"type":26,"tag":126,"props":2698,"children":2699},{"style":139},[2700],{"type":49,"value":2621},{"type":26,"tag":126,"props":2702,"children":2703},{"style":159},[2704],{"type":49,"value":2626},{"type":26,"tag":126,"props":2706,"children":2707},{"style":139},[2708],{"type":49,"value":403},{"type":26,"tag":126,"props":2710,"children":2711},{"class":128,"line":201},[2712,2717,2721,2726,2731],{"type":26,"tag":126,"props":2713,"children":2714},{"style":139},[2715],{"type":49,"value":2716},"        username ",{"type":26,"tag":126,"props":2718,"children":2719},{"style":375},[2720],{"type":49,"value":378},{"type":26,"tag":126,"props":2722,"children":2723},{"style":139},[2724],{"type":49,"value":2725}," form.cleaned_data.get(",{"type":26,"tag":126,"props":2727,"children":2728},{"style":159},[2729],{"type":49,"value":2730},"'username'",{"type":26,"tag":126,"props":2732,"children":2733},{"style":139},[2734],{"type":49,"value":403},{"type":26,"tag":126,"props":2736,"children":2737},{"class":128,"line":220},[2738,2743,2747,2751,2756],{"type":26,"tag":126,"props":2739,"children":2740},{"style":139},[2741],{"type":49,"value":2742},"        password ",{"type":26,"tag":126,"props":2744,"children":2745},{"style":375},[2746],{"type":49,"value":378},{"type":26,"tag":126,"props":2748,"children":2749},{"style":139},[2750],{"type":49,"value":2725},{"type":26,"tag":126,"props":2752,"children":2753},{"style":159},[2754],{"type":49,"value":2755},"'password'",{"type":26,"tag":126,"props":2757,"children":2758},{"style":139},[2759],{"type":49,"value":403},{"type":26,"tag":126,"props":2761,"children":2762},{"class":128,"line":238},[2763,2768,2772,2777,2782,2786,2791,2796,2800],{"type":26,"tag":126,"props":2764,"children":2765},{"style":139},[2766],{"type":49,"value":2767},"        user ",{"type":26,"tag":126,"props":2769,"children":2770},{"style":375},[2771],{"type":49,"value":378},{"type":26,"tag":126,"props":2773,"children":2774},{"style":139},[2775],{"type":49,"value":2776}," authenticate(",{"type":26,"tag":126,"props":2778,"children":2779},{"style":386},[2780],{"type":49,"value":2781},"username",{"type":26,"tag":126,"props":2783,"children":2784},{"style":375},[2785],{"type":49,"value":378},{"type":26,"tag":126,"props":2787,"children":2788},{"style":139},[2789],{"type":49,"value":2790},"username, ",{"type":26,"tag":126,"props":2792,"children":2793},{"style":386},[2794],{"type":49,"value":2795},"password",{"type":26,"tag":126,"props":2797,"children":2798},{"style":375},[2799],{"type":49,"value":378},{"type":26,"tag":126,"props":2801,"children":2802},{"style":139},[2803],{"type":49,"value":2804},"password)\n",{"type":26,"tag":126,"props":2806,"children":2807},{"class":128,"line":256},[2808],{"type":26,"tag":126,"props":2809,"children":2810},{"style":139},[2811],{"type":49,"value":2812},"        login(request, user)\n",{"type":26,"tag":126,"props":2814,"children":2815},{"class":128,"line":265},[2816,2822],{"type":26,"tag":126,"props":2817,"children":2819},{"style":2818},"--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF",[2820],{"type":49,"value":2821},"        print",{"type":26,"tag":126,"props":2823,"children":2824},{"style":139},[2825],{"type":49,"value":2826},"(next_redirect)\n",{"type":26,"tag":126,"props":2828,"children":2829},{"class":128,"line":731},[2830,2835,2840,2845,2850],{"type":26,"tag":126,"props":2831,"children":2832},{"style":375},[2833],{"type":49,"value":2834},"        if",{"type":26,"tag":126,"props":2836,"children":2837},{"style":139},[2838],{"type":49,"value":2839}," next_redirect ",{"type":26,"tag":126,"props":2841,"children":2842},{"style":375},[2843],{"type":49,"value":2844},"!=",{"type":26,"tag":126,"props":2846,"children":2847},{"style":159},[2848],{"type":49,"value":2849}," 'None'",{"type":26,"tag":126,"props":2851,"children":2852},{"style":139},[2853],{"type":49,"value":2854},":\n",{"type":26,"tag":126,"props":2856,"children":2857},{"class":128,"line":759},[2858,2863],{"type":26,"tag":126,"props":2859,"children":2860},{"style":375},[2861],{"type":49,"value":2862},"            return",{"type":26,"tag":126,"props":2864,"children":2865},{"style":139},[2866],{"type":49,"value":2867}," redirect(next_redirect)\n",{"type":26,"tag":126,"props":2869,"children":2870},{"class":128,"line":767},[2871,2876,2881,2886],{"type":26,"tag":126,"props":2872,"children":2873},{"style":375},[2874],{"type":49,"value":2875},"        return",{"type":26,"tag":126,"props":2877,"children":2878},{"style":139},[2879],{"type":49,"value":2880}," redirect(",{"type":26,"tag":126,"props":2882,"children":2883},{"style":159},[2884],{"type":49,"value":2885},"'books:all'",{"type":26,"tag":126,"props":2887,"children":2888},{"style":139},[2889],{"type":49,"value":403},{"type":26,"tag":126,"props":2891,"children":2892},{"class":128,"line":777},[2893,2897,2901,2906,2911,2916,2920],{"type":26,"tag":126,"props":2894,"children":2895},{"style":139},[2896],{"type":49,"value":888},{"type":26,"tag":126,"props":2898,"children":2899},{"style":375},[2900],{"type":49,"value":378},{"type":26,"tag":126,"props":2902,"children":2903},{"style":139},[2904],{"type":49,"value":2905}," { ",{"type":26,"tag":126,"props":2907,"children":2908},{"style":159},[2909],{"type":49,"value":2910},"'form'",{"type":26,"tag":126,"props":2912,"children":2913},{"style":139},[2914],{"type":49,"value":2915},":form, ",{"type":26,"tag":126,"props":2917,"children":2918},{"style":159},[2919],{"type":49,"value":2626},{"type":26,"tag":126,"props":2921,"children":2922},{"style":139},[2923],{"type":49,"value":2924},":next_redirect }\n",{"type":26,"tag":126,"props":2926,"children":2927},{"class":128,"line":786},[2928,2932,2936,2941],{"type":26,"tag":126,"props":2929,"children":2930},{"style":375},[2931],{"type":49,"value":990},{"type":26,"tag":126,"props":2933,"children":2934},{"style":139},[2935],{"type":49,"value":995},{"type":26,"tag":126,"props":2937,"children":2938},{"style":159},[2939],{"type":49,"value":2940},"'accounts/login_form.html'",{"type":26,"tag":126,"props":2942,"children":2943},{"style":139},[2944],{"type":49,"value":1005},{"type":26,"tag":27,"props":2946,"children":2947},{},[2948,2950,2955],{"type":49,"value":2949},"Notice that I pass ",{"type":26,"tag":102,"props":2951,"children":2953},{"className":2952},[],[2954],{"type":49,"value":2558},{"type":49,"value":2956}," as a context variable. I use this in the login form here:",{"type":26,"tag":27,"props":2958,"children":2959},{},[2960],{"type":49,"value":114},{"type":26,"tag":116,"props":2962,"children":2964},{"code":2963,"language":1380,"meta":8,"className":1381,"style":8},"\u003Cform method=\"POST\" action=\".\">\n  {% csrf_token %} {{ form | crispy }}\n  \u003Cinput type=\"hidden\" value=\"{{ next }}\" name=\"next\" />\n  \u003Cdiv class=\"login-center\">\n    \u003Cinput class=\"btn btn-success login-center\" type=\"submit\" value=\"Login\" />\n  \u003C/div>\n  \u003Cbr />\n  or \u003Ca href=\"{% url 'accounts:register' %}\">create an account\u003C/a>\n\u003C/form>\n",[2965],{"type":26,"tag":102,"props":2966,"children":2967},{"__ignoreMap":8},[2968,3012,3020,3080,3110,3165,3181,3197,3236],{"type":26,"tag":126,"props":2969,"children":2970},{"class":128,"line":129},[2971,2975,2980,2985,2989,2994,2999,3003,3008],{"type":26,"tag":126,"props":2972,"children":2973},{"style":139},[2974],{"type":49,"value":1393},{"type":26,"tag":126,"props":2976,"children":2977},{"style":1396},[2978],{"type":49,"value":2979},"form",{"type":26,"tag":126,"props":2981,"children":2982},{"style":144},[2983],{"type":49,"value":2984}," method",{"type":26,"tag":126,"props":2986,"children":2987},{"style":139},[2988],{"type":49,"value":378},{"type":26,"tag":126,"props":2990,"children":2991},{"style":159},[2992],{"type":49,"value":2993},"\"POST\"",{"type":26,"tag":126,"props":2995,"children":2996},{"style":144},[2997],{"type":49,"value":2998}," action",{"type":26,"tag":126,"props":3000,"children":3001},{"style":139},[3002],{"type":49,"value":378},{"type":26,"tag":126,"props":3004,"children":3005},{"style":159},[3006],{"type":49,"value":3007},"\".\"",{"type":26,"tag":126,"props":3009,"children":3010},{"style":139},[3011],{"type":49,"value":1404},{"type":26,"tag":126,"props":3013,"children":3014},{"class":128,"line":155},[3015],{"type":26,"tag":126,"props":3016,"children":3017},{"style":139},[3018],{"type":49,"value":3019},"  {% csrf_token %} {{ form | crispy }}\n",{"type":26,"tag":126,"props":3021,"children":3022},{"class":128,"line":170},[3023,3028,3033,3038,3042,3047,3052,3056,3061,3066,3070,3075],{"type":26,"tag":126,"props":3024,"children":3025},{"style":139},[3026],{"type":49,"value":3027},"  \u003C",{"type":26,"tag":126,"props":3029,"children":3030},{"style":1396},[3031],{"type":49,"value":3032},"input",{"type":26,"tag":126,"props":3034,"children":3035},{"style":144},[3036],{"type":49,"value":3037}," type",{"type":26,"tag":126,"props":3039,"children":3040},{"style":139},[3041],{"type":49,"value":378},{"type":26,"tag":126,"props":3043,"children":3044},{"style":159},[3045],{"type":49,"value":3046},"\"hidden\"",{"type":26,"tag":126,"props":3048,"children":3049},{"style":144},[3050],{"type":49,"value":3051}," value",{"type":26,"tag":126,"props":3053,"children":3054},{"style":139},[3055],{"type":49,"value":378},{"type":26,"tag":126,"props":3057,"children":3058},{"style":159},[3059],{"type":49,"value":3060},"\"{{ next }}\"",{"type":26,"tag":126,"props":3062,"children":3063},{"style":144},[3064],{"type":49,"value":3065}," name",{"type":26,"tag":126,"props":3067,"children":3068},{"style":139},[3069],{"type":49,"value":378},{"type":26,"tag":126,"props":3071,"children":3072},{"style":159},[3073],{"type":49,"value":3074},"\"next\"",{"type":26,"tag":126,"props":3076,"children":3077},{"style":139},[3078],{"type":49,"value":3079}," />\n",{"type":26,"tag":126,"props":3081,"children":3082},{"class":128,"line":179},[3083,3087,3092,3097,3101,3106],{"type":26,"tag":126,"props":3084,"children":3085},{"style":139},[3086],{"type":49,"value":3027},{"type":26,"tag":126,"props":3088,"children":3089},{"style":1396},[3090],{"type":49,"value":3091},"div",{"type":26,"tag":126,"props":3093,"children":3094},{"style":144},[3095],{"type":49,"value":3096}," class",{"type":26,"tag":126,"props":3098,"children":3099},{"style":139},[3100],{"type":49,"value":378},{"type":26,"tag":126,"props":3102,"children":3103},{"style":159},[3104],{"type":49,"value":3105},"\"login-center\"",{"type":26,"tag":126,"props":3107,"children":3108},{"style":139},[3109],{"type":49,"value":1404},{"type":26,"tag":126,"props":3111,"children":3112},{"class":128,"line":188},[3113,3118,3122,3126,3130,3135,3139,3143,3148,3152,3156,3161],{"type":26,"tag":126,"props":3114,"children":3115},{"style":139},[3116],{"type":49,"value":3117},"    \u003C",{"type":26,"tag":126,"props":3119,"children":3120},{"style":1396},[3121],{"type":49,"value":3032},{"type":26,"tag":126,"props":3123,"children":3124},{"style":144},[3125],{"type":49,"value":3096},{"type":26,"tag":126,"props":3127,"children":3128},{"style":139},[3129],{"type":49,"value":378},{"type":26,"tag":126,"props":3131,"children":3132},{"style":159},[3133],{"type":49,"value":3134},"\"btn btn-success login-center\"",{"type":26,"tag":126,"props":3136,"children":3137},{"style":144},[3138],{"type":49,"value":3037},{"type":26,"tag":126,"props":3140,"children":3141},{"style":139},[3142],{"type":49,"value":378},{"type":26,"tag":126,"props":3144,"children":3145},{"style":159},[3146],{"type":49,"value":3147},"\"submit\"",{"type":26,"tag":126,"props":3149,"children":3150},{"style":144},[3151],{"type":49,"value":3051},{"type":26,"tag":126,"props":3153,"children":3154},{"style":139},[3155],{"type":49,"value":378},{"type":26,"tag":126,"props":3157,"children":3158},{"style":159},[3159],{"type":49,"value":3160},"\"Login\"",{"type":26,"tag":126,"props":3162,"children":3163},{"style":139},[3164],{"type":49,"value":3079},{"type":26,"tag":126,"props":3166,"children":3167},{"class":128,"line":201},[3168,3173,3177],{"type":26,"tag":126,"props":3169,"children":3170},{"style":139},[3171],{"type":49,"value":3172},"  \u003C/",{"type":26,"tag":126,"props":3174,"children":3175},{"style":1396},[3176],{"type":49,"value":3091},{"type":26,"tag":126,"props":3178,"children":3179},{"style":139},[3180],{"type":49,"value":1404},{"type":26,"tag":126,"props":3182,"children":3183},{"class":128,"line":220},[3184,3188,3193],{"type":26,"tag":126,"props":3185,"children":3186},{"style":139},[3187],{"type":49,"value":3027},{"type":26,"tag":126,"props":3189,"children":3190},{"style":1396},[3191],{"type":49,"value":3192},"br",{"type":26,"tag":126,"props":3194,"children":3195},{"style":139},[3196],{"type":49,"value":3079},{"type":26,"tag":126,"props":3198,"children":3199},{"class":128,"line":238},[3200,3205,3209,3214,3218,3223,3228,3232],{"type":26,"tag":126,"props":3201,"children":3202},{"style":139},[3203],{"type":49,"value":3204},"  or \u003C",{"type":26,"tag":126,"props":3206,"children":3207},{"style":1396},[3208],{"type":49,"value":42},{"type":26,"tag":126,"props":3210,"children":3211},{"style":144},[3212],{"type":49,"value":3213}," href",{"type":26,"tag":126,"props":3215,"children":3216},{"style":139},[3217],{"type":49,"value":378},{"type":26,"tag":126,"props":3219,"children":3220},{"style":159},[3221],{"type":49,"value":3222},"\"{% url 'accounts:register' %}\"",{"type":26,"tag":126,"props":3224,"children":3225},{"style":139},[3226],{"type":49,"value":3227},">create an account\u003C/",{"type":26,"tag":126,"props":3229,"children":3230},{"style":1396},[3231],{"type":49,"value":42},{"type":26,"tag":126,"props":3233,"children":3234},{"style":139},[3235],{"type":49,"value":1404},{"type":26,"tag":126,"props":3237,"children":3238},{"class":128,"line":256},[3239,3243,3247],{"type":26,"tag":126,"props":3240,"children":3241},{"style":139},[3242],{"type":49,"value":2529},{"type":26,"tag":126,"props":3244,"children":3245},{"style":1396},[3246],{"type":49,"value":2979},{"type":26,"tag":126,"props":3248,"children":3249},{"style":139},[3250],{"type":49,"value":1404},{"type":26,"tag":27,"props":3252,"children":3253},{},[3254],{"type":49,"value":286},{"type":26,"tag":27,"props":3256,"children":3257},{},[3258,3260,3265,3267,3272,3274,3280],{"type":49,"value":3259},"By passing this as a hidden value to the form, when a ",{"type":26,"tag":102,"props":3261,"children":3263},{"className":3262},[],[3264],{"type":49,"value":2651},{"type":49,"value":3266}," request is made, we are redirected to the value of ",{"type":26,"tag":102,"props":3268,"children":3270},{"className":3269},[],[3271],{"type":49,"value":2558},{"type":49,"value":3273}," if it is not ",{"type":26,"tag":102,"props":3275,"children":3277},{"className":3276},[],[3278],{"type":49,"value":3279},"None",{"type":49,"value":3281},", or if there is no redirect.",{"type":26,"tag":27,"props":3283,"children":3284},{},[3285,3287,3293,3295,3301],{"type":49,"value":3286},"When a ",{"type":26,"tag":102,"props":3288,"children":3290},{"className":3289},[],[3291],{"type":49,"value":3292},"@login_required",{"type":49,"value":3294}," decorator is used, and we want to access a url such as ",{"type":26,"tag":102,"props":3296,"children":3298},{"className":3297},[],[3299],{"type":49,"value":3300},"/books/add",{"type":49,"value":3302},", we are redirected to a url that looks like this:",{"type":26,"tag":116,"props":3304,"children":3306},{"code":3305,"language":1380,"meta":8,"className":1381,"style":8},"http://localhost:8000/accounts/login/?next=/books/new/\n",[3307],{"type":26,"tag":102,"props":3308,"children":3309},{"__ignoreMap":8},[3310],{"type":26,"tag":126,"props":3311,"children":3312},{"class":128,"line":129},[3313],{"type":26,"tag":126,"props":3314,"children":3315},{"style":139},[3316],{"type":49,"value":3305},{"type":26,"tag":27,"props":3318,"children":3319},{},[3320,3322,3327,3329,3334],{"type":49,"value":3321},"In this way we can pass the next parameter from the ",{"type":26,"tag":102,"props":3323,"children":3325},{"className":3324},[],[3326],{"type":49,"value":661},{"type":49,"value":3328}," request to the ",{"type":26,"tag":102,"props":3330,"children":3332},{"className":3331},[],[3333],{"type":49,"value":2651},{"type":49,"value":3335}," request that is made when the login view is hit.",{"type":26,"tag":293,"props":3337,"children":3339},{"id":3338},"authors",[3340],{"type":49,"value":3341},"Authors",{"type":26,"tag":27,"props":3343,"children":3344},{},[3345,3347,3353],{"type":49,"value":3346},"For illustration purposes, I included an ",{"type":26,"tag":102,"props":3348,"children":3350},{"className":3349},[],[3351],{"type":49,"value":3352},"Author",{"type":49,"value":3354}," model. Since a book can have zero, one or many Authors, I used a many-to-many relationship to link authors to books. Here is how we do this in our Book model:",{"type":26,"tag":116,"props":3356,"children":3358},{"code":3357,"language":319,"meta":8,"className":320,"style":8},"class Book(models.Model):\n    [...other fields...]\n    authors = models.ManyToManyField('authors.Author')\n",[3359],{"type":26,"tag":102,"props":3360,"children":3361},{"__ignoreMap":8},[3362,3393,3417],{"type":26,"tag":126,"props":3363,"children":3364},{"class":128,"line":129},[3365,3369,3373,3377,3381,3385,3389],{"type":26,"tag":126,"props":3366,"children":3367},{"style":330},[3368],{"type":49,"value":333},{"type":26,"tag":126,"props":3370,"children":3371},{"style":336},[3372],{"type":49,"value":339},{"type":26,"tag":126,"props":3374,"children":3375},{"style":139},[3376],{"type":49,"value":344},{"type":26,"tag":126,"props":3378,"children":3379},{"style":347},[3380],{"type":49,"value":350},{"type":26,"tag":126,"props":3382,"children":3383},{"style":139},[3384],{"type":49,"value":86},{"type":26,"tag":126,"props":3386,"children":3387},{"style":347},[3388],{"type":49,"value":359},{"type":26,"tag":126,"props":3390,"children":3391},{"style":139},[3392],{"type":49,"value":364},{"type":26,"tag":126,"props":3394,"children":3395},{"class":128,"line":155},[3396,3400,3404,3409,3413],{"type":26,"tag":126,"props":3397,"children":3398},{"style":139},[3399],{"type":49,"value":513},{"type":26,"tag":126,"props":3401,"children":3402},{"style":210},[3403],{"type":49,"value":518},{"type":26,"tag":126,"props":3405,"children":3406},{"style":139},[3407],{"type":49,"value":3408},"other fields",{"type":26,"tag":126,"props":3410,"children":3411},{"style":210},[3412],{"type":49,"value":518},{"type":26,"tag":126,"props":3414,"children":3415},{"style":139},[3416],{"type":49,"value":523},{"type":26,"tag":126,"props":3418,"children":3419},{"class":128,"line":170},[3420,3425,3429,3434,3439],{"type":26,"tag":126,"props":3421,"children":3422},{"style":139},[3423],{"type":49,"value":3424},"    authors ",{"type":26,"tag":126,"props":3426,"children":3427},{"style":375},[3428],{"type":49,"value":378},{"type":26,"tag":126,"props":3430,"children":3431},{"style":139},[3432],{"type":49,"value":3433}," models.ManyToManyField(",{"type":26,"tag":126,"props":3435,"children":3436},{"style":159},[3437],{"type":49,"value":3438},"'authors.Author'",{"type":26,"tag":126,"props":3440,"children":3441},{"style":139},[3442],{"type":49,"value":403},{"type":26,"tag":27,"props":3444,"children":3445},{},[3446,3448,3453,3455,3460],{"type":49,"value":3447},"This dot notation with ",{"type":26,"tag":102,"props":3449,"children":3451},{"className":3450},[],[3452],{"type":49,"value":3438},{"type":49,"value":3454}," is important. Previously I would have just imported the ",{"type":26,"tag":102,"props":3456,"children":3458},{"className":3457},[],[3459],{"type":49,"value":3352},{"type":49,"value":3461},"model and then referenced that in the ManyToManyField. However, this can lead to circular import errors which are hard to debug unless you know what a circular import is.",{"type":26,"tag":27,"props":3463,"children":3464},{},[3465,3467,3473,3475,3480],{"type":49,"value":3466},"Now let's look at how to find all ",{"type":26,"tag":102,"props":3468,"children":3470},{"className":3469},[],[3471],{"type":49,"value":3472},"Books",{"type":49,"value":3474}," by a certain author, as well as all ",{"type":26,"tag":102,"props":3476,"children":3478},{"className":3477},[],[3479],{"type":49,"value":3341},{"type":49,"value":3481}," of a given book. Uing the Django shell, we can do the following:",{"type":26,"tag":116,"props":3483,"children":3485},{"code":3484,"language":319,"meta":8,"className":320,"style":8},"from authors.models import Author\nfrom books.models import Book\na = Author.objects.all().first()\na.book_set.values()\n\u003CQuerySet [{'id': 583, 'title': 'None Or Other', 'lat': Decimal('-118.035345'), 'lon': Decimal('34.139729'), 'pages': 1881, 'publish_date': datetime.date(2018, 3, 18), 'website': 'https://www.fleming-mitchell.com/', 'synopsis': 'Option ever large throw dinner worker ahead realize clearly congress as smile size spend expert chair well. Brother item win follow hope coach garden later arrive who if ago voice analysis simply reflect. Amount under data drug kind book fish still information president minute stage dog. Focus full green society parent door according my management sell arrive only send international tonight. Player character financial detail oil check bring pressure possible former. Learn politics compare position large loss exactly probably approach physical international machine as model. ', 'slug': 'none-or-other', 'status': True}, {'id': 601, 'title': 'Teacher Them Step', 'lat': Decimal('-80.268357'), 'lon': Decimal('26.661763'), 'pages': 206, 'publish_date': datetime.date(2018, 2, 27), 'website': 'http://www.rodriguez.net/', 'synopsis': 'Drug fact behavior environment green try account where training brother building particular window even reach. Pressure lawyer dog world thought near institution we get force market can guy receive matter structure research foot of small. Professor production very this practice car wind wish relationship after follow professor news card concern media property have. According majority owner go mention reach store computer project kitchen group quality present several another time school and will. Before during central artist page only health region happen share traditional section well out human. Mention quite short race only education heavy book up recent official here spring oil buy which language information practice. Time mother better peace girl defense rock mr never feeling tax city stock bar tv others right conference skin. ', 'slug': 'teacher-them-step', 'status': True}]>\n",[3486],{"type":26,"tag":102,"props":3487,"children":3488},{"__ignoreMap":8},[3489,3512,3533,3550,3558],{"type":26,"tag":126,"props":3490,"children":3491},{"class":128,"line":129},[3492,3497,3502,3507],{"type":26,"tag":126,"props":3493,"children":3494},{"style":375},[3495],{"type":49,"value":3496},"from",{"type":26,"tag":126,"props":3498,"children":3499},{"style":139},[3500],{"type":49,"value":3501}," authors.models ",{"type":26,"tag":126,"props":3503,"children":3504},{"style":375},[3505],{"type":49,"value":3506},"import",{"type":26,"tag":126,"props":3508,"children":3509},{"style":139},[3510],{"type":49,"value":3511}," Author\n",{"type":26,"tag":126,"props":3513,"children":3514},{"class":128,"line":155},[3515,3519,3524,3528],{"type":26,"tag":126,"props":3516,"children":3517},{"style":375},[3518],{"type":49,"value":3496},{"type":26,"tag":126,"props":3520,"children":3521},{"style":139},[3522],{"type":49,"value":3523}," books.models ",{"type":26,"tag":126,"props":3525,"children":3526},{"style":375},[3527],{"type":49,"value":3506},{"type":26,"tag":126,"props":3529,"children":3530},{"style":139},[3531],{"type":49,"value":3532}," Book\n",{"type":26,"tag":126,"props":3534,"children":3535},{"class":128,"line":170},[3536,3541,3545],{"type":26,"tag":126,"props":3537,"children":3538},{"style":139},[3539],{"type":49,"value":3540},"a ",{"type":26,"tag":126,"props":3542,"children":3543},{"style":375},[3544],{"type":49,"value":378},{"type":26,"tag":126,"props":3546,"children":3547},{"style":139},[3548],{"type":49,"value":3549}," Author.objects.all().first()\n",{"type":26,"tag":126,"props":3551,"children":3552},{"class":128,"line":179},[3553],{"type":26,"tag":126,"props":3554,"children":3555},{"style":139},[3556],{"type":49,"value":3557},"a.book_set.values()\n",{"type":26,"tag":126,"props":3559,"children":3560},{"class":128,"line":188},[3561,3565,3570,3575,3580,3585,3589,3594,3598,3603,3607,3612,3617,3622,3627,3632,3636,3641,3645,3649,3653,3658,3662,3667,3672,3677,3681,3686,3690,3694,3698,3703,3707,3712,3716,3721,3725,3730,3734,3739,3743,3748,3752,3757,3761,3766,3771,3775,3779,3784,3788,3792,3796,3801,3805,3809,3813,3818,3822,3826,3830,3835,3839,3843,3847,3852,3856,3860,3864,3868,3872,3876,3880,3885,3889,3893,3897,3902,3906,3910,3914,3919,3923,3927,3931,3936,3940,3944,3948,3952,3957],{"type":26,"tag":126,"props":3562,"children":3563},{"style":375},[3564],{"type":49,"value":1393},{"type":26,"tag":126,"props":3566,"children":3567},{"style":139},[3568],{"type":49,"value":3569},"QuerySet [{",{"type":26,"tag":126,"props":3571,"children":3572},{"style":159},[3573],{"type":49,"value":3574},"'id'",{"type":26,"tag":126,"props":3576,"children":3577},{"style":139},[3578],{"type":49,"value":3579},": ",{"type":26,"tag":126,"props":3581,"children":3582},{"style":210},[3583],{"type":49,"value":3584},"583",{"type":26,"tag":126,"props":3586,"children":3587},{"style":139},[3588],{"type":49,"value":439},{"type":26,"tag":126,"props":3590,"children":3591},{"style":159},[3592],{"type":49,"value":3593},"'title'",{"type":26,"tag":126,"props":3595,"children":3596},{"style":139},[3597],{"type":49,"value":3579},{"type":26,"tag":126,"props":3599,"children":3600},{"style":159},[3601],{"type":49,"value":3602},"'None Or Other'",{"type":26,"tag":126,"props":3604,"children":3605},{"style":139},[3606],{"type":49,"value":439},{"type":26,"tag":126,"props":3608,"children":3609},{"style":159},[3610],{"type":49,"value":3611},"'lat'",{"type":26,"tag":126,"props":3613,"children":3614},{"style":139},[3615],{"type":49,"value":3616},": Decimal(",{"type":26,"tag":126,"props":3618,"children":3619},{"style":159},[3620],{"type":49,"value":3621},"'-118.035345'",{"type":26,"tag":126,"props":3623,"children":3624},{"style":139},[3625],{"type":49,"value":3626},"), ",{"type":26,"tag":126,"props":3628,"children":3629},{"style":159},[3630],{"type":49,"value":3631},"'lon'",{"type":26,"tag":126,"props":3633,"children":3634},{"style":139},[3635],{"type":49,"value":3616},{"type":26,"tag":126,"props":3637,"children":3638},{"style":159},[3639],{"type":49,"value":3640},"'34.139729'",{"type":26,"tag":126,"props":3642,"children":3643},{"style":139},[3644],{"type":49,"value":3626},{"type":26,"tag":126,"props":3646,"children":3647},{"style":159},[3648],{"type":49,"value":751},{"type":26,"tag":126,"props":3650,"children":3651},{"style":139},[3652],{"type":49,"value":3579},{"type":26,"tag":126,"props":3654,"children":3655},{"style":210},[3656],{"type":49,"value":3657},"1881",{"type":26,"tag":126,"props":3659,"children":3660},{"style":139},[3661],{"type":49,"value":439},{"type":26,"tag":126,"props":3663,"children":3664},{"style":159},[3665],{"type":49,"value":3666},"'publish_date'",{"type":26,"tag":126,"props":3668,"children":3669},{"style":139},[3670],{"type":49,"value":3671},": datetime.date(",{"type":26,"tag":126,"props":3673,"children":3674},{"style":210},[3675],{"type":49,"value":3676},"2018",{"type":26,"tag":126,"props":3678,"children":3679},{"style":139},[3680],{"type":49,"value":439},{"type":26,"tag":126,"props":3682,"children":3683},{"style":210},[3684],{"type":49,"value":3685},"3",{"type":26,"tag":126,"props":3687,"children":3688},{"style":139},[3689],{"type":49,"value":439},{"type":26,"tag":126,"props":3691,"children":3692},{"style":210},[3693],{"type":49,"value":213},{"type":26,"tag":126,"props":3695,"children":3696},{"style":139},[3697],{"type":49,"value":3626},{"type":26,"tag":126,"props":3699,"children":3700},{"style":159},[3701],{"type":49,"value":3702},"'website'",{"type":26,"tag":126,"props":3704,"children":3705},{"style":139},[3706],{"type":49,"value":3579},{"type":26,"tag":126,"props":3708,"children":3709},{"style":159},[3710],{"type":49,"value":3711},"'https://www.fleming-mitchell.com/'",{"type":26,"tag":126,"props":3713,"children":3714},{"style":139},[3715],{"type":49,"value":439},{"type":26,"tag":126,"props":3717,"children":3718},{"style":159},[3719],{"type":49,"value":3720},"'synopsis'",{"type":26,"tag":126,"props":3722,"children":3723},{"style":139},[3724],{"type":49,"value":3579},{"type":26,"tag":126,"props":3726,"children":3727},{"style":159},[3728],{"type":49,"value":3729},"'Option ever large throw dinner worker ahead realize clearly congress as smile size spend expert chair well. Brother item win follow hope coach garden later arrive who if ago voice analysis simply reflect. Amount under data drug kind book fish still information president minute stage dog. Focus full green society parent door according my management sell arrive only send international tonight. Player character financial detail oil check bring pressure possible former. Learn politics compare position large loss exactly probably approach physical international machine as model. '",{"type":26,"tag":126,"props":3731,"children":3732},{"style":139},[3733],{"type":49,"value":439},{"type":26,"tag":126,"props":3735,"children":3736},{"style":159},[3737],{"type":49,"value":3738},"'slug'",{"type":26,"tag":126,"props":3740,"children":3741},{"style":139},[3742],{"type":49,"value":3579},{"type":26,"tag":126,"props":3744,"children":3745},{"style":159},[3746],{"type":49,"value":3747},"'none-or-other'",{"type":26,"tag":126,"props":3749,"children":3750},{"style":139},[3751],{"type":49,"value":439},{"type":26,"tag":126,"props":3753,"children":3754},{"style":159},[3755],{"type":49,"value":3756},"'status'",{"type":26,"tag":126,"props":3758,"children":3759},{"style":139},[3760],{"type":49,"value":3579},{"type":26,"tag":126,"props":3762,"children":3763},{"style":210},[3764],{"type":49,"value":3765},"True",{"type":26,"tag":126,"props":3767,"children":3768},{"style":139},[3769],{"type":49,"value":3770},"}, {",{"type":26,"tag":126,"props":3772,"children":3773},{"style":159},[3774],{"type":49,"value":3574},{"type":26,"tag":126,"props":3776,"children":3777},{"style":139},[3778],{"type":49,"value":3579},{"type":26,"tag":126,"props":3780,"children":3781},{"style":210},[3782],{"type":49,"value":3783},"601",{"type":26,"tag":126,"props":3785,"children":3786},{"style":139},[3787],{"type":49,"value":439},{"type":26,"tag":126,"props":3789,"children":3790},{"style":159},[3791],{"type":49,"value":3593},{"type":26,"tag":126,"props":3793,"children":3794},{"style":139},[3795],{"type":49,"value":3579},{"type":26,"tag":126,"props":3797,"children":3798},{"style":159},[3799],{"type":49,"value":3800},"'Teacher Them Step'",{"type":26,"tag":126,"props":3802,"children":3803},{"style":139},[3804],{"type":49,"value":439},{"type":26,"tag":126,"props":3806,"children":3807},{"style":159},[3808],{"type":49,"value":3611},{"type":26,"tag":126,"props":3810,"children":3811},{"style":139},[3812],{"type":49,"value":3616},{"type":26,"tag":126,"props":3814,"children":3815},{"style":159},[3816],{"type":49,"value":3817},"'-80.268357'",{"type":26,"tag":126,"props":3819,"children":3820},{"style":139},[3821],{"type":49,"value":3626},{"type":26,"tag":126,"props":3823,"children":3824},{"style":159},[3825],{"type":49,"value":3631},{"type":26,"tag":126,"props":3827,"children":3828},{"style":139},[3829],{"type":49,"value":3616},{"type":26,"tag":126,"props":3831,"children":3832},{"style":159},[3833],{"type":49,"value":3834},"'26.661763'",{"type":26,"tag":126,"props":3836,"children":3837},{"style":139},[3838],{"type":49,"value":3626},{"type":26,"tag":126,"props":3840,"children":3841},{"style":159},[3842],{"type":49,"value":751},{"type":26,"tag":126,"props":3844,"children":3845},{"style":139},[3846],{"type":49,"value":3579},{"type":26,"tag":126,"props":3848,"children":3849},{"style":210},[3850],{"type":49,"value":3851},"206",{"type":26,"tag":126,"props":3853,"children":3854},{"style":139},[3855],{"type":49,"value":439},{"type":26,"tag":126,"props":3857,"children":3858},{"style":159},[3859],{"type":49,"value":3666},{"type":26,"tag":126,"props":3861,"children":3862},{"style":139},[3863],{"type":49,"value":3671},{"type":26,"tag":126,"props":3865,"children":3866},{"style":210},[3867],{"type":49,"value":3676},{"type":26,"tag":126,"props":3869,"children":3870},{"style":139},[3871],{"type":49,"value":439},{"type":26,"tag":126,"props":3873,"children":3874},{"style":210},[3875],{"type":49,"value":2502},{"type":26,"tag":126,"props":3877,"children":3878},{"style":139},[3879],{"type":49,"value":439},{"type":26,"tag":126,"props":3881,"children":3882},{"style":210},[3883],{"type":49,"value":3884},"27",{"type":26,"tag":126,"props":3886,"children":3887},{"style":139},[3888],{"type":49,"value":3626},{"type":26,"tag":126,"props":3890,"children":3891},{"style":159},[3892],{"type":49,"value":3702},{"type":26,"tag":126,"props":3894,"children":3895},{"style":139},[3896],{"type":49,"value":3579},{"type":26,"tag":126,"props":3898,"children":3899},{"style":159},[3900],{"type":49,"value":3901},"'http://www.rodriguez.net/'",{"type":26,"tag":126,"props":3903,"children":3904},{"style":139},[3905],{"type":49,"value":439},{"type":26,"tag":126,"props":3907,"children":3908},{"style":159},[3909],{"type":49,"value":3720},{"type":26,"tag":126,"props":3911,"children":3912},{"style":139},[3913],{"type":49,"value":3579},{"type":26,"tag":126,"props":3915,"children":3916},{"style":159},[3917],{"type":49,"value":3918},"'Drug fact behavior environment green try account where training brother building particular window even reach. Pressure lawyer dog world thought near institution we get force market can guy receive matter structure research foot of small. Professor production very this practice car wind wish relationship after follow professor news card concern media property have. According majority owner go mention reach store computer project kitchen group quality present several another time school and will. Before during central artist page only health region happen share traditional section well out human. Mention quite short race only education heavy book up recent official here spring oil buy which language information practice. Time mother better peace girl defense rock mr never feeling tax city stock bar tv others right conference skin. '",{"type":26,"tag":126,"props":3920,"children":3921},{"style":139},[3922],{"type":49,"value":439},{"type":26,"tag":126,"props":3924,"children":3925},{"style":159},[3926],{"type":49,"value":3738},{"type":26,"tag":126,"props":3928,"children":3929},{"style":139},[3930],{"type":49,"value":3579},{"type":26,"tag":126,"props":3932,"children":3933},{"style":159},[3934],{"type":49,"value":3935},"'teacher-them-step'",{"type":26,"tag":126,"props":3937,"children":3938},{"style":139},[3939],{"type":49,"value":439},{"type":26,"tag":126,"props":3941,"children":3942},{"style":159},[3943],{"type":49,"value":3756},{"type":26,"tag":126,"props":3945,"children":3946},{"style":139},[3947],{"type":49,"value":3579},{"type":26,"tag":126,"props":3949,"children":3950},{"style":210},[3951],{"type":49,"value":3765},{"type":26,"tag":126,"props":3953,"children":3954},{"style":139},[3955],{"type":49,"value":3956},"}]",{"type":26,"tag":126,"props":3958,"children":3959},{"style":375},[3960],{"type":49,"value":1404},{"type":26,"tag":27,"props":3962,"children":3963},{},[3964],{"type":49,"value":3965},"This gave us two books by an author.",{"type":26,"tag":27,"props":3967,"children":3968},{},[3969,3971,3977],{"type":49,"value":3970},"Now, let's look at how to find all authors of a given book. For this example, we can get authors directly in the template from a book object. This example come from the ",{"type":26,"tag":102,"props":3972,"children":3974},{"className":3973},[],[3975],{"type":49,"value":3976},"book_detail",{"type":49,"value":3978}," template:",{"type":26,"tag":27,"props":3980,"children":3981},{},[3982],{"type":49,"value":114},{"type":26,"tag":116,"props":3984,"children":3986},{"code":3985,"language":1380,"meta":8,"className":1381,"style":8},"\u003Ch3>\n  Authors: {% for author in book.authors.all %}\n  \u003Ca href=\"{% url 'authors:author_detail' id=author.id %}\"\n    >{{ author.full_name }}\u003C/a\n  >\n  {% endfor %}\n\u003C/h3>\n",[3987],{"type":26,"tag":102,"props":3988,"children":3989},{"__ignoreMap":8},[3990,4005,4013,4037,4050,4058,4066],{"type":26,"tag":126,"props":3991,"children":3992},{"class":128,"line":129},[3993,3997,4001],{"type":26,"tag":126,"props":3994,"children":3995},{"style":139},[3996],{"type":49,"value":1393},{"type":26,"tag":126,"props":3998,"children":3999},{"style":1396},[4000],{"type":49,"value":37},{"type":26,"tag":126,"props":4002,"children":4003},{"style":139},[4004],{"type":49,"value":1404},{"type":26,"tag":126,"props":4006,"children":4007},{"class":128,"line":155},[4008],{"type":26,"tag":126,"props":4009,"children":4010},{"style":139},[4011],{"type":49,"value":4012},"  Authors: {% for author in book.authors.all %}\n",{"type":26,"tag":126,"props":4014,"children":4015},{"class":128,"line":170},[4016,4020,4024,4028,4032],{"type":26,"tag":126,"props":4017,"children":4018},{"style":139},[4019],{"type":49,"value":3027},{"type":26,"tag":126,"props":4021,"children":4022},{"style":1396},[4023],{"type":49,"value":42},{"type":26,"tag":126,"props":4025,"children":4026},{"style":144},[4027],{"type":49,"value":3213},{"type":26,"tag":126,"props":4029,"children":4030},{"style":139},[4031],{"type":49,"value":378},{"type":26,"tag":126,"props":4033,"children":4034},{"style":159},[4035],{"type":49,"value":4036},"\"{% url 'authors:author_detail' id=author.id %}\"\n",{"type":26,"tag":126,"props":4038,"children":4039},{"class":128,"line":179},[4040,4045],{"type":26,"tag":126,"props":4041,"children":4042},{"style":139},[4043],{"type":49,"value":4044},"    >{{ author.full_name }}\u003C/",{"type":26,"tag":126,"props":4046,"children":4047},{"style":1396},[4048],{"type":49,"value":4049},"a\n",{"type":26,"tag":126,"props":4051,"children":4052},{"class":128,"line":188},[4053],{"type":26,"tag":126,"props":4054,"children":4055},{"style":139},[4056],{"type":49,"value":4057},"  >\n",{"type":26,"tag":126,"props":4059,"children":4060},{"class":128,"line":201},[4061],{"type":26,"tag":126,"props":4062,"children":4063},{"style":139},[4064],{"type":49,"value":4065},"  {% endfor %}\n",{"type":26,"tag":126,"props":4067,"children":4068},{"class":128,"line":220},[4069,4073,4077],{"type":26,"tag":126,"props":4070,"children":4071},{"style":139},[4072],{"type":49,"value":2529},{"type":26,"tag":126,"props":4074,"children":4075},{"style":1396},[4076],{"type":49,"value":37},{"type":26,"tag":126,"props":4078,"children":4079},{"style":139},[4080],{"type":49,"value":1404},{"type":26,"tag":27,"props":4082,"children":4083},{},[4084],{"type":49,"value":286},{"type":26,"tag":27,"props":4086,"children":4087},{},[4088,4090,4096],{"type":49,"value":4089},"We could just as well access ",{"type":26,"tag":102,"props":4091,"children":4093},{"className":4092},[],[4094],{"type":49,"value":4095},"books.authors.all",{"type":49,"value":4097}," in the view and pass authors in a variable that we can iterate over in the template, but this keeps things simpler without much more code to write.",{"type":26,"tag":293,"props":4099,"children":4101},{"id":4100},"filtering-data",[4102],{"type":49,"value":4103},"Filtering Data",{"type":26,"tag":27,"props":4105,"children":4106},{},[4107,4109,4114,4116,4122,4124,4130,4132,4137],{"type":49,"value":4108},"One other question I wanted to answer with this project is how to do relatively complex data filtering. To do this, I used Django forms to create a form that calls a ",{"type":26,"tag":102,"props":4110,"children":4112},{"className":4111},[],[4113],{"type":49,"value":661},{"type":49,"value":4115}," request to the same view it came from, which is to say, a filter form on the template for the ",{"type":26,"tag":102,"props":4117,"children":4119},{"className":4118},[],[4120],{"type":49,"value":4121},"all",{"type":49,"value":4123}," books view has a form action with an ",{"type":26,"tag":102,"props":4125,"children":4127},{"className":4126},[],[4128],{"type":49,"value":4129},"action",{"type":49,"value":4131}," value of the url that returns the ",{"type":26,"tag":102,"props":4133,"children":4135},{"className":4134},[],[4136],{"type":49,"value":4121},{"type":49,"value":4138}," view.",{"type":26,"tag":27,"props":4140,"children":4141},{},[4142],{"type":49,"value":4143},"Here's a look at the form I put together for filtering data:",{"type":26,"tag":116,"props":4145,"children":4147},{"code":4146,"language":319,"meta":8,"className":320,"style":8},"class QueryForm(forms.Form):\n\n    publish_date_before = forms.DateField(\n        label='',\n        required=False,\n        # initial = datetime.datetime.now(),\n        widget = forms.TextInput(\n            attrs={\n                'class': 'form-control',\n                'id':'datepicker1',\n                'placeholder':'published before'\n            }))\n\n    publish_date_after = forms.DateField(\n        label='',\n        required=False,\n        # initial = datetime.datetime.now(),\n        widget = forms.TextInput(\n            attrs={\n                'class': 'form-control',\n                'id':'datepicker2',\n                'placeholder':'published after'\n            }))\n\n    keywords = forms.CharField(\n        required=False,\n        label='',\n        widget=forms.TextInput(\n\n            attrs={\n                'class':'form-control',\n                'placeholder':'space-separated words matching title, synopsis, website or tags'\n            }))\n",[4148],{"type":26,"tag":102,"props":4149,"children":4150},{"__ignoreMap":8},[4151,4185,4192,4209,4230,4251,4259,4277,4294,4315,4336,4353,4361,4368,4384,4403,4422,4429,4444,4459,4478,4498,4514,4521,4528,4545,4564,4583,4599,4606,4621,4640,4656],{"type":26,"tag":126,"props":4152,"children":4153},{"class":128,"line":129},[4154,4158,4163,4167,4172,4176,4181],{"type":26,"tag":126,"props":4155,"children":4156},{"style":330},[4157],{"type":49,"value":333},{"type":26,"tag":126,"props":4159,"children":4160},{"style":336},[4161],{"type":49,"value":4162}," QueryForm",{"type":26,"tag":126,"props":4164,"children":4165},{"style":139},[4166],{"type":49,"value":344},{"type":26,"tag":126,"props":4168,"children":4169},{"style":347},[4170],{"type":49,"value":4171},"forms",{"type":26,"tag":126,"props":4173,"children":4174},{"style":139},[4175],{"type":49,"value":86},{"type":26,"tag":126,"props":4177,"children":4178},{"style":347},[4179],{"type":49,"value":4180},"Form",{"type":26,"tag":126,"props":4182,"children":4183},{"style":139},[4184],{"type":49,"value":364},{"type":26,"tag":126,"props":4186,"children":4187},{"class":128,"line":155},[4188],{"type":26,"tag":126,"props":4189,"children":4190},{"emptyLinePlaceholder":12},[4191],{"type":49,"value":705},{"type":26,"tag":126,"props":4193,"children":4194},{"class":128,"line":170},[4195,4200,4204],{"type":26,"tag":126,"props":4196,"children":4197},{"style":139},[4198],{"type":49,"value":4199},"    publish_date_before ",{"type":26,"tag":126,"props":4201,"children":4202},{"style":375},[4203],{"type":49,"value":378},{"type":26,"tag":126,"props":4205,"children":4206},{"style":139},[4207],{"type":49,"value":4208}," forms.DateField(\n",{"type":26,"tag":126,"props":4210,"children":4211},{"class":128,"line":179},[4212,4217,4221,4226],{"type":26,"tag":126,"props":4213,"children":4214},{"style":386},[4215],{"type":49,"value":4216},"        label",{"type":26,"tag":126,"props":4218,"children":4219},{"style":375},[4220],{"type":49,"value":378},{"type":26,"tag":126,"props":4222,"children":4223},{"style":159},[4224],{"type":49,"value":4225},"''",{"type":26,"tag":126,"props":4227,"children":4228},{"style":139},[4229],{"type":49,"value":167},{"type":26,"tag":126,"props":4231,"children":4232},{"class":128,"line":188},[4233,4238,4242,4247],{"type":26,"tag":126,"props":4234,"children":4235},{"style":386},[4236],{"type":49,"value":4237},"        required",{"type":26,"tag":126,"props":4239,"children":4240},{"style":375},[4241],{"type":49,"value":378},{"type":26,"tag":126,"props":4243,"children":4244},{"style":210},[4245],{"type":49,"value":4246},"False",{"type":26,"tag":126,"props":4248,"children":4249},{"style":139},[4250],{"type":49,"value":167},{"type":26,"tag":126,"props":4252,"children":4253},{"class":128,"line":201},[4254],{"type":26,"tag":126,"props":4255,"children":4256},{"style":771},[4257],{"type":49,"value":4258},"        # initial = datetime.datetime.now(),\n",{"type":26,"tag":126,"props":4260,"children":4261},{"class":128,"line":220},[4262,4267,4272],{"type":26,"tag":126,"props":4263,"children":4264},{"style":386},[4265],{"type":49,"value":4266},"        widget",{"type":26,"tag":126,"props":4268,"children":4269},{"style":375},[4270],{"type":49,"value":4271}," =",{"type":26,"tag":126,"props":4273,"children":4274},{"style":139},[4275],{"type":49,"value":4276}," forms.TextInput(\n",{"type":26,"tag":126,"props":4278,"children":4279},{"class":128,"line":238},[4280,4285,4289],{"type":26,"tag":126,"props":4281,"children":4282},{"style":386},[4283],{"type":49,"value":4284},"            attrs",{"type":26,"tag":126,"props":4286,"children":4287},{"style":375},[4288],{"type":49,"value":378},{"type":26,"tag":126,"props":4290,"children":4291},{"style":139},[4292],{"type":49,"value":4293},"{\n",{"type":26,"tag":126,"props":4295,"children":4296},{"class":128,"line":256},[4297,4302,4306,4311],{"type":26,"tag":126,"props":4298,"children":4299},{"style":159},[4300],{"type":49,"value":4301},"                'class'",{"type":26,"tag":126,"props":4303,"children":4304},{"style":139},[4305],{"type":49,"value":3579},{"type":26,"tag":126,"props":4307,"children":4308},{"style":159},[4309],{"type":49,"value":4310},"'form-control'",{"type":26,"tag":126,"props":4312,"children":4313},{"style":139},[4314],{"type":49,"value":167},{"type":26,"tag":126,"props":4316,"children":4317},{"class":128,"line":265},[4318,4323,4327,4332],{"type":26,"tag":126,"props":4319,"children":4320},{"style":159},[4321],{"type":49,"value":4322},"                'id'",{"type":26,"tag":126,"props":4324,"children":4325},{"style":139},[4326],{"type":49,"value":64},{"type":26,"tag":126,"props":4328,"children":4329},{"style":159},[4330],{"type":49,"value":4331},"'datepicker1'",{"type":26,"tag":126,"props":4333,"children":4334},{"style":139},[4335],{"type":49,"value":167},{"type":26,"tag":126,"props":4337,"children":4338},{"class":128,"line":731},[4339,4344,4348],{"type":26,"tag":126,"props":4340,"children":4341},{"style":159},[4342],{"type":49,"value":4343},"                'placeholder'",{"type":26,"tag":126,"props":4345,"children":4346},{"style":139},[4347],{"type":49,"value":64},{"type":26,"tag":126,"props":4349,"children":4350},{"style":159},[4351],{"type":49,"value":4352},"'published before'\n",{"type":26,"tag":126,"props":4354,"children":4355},{"class":128,"line":759},[4356],{"type":26,"tag":126,"props":4357,"children":4358},{"style":139},[4359],{"type":49,"value":4360},"            }))\n",{"type":26,"tag":126,"props":4362,"children":4363},{"class":128,"line":767},[4364],{"type":26,"tag":126,"props":4365,"children":4366},{"emptyLinePlaceholder":12},[4367],{"type":49,"value":705},{"type":26,"tag":126,"props":4369,"children":4370},{"class":128,"line":777},[4371,4376,4380],{"type":26,"tag":126,"props":4372,"children":4373},{"style":139},[4374],{"type":49,"value":4375},"    publish_date_after ",{"type":26,"tag":126,"props":4377,"children":4378},{"style":375},[4379],{"type":49,"value":378},{"type":26,"tag":126,"props":4381,"children":4382},{"style":139},[4383],{"type":49,"value":4208},{"type":26,"tag":126,"props":4385,"children":4386},{"class":128,"line":786},[4387,4391,4395,4399],{"type":26,"tag":126,"props":4388,"children":4389},{"style":386},[4390],{"type":49,"value":4216},{"type":26,"tag":126,"props":4392,"children":4393},{"style":375},[4394],{"type":49,"value":378},{"type":26,"tag":126,"props":4396,"children":4397},{"style":159},[4398],{"type":49,"value":4225},{"type":26,"tag":126,"props":4400,"children":4401},{"style":139},[4402],{"type":49,"value":167},{"type":26,"tag":126,"props":4404,"children":4405},{"class":128,"line":834},[4406,4410,4414,4418],{"type":26,"tag":126,"props":4407,"children":4408},{"style":386},[4409],{"type":49,"value":4237},{"type":26,"tag":126,"props":4411,"children":4412},{"style":375},[4413],{"type":49,"value":378},{"type":26,"tag":126,"props":4415,"children":4416},{"style":210},[4417],{"type":49,"value":4246},{"type":26,"tag":126,"props":4419,"children":4420},{"style":139},[4421],{"type":49,"value":167},{"type":26,"tag":126,"props":4423,"children":4424},{"class":128,"line":848},[4425],{"type":26,"tag":126,"props":4426,"children":4427},{"style":771},[4428],{"type":49,"value":4258},{"type":26,"tag":126,"props":4430,"children":4431},{"class":128,"line":882},[4432,4436,4440],{"type":26,"tag":126,"props":4433,"children":4434},{"style":386},[4435],{"type":49,"value":4266},{"type":26,"tag":126,"props":4437,"children":4438},{"style":375},[4439],{"type":49,"value":4271},{"type":26,"tag":126,"props":4441,"children":4442},{"style":139},[4443],{"type":49,"value":4276},{"type":26,"tag":126,"props":4445,"children":4446},{"class":128,"line":900},[4447,4451,4455],{"type":26,"tag":126,"props":4448,"children":4449},{"style":386},[4450],{"type":49,"value":4284},{"type":26,"tag":126,"props":4452,"children":4453},{"style":375},[4454],{"type":49,"value":378},{"type":26,"tag":126,"props":4456,"children":4457},{"style":139},[4458],{"type":49,"value":4293},{"type":26,"tag":126,"props":4460,"children":4461},{"class":128,"line":914},[4462,4466,4470,4474],{"type":26,"tag":126,"props":4463,"children":4464},{"style":159},[4465],{"type":49,"value":4301},{"type":26,"tag":126,"props":4467,"children":4468},{"style":139},[4469],{"type":49,"value":3579},{"type":26,"tag":126,"props":4471,"children":4472},{"style":159},[4473],{"type":49,"value":4310},{"type":26,"tag":126,"props":4475,"children":4476},{"style":139},[4477],{"type":49,"value":167},{"type":26,"tag":126,"props":4479,"children":4480},{"class":128,"line":923},[4481,4485,4489,4494],{"type":26,"tag":126,"props":4482,"children":4483},{"style":159},[4484],{"type":49,"value":4322},{"type":26,"tag":126,"props":4486,"children":4487},{"style":139},[4488],{"type":49,"value":64},{"type":26,"tag":126,"props":4490,"children":4491},{"style":159},[4492],{"type":49,"value":4493},"'datepicker2'",{"type":26,"tag":126,"props":4495,"children":4496},{"style":139},[4497],{"type":49,"value":167},{"type":26,"tag":126,"props":4499,"children":4500},{"class":128,"line":932},[4501,4505,4509],{"type":26,"tag":126,"props":4502,"children":4503},{"style":159},[4504],{"type":49,"value":4343},{"type":26,"tag":126,"props":4506,"children":4507},{"style":139},[4508],{"type":49,"value":64},{"type":26,"tag":126,"props":4510,"children":4511},{"style":159},[4512],{"type":49,"value":4513},"'published after'\n",{"type":26,"tag":126,"props":4515,"children":4516},{"class":128,"line":946},[4517],{"type":26,"tag":126,"props":4518,"children":4519},{"style":139},[4520],{"type":49,"value":4360},{"type":26,"tag":126,"props":4522,"children":4523},{"class":128,"line":970},[4524],{"type":26,"tag":126,"props":4525,"children":4526},{"emptyLinePlaceholder":12},[4527],{"type":49,"value":705},{"type":26,"tag":126,"props":4529,"children":4530},{"class":128,"line":984},[4531,4536,4540],{"type":26,"tag":126,"props":4532,"children":4533},{"style":139},[4534],{"type":49,"value":4535},"    keywords ",{"type":26,"tag":126,"props":4537,"children":4538},{"style":375},[4539],{"type":49,"value":378},{"type":26,"tag":126,"props":4541,"children":4542},{"style":139},[4543],{"type":49,"value":4544}," forms.CharField(\n",{"type":26,"tag":126,"props":4546,"children":4547},{"class":128,"line":1880},[4548,4552,4556,4560],{"type":26,"tag":126,"props":4549,"children":4550},{"style":386},[4551],{"type":49,"value":4237},{"type":26,"tag":126,"props":4553,"children":4554},{"style":375},[4555],{"type":49,"value":378},{"type":26,"tag":126,"props":4557,"children":4558},{"style":210},[4559],{"type":49,"value":4246},{"type":26,"tag":126,"props":4561,"children":4562},{"style":139},[4563],{"type":49,"value":167},{"type":26,"tag":126,"props":4565,"children":4566},{"class":128,"line":1888},[4567,4571,4575,4579],{"type":26,"tag":126,"props":4568,"children":4569},{"style":386},[4570],{"type":49,"value":4216},{"type":26,"tag":126,"props":4572,"children":4573},{"style":375},[4574],{"type":49,"value":378},{"type":26,"tag":126,"props":4576,"children":4577},{"style":159},[4578],{"type":49,"value":4225},{"type":26,"tag":126,"props":4580,"children":4581},{"style":139},[4582],{"type":49,"value":167},{"type":26,"tag":126,"props":4584,"children":4585},{"class":128,"line":1927},[4586,4590,4594],{"type":26,"tag":126,"props":4587,"children":4588},{"style":386},[4589],{"type":49,"value":4266},{"type":26,"tag":126,"props":4591,"children":4592},{"style":375},[4593],{"type":49,"value":378},{"type":26,"tag":126,"props":4595,"children":4596},{"style":139},[4597],{"type":49,"value":4598},"forms.TextInput(\n",{"type":26,"tag":126,"props":4600,"children":4601},{"class":128,"line":1945},[4602],{"type":26,"tag":126,"props":4603,"children":4604},{"emptyLinePlaceholder":12},[4605],{"type":49,"value":705},{"type":26,"tag":126,"props":4607,"children":4608},{"class":128,"line":1954},[4609,4613,4617],{"type":26,"tag":126,"props":4610,"children":4611},{"style":386},[4612],{"type":49,"value":4284},{"type":26,"tag":126,"props":4614,"children":4615},{"style":375},[4616],{"type":49,"value":378},{"type":26,"tag":126,"props":4618,"children":4619},{"style":139},[4620],{"type":49,"value":4293},{"type":26,"tag":126,"props":4622,"children":4623},{"class":128,"line":1972},[4624,4628,4632,4636],{"type":26,"tag":126,"props":4625,"children":4626},{"style":159},[4627],{"type":49,"value":4301},{"type":26,"tag":126,"props":4629,"children":4630},{"style":139},[4631],{"type":49,"value":64},{"type":26,"tag":126,"props":4633,"children":4634},{"style":159},[4635],{"type":49,"value":4310},{"type":26,"tag":126,"props":4637,"children":4638},{"style":139},[4639],{"type":49,"value":167},{"type":26,"tag":126,"props":4641,"children":4642},{"class":128,"line":1990},[4643,4647,4651],{"type":26,"tag":126,"props":4644,"children":4645},{"style":159},[4646],{"type":49,"value":4343},{"type":26,"tag":126,"props":4648,"children":4649},{"style":139},[4650],{"type":49,"value":64},{"type":26,"tag":126,"props":4652,"children":4653},{"style":159},[4654],{"type":49,"value":4655},"'space-separated words matching title, synopsis, website or tags'\n",{"type":26,"tag":126,"props":4657,"children":4658},{"class":128,"line":2007},[4659],{"type":26,"tag":126,"props":4660,"children":4661},{"style":139},[4662],{"type":49,"value":4360},{"type":26,"tag":27,"props":4664,"children":4665},{},[4666,4668,4674,4676,4682,4684,4690],{"type":49,"value":4667},"Here we are using three fields to filter data, a ",{"type":26,"tag":102,"props":4669,"children":4671},{"className":4670},[],[4672],{"type":49,"value":4673},"published_before",{"type":49,"value":4675}," date, a ",{"type":26,"tag":102,"props":4677,"children":4679},{"className":4678},[],[4680],{"type":49,"value":4681},"published_after",{"type":49,"value":4683}," date and a ",{"type":26,"tag":102,"props":4685,"children":4687},{"className":4686},[],[4688],{"type":49,"value":4689},"keywords",{"type":49,"value":4691}," field.",{"type":26,"tag":27,"props":4693,"children":4694},{},[4695,4697,4703,4705,4711,4713,4719,4721,4726],{"type":49,"value":4696},"Filtering this data can really clog up code in ",{"type":26,"tag":102,"props":4698,"children":4700},{"className":4699},[],[4701],{"type":49,"value":4702},"views.py",{"type":49,"value":4704},", and I know I was going to need this same code again for filtering data for CSV and XLS file downloads (more on this in a minute), so I decided to wrote a utility function that takes a ",{"type":26,"tag":102,"props":4706,"children":4708},{"className":4707},[],[4709],{"type":49,"value":4710},"Book",{"type":49,"value":4712}," queryset and parameter dictionary (",{"type":26,"tag":102,"props":4714,"children":4716},{"className":4715},[],[4717],{"type":49,"value":4718},"request.GET",{"type":49,"value":4720},"), and returns a filtered ",{"type":26,"tag":102,"props":4722,"children":4724},{"className":4723},[],[4725],{"type":49,"value":4710},{"type":49,"value":4727}," queryset. Here's what that function looks like:",{"type":26,"tag":116,"props":4729,"children":4731},{"code":4730,"language":319,"meta":8,"className":320,"style":8},"from django.db.models import Q\nfrom functools import reduce\nfrom ..models import Book\nimport datetime\n\ndef filter_books(books, paramDict):\n    # paramDict = request.GET\n    params = paramDict.keys()\n\n    # data filtering\n    if any(x!='' for x in paramDict.values()):\n        if paramDict['publish_date_after'] != '':\n            after_date = paramDict['publish_date_after']\n            _after_date = datetime.datetime.strptime(after_date, '%m/%d/%Y')\n\n            books = books.filter(publish_date__gte=_after_date)\n\n        if paramDict['publish_date_before'] != '':\n            before_date = paramDict['publish_date_before']\n            _before_date = datetime.datetime.strptime(before_date, '%m/%d/%Y')\n            books = books.filter(publish_date__lte=_before_date)\n\n        # filters records that contain any of the following keywords\n        if paramDict['keywords'] != '':\n            kws = paramDict['keywords'].split()\n            q_lookups = [Q(title__icontains=kw) for kw in kws] + \\\n                        [Q(synopsis__icontains=kw) for kw in kws] + \\\n                        [Q(website__icontains=kw) for kw in kws]\n            filters = Q()\n            filters |= reduce(lambda x, y: x | y, q_lookups)\n            books = books.filter(filters)\n\n    return books\n",[4732],{"type":26,"tag":102,"props":4733,"children":4734},{"__ignoreMap":8},[4735,4756,4778,4798,4810,4817,4850,4858,4875,4882,4890,4934,4969,4993,5029,5036,5067,5074,5106,5130,5163,5192,5199,5207,5239,5264,5322,5367,5404,5421,5476,5492,5499],{"type":26,"tag":126,"props":4736,"children":4737},{"class":128,"line":129},[4738,4742,4747,4751],{"type":26,"tag":126,"props":4739,"children":4740},{"style":375},[4741],{"type":49,"value":3496},{"type":26,"tag":126,"props":4743,"children":4744},{"style":139},[4745],{"type":49,"value":4746}," django.db.models ",{"type":26,"tag":126,"props":4748,"children":4749},{"style":375},[4750],{"type":49,"value":3506},{"type":26,"tag":126,"props":4752,"children":4753},{"style":139},[4754],{"type":49,"value":4755}," Q\n",{"type":26,"tag":126,"props":4757,"children":4758},{"class":128,"line":155},[4759,4763,4768,4772],{"type":26,"tag":126,"props":4760,"children":4761},{"style":375},[4762],{"type":49,"value":3496},{"type":26,"tag":126,"props":4764,"children":4765},{"style":139},[4766],{"type":49,"value":4767}," functools ",{"type":26,"tag":126,"props":4769,"children":4770},{"style":375},[4771],{"type":49,"value":3506},{"type":26,"tag":126,"props":4773,"children":4775},{"style":4774},"--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#F8F8F2",[4776],{"type":49,"value":4777}," reduce\n",{"type":26,"tag":126,"props":4779,"children":4780},{"class":128,"line":170},[4781,4785,4790,4794],{"type":26,"tag":126,"props":4782,"children":4783},{"style":375},[4784],{"type":49,"value":3496},{"type":26,"tag":126,"props":4786,"children":4787},{"style":139},[4788],{"type":49,"value":4789}," ..models ",{"type":26,"tag":126,"props":4791,"children":4792},{"style":375},[4793],{"type":49,"value":3506},{"type":26,"tag":126,"props":4795,"children":4796},{"style":139},[4797],{"type":49,"value":3532},{"type":26,"tag":126,"props":4799,"children":4800},{"class":128,"line":179},[4801,4805],{"type":26,"tag":126,"props":4802,"children":4803},{"style":375},[4804],{"type":49,"value":3506},{"type":26,"tag":126,"props":4806,"children":4807},{"style":139},[4808],{"type":49,"value":4809}," datetime\n",{"type":26,"tag":126,"props":4811,"children":4812},{"class":128,"line":188},[4813],{"type":26,"tag":126,"props":4814,"children":4815},{"emptyLinePlaceholder":12},[4816],{"type":49,"value":705},{"type":26,"tag":126,"props":4818,"children":4819},{"class":128,"line":201},[4820,4824,4829,4833,4837,4841,4846],{"type":26,"tag":126,"props":4821,"children":4822},{"style":330},[4823],{"type":49,"value":580},{"type":26,"tag":126,"props":4825,"children":4826},{"style":144},[4827],{"type":49,"value":4828}," filter_books",{"type":26,"tag":126,"props":4830,"children":4831},{"style":139},[4832],{"type":49,"value":344},{"type":26,"tag":126,"props":4834,"children":4835},{"style":592},[4836],{"type":49,"value":558},{"type":26,"tag":126,"props":4838,"children":4839},{"style":139},[4840],{"type":49,"value":439},{"type":26,"tag":126,"props":4842,"children":4843},{"style":592},[4844],{"type":49,"value":4845},"paramDict",{"type":26,"tag":126,"props":4847,"children":4848},{"style":139},[4849],{"type":49,"value":364},{"type":26,"tag":126,"props":4851,"children":4852},{"class":128,"line":220},[4853],{"type":26,"tag":126,"props":4854,"children":4855},{"style":771},[4856],{"type":49,"value":4857},"    # paramDict = request.GET\n",{"type":26,"tag":126,"props":4859,"children":4860},{"class":128,"line":238},[4861,4866,4870],{"type":26,"tag":126,"props":4862,"children":4863},{"style":139},[4864],{"type":49,"value":4865},"    params ",{"type":26,"tag":126,"props":4867,"children":4868},{"style":375},[4869],{"type":49,"value":378},{"type":26,"tag":126,"props":4871,"children":4872},{"style":139},[4873],{"type":49,"value":4874}," paramDict.keys()\n",{"type":26,"tag":126,"props":4876,"children":4877},{"class":128,"line":256},[4878],{"type":26,"tag":126,"props":4879,"children":4880},{"emptyLinePlaceholder":12},[4881],{"type":49,"value":705},{"type":26,"tag":126,"props":4883,"children":4884},{"class":128,"line":265},[4885],{"type":26,"tag":126,"props":4886,"children":4887},{"style":771},[4888],{"type":49,"value":4889},"    # data filtering\n",{"type":26,"tag":126,"props":4891,"children":4892},{"class":128,"line":731},[4893,4897,4902,4907,4911,4915,4920,4925,4929],{"type":26,"tag":126,"props":4894,"children":4895},{"style":375},[4896],{"type":49,"value":2671},{"type":26,"tag":126,"props":4898,"children":4899},{"style":2818},[4900],{"type":49,"value":4901}," any",{"type":26,"tag":126,"props":4903,"children":4904},{"style":139},[4905],{"type":49,"value":4906},"(x",{"type":26,"tag":126,"props":4908,"children":4909},{"style":375},[4910],{"type":49,"value":2844},{"type":26,"tag":126,"props":4912,"children":4913},{"style":159},[4914],{"type":49,"value":4225},{"type":26,"tag":126,"props":4916,"children":4917},{"style":375},[4918],{"type":49,"value":4919}," for",{"type":26,"tag":126,"props":4921,"children":4922},{"style":139},[4923],{"type":49,"value":4924}," x ",{"type":26,"tag":126,"props":4926,"children":4927},{"style":375},[4928],{"type":49,"value":874},{"type":26,"tag":126,"props":4930,"children":4931},{"style":139},[4932],{"type":49,"value":4933}," paramDict.values()):\n",{"type":26,"tag":126,"props":4935,"children":4936},{"class":128,"line":759},[4937,4941,4946,4951,4956,4960,4965],{"type":26,"tag":126,"props":4938,"children":4939},{"style":375},[4940],{"type":49,"value":2834},{"type":26,"tag":126,"props":4942,"children":4943},{"style":139},[4944],{"type":49,"value":4945}," paramDict[",{"type":26,"tag":126,"props":4947,"children":4948},{"style":159},[4949],{"type":49,"value":4950},"'publish_date_after'",{"type":26,"tag":126,"props":4952,"children":4953},{"style":139},[4954],{"type":49,"value":4955},"] ",{"type":26,"tag":126,"props":4957,"children":4958},{"style":375},[4959],{"type":49,"value":2844},{"type":26,"tag":126,"props":4961,"children":4962},{"style":159},[4963],{"type":49,"value":4964}," ''",{"type":26,"tag":126,"props":4966,"children":4967},{"style":139},[4968],{"type":49,"value":2854},{"type":26,"tag":126,"props":4970,"children":4971},{"class":128,"line":767},[4972,4977,4981,4985,4989],{"type":26,"tag":126,"props":4973,"children":4974},{"style":139},[4975],{"type":49,"value":4976},"            after_date ",{"type":26,"tag":126,"props":4978,"children":4979},{"style":375},[4980],{"type":49,"value":378},{"type":26,"tag":126,"props":4982,"children":4983},{"style":139},[4984],{"type":49,"value":4945},{"type":26,"tag":126,"props":4986,"children":4987},{"style":159},[4988],{"type":49,"value":4950},{"type":26,"tag":126,"props":4990,"children":4991},{"style":139},[4992],{"type":49,"value":523},{"type":26,"tag":126,"props":4994,"children":4995},{"class":128,"line":777},[4996,5001,5005,5010,5015,5020,5025],{"type":26,"tag":126,"props":4997,"children":4998},{"style":139},[4999],{"type":49,"value":5000},"            _after_date ",{"type":26,"tag":126,"props":5002,"children":5003},{"style":375},[5004],{"type":49,"value":378},{"type":26,"tag":126,"props":5006,"children":5007},{"style":139},[5008],{"type":49,"value":5009}," datetime.datetime.strptime(after_date, ",{"type":26,"tag":126,"props":5011,"children":5012},{"style":159},[5013],{"type":49,"value":5014},"'%m/",{"type":26,"tag":126,"props":5016,"children":5017},{"style":210},[5018],{"type":49,"value":5019},"%d",{"type":26,"tag":126,"props":5021,"children":5022},{"style":159},[5023],{"type":49,"value":5024},"/%Y'",{"type":26,"tag":126,"props":5026,"children":5027},{"style":139},[5028],{"type":49,"value":403},{"type":26,"tag":126,"props":5030,"children":5031},{"class":128,"line":786},[5032],{"type":26,"tag":126,"props":5033,"children":5034},{"emptyLinePlaceholder":12},[5035],{"type":49,"value":705},{"type":26,"tag":126,"props":5037,"children":5038},{"class":128,"line":834},[5039,5044,5048,5053,5058,5062],{"type":26,"tag":126,"props":5040,"children":5041},{"style":139},[5042],{"type":49,"value":5043},"            books ",{"type":26,"tag":126,"props":5045,"children":5046},{"style":375},[5047],{"type":49,"value":378},{"type":26,"tag":126,"props":5049,"children":5050},{"style":139},[5051],{"type":49,"value":5052}," books.filter(",{"type":26,"tag":126,"props":5054,"children":5055},{"style":386},[5056],{"type":49,"value":5057},"publish_date__gte",{"type":26,"tag":126,"props":5059,"children":5060},{"style":375},[5061],{"type":49,"value":378},{"type":26,"tag":126,"props":5063,"children":5064},{"style":139},[5065],{"type":49,"value":5066},"_after_date)\n",{"type":26,"tag":126,"props":5068,"children":5069},{"class":128,"line":848},[5070],{"type":26,"tag":126,"props":5071,"children":5072},{"emptyLinePlaceholder":12},[5073],{"type":49,"value":705},{"type":26,"tag":126,"props":5075,"children":5076},{"class":128,"line":882},[5077,5081,5085,5090,5094,5098,5102],{"type":26,"tag":126,"props":5078,"children":5079},{"style":375},[5080],{"type":49,"value":2834},{"type":26,"tag":126,"props":5082,"children":5083},{"style":139},[5084],{"type":49,"value":4945},{"type":26,"tag":126,"props":5086,"children":5087},{"style":159},[5088],{"type":49,"value":5089},"'publish_date_before'",{"type":26,"tag":126,"props":5091,"children":5092},{"style":139},[5093],{"type":49,"value":4955},{"type":26,"tag":126,"props":5095,"children":5096},{"style":375},[5097],{"type":49,"value":2844},{"type":26,"tag":126,"props":5099,"children":5100},{"style":159},[5101],{"type":49,"value":4964},{"type":26,"tag":126,"props":5103,"children":5104},{"style":139},[5105],{"type":49,"value":2854},{"type":26,"tag":126,"props":5107,"children":5108},{"class":128,"line":900},[5109,5114,5118,5122,5126],{"type":26,"tag":126,"props":5110,"children":5111},{"style":139},[5112],{"type":49,"value":5113},"            before_date ",{"type":26,"tag":126,"props":5115,"children":5116},{"style":375},[5117],{"type":49,"value":378},{"type":26,"tag":126,"props":5119,"children":5120},{"style":139},[5121],{"type":49,"value":4945},{"type":26,"tag":126,"props":5123,"children":5124},{"style":159},[5125],{"type":49,"value":5089},{"type":26,"tag":126,"props":5127,"children":5128},{"style":139},[5129],{"type":49,"value":523},{"type":26,"tag":126,"props":5131,"children":5132},{"class":128,"line":914},[5133,5138,5142,5147,5151,5155,5159],{"type":26,"tag":126,"props":5134,"children":5135},{"style":139},[5136],{"type":49,"value":5137},"            _before_date ",{"type":26,"tag":126,"props":5139,"children":5140},{"style":375},[5141],{"type":49,"value":378},{"type":26,"tag":126,"props":5143,"children":5144},{"style":139},[5145],{"type":49,"value":5146}," datetime.datetime.strptime(before_date, ",{"type":26,"tag":126,"props":5148,"children":5149},{"style":159},[5150],{"type":49,"value":5014},{"type":26,"tag":126,"props":5152,"children":5153},{"style":210},[5154],{"type":49,"value":5019},{"type":26,"tag":126,"props":5156,"children":5157},{"style":159},[5158],{"type":49,"value":5024},{"type":26,"tag":126,"props":5160,"children":5161},{"style":139},[5162],{"type":49,"value":403},{"type":26,"tag":126,"props":5164,"children":5165},{"class":128,"line":923},[5166,5170,5174,5178,5183,5187],{"type":26,"tag":126,"props":5167,"children":5168},{"style":139},[5169],{"type":49,"value":5043},{"type":26,"tag":126,"props":5171,"children":5172},{"style":375},[5173],{"type":49,"value":378},{"type":26,"tag":126,"props":5175,"children":5176},{"style":139},[5177],{"type":49,"value":5052},{"type":26,"tag":126,"props":5179,"children":5180},{"style":386},[5181],{"type":49,"value":5182},"publish_date__lte",{"type":26,"tag":126,"props":5184,"children":5185},{"style":375},[5186],{"type":49,"value":378},{"type":26,"tag":126,"props":5188,"children":5189},{"style":139},[5190],{"type":49,"value":5191},"_before_date)\n",{"type":26,"tag":126,"props":5193,"children":5194},{"class":128,"line":932},[5195],{"type":26,"tag":126,"props":5196,"children":5197},{"emptyLinePlaceholder":12},[5198],{"type":49,"value":705},{"type":26,"tag":126,"props":5200,"children":5201},{"class":128,"line":946},[5202],{"type":26,"tag":126,"props":5203,"children":5204},{"style":771},[5205],{"type":49,"value":5206},"        # filters records that contain any of the following keywords\n",{"type":26,"tag":126,"props":5208,"children":5209},{"class":128,"line":970},[5210,5214,5218,5223,5227,5231,5235],{"type":26,"tag":126,"props":5211,"children":5212},{"style":375},[5213],{"type":49,"value":2834},{"type":26,"tag":126,"props":5215,"children":5216},{"style":139},[5217],{"type":49,"value":4945},{"type":26,"tag":126,"props":5219,"children":5220},{"style":159},[5221],{"type":49,"value":5222},"'keywords'",{"type":26,"tag":126,"props":5224,"children":5225},{"style":139},[5226],{"type":49,"value":4955},{"type":26,"tag":126,"props":5228,"children":5229},{"style":375},[5230],{"type":49,"value":2844},{"type":26,"tag":126,"props":5232,"children":5233},{"style":159},[5234],{"type":49,"value":4964},{"type":26,"tag":126,"props":5236,"children":5237},{"style":139},[5238],{"type":49,"value":2854},{"type":26,"tag":126,"props":5240,"children":5241},{"class":128,"line":984},[5242,5247,5251,5255,5259],{"type":26,"tag":126,"props":5243,"children":5244},{"style":139},[5245],{"type":49,"value":5246},"            kws ",{"type":26,"tag":126,"props":5248,"children":5249},{"style":375},[5250],{"type":49,"value":378},{"type":26,"tag":126,"props":5252,"children":5253},{"style":139},[5254],{"type":49,"value":4945},{"type":26,"tag":126,"props":5256,"children":5257},{"style":159},[5258],{"type":49,"value":5222},{"type":26,"tag":126,"props":5260,"children":5261},{"style":139},[5262],{"type":49,"value":5263},"].split()\n",{"type":26,"tag":126,"props":5265,"children":5266},{"class":128,"line":1880},[5267,5272,5276,5281,5286,5290,5295,5299,5304,5308,5313,5317],{"type":26,"tag":126,"props":5268,"children":5269},{"style":139},[5270],{"type":49,"value":5271},"            q_lookups ",{"type":26,"tag":126,"props":5273,"children":5274},{"style":375},[5275],{"type":49,"value":378},{"type":26,"tag":126,"props":5277,"children":5278},{"style":139},[5279],{"type":49,"value":5280}," [Q(",{"type":26,"tag":126,"props":5282,"children":5283},{"style":386},[5284],{"type":49,"value":5285},"title__icontains",{"type":26,"tag":126,"props":5287,"children":5288},{"style":375},[5289],{"type":49,"value":378},{"type":26,"tag":126,"props":5291,"children":5292},{"style":139},[5293],{"type":49,"value":5294},"kw) ",{"type":26,"tag":126,"props":5296,"children":5297},{"style":375},[5298],{"type":49,"value":864},{"type":26,"tag":126,"props":5300,"children":5301},{"style":139},[5302],{"type":49,"value":5303}," kw ",{"type":26,"tag":126,"props":5305,"children":5306},{"style":375},[5307],{"type":49,"value":874},{"type":26,"tag":126,"props":5309,"children":5310},{"style":139},[5311],{"type":49,"value":5312}," kws] ",{"type":26,"tag":126,"props":5314,"children":5315},{"style":375},[5316],{"type":49,"value":1303},{"type":26,"tag":126,"props":5318,"children":5319},{"style":139},[5320],{"type":49,"value":5321}," \\\n",{"type":26,"tag":126,"props":5323,"children":5324},{"class":128,"line":1888},[5325,5330,5335,5339,5343,5347,5351,5355,5359,5363],{"type":26,"tag":126,"props":5326,"children":5327},{"style":139},[5328],{"type":49,"value":5329},"                        [Q(",{"type":26,"tag":126,"props":5331,"children":5332},{"style":386},[5333],{"type":49,"value":5334},"synopsis__icontains",{"type":26,"tag":126,"props":5336,"children":5337},{"style":375},[5338],{"type":49,"value":378},{"type":26,"tag":126,"props":5340,"children":5341},{"style":139},[5342],{"type":49,"value":5294},{"type":26,"tag":126,"props":5344,"children":5345},{"style":375},[5346],{"type":49,"value":864},{"type":26,"tag":126,"props":5348,"children":5349},{"style":139},[5350],{"type":49,"value":5303},{"type":26,"tag":126,"props":5352,"children":5353},{"style":375},[5354],{"type":49,"value":874},{"type":26,"tag":126,"props":5356,"children":5357},{"style":139},[5358],{"type":49,"value":5312},{"type":26,"tag":126,"props":5360,"children":5361},{"style":375},[5362],{"type":49,"value":1303},{"type":26,"tag":126,"props":5364,"children":5365},{"style":139},[5366],{"type":49,"value":5321},{"type":26,"tag":126,"props":5368,"children":5369},{"class":128,"line":1927},[5370,5374,5379,5383,5387,5391,5395,5399],{"type":26,"tag":126,"props":5371,"children":5372},{"style":139},[5373],{"type":49,"value":5329},{"type":26,"tag":126,"props":5375,"children":5376},{"style":386},[5377],{"type":49,"value":5378},"website__icontains",{"type":26,"tag":126,"props":5380,"children":5381},{"style":375},[5382],{"type":49,"value":378},{"type":26,"tag":126,"props":5384,"children":5385},{"style":139},[5386],{"type":49,"value":5294},{"type":26,"tag":126,"props":5388,"children":5389},{"style":375},[5390],{"type":49,"value":864},{"type":26,"tag":126,"props":5392,"children":5393},{"style":139},[5394],{"type":49,"value":5303},{"type":26,"tag":126,"props":5396,"children":5397},{"style":375},[5398],{"type":49,"value":874},{"type":26,"tag":126,"props":5400,"children":5401},{"style":139},[5402],{"type":49,"value":5403}," kws]\n",{"type":26,"tag":126,"props":5405,"children":5406},{"class":128,"line":1945},[5407,5412,5416],{"type":26,"tag":126,"props":5408,"children":5409},{"style":139},[5410],{"type":49,"value":5411},"            filters ",{"type":26,"tag":126,"props":5413,"children":5414},{"style":375},[5415],{"type":49,"value":378},{"type":26,"tag":126,"props":5417,"children":5418},{"style":139},[5419],{"type":49,"value":5420}," Q()\n",{"type":26,"tag":126,"props":5422,"children":5423},{"class":128,"line":1954},[5424,5428,5433,5438,5442,5447,5452,5456,5461,5466,5471],{"type":26,"tag":126,"props":5425,"children":5426},{"style":139},[5427],{"type":49,"value":5411},{"type":26,"tag":126,"props":5429,"children":5430},{"style":375},[5431],{"type":49,"value":5432},"|=",{"type":26,"tag":126,"props":5434,"children":5435},{"style":4774},[5436],{"type":49,"value":5437}," reduce",{"type":26,"tag":126,"props":5439,"children":5440},{"style":139},[5441],{"type":49,"value":344},{"type":26,"tag":126,"props":5443,"children":5444},{"style":330},[5445],{"type":49,"value":5446},"lambda",{"type":26,"tag":126,"props":5448,"children":5449},{"style":592},[5450],{"type":49,"value":5451}," x",{"type":26,"tag":126,"props":5453,"children":5454},{"style":139},[5455],{"type":49,"value":439},{"type":26,"tag":126,"props":5457,"children":5458},{"style":592},[5459],{"type":49,"value":5460},"y",{"type":26,"tag":126,"props":5462,"children":5463},{"style":139},[5464],{"type":49,"value":5465},": x ",{"type":26,"tag":126,"props":5467,"children":5468},{"style":375},[5469],{"type":49,"value":5470},"|",{"type":26,"tag":126,"props":5472,"children":5473},{"style":139},[5474],{"type":49,"value":5475}," y, q_lookups)\n",{"type":26,"tag":126,"props":5477,"children":5478},{"class":128,"line":1972},[5479,5483,5487],{"type":26,"tag":126,"props":5480,"children":5481},{"style":139},[5482],{"type":49,"value":5043},{"type":26,"tag":126,"props":5484,"children":5485},{"style":375},[5486],{"type":49,"value":378},{"type":26,"tag":126,"props":5488,"children":5489},{"style":139},[5490],{"type":49,"value":5491}," books.filter(filters)\n",{"type":26,"tag":126,"props":5493,"children":5494},{"class":128,"line":1990},[5495],{"type":26,"tag":126,"props":5496,"children":5497},{"emptyLinePlaceholder":12},[5498],{"type":49,"value":705},{"type":26,"tag":126,"props":5500,"children":5501},{"class":128,"line":2007},[5502,5506],{"type":26,"tag":126,"props":5503,"children":5504},{"style":375},[5505],{"type":49,"value":990},{"type":26,"tag":126,"props":5507,"children":5508},{"style":139},[5509],{"type":49,"value":5510}," books\n",{"type":26,"tag":27,"props":5512,"children":5513},{},[5514,5516,5521],{"type":49,"value":5515},"This makes things much more simple in our views. Here's the code in the main ",{"type":26,"tag":102,"props":5517,"children":5519},{"className":5518},[],[5520],{"type":49,"value":558},{"type":49,"value":5522}," view that uses this filter function, truncated for simplicity:",{"type":26,"tag":116,"props":5524,"children":5526},{"code":5525,"language":319,"meta":8,"className":320,"style":8},"def all_books(request):\n    books = Book.objects.all()\n    form = QueryForm(request.GET or None)\n    paramDict = request.GET\n    books = filter_books(books, paramDict)\n    [...]\n    context = {\n        'books':books,\n        'form':form,\n        [...],}\n    return render(request, 'books/books.html', context)\n",[5527],{"type":26,"tag":102,"props":5528,"children":5529},{"__ignoreMap":8},[5530,5553,5568,5599,5618,5633,5648,5663,5674,5686,5703],{"type":26,"tag":126,"props":5531,"children":5532},{"class":128,"line":129},[5533,5537,5541,5545,5549],{"type":26,"tag":126,"props":5534,"children":5535},{"style":330},[5536],{"type":49,"value":580},{"type":26,"tag":126,"props":5538,"children":5539},{"style":144},[5540],{"type":49,"value":585},{"type":26,"tag":126,"props":5542,"children":5543},{"style":139},[5544],{"type":49,"value":344},{"type":26,"tag":126,"props":5546,"children":5547},{"style":592},[5548],{"type":49,"value":595},{"type":26,"tag":126,"props":5550,"children":5551},{"style":139},[5552],{"type":49,"value":364},{"type":26,"tag":126,"props":5554,"children":5555},{"class":128,"line":155},[5556,5560,5564],{"type":26,"tag":126,"props":5557,"children":5558},{"style":139},[5559],{"type":49,"value":630},{"type":26,"tag":126,"props":5561,"children":5562},{"style":375},[5563],{"type":49,"value":378},{"type":26,"tag":126,"props":5565,"children":5566},{"style":139},[5567],{"type":49,"value":639},{"type":26,"tag":126,"props":5569,"children":5570},{"class":128,"line":170},[5571,5575,5579,5583,5587,5591,5595],{"type":26,"tag":126,"props":5572,"children":5573},{"style":139},[5574],{"type":49,"value":647},{"type":26,"tag":126,"props":5576,"children":5577},{"style":375},[5578],{"type":49,"value":378},{"type":26,"tag":126,"props":5580,"children":5581},{"style":139},[5582],{"type":49,"value":656},{"type":26,"tag":126,"props":5584,"children":5585},{"style":210},[5586],{"type":49,"value":661},{"type":26,"tag":126,"props":5588,"children":5589},{"style":375},[5590],{"type":49,"value":666},{"type":26,"tag":126,"props":5592,"children":5593},{"style":210},[5594],{"type":49,"value":671},{"type":26,"tag":126,"props":5596,"children":5597},{"style":139},[5598],{"type":49,"value":403},{"type":26,"tag":126,"props":5600,"children":5601},{"class":128,"line":179},[5602,5606,5610,5614],{"type":26,"tag":126,"props":5603,"children":5604},{"style":139},[5605],{"type":49,"value":683},{"type":26,"tag":126,"props":5607,"children":5608},{"style":375},[5609],{"type":49,"value":378},{"type":26,"tag":126,"props":5611,"children":5612},{"style":139},[5613],{"type":49,"value":692},{"type":26,"tag":126,"props":5615,"children":5616},{"style":210},[5617],{"type":49,"value":697},{"type":26,"tag":126,"props":5619,"children":5620},{"class":128,"line":188},[5621,5625,5629],{"type":26,"tag":126,"props":5622,"children":5623},{"style":139},[5624],{"type":49,"value":630},{"type":26,"tag":126,"props":5626,"children":5627},{"style":375},[5628],{"type":49,"value":378},{"type":26,"tag":126,"props":5630,"children":5631},{"style":139},[5632],{"type":49,"value":721},{"type":26,"tag":126,"props":5634,"children":5635},{"class":128,"line":201},[5636,5640,5644],{"type":26,"tag":126,"props":5637,"children":5638},{"style":139},[5639],{"type":49,"value":513},{"type":26,"tag":126,"props":5641,"children":5642},{"style":210},[5643],{"type":49,"value":518},{"type":26,"tag":126,"props":5645,"children":5646},{"style":139},[5647],{"type":49,"value":523},{"type":26,"tag":126,"props":5649,"children":5650},{"class":128,"line":220},[5651,5655,5659],{"type":26,"tag":126,"props":5652,"children":5653},{"style":139},[5654],{"type":49,"value":888},{"type":26,"tag":126,"props":5656,"children":5657},{"style":375},[5658],{"type":49,"value":378},{"type":26,"tag":126,"props":5660,"children":5661},{"style":139},[5662],{"type":49,"value":897},{"type":26,"tag":126,"props":5664,"children":5665},{"class":128,"line":238},[5666,5670],{"type":26,"tag":126,"props":5667,"children":5668},{"style":159},[5669],{"type":49,"value":906},{"type":26,"tag":126,"props":5671,"children":5672},{"style":139},[5673],{"type":49,"value":911},{"type":26,"tag":126,"props":5675,"children":5676},{"class":128,"line":256},[5677,5681],{"type":26,"tag":126,"props":5678,"children":5679},{"style":159},[5680],{"type":49,"value":976},{"type":26,"tag":126,"props":5682,"children":5683},{"style":139},[5684],{"type":49,"value":5685},":form,\n",{"type":26,"tag":126,"props":5687,"children":5688},{"class":128,"line":265},[5689,5694,5698],{"type":26,"tag":126,"props":5690,"children":5691},{"style":139},[5692],{"type":49,"value":5693},"        [",{"type":26,"tag":126,"props":5695,"children":5696},{"style":210},[5697],{"type":49,"value":518},{"type":26,"tag":126,"props":5699,"children":5700},{"style":139},[5701],{"type":49,"value":5702},"],}\n",{"type":26,"tag":126,"props":5704,"children":5705},{"class":128,"line":731},[5706,5710,5714,5718],{"type":26,"tag":126,"props":5707,"children":5708},{"style":375},[5709],{"type":49,"value":990},{"type":26,"tag":126,"props":5711,"children":5712},{"style":139},[5713],{"type":49,"value":995},{"type":26,"tag":126,"props":5715,"children":5716},{"style":159},[5717],{"type":49,"value":1000},{"type":26,"tag":126,"props":5719,"children":5720},{"style":139},[5721],{"type":49,"value":1005},{"type":26,"tag":293,"props":5723,"children":5725},{"id":5724},"exporting-data-as-csv-or-xls",[5726],{"type":49,"value":5727},"Exporting data as CSV or XLS",{"type":26,"tag":27,"props":5729,"children":5730},{},[5731],{"type":49,"value":5732},"One other requirement I gave myself for this project was giving users the option to export data in CSV or XLS file formats.",{"type":26,"tag":27,"props":5734,"children":5735},{},[5736,5738,5745,5747,5753,5755,5762],{"type":49,"value":5737},"With the filter data function, I was able to keep things DRY (Don't Repeart Yourself). This task taught me about a few aspects of HTML5 and forms that I wasn't aware of. First, let's take a look at the CSV export function that I learned about throught ",{"type":26,"tag":42,"props":5739,"children":5742},{"href":5740,"rel":5741},"https://simpleisbetterthancomplex.com/tutorial/2016/07/29/how-to-export-to-excel.html",[46],[5743],{"type":49,"value":5744},"this blog post",{"type":49,"value":5746},", from a great Django blog called ",{"type":26,"tag":42,"props":5748,"children":5750},{"href":5740,"rel":5749},[46],[5751],{"type":49,"value":5752},"Simple is Better than Complex",{"type":49,"value":5754}," by ",{"type":26,"tag":42,"props":5756,"children":5759},{"href":5757,"rel":5758},"https://github.com/vitorfs",[46],[5760],{"type":49,"value":5761},"Vitor Freitas",{"type":49,"value":64},{"type":26,"tag":116,"props":5764,"children":5766},{"code":5765,"language":319,"meta":8,"className":320,"style":8},"def export_filtered_books_csv(request):\n    response = HttpResponse(content_type='text/csv')\n    response['Content-Disposition'] = 'attachment; filename=\"books.csv\"'\n\n    writer = csv.writer(response)\n    writer.writerow(['Title', 'Synopsis', 'Pages'])\n    books = Book.objects.all()\n    paramDict = request.GET\n    books = filter_books(books, paramDict)\n    books = books.values_list(\n        'title',\n        'synopsis',\n        'pages')\n\n    for book in books:\n        writer.writerow(book)\n\n    return response\n",[5767],{"type":26,"tag":102,"props":5768,"children":5769},{"__ignoreMap":8},[5770,5794,5829,5855,5862,5879,5915,5930,5949,5964,5980,5992,6004,6016,6023,6043,6051,6058],{"type":26,"tag":126,"props":5771,"children":5772},{"class":128,"line":129},[5773,5777,5782,5786,5790],{"type":26,"tag":126,"props":5774,"children":5775},{"style":330},[5776],{"type":49,"value":580},{"type":26,"tag":126,"props":5778,"children":5779},{"style":144},[5780],{"type":49,"value":5781}," export_filtered_books_csv",{"type":26,"tag":126,"props":5783,"children":5784},{"style":139},[5785],{"type":49,"value":344},{"type":26,"tag":126,"props":5787,"children":5788},{"style":592},[5789],{"type":49,"value":595},{"type":26,"tag":126,"props":5791,"children":5792},{"style":139},[5793],{"type":49,"value":364},{"type":26,"tag":126,"props":5795,"children":5796},{"class":128,"line":155},[5797,5802,5806,5811,5816,5820,5825],{"type":26,"tag":126,"props":5798,"children":5799},{"style":139},[5800],{"type":49,"value":5801},"    response ",{"type":26,"tag":126,"props":5803,"children":5804},{"style":375},[5805],{"type":49,"value":378},{"type":26,"tag":126,"props":5807,"children":5808},{"style":139},[5809],{"type":49,"value":5810}," HttpResponse(",{"type":26,"tag":126,"props":5812,"children":5813},{"style":386},[5814],{"type":49,"value":5815},"content_type",{"type":26,"tag":126,"props":5817,"children":5818},{"style":375},[5819],{"type":49,"value":378},{"type":26,"tag":126,"props":5821,"children":5822},{"style":159},[5823],{"type":49,"value":5824},"'text/csv'",{"type":26,"tag":126,"props":5826,"children":5827},{"style":139},[5828],{"type":49,"value":403},{"type":26,"tag":126,"props":5830,"children":5831},{"class":128,"line":170},[5832,5837,5842,5846,5850],{"type":26,"tag":126,"props":5833,"children":5834},{"style":139},[5835],{"type":49,"value":5836},"    response[",{"type":26,"tag":126,"props":5838,"children":5839},{"style":159},[5840],{"type":49,"value":5841},"'Content-Disposition'",{"type":26,"tag":126,"props":5843,"children":5844},{"style":139},[5845],{"type":49,"value":4955},{"type":26,"tag":126,"props":5847,"children":5848},{"style":375},[5849],{"type":49,"value":378},{"type":26,"tag":126,"props":5851,"children":5852},{"style":159},[5853],{"type":49,"value":5854}," 'attachment; filename=\"books.csv\"'\n",{"type":26,"tag":126,"props":5856,"children":5857},{"class":128,"line":179},[5858],{"type":26,"tag":126,"props":5859,"children":5860},{"emptyLinePlaceholder":12},[5861],{"type":49,"value":705},{"type":26,"tag":126,"props":5863,"children":5864},{"class":128,"line":188},[5865,5870,5874],{"type":26,"tag":126,"props":5866,"children":5867},{"style":139},[5868],{"type":49,"value":5869},"    writer ",{"type":26,"tag":126,"props":5871,"children":5872},{"style":375},[5873],{"type":49,"value":378},{"type":26,"tag":126,"props":5875,"children":5876},{"style":139},[5877],{"type":49,"value":5878}," csv.writer(response)\n",{"type":26,"tag":126,"props":5880,"children":5881},{"class":128,"line":201},[5882,5887,5892,5896,5901,5905,5910],{"type":26,"tag":126,"props":5883,"children":5884},{"style":139},[5885],{"type":49,"value":5886},"    writer.writerow([",{"type":26,"tag":126,"props":5888,"children":5889},{"style":159},[5890],{"type":49,"value":5891},"'Title'",{"type":26,"tag":126,"props":5893,"children":5894},{"style":139},[5895],{"type":49,"value":439},{"type":26,"tag":126,"props":5897,"children":5898},{"style":159},[5899],{"type":49,"value":5900},"'Synopsis'",{"type":26,"tag":126,"props":5902,"children":5903},{"style":139},[5904],{"type":49,"value":439},{"type":26,"tag":126,"props":5906,"children":5907},{"style":159},[5908],{"type":49,"value":5909},"'Pages'",{"type":26,"tag":126,"props":5911,"children":5912},{"style":139},[5913],{"type":49,"value":5914},"])\n",{"type":26,"tag":126,"props":5916,"children":5917},{"class":128,"line":220},[5918,5922,5926],{"type":26,"tag":126,"props":5919,"children":5920},{"style":139},[5921],{"type":49,"value":630},{"type":26,"tag":126,"props":5923,"children":5924},{"style":375},[5925],{"type":49,"value":378},{"type":26,"tag":126,"props":5927,"children":5928},{"style":139},[5929],{"type":49,"value":639},{"type":26,"tag":126,"props":5931,"children":5932},{"class":128,"line":238},[5933,5937,5941,5945],{"type":26,"tag":126,"props":5934,"children":5935},{"style":139},[5936],{"type":49,"value":683},{"type":26,"tag":126,"props":5938,"children":5939},{"style":375},[5940],{"type":49,"value":378},{"type":26,"tag":126,"props":5942,"children":5943},{"style":139},[5944],{"type":49,"value":692},{"type":26,"tag":126,"props":5946,"children":5947},{"style":210},[5948],{"type":49,"value":697},{"type":26,"tag":126,"props":5950,"children":5951},{"class":128,"line":256},[5952,5956,5960],{"type":26,"tag":126,"props":5953,"children":5954},{"style":139},[5955],{"type":49,"value":630},{"type":26,"tag":126,"props":5957,"children":5958},{"style":375},[5959],{"type":49,"value":378},{"type":26,"tag":126,"props":5961,"children":5962},{"style":139},[5963],{"type":49,"value":721},{"type":26,"tag":126,"props":5965,"children":5966},{"class":128,"line":265},[5967,5971,5975],{"type":26,"tag":126,"props":5968,"children":5969},{"style":139},[5970],{"type":49,"value":630},{"type":26,"tag":126,"props":5972,"children":5973},{"style":375},[5974],{"type":49,"value":378},{"type":26,"tag":126,"props":5976,"children":5977},{"style":139},[5978],{"type":49,"value":5979}," books.values_list(\n",{"type":26,"tag":126,"props":5981,"children":5982},{"class":128,"line":731},[5983,5988],{"type":26,"tag":126,"props":5984,"children":5985},{"style":159},[5986],{"type":49,"value":5987},"        'title'",{"type":26,"tag":126,"props":5989,"children":5990},{"style":139},[5991],{"type":49,"value":167},{"type":26,"tag":126,"props":5993,"children":5994},{"class":128,"line":759},[5995,6000],{"type":26,"tag":126,"props":5996,"children":5997},{"style":159},[5998],{"type":49,"value":5999},"        'synopsis'",{"type":26,"tag":126,"props":6001,"children":6002},{"style":139},[6003],{"type":49,"value":167},{"type":26,"tag":126,"props":6005,"children":6006},{"class":128,"line":767},[6007,6012],{"type":26,"tag":126,"props":6008,"children":6009},{"style":159},[6010],{"type":49,"value":6011},"        'pages'",{"type":26,"tag":126,"props":6013,"children":6014},{"style":139},[6015],{"type":49,"value":403},{"type":26,"tag":126,"props":6017,"children":6018},{"class":128,"line":777},[6019],{"type":26,"tag":126,"props":6020,"children":6021},{"emptyLinePlaceholder":12},[6022],{"type":49,"value":705},{"type":26,"tag":126,"props":6024,"children":6025},{"class":128,"line":786},[6026,6030,6034,6038],{"type":26,"tag":126,"props":6027,"children":6028},{"style":375},[6029],{"type":49,"value":2080},{"type":26,"tag":126,"props":6031,"children":6032},{"style":139},[6033],{"type":49,"value":869},{"type":26,"tag":126,"props":6035,"children":6036},{"style":375},[6037],{"type":49,"value":874},{"type":26,"tag":126,"props":6039,"children":6040},{"style":139},[6041],{"type":49,"value":6042}," books:\n",{"type":26,"tag":126,"props":6044,"children":6045},{"class":128,"line":834},[6046],{"type":26,"tag":126,"props":6047,"children":6048},{"style":139},[6049],{"type":49,"value":6050},"        writer.writerow(book)\n",{"type":26,"tag":126,"props":6052,"children":6053},{"class":128,"line":848},[6054],{"type":26,"tag":126,"props":6055,"children":6056},{"emptyLinePlaceholder":12},[6057],{"type":49,"value":705},{"type":26,"tag":126,"props":6059,"children":6060},{"class":128,"line":882},[6061,6065],{"type":26,"tag":126,"props":6062,"children":6063},{"style":375},[6064],{"type":49,"value":990},{"type":26,"tag":126,"props":6066,"children":6067},{"style":139},[6068],{"type":49,"value":6069}," response\n",{"type":26,"tag":27,"props":6071,"children":6072},{},[6073,6075,6080],{"type":49,"value":6074},"I wanted to put this button in the filter form on the main ",{"type":26,"tag":102,"props":6076,"children":6078},{"className":6077},[],[6079],{"type":49,"value":558},{"type":49,"value":6081}," page, but I need to place the button outside of the form tag. To get around this, here is the HTML I used:",{"type":26,"tag":27,"props":6083,"children":6084},{},[6085],{"type":49,"value":114},{"type":26,"tag":116,"props":6087,"children":6089},{"code":6088,"language":1380,"meta":8,"className":1381,"style":8},"\u003Cform action=\"{% url 'books:csv' %}\">\n  \u003Ca\n    class=\"btn btn-primary\"\n    data-toggle=\"collapse\"\n    href=\"#collapseExample\"\n    aria-expanded=\"false\"\n    aria-controls=\"collapseExample\"\n  >\n    Filter Books\n  \u003C/a>\n  \u003Cinput\n    type=\"submit\"\n    class=\"btn btn-info\"\n    form=\"id_query_form\"\n    formaction=\"{% url 'books:csv' %}\"\n    value=\"Export CSV\"\n  />\n  \u003Cinput\n    type=\"submit\"\n    class=\"btn btn-default\"\n    form=\"id_query_form\"\n    formaction=\"{% url 'books:xls' %}\"\n    value=\"Export XLS\"\n  />\n\u003C/form>\n\n\u003Cform method=\"get\" action=\".\" id=\"id_query_form\">\n  \u003Cp>{{ form.keywords }}\u003C/p>\n  \u003Cdiv class=\"row\">\n    \u003Cdiv class=\"col-md-6\">{{ form.publish_date_before }}\u003C/div>\n    \u003Cdiv class=\"col-md-6\">{{ form.publish_date_after }}\u003C/div>\n  \u003C/div>\n\n  \u003Cp>\u003C/p>\n  \u003Cp>\n    \u003Cinput class=\"btn btn-success\" type=\"submit\" />\n    \u003Cbutton type=\"reset\" class=\"btn btn-info\" value=\"Reset filters\">\n      Reset filters\n    \u003C/button>\n    \u003Cbutton\n      type=\"reset\"\n      class=\"btn btn-warning\"\n      id=\"id_clear_filters\"\n      onclick=\"return resetForm(this.form);\"\n    >\n      Clear Filters\n    \u003C/button>\n  \u003C/p>\n\u003C/form>\n",[6090],{"type":26,"tag":102,"props":6091,"children":6092},{"__ignoreMap":8},[6093,6121,6132,6149,6166,6183,6200,6217,6224,6232,6247,6259,6276,6292,6309,6326,6343,6351,6362,6377,6393,6408,6424,6440,6447,6462,6469,6523,6547,6575,6612,6648,6663,6670,6694,6709,6749,6804,6812,6828,6840,6857,6874,6891,6941,6949,6957,6972,6987],{"type":26,"tag":126,"props":6094,"children":6095},{"class":128,"line":129},[6096,6100,6104,6108,6112,6117],{"type":26,"tag":126,"props":6097,"children":6098},{"style":139},[6099],{"type":49,"value":1393},{"type":26,"tag":126,"props":6101,"children":6102},{"style":1396},[6103],{"type":49,"value":2979},{"type":26,"tag":126,"props":6105,"children":6106},{"style":144},[6107],{"type":49,"value":2998},{"type":26,"tag":126,"props":6109,"children":6110},{"style":139},[6111],{"type":49,"value":378},{"type":26,"tag":126,"props":6113,"children":6114},{"style":159},[6115],{"type":49,"value":6116},"\"{% url 'books:csv' %}\"",{"type":26,"tag":126,"props":6118,"children":6119},{"style":139},[6120],{"type":49,"value":1404},{"type":26,"tag":126,"props":6122,"children":6123},{"class":128,"line":155},[6124,6128],{"type":26,"tag":126,"props":6125,"children":6126},{"style":139},[6127],{"type":49,"value":3027},{"type":26,"tag":126,"props":6129,"children":6130},{"style":1396},[6131],{"type":49,"value":4049},{"type":26,"tag":126,"props":6133,"children":6134},{"class":128,"line":170},[6135,6140,6144],{"type":26,"tag":126,"props":6136,"children":6137},{"style":144},[6138],{"type":49,"value":6139},"    class",{"type":26,"tag":126,"props":6141,"children":6142},{"style":139},[6143],{"type":49,"value":378},{"type":26,"tag":126,"props":6145,"children":6146},{"style":159},[6147],{"type":49,"value":6148},"\"btn btn-primary\"\n",{"type":26,"tag":126,"props":6150,"children":6151},{"class":128,"line":179},[6152,6157,6161],{"type":26,"tag":126,"props":6153,"children":6154},{"style":144},[6155],{"type":49,"value":6156},"    data-toggle",{"type":26,"tag":126,"props":6158,"children":6159},{"style":139},[6160],{"type":49,"value":378},{"type":26,"tag":126,"props":6162,"children":6163},{"style":159},[6164],{"type":49,"value":6165},"\"collapse\"\n",{"type":26,"tag":126,"props":6167,"children":6168},{"class":128,"line":188},[6169,6174,6178],{"type":26,"tag":126,"props":6170,"children":6171},{"style":144},[6172],{"type":49,"value":6173},"    href",{"type":26,"tag":126,"props":6175,"children":6176},{"style":139},[6177],{"type":49,"value":378},{"type":26,"tag":126,"props":6179,"children":6180},{"style":159},[6181],{"type":49,"value":6182},"\"#collapseExample\"\n",{"type":26,"tag":126,"props":6184,"children":6185},{"class":128,"line":201},[6186,6191,6195],{"type":26,"tag":126,"props":6187,"children":6188},{"style":144},[6189],{"type":49,"value":6190},"    aria-expanded",{"type":26,"tag":126,"props":6192,"children":6193},{"style":139},[6194],{"type":49,"value":378},{"type":26,"tag":126,"props":6196,"children":6197},{"style":159},[6198],{"type":49,"value":6199},"\"false\"\n",{"type":26,"tag":126,"props":6201,"children":6202},{"class":128,"line":220},[6203,6208,6212],{"type":26,"tag":126,"props":6204,"children":6205},{"style":144},[6206],{"type":49,"value":6207},"    aria-controls",{"type":26,"tag":126,"props":6209,"children":6210},{"style":139},[6211],{"type":49,"value":378},{"type":26,"tag":126,"props":6213,"children":6214},{"style":159},[6215],{"type":49,"value":6216},"\"collapseExample\"\n",{"type":26,"tag":126,"props":6218,"children":6219},{"class":128,"line":238},[6220],{"type":26,"tag":126,"props":6221,"children":6222},{"style":139},[6223],{"type":49,"value":4057},{"type":26,"tag":126,"props":6225,"children":6226},{"class":128,"line":256},[6227],{"type":26,"tag":126,"props":6228,"children":6229},{"style":139},[6230],{"type":49,"value":6231},"    Filter Books\n",{"type":26,"tag":126,"props":6233,"children":6234},{"class":128,"line":265},[6235,6239,6243],{"type":26,"tag":126,"props":6236,"children":6237},{"style":139},[6238],{"type":49,"value":3172},{"type":26,"tag":126,"props":6240,"children":6241},{"style":1396},[6242],{"type":49,"value":42},{"type":26,"tag":126,"props":6244,"children":6245},{"style":139},[6246],{"type":49,"value":1404},{"type":26,"tag":126,"props":6248,"children":6249},{"class":128,"line":731},[6250,6254],{"type":26,"tag":126,"props":6251,"children":6252},{"style":139},[6253],{"type":49,"value":3027},{"type":26,"tag":126,"props":6255,"children":6256},{"style":1396},[6257],{"type":49,"value":6258},"input\n",{"type":26,"tag":126,"props":6260,"children":6261},{"class":128,"line":759},[6262,6267,6271],{"type":26,"tag":126,"props":6263,"children":6264},{"style":144},[6265],{"type":49,"value":6266},"    type",{"type":26,"tag":126,"props":6268,"children":6269},{"style":139},[6270],{"type":49,"value":378},{"type":26,"tag":126,"props":6272,"children":6273},{"style":159},[6274],{"type":49,"value":6275},"\"submit\"\n",{"type":26,"tag":126,"props":6277,"children":6278},{"class":128,"line":767},[6279,6283,6287],{"type":26,"tag":126,"props":6280,"children":6281},{"style":144},[6282],{"type":49,"value":6139},{"type":26,"tag":126,"props":6284,"children":6285},{"style":139},[6286],{"type":49,"value":378},{"type":26,"tag":126,"props":6288,"children":6289},{"style":159},[6290],{"type":49,"value":6291},"\"btn btn-info\"\n",{"type":26,"tag":126,"props":6293,"children":6294},{"class":128,"line":777},[6295,6300,6304],{"type":26,"tag":126,"props":6296,"children":6297},{"style":144},[6298],{"type":49,"value":6299},"    form",{"type":26,"tag":126,"props":6301,"children":6302},{"style":139},[6303],{"type":49,"value":378},{"type":26,"tag":126,"props":6305,"children":6306},{"style":159},[6307],{"type":49,"value":6308},"\"id_query_form\"\n",{"type":26,"tag":126,"props":6310,"children":6311},{"class":128,"line":786},[6312,6317,6321],{"type":26,"tag":126,"props":6313,"children":6314},{"style":144},[6315],{"type":49,"value":6316},"    formaction",{"type":26,"tag":126,"props":6318,"children":6319},{"style":139},[6320],{"type":49,"value":378},{"type":26,"tag":126,"props":6322,"children":6323},{"style":159},[6324],{"type":49,"value":6325},"\"{% url 'books:csv' %}\"\n",{"type":26,"tag":126,"props":6327,"children":6328},{"class":128,"line":834},[6329,6334,6338],{"type":26,"tag":126,"props":6330,"children":6331},{"style":144},[6332],{"type":49,"value":6333},"    value",{"type":26,"tag":126,"props":6335,"children":6336},{"style":139},[6337],{"type":49,"value":378},{"type":26,"tag":126,"props":6339,"children":6340},{"style":159},[6341],{"type":49,"value":6342},"\"Export CSV\"\n",{"type":26,"tag":126,"props":6344,"children":6345},{"class":128,"line":848},[6346],{"type":26,"tag":126,"props":6347,"children":6348},{"style":139},[6349],{"type":49,"value":6350},"  />\n",{"type":26,"tag":126,"props":6352,"children":6353},{"class":128,"line":882},[6354,6358],{"type":26,"tag":126,"props":6355,"children":6356},{"style":139},[6357],{"type":49,"value":3027},{"type":26,"tag":126,"props":6359,"children":6360},{"style":1396},[6361],{"type":49,"value":6258},{"type":26,"tag":126,"props":6363,"children":6364},{"class":128,"line":900},[6365,6369,6373],{"type":26,"tag":126,"props":6366,"children":6367},{"style":144},[6368],{"type":49,"value":6266},{"type":26,"tag":126,"props":6370,"children":6371},{"style":139},[6372],{"type":49,"value":378},{"type":26,"tag":126,"props":6374,"children":6375},{"style":159},[6376],{"type":49,"value":6275},{"type":26,"tag":126,"props":6378,"children":6379},{"class":128,"line":914},[6380,6384,6388],{"type":26,"tag":126,"props":6381,"children":6382},{"style":144},[6383],{"type":49,"value":6139},{"type":26,"tag":126,"props":6385,"children":6386},{"style":139},[6387],{"type":49,"value":378},{"type":26,"tag":126,"props":6389,"children":6390},{"style":159},[6391],{"type":49,"value":6392},"\"btn btn-default\"\n",{"type":26,"tag":126,"props":6394,"children":6395},{"class":128,"line":923},[6396,6400,6404],{"type":26,"tag":126,"props":6397,"children":6398},{"style":144},[6399],{"type":49,"value":6299},{"type":26,"tag":126,"props":6401,"children":6402},{"style":139},[6403],{"type":49,"value":378},{"type":26,"tag":126,"props":6405,"children":6406},{"style":159},[6407],{"type":49,"value":6308},{"type":26,"tag":126,"props":6409,"children":6410},{"class":128,"line":932},[6411,6415,6419],{"type":26,"tag":126,"props":6412,"children":6413},{"style":144},[6414],{"type":49,"value":6316},{"type":26,"tag":126,"props":6416,"children":6417},{"style":139},[6418],{"type":49,"value":378},{"type":26,"tag":126,"props":6420,"children":6421},{"style":159},[6422],{"type":49,"value":6423},"\"{% url 'books:xls' %}\"\n",{"type":26,"tag":126,"props":6425,"children":6426},{"class":128,"line":946},[6427,6431,6435],{"type":26,"tag":126,"props":6428,"children":6429},{"style":144},[6430],{"type":49,"value":6333},{"type":26,"tag":126,"props":6432,"children":6433},{"style":139},[6434],{"type":49,"value":378},{"type":26,"tag":126,"props":6436,"children":6437},{"style":159},[6438],{"type":49,"value":6439},"\"Export XLS\"\n",{"type":26,"tag":126,"props":6441,"children":6442},{"class":128,"line":970},[6443],{"type":26,"tag":126,"props":6444,"children":6445},{"style":139},[6446],{"type":49,"value":6350},{"type":26,"tag":126,"props":6448,"children":6449},{"class":128,"line":984},[6450,6454,6458],{"type":26,"tag":126,"props":6451,"children":6452},{"style":139},[6453],{"type":49,"value":2529},{"type":26,"tag":126,"props":6455,"children":6456},{"style":1396},[6457],{"type":49,"value":2979},{"type":26,"tag":126,"props":6459,"children":6460},{"style":139},[6461],{"type":49,"value":1404},{"type":26,"tag":126,"props":6463,"children":6464},{"class":128,"line":1880},[6465],{"type":26,"tag":126,"props":6466,"children":6467},{"emptyLinePlaceholder":12},[6468],{"type":49,"value":705},{"type":26,"tag":126,"props":6470,"children":6471},{"class":128,"line":1888},[6472,6476,6480,6484,6488,6493,6497,6501,6505,6510,6514,6519],{"type":26,"tag":126,"props":6473,"children":6474},{"style":139},[6475],{"type":49,"value":1393},{"type":26,"tag":126,"props":6477,"children":6478},{"style":1396},[6479],{"type":49,"value":2979},{"type":26,"tag":126,"props":6481,"children":6482},{"style":144},[6483],{"type":49,"value":2984},{"type":26,"tag":126,"props":6485,"children":6486},{"style":139},[6487],{"type":49,"value":378},{"type":26,"tag":126,"props":6489,"children":6490},{"style":159},[6491],{"type":49,"value":6492},"\"get\"",{"type":26,"tag":126,"props":6494,"children":6495},{"style":144},[6496],{"type":49,"value":2998},{"type":26,"tag":126,"props":6498,"children":6499},{"style":139},[6500],{"type":49,"value":378},{"type":26,"tag":126,"props":6502,"children":6503},{"style":159},[6504],{"type":49,"value":3007},{"type":26,"tag":126,"props":6506,"children":6507},{"style":144},[6508],{"type":49,"value":6509}," id",{"type":26,"tag":126,"props":6511,"children":6512},{"style":139},[6513],{"type":49,"value":378},{"type":26,"tag":126,"props":6515,"children":6516},{"style":159},[6517],{"type":49,"value":6518},"\"id_query_form\"",{"type":26,"tag":126,"props":6520,"children":6521},{"style":139},[6522],{"type":49,"value":1404},{"type":26,"tag":126,"props":6524,"children":6525},{"class":128,"line":1927},[6526,6530,6534,6539,6543],{"type":26,"tag":126,"props":6527,"children":6528},{"style":139},[6529],{"type":49,"value":3027},{"type":26,"tag":126,"props":6531,"children":6532},{"style":1396},[6533],{"type":49,"value":27},{"type":26,"tag":126,"props":6535,"children":6536},{"style":139},[6537],{"type":49,"value":6538},">{{ form.keywords }}\u003C/",{"type":26,"tag":126,"props":6540,"children":6541},{"style":1396},[6542],{"type":49,"value":27},{"type":26,"tag":126,"props":6544,"children":6545},{"style":139},[6546],{"type":49,"value":1404},{"type":26,"tag":126,"props":6548,"children":6549},{"class":128,"line":1945},[6550,6554,6558,6562,6566,6571],{"type":26,"tag":126,"props":6551,"children":6552},{"style":139},[6553],{"type":49,"value":3027},{"type":26,"tag":126,"props":6555,"children":6556},{"style":1396},[6557],{"type":49,"value":3091},{"type":26,"tag":126,"props":6559,"children":6560},{"style":144},[6561],{"type":49,"value":3096},{"type":26,"tag":126,"props":6563,"children":6564},{"style":139},[6565],{"type":49,"value":378},{"type":26,"tag":126,"props":6567,"children":6568},{"style":159},[6569],{"type":49,"value":6570},"\"row\"",{"type":26,"tag":126,"props":6572,"children":6573},{"style":139},[6574],{"type":49,"value":1404},{"type":26,"tag":126,"props":6576,"children":6577},{"class":128,"line":1954},[6578,6582,6586,6590,6594,6599,6604,6608],{"type":26,"tag":126,"props":6579,"children":6580},{"style":139},[6581],{"type":49,"value":3117},{"type":26,"tag":126,"props":6583,"children":6584},{"style":1396},[6585],{"type":49,"value":3091},{"type":26,"tag":126,"props":6587,"children":6588},{"style":144},[6589],{"type":49,"value":3096},{"type":26,"tag":126,"props":6591,"children":6592},{"style":139},[6593],{"type":49,"value":378},{"type":26,"tag":126,"props":6595,"children":6596},{"style":159},[6597],{"type":49,"value":6598},"\"col-md-6\"",{"type":26,"tag":126,"props":6600,"children":6601},{"style":139},[6602],{"type":49,"value":6603},">{{ form.publish_date_before }}\u003C/",{"type":26,"tag":126,"props":6605,"children":6606},{"style":1396},[6607],{"type":49,"value":3091},{"type":26,"tag":126,"props":6609,"children":6610},{"style":139},[6611],{"type":49,"value":1404},{"type":26,"tag":126,"props":6613,"children":6614},{"class":128,"line":1972},[6615,6619,6623,6627,6631,6635,6640,6644],{"type":26,"tag":126,"props":6616,"children":6617},{"style":139},[6618],{"type":49,"value":3117},{"type":26,"tag":126,"props":6620,"children":6621},{"style":1396},[6622],{"type":49,"value":3091},{"type":26,"tag":126,"props":6624,"children":6625},{"style":144},[6626],{"type":49,"value":3096},{"type":26,"tag":126,"props":6628,"children":6629},{"style":139},[6630],{"type":49,"value":378},{"type":26,"tag":126,"props":6632,"children":6633},{"style":159},[6634],{"type":49,"value":6598},{"type":26,"tag":126,"props":6636,"children":6637},{"style":139},[6638],{"type":49,"value":6639},">{{ form.publish_date_after }}\u003C/",{"type":26,"tag":126,"props":6641,"children":6642},{"style":1396},[6643],{"type":49,"value":3091},{"type":26,"tag":126,"props":6645,"children":6646},{"style":139},[6647],{"type":49,"value":1404},{"type":26,"tag":126,"props":6649,"children":6650},{"class":128,"line":1990},[6651,6655,6659],{"type":26,"tag":126,"props":6652,"children":6653},{"style":139},[6654],{"type":49,"value":3172},{"type":26,"tag":126,"props":6656,"children":6657},{"style":1396},[6658],{"type":49,"value":3091},{"type":26,"tag":126,"props":6660,"children":6661},{"style":139},[6662],{"type":49,"value":1404},{"type":26,"tag":126,"props":6664,"children":6665},{"class":128,"line":2007},[6666],{"type":26,"tag":126,"props":6667,"children":6668},{"emptyLinePlaceholder":12},[6669],{"type":49,"value":705},{"type":26,"tag":126,"props":6671,"children":6672},{"class":128,"line":2015},[6673,6677,6681,6686,6690],{"type":26,"tag":126,"props":6674,"children":6675},{"style":139},[6676],{"type":49,"value":3027},{"type":26,"tag":126,"props":6678,"children":6679},{"style":1396},[6680],{"type":49,"value":27},{"type":26,"tag":126,"props":6682,"children":6683},{"style":139},[6684],{"type":49,"value":6685},">\u003C/",{"type":26,"tag":126,"props":6687,"children":6688},{"style":1396},[6689],{"type":49,"value":27},{"type":26,"tag":126,"props":6691,"children":6692},{"style":139},[6693],{"type":49,"value":1404},{"type":26,"tag":126,"props":6695,"children":6696},{"class":128,"line":2023},[6697,6701,6705],{"type":26,"tag":126,"props":6698,"children":6699},{"style":139},[6700],{"type":49,"value":3027},{"type":26,"tag":126,"props":6702,"children":6703},{"style":1396},[6704],{"type":49,"value":27},{"type":26,"tag":126,"props":6706,"children":6707},{"style":139},[6708],{"type":49,"value":1404},{"type":26,"tag":126,"props":6710,"children":6711},{"class":128,"line":2041},[6712,6716,6720,6724,6728,6733,6737,6741,6745],{"type":26,"tag":126,"props":6713,"children":6714},{"style":139},[6715],{"type":49,"value":3117},{"type":26,"tag":126,"props":6717,"children":6718},{"style":1396},[6719],{"type":49,"value":3032},{"type":26,"tag":126,"props":6721,"children":6722},{"style":144},[6723],{"type":49,"value":3096},{"type":26,"tag":126,"props":6725,"children":6726},{"style":139},[6727],{"type":49,"value":378},{"type":26,"tag":126,"props":6729,"children":6730},{"style":159},[6731],{"type":49,"value":6732},"\"btn btn-success\"",{"type":26,"tag":126,"props":6734,"children":6735},{"style":144},[6736],{"type":49,"value":3037},{"type":26,"tag":126,"props":6738,"children":6739},{"style":139},[6740],{"type":49,"value":378},{"type":26,"tag":126,"props":6742,"children":6743},{"style":159},[6744],{"type":49,"value":3147},{"type":26,"tag":126,"props":6746,"children":6747},{"style":139},[6748],{"type":49,"value":3079},{"type":26,"tag":126,"props":6750,"children":6751},{"class":128,"line":2049},[6752,6756,6761,6765,6769,6774,6778,6782,6787,6791,6795,6800],{"type":26,"tag":126,"props":6753,"children":6754},{"style":139},[6755],{"type":49,"value":3117},{"type":26,"tag":126,"props":6757,"children":6758},{"style":1396},[6759],{"type":49,"value":6760},"button",{"type":26,"tag":126,"props":6762,"children":6763},{"style":144},[6764],{"type":49,"value":3037},{"type":26,"tag":126,"props":6766,"children":6767},{"style":139},[6768],{"type":49,"value":378},{"type":26,"tag":126,"props":6770,"children":6771},{"style":159},[6772],{"type":49,"value":6773},"\"reset\"",{"type":26,"tag":126,"props":6775,"children":6776},{"style":144},[6777],{"type":49,"value":3096},{"type":26,"tag":126,"props":6779,"children":6780},{"style":139},[6781],{"type":49,"value":378},{"type":26,"tag":126,"props":6783,"children":6784},{"style":159},[6785],{"type":49,"value":6786},"\"btn btn-info\"",{"type":26,"tag":126,"props":6788,"children":6789},{"style":144},[6790],{"type":49,"value":3051},{"type":26,"tag":126,"props":6792,"children":6793},{"style":139},[6794],{"type":49,"value":378},{"type":26,"tag":126,"props":6796,"children":6797},{"style":159},[6798],{"type":49,"value":6799},"\"Reset filters\"",{"type":26,"tag":126,"props":6801,"children":6802},{"style":139},[6803],{"type":49,"value":1404},{"type":26,"tag":126,"props":6805,"children":6806},{"class":128,"line":2074},[6807],{"type":26,"tag":126,"props":6808,"children":6809},{"style":139},[6810],{"type":49,"value":6811},"      Reset filters\n",{"type":26,"tag":126,"props":6813,"children":6814},{"class":128,"line":2095},[6815,6820,6824],{"type":26,"tag":126,"props":6816,"children":6817},{"style":139},[6818],{"type":49,"value":6819},"    \u003C/",{"type":26,"tag":126,"props":6821,"children":6822},{"style":1396},[6823],{"type":49,"value":6760},{"type":26,"tag":126,"props":6825,"children":6826},{"style":139},[6827],{"type":49,"value":1404},{"type":26,"tag":126,"props":6829,"children":6830},{"class":128,"line":2120},[6831,6835],{"type":26,"tag":126,"props":6832,"children":6833},{"style":139},[6834],{"type":49,"value":3117},{"type":26,"tag":126,"props":6836,"children":6837},{"style":1396},[6838],{"type":49,"value":6839},"button\n",{"type":26,"tag":126,"props":6841,"children":6842},{"class":128,"line":2141},[6843,6848,6852],{"type":26,"tag":126,"props":6844,"children":6845},{"style":144},[6846],{"type":49,"value":6847},"      type",{"type":26,"tag":126,"props":6849,"children":6850},{"style":139},[6851],{"type":49,"value":378},{"type":26,"tag":126,"props":6853,"children":6854},{"style":159},[6855],{"type":49,"value":6856},"\"reset\"\n",{"type":26,"tag":126,"props":6858,"children":6859},{"class":128,"line":2158},[6860,6865,6869],{"type":26,"tag":126,"props":6861,"children":6862},{"style":144},[6863],{"type":49,"value":6864},"      class",{"type":26,"tag":126,"props":6866,"children":6867},{"style":139},[6868],{"type":49,"value":378},{"type":26,"tag":126,"props":6870,"children":6871},{"style":159},[6872],{"type":49,"value":6873},"\"btn btn-warning\"\n",{"type":26,"tag":126,"props":6875,"children":6876},{"class":128,"line":2212},[6877,6882,6886],{"type":26,"tag":126,"props":6878,"children":6879},{"style":144},[6880],{"type":49,"value":6881},"      id",{"type":26,"tag":126,"props":6883,"children":6884},{"style":139},[6885],{"type":49,"value":378},{"type":26,"tag":126,"props":6887,"children":6888},{"style":159},[6889],{"type":49,"value":6890},"\"id_clear_filters\"\n",{"type":26,"tag":126,"props":6892,"children":6893},{"class":128,"line":2221},[6894,6899,6903,6908,6913,6918,6922,6928,6932,6936],{"type":26,"tag":126,"props":6895,"children":6896},{"style":144},[6897],{"type":49,"value":6898},"      onclick",{"type":26,"tag":126,"props":6900,"children":6901},{"style":139},[6902],{"type":49,"value":378},{"type":26,"tag":126,"props":6904,"children":6905},{"style":159},[6906],{"type":49,"value":6907},"\"",{"type":26,"tag":126,"props":6909,"children":6910},{"style":375},[6911],{"type":49,"value":6912},"return",{"type":26,"tag":126,"props":6914,"children":6915},{"style":144},[6916],{"type":49,"value":6917}," resetForm",{"type":26,"tag":126,"props":6919,"children":6920},{"style":159},[6921],{"type":49,"value":344},{"type":26,"tag":126,"props":6923,"children":6925},{"style":6924},"--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F",[6926],{"type":49,"value":6927},"this",{"type":26,"tag":126,"props":6929,"children":6930},{"style":159},[6931],{"type":49,"value":86},{"type":26,"tag":126,"props":6933,"children":6934},{"style":139},[6935],{"type":49,"value":2979},{"type":26,"tag":126,"props":6937,"children":6938},{"style":159},[6939],{"type":49,"value":6940},");\"\n",{"type":26,"tag":126,"props":6942,"children":6943},{"class":128,"line":2230},[6944],{"type":26,"tag":126,"props":6945,"children":6946},{"style":139},[6947],{"type":49,"value":6948},"    >\n",{"type":26,"tag":126,"props":6950,"children":6951},{"class":128,"line":2243},[6952],{"type":26,"tag":126,"props":6953,"children":6954},{"style":139},[6955],{"type":49,"value":6956},"      Clear Filters\n",{"type":26,"tag":126,"props":6958,"children":6959},{"class":128,"line":2300},[6960,6964,6968],{"type":26,"tag":126,"props":6961,"children":6962},{"style":139},[6963],{"type":49,"value":6819},{"type":26,"tag":126,"props":6965,"children":6966},{"style":1396},[6967],{"type":49,"value":6760},{"type":26,"tag":126,"props":6969,"children":6970},{"style":139},[6971],{"type":49,"value":1404},{"type":26,"tag":126,"props":6973,"children":6974},{"class":128,"line":2317},[6975,6979,6983],{"type":26,"tag":126,"props":6976,"children":6977},{"style":139},[6978],{"type":49,"value":3172},{"type":26,"tag":126,"props":6980,"children":6981},{"style":1396},[6982],{"type":49,"value":27},{"type":26,"tag":126,"props":6984,"children":6985},{"style":139},[6986],{"type":49,"value":1404},{"type":26,"tag":126,"props":6988,"children":6989},{"class":128,"line":2325},[6990,6994,6998],{"type":26,"tag":126,"props":6991,"children":6992},{"style":139},[6993],{"type":49,"value":2529},{"type":26,"tag":126,"props":6995,"children":6996},{"style":1396},[6997],{"type":49,"value":2979},{"type":26,"tag":126,"props":6999,"children":7000},{"style":139},[7001],{"type":49,"value":1404},{"type":26,"tag":27,"props":7003,"children":7004},{},[7005],{"type":49,"value":286},{"type":26,"tag":27,"props":7007,"children":7008},{},[7009,7011,7016,7018,7024,7026,7032,7034,7040],{"type":49,"value":7010},"There are two forms here, but the first form has an ",{"type":26,"tag":102,"props":7012,"children":7014},{"className":7013},[],[7015],{"type":49,"value":3032},{"type":49,"value":7017}," of ",{"type":26,"tag":102,"props":7019,"children":7021},{"className":7020},[],[7022],{"type":49,"value":7023},"type=submit",{"type":49,"value":7025}," that references another form with ",{"type":26,"tag":102,"props":7027,"children":7029},{"className":7028},[],[7030],{"type":49,"value":7031},"form=\"id_query_form\"",{"type":49,"value":7033},", and this button's action is the url for the ",{"type":26,"tag":102,"props":7035,"children":7037},{"className":7036},[],[7038],{"type":49,"value":7039},"export_filtered_books_csv",{"type":49,"value":7041}," function shown above.",{"type":26,"tag":27,"props":7043,"children":7044},{},[7045,7047,7053,7055,7060],{"type":49,"value":7046},"For the filter function, I make a ",{"type":26,"tag":102,"props":7048,"children":7050},{"className":7049},[],[7051],{"type":49,"value":7052},"utils",{"type":49,"value":7054}," folder in the app I am working with, so the directory structure looks like this (for the ",{"type":26,"tag":102,"props":7056,"children":7058},{"className":7057},[],[7059],{"type":49,"value":558},{"type":49,"value":7061}," app):",{"type":26,"tag":116,"props":7063,"children":7065},{"code":7064},".\n├── admin.py\n├── apps.py\n├── forms.py\n├── __init__.py\n├── migrations\n│   ├── 0001_initial.py\n│   ├── 0002_book_authors.py\n│   └── __init__.py\n├── models.py\n├── templates\n│   └── books\n├── tests.py\n├── urls.py\n├── utils\n│   ├── filter.py\n│   ├── __init__.py\n│   └── nearby.py\n└── views.py\n",[7066],{"type":26,"tag":102,"props":7067,"children":7068},{"__ignoreMap":8},[7069],{"type":49,"value":7064},{"type":26,"tag":27,"props":7071,"children":7072},{},[7073,7075,7081,7082,7088,7089,7095],{"type":49,"value":7074},"I initially had a litte bit of confusion on how to write a simple search query. I wanted a user to be able to enter terms that would return a query set where the items in the query set contained at least on of the terms in at least on of a few different fields (",{"type":26,"tag":102,"props":7076,"children":7078},{"className":7077},[],[7079],{"type":49,"value":7080},"title",{"type":49,"value":439},{"type":26,"tag":102,"props":7083,"children":7085},{"className":7084},[],[7086],{"type":49,"value":7087},"synopsis",{"type":49,"value":439},{"type":26,"tag":102,"props":7090,"children":7092},{"className":7091},[],[7093],{"type":49,"value":7094},"website",{"type":49,"value":271},{"type":26,"tag":27,"props":7097,"children":7098},{},[7099],{"type":49,"value":7100},"To make this filter, I found a nice idiomatic pattern:",{"type":26,"tag":116,"props":7102,"children":7104},{"code":7103,"language":319,"meta":8,"className":320,"style":8},"if paramDict['keywords'] != '':\n    kws = paramDict['keywords'].split()\n    q_lookups = [Q(title__icontains=kw) for kw in kws] + \\\n                [Q(synopsis__icontains=kw) for kw in kws] + \\\n                [Q(website__icontains=kw) for kw in kws]\n    filters = Q()\n    filters |= reduce(lambda x, y: x | y, q_lookups)\n    books = books.filter(filters)\n",[7105],{"type":26,"tag":102,"props":7106,"children":7107},{"__ignoreMap":8},[7108,7140,7164,7216,7260,7295,7311,7358],{"type":26,"tag":126,"props":7109,"children":7110},{"class":128,"line":129},[7111,7116,7120,7124,7128,7132,7136],{"type":26,"tag":126,"props":7112,"children":7113},{"style":375},[7114],{"type":49,"value":7115},"if",{"type":26,"tag":126,"props":7117,"children":7118},{"style":139},[7119],{"type":49,"value":4945},{"type":26,"tag":126,"props":7121,"children":7122},{"style":159},[7123],{"type":49,"value":5222},{"type":26,"tag":126,"props":7125,"children":7126},{"style":139},[7127],{"type":49,"value":4955},{"type":26,"tag":126,"props":7129,"children":7130},{"style":375},[7131],{"type":49,"value":2844},{"type":26,"tag":126,"props":7133,"children":7134},{"style":159},[7135],{"type":49,"value":4964},{"type":26,"tag":126,"props":7137,"children":7138},{"style":139},[7139],{"type":49,"value":2854},{"type":26,"tag":126,"props":7141,"children":7142},{"class":128,"line":155},[7143,7148,7152,7156,7160],{"type":26,"tag":126,"props":7144,"children":7145},{"style":139},[7146],{"type":49,"value":7147},"    kws ",{"type":26,"tag":126,"props":7149,"children":7150},{"style":375},[7151],{"type":49,"value":378},{"type":26,"tag":126,"props":7153,"children":7154},{"style":139},[7155],{"type":49,"value":4945},{"type":26,"tag":126,"props":7157,"children":7158},{"style":159},[7159],{"type":49,"value":5222},{"type":26,"tag":126,"props":7161,"children":7162},{"style":139},[7163],{"type":49,"value":5263},{"type":26,"tag":126,"props":7165,"children":7166},{"class":128,"line":170},[7167,7172,7176,7180,7184,7188,7192,7196,7200,7204,7208,7212],{"type":26,"tag":126,"props":7168,"children":7169},{"style":139},[7170],{"type":49,"value":7171},"    q_lookups ",{"type":26,"tag":126,"props":7173,"children":7174},{"style":375},[7175],{"type":49,"value":378},{"type":26,"tag":126,"props":7177,"children":7178},{"style":139},[7179],{"type":49,"value":5280},{"type":26,"tag":126,"props":7181,"children":7182},{"style":386},[7183],{"type":49,"value":5285},{"type":26,"tag":126,"props":7185,"children":7186},{"style":375},[7187],{"type":49,"value":378},{"type":26,"tag":126,"props":7189,"children":7190},{"style":139},[7191],{"type":49,"value":5294},{"type":26,"tag":126,"props":7193,"children":7194},{"style":375},[7195],{"type":49,"value":864},{"type":26,"tag":126,"props":7197,"children":7198},{"style":139},[7199],{"type":49,"value":5303},{"type":26,"tag":126,"props":7201,"children":7202},{"style":375},[7203],{"type":49,"value":874},{"type":26,"tag":126,"props":7205,"children":7206},{"style":139},[7207],{"type":49,"value":5312},{"type":26,"tag":126,"props":7209,"children":7210},{"style":375},[7211],{"type":49,"value":1303},{"type":26,"tag":126,"props":7213,"children":7214},{"style":139},[7215],{"type":49,"value":5321},{"type":26,"tag":126,"props":7217,"children":7218},{"class":128,"line":179},[7219,7224,7228,7232,7236,7240,7244,7248,7252,7256],{"type":26,"tag":126,"props":7220,"children":7221},{"style":139},[7222],{"type":49,"value":7223},"                [Q(",{"type":26,"tag":126,"props":7225,"children":7226},{"style":386},[7227],{"type":49,"value":5334},{"type":26,"tag":126,"props":7229,"children":7230},{"style":375},[7231],{"type":49,"value":378},{"type":26,"tag":126,"props":7233,"children":7234},{"style":139},[7235],{"type":49,"value":5294},{"type":26,"tag":126,"props":7237,"children":7238},{"style":375},[7239],{"type":49,"value":864},{"type":26,"tag":126,"props":7241,"children":7242},{"style":139},[7243],{"type":49,"value":5303},{"type":26,"tag":126,"props":7245,"children":7246},{"style":375},[7247],{"type":49,"value":874},{"type":26,"tag":126,"props":7249,"children":7250},{"style":139},[7251],{"type":49,"value":5312},{"type":26,"tag":126,"props":7253,"children":7254},{"style":375},[7255],{"type":49,"value":1303},{"type":26,"tag":126,"props":7257,"children":7258},{"style":139},[7259],{"type":49,"value":5321},{"type":26,"tag":126,"props":7261,"children":7262},{"class":128,"line":188},[7263,7267,7271,7275,7279,7283,7287,7291],{"type":26,"tag":126,"props":7264,"children":7265},{"style":139},[7266],{"type":49,"value":7223},{"type":26,"tag":126,"props":7268,"children":7269},{"style":386},[7270],{"type":49,"value":5378},{"type":26,"tag":126,"props":7272,"children":7273},{"style":375},[7274],{"type":49,"value":378},{"type":26,"tag":126,"props":7276,"children":7277},{"style":139},[7278],{"type":49,"value":5294},{"type":26,"tag":126,"props":7280,"children":7281},{"style":375},[7282],{"type":49,"value":864},{"type":26,"tag":126,"props":7284,"children":7285},{"style":139},[7286],{"type":49,"value":5303},{"type":26,"tag":126,"props":7288,"children":7289},{"style":375},[7290],{"type":49,"value":874},{"type":26,"tag":126,"props":7292,"children":7293},{"style":139},[7294],{"type":49,"value":5403},{"type":26,"tag":126,"props":7296,"children":7297},{"class":128,"line":201},[7298,7303,7307],{"type":26,"tag":126,"props":7299,"children":7300},{"style":139},[7301],{"type":49,"value":7302},"    filters ",{"type":26,"tag":126,"props":7304,"children":7305},{"style":375},[7306],{"type":49,"value":378},{"type":26,"tag":126,"props":7308,"children":7309},{"style":139},[7310],{"type":49,"value":5420},{"type":26,"tag":126,"props":7312,"children":7313},{"class":128,"line":220},[7314,7318,7322,7326,7330,7334,7338,7342,7346,7350,7354],{"type":26,"tag":126,"props":7315,"children":7316},{"style":139},[7317],{"type":49,"value":7302},{"type":26,"tag":126,"props":7319,"children":7320},{"style":375},[7321],{"type":49,"value":5432},{"type":26,"tag":126,"props":7323,"children":7324},{"style":4774},[7325],{"type":49,"value":5437},{"type":26,"tag":126,"props":7327,"children":7328},{"style":139},[7329],{"type":49,"value":344},{"type":26,"tag":126,"props":7331,"children":7332},{"style":330},[7333],{"type":49,"value":5446},{"type":26,"tag":126,"props":7335,"children":7336},{"style":592},[7337],{"type":49,"value":5451},{"type":26,"tag":126,"props":7339,"children":7340},{"style":139},[7341],{"type":49,"value":439},{"type":26,"tag":126,"props":7343,"children":7344},{"style":592},[7345],{"type":49,"value":5460},{"type":26,"tag":126,"props":7347,"children":7348},{"style":139},[7349],{"type":49,"value":5465},{"type":26,"tag":126,"props":7351,"children":7352},{"style":375},[7353],{"type":49,"value":5470},{"type":26,"tag":126,"props":7355,"children":7356},{"style":139},[7357],{"type":49,"value":5475},{"type":26,"tag":126,"props":7359,"children":7360},{"class":128,"line":238},[7361,7365,7369],{"type":26,"tag":126,"props":7362,"children":7363},{"style":139},[7364],{"type":49,"value":630},{"type":26,"tag":126,"props":7366,"children":7367},{"style":375},[7368],{"type":49,"value":378},{"type":26,"tag":126,"props":7370,"children":7371},{"style":139},[7372],{"type":49,"value":5491},{"type":26,"tag":27,"props":7374,"children":7375},{},[7376],{"type":49,"value":7377},"This is good for a small database, but could end up having to do lots of operations, especially if I decided that I want to add more fields to be searched, such as category or tags.",{"type":26,"tag":27,"props":7379,"children":7380},{},[7381,7383,7389,7391,7397,7399,7404],{"type":49,"value":7382},"One option that I have considered to simplify the search query is to make one field called something like ",{"type":26,"tag":102,"props":7384,"children":7386},{"className":7385},[],[7387],{"type":49,"value":7388},"search_string",{"type":49,"value":7390},". This field would be modified on ",{"type":26,"tag":102,"props":7392,"children":7394},{"className":7393},[],[7395],{"type":49,"value":7396},"save",{"type":49,"value":7398},", and it would simply appends the text from all of the fields I'm interested in searching. Then, instead of doing Q lookups for each word over many different fields, I could search each word in ",{"type":26,"tag":102,"props":7400,"children":7402},{"className":7401},[],[7403],{"type":49,"value":4689},{"type":49,"value":7405}," over one field. I haven't implemented this here, but I would like to test this in the future.",{"type":26,"tag":293,"props":7407,"children":7409},{"id":7408},"finding-books-nearby",[7410],{"type":49,"value":7411},"Finding \"Books Nearby\"",{"type":26,"tag":27,"props":7413,"children":7414},{},[7415],{"type":49,"value":7416},"On the pages that show details for each book I wanted to add additional information. I thought it would be interesting to show the 5 books closest to the book we are currently showing. Since we are dealing with coordinate points on a globe, the best way to calculate distance between two points is to use the Halversine formula:",{"type":26,"tag":66,"props":7418,"children":7419},{},[7420],{"type":26,"tag":27,"props":7421,"children":7422},{},[7423],{"type":49,"value":7424},"The haversine formula determines the great-circle distance between two points on a sphere given their longitudes and latitudes. Important in navigation, it is a special case of a more general formula in spherical trigonometry, the law of haversines, that relates the sides and angles of spherical triangles.",{"type":26,"tag":27,"props":7426,"children":7427},{},[7428],{"type":26,"tag":31,"props":7429,"children":7431},{"alt":33,"src":7430},"/static/great_circle.png",[],{"type":26,"tag":27,"props":7433,"children":7434},{},[7435],{"type":49,"value":7436},"Here's the code I used for calculating distance (using the Halversine formula):",{"type":26,"tag":116,"props":7438,"children":7440},{"code":7439,"language":319,"meta":8,"className":320,"style":8},"from math import radians, cos, sin, asin, sqrt\n\ndef distance(origin, destination):\n    \"\"\"\n    Calculate the great circle distance between two points\n    on the earth (specified in decimal degrees)\n    \"\"\"\n\n    lon1, lat1 = origin\n    lon2, lat2 = destination\n    # convert decimal degrees to radians\n    lon1, lat1, lon2, lat2 = map(radians, [lon1, lat1, lon2, lat2])\n    # haversine formula\n    dlon = lon2 - lon1\n    dlat = lat2 - lat1\n    a = sin(dlat/2)**2 + cos(lat1) * cos(lat2) * sin(dlon/2)**2\n    c = 2 * asin(sqrt(a))\n    r = 3956 # miles\n    return c * r\n",[7441],{"type":26,"tag":102,"props":7442,"children":7443},{"__ignoreMap":8},[7444,7465,7472,7506,7513,7521,7529,7536,7543,7560,7577,7585,7607,7615,7641,7667,7756,7783,7805],{"type":26,"tag":126,"props":7445,"children":7446},{"class":128,"line":129},[7447,7451,7456,7460],{"type":26,"tag":126,"props":7448,"children":7449},{"style":375},[7450],{"type":49,"value":3496},{"type":26,"tag":126,"props":7452,"children":7453},{"style":139},[7454],{"type":49,"value":7455}," math ",{"type":26,"tag":126,"props":7457,"children":7458},{"style":375},[7459],{"type":49,"value":3506},{"type":26,"tag":126,"props":7461,"children":7462},{"style":139},[7463],{"type":49,"value":7464}," radians, cos, sin, asin, sqrt\n",{"type":26,"tag":126,"props":7466,"children":7467},{"class":128,"line":155},[7468],{"type":26,"tag":126,"props":7469,"children":7470},{"emptyLinePlaceholder":12},[7471],{"type":49,"value":705},{"type":26,"tag":126,"props":7473,"children":7474},{"class":128,"line":170},[7475,7479,7484,7488,7493,7497,7502],{"type":26,"tag":126,"props":7476,"children":7477},{"style":330},[7478],{"type":49,"value":580},{"type":26,"tag":126,"props":7480,"children":7481},{"style":144},[7482],{"type":49,"value":7483}," distance",{"type":26,"tag":126,"props":7485,"children":7486},{"style":139},[7487],{"type":49,"value":344},{"type":26,"tag":126,"props":7489,"children":7490},{"style":592},[7491],{"type":49,"value":7492},"origin",{"type":26,"tag":126,"props":7494,"children":7495},{"style":139},[7496],{"type":49,"value":439},{"type":26,"tag":126,"props":7498,"children":7499},{"style":592},[7500],{"type":49,"value":7501},"destination",{"type":26,"tag":126,"props":7503,"children":7504},{"style":139},[7505],{"type":49,"value":364},{"type":26,"tag":126,"props":7507,"children":7508},{"class":128,"line":179},[7509],{"type":26,"tag":126,"props":7510,"children":7511},{"style":159},[7512],{"type":49,"value":607},{"type":26,"tag":126,"props":7514,"children":7515},{"class":128,"line":188},[7516],{"type":26,"tag":126,"props":7517,"children":7518},{"style":159},[7519],{"type":49,"value":7520},"    Calculate the great circle distance between two points\n",{"type":26,"tag":126,"props":7522,"children":7523},{"class":128,"line":201},[7524],{"type":26,"tag":126,"props":7525,"children":7526},{"style":159},[7527],{"type":49,"value":7528},"    on the earth (specified in decimal degrees)\n",{"type":26,"tag":126,"props":7530,"children":7531},{"class":128,"line":220},[7532],{"type":26,"tag":126,"props":7533,"children":7534},{"style":159},[7535],{"type":49,"value":607},{"type":26,"tag":126,"props":7537,"children":7538},{"class":128,"line":238},[7539],{"type":26,"tag":126,"props":7540,"children":7541},{"emptyLinePlaceholder":12},[7542],{"type":49,"value":705},{"type":26,"tag":126,"props":7544,"children":7545},{"class":128,"line":256},[7546,7551,7555],{"type":26,"tag":126,"props":7547,"children":7548},{"style":139},[7549],{"type":49,"value":7550},"    lon1, lat1 ",{"type":26,"tag":126,"props":7552,"children":7553},{"style":375},[7554],{"type":49,"value":378},{"type":26,"tag":126,"props":7556,"children":7557},{"style":139},[7558],{"type":49,"value":7559}," origin\n",{"type":26,"tag":126,"props":7561,"children":7562},{"class":128,"line":265},[7563,7568,7572],{"type":26,"tag":126,"props":7564,"children":7565},{"style":139},[7566],{"type":49,"value":7567},"    lon2, lat2 ",{"type":26,"tag":126,"props":7569,"children":7570},{"style":375},[7571],{"type":49,"value":378},{"type":26,"tag":126,"props":7573,"children":7574},{"style":139},[7575],{"type":49,"value":7576}," destination\n",{"type":26,"tag":126,"props":7578,"children":7579},{"class":128,"line":731},[7580],{"type":26,"tag":126,"props":7581,"children":7582},{"style":771},[7583],{"type":49,"value":7584},"    # convert decimal degrees to radians\n",{"type":26,"tag":126,"props":7586,"children":7587},{"class":128,"line":759},[7588,7593,7597,7602],{"type":26,"tag":126,"props":7589,"children":7590},{"style":139},[7591],{"type":49,"value":7592},"    lon1, lat1, lon2, lat2 ",{"type":26,"tag":126,"props":7594,"children":7595},{"style":375},[7596],{"type":49,"value":378},{"type":26,"tag":126,"props":7598,"children":7599},{"style":2818},[7600],{"type":49,"value":7601}," map",{"type":26,"tag":126,"props":7603,"children":7604},{"style":139},[7605],{"type":49,"value":7606},"(radians, [lon1, lat1, lon2, lat2])\n",{"type":26,"tag":126,"props":7608,"children":7609},{"class":128,"line":767},[7610],{"type":26,"tag":126,"props":7611,"children":7612},{"style":771},[7613],{"type":49,"value":7614},"    # haversine formula\n",{"type":26,"tag":126,"props":7616,"children":7617},{"class":128,"line":777},[7618,7623,7627,7632,7636],{"type":26,"tag":126,"props":7619,"children":7620},{"style":139},[7621],{"type":49,"value":7622},"    dlon ",{"type":26,"tag":126,"props":7624,"children":7625},{"style":375},[7626],{"type":49,"value":378},{"type":26,"tag":126,"props":7628,"children":7629},{"style":139},[7630],{"type":49,"value":7631}," lon2 ",{"type":26,"tag":126,"props":7633,"children":7634},{"style":375},[7635],{"type":49,"value":1790},{"type":26,"tag":126,"props":7637,"children":7638},{"style":139},[7639],{"type":49,"value":7640}," lon1\n",{"type":26,"tag":126,"props":7642,"children":7643},{"class":128,"line":786},[7644,7649,7653,7658,7662],{"type":26,"tag":126,"props":7645,"children":7646},{"style":139},[7647],{"type":49,"value":7648},"    dlat ",{"type":26,"tag":126,"props":7650,"children":7651},{"style":375},[7652],{"type":49,"value":378},{"type":26,"tag":126,"props":7654,"children":7655},{"style":139},[7656],{"type":49,"value":7657}," lat2 ",{"type":26,"tag":126,"props":7659,"children":7660},{"style":375},[7661],{"type":49,"value":1790},{"type":26,"tag":126,"props":7663,"children":7664},{"style":139},[7665],{"type":49,"value":7666}," lat1\n",{"type":26,"tag":126,"props":7668,"children":7669},{"class":128,"line":834},[7670,7675,7679,7684,7689,7693,7698,7703,7707,7711,7716,7721,7726,7730,7735,7739,7743,7747,7751],{"type":26,"tag":126,"props":7671,"children":7672},{"style":139},[7673],{"type":49,"value":7674},"    a ",{"type":26,"tag":126,"props":7676,"children":7677},{"style":375},[7678],{"type":49,"value":378},{"type":26,"tag":126,"props":7680,"children":7681},{"style":139},[7682],{"type":49,"value":7683}," sin(dlat",{"type":26,"tag":126,"props":7685,"children":7686},{"style":375},[7687],{"type":49,"value":7688},"/",{"type":26,"tag":126,"props":7690,"children":7691},{"style":210},[7692],{"type":49,"value":2502},{"type":26,"tag":126,"props":7694,"children":7695},{"style":139},[7696],{"type":49,"value":7697},")",{"type":26,"tag":126,"props":7699,"children":7700},{"style":375},[7701],{"type":49,"value":7702},"**",{"type":26,"tag":126,"props":7704,"children":7705},{"style":210},[7706],{"type":49,"value":2502},{"type":26,"tag":126,"props":7708,"children":7709},{"style":375},[7710],{"type":49,"value":1293},{"type":26,"tag":126,"props":7712,"children":7713},{"style":139},[7714],{"type":49,"value":7715}," cos(lat1) ",{"type":26,"tag":126,"props":7717,"children":7718},{"style":375},[7719],{"type":49,"value":7720},"*",{"type":26,"tag":126,"props":7722,"children":7723},{"style":139},[7724],{"type":49,"value":7725}," cos(lat2) ",{"type":26,"tag":126,"props":7727,"children":7728},{"style":375},[7729],{"type":49,"value":7720},{"type":26,"tag":126,"props":7731,"children":7732},{"style":139},[7733],{"type":49,"value":7734}," sin(dlon",{"type":26,"tag":126,"props":7736,"children":7737},{"style":375},[7738],{"type":49,"value":7688},{"type":26,"tag":126,"props":7740,"children":7741},{"style":210},[7742],{"type":49,"value":2502},{"type":26,"tag":126,"props":7744,"children":7745},{"style":139},[7746],{"type":49,"value":7697},{"type":26,"tag":126,"props":7748,"children":7749},{"style":375},[7750],{"type":49,"value":7702},{"type":26,"tag":126,"props":7752,"children":7753},{"style":210},[7754],{"type":49,"value":7755},"2\n",{"type":26,"tag":126,"props":7757,"children":7758},{"class":128,"line":848},[7759,7764,7768,7773,7778],{"type":26,"tag":126,"props":7760,"children":7761},{"style":139},[7762],{"type":49,"value":7763},"    c ",{"type":26,"tag":126,"props":7765,"children":7766},{"style":375},[7767],{"type":49,"value":378},{"type":26,"tag":126,"props":7769,"children":7770},{"style":210},[7771],{"type":49,"value":7772}," 2",{"type":26,"tag":126,"props":7774,"children":7775},{"style":375},[7776],{"type":49,"value":7777}," *",{"type":26,"tag":126,"props":7779,"children":7780},{"style":139},[7781],{"type":49,"value":7782}," asin(sqrt(a))\n",{"type":26,"tag":126,"props":7784,"children":7785},{"class":128,"line":882},[7786,7791,7795,7800],{"type":26,"tag":126,"props":7787,"children":7788},{"style":139},[7789],{"type":49,"value":7790},"    r ",{"type":26,"tag":126,"props":7792,"children":7793},{"style":375},[7794],{"type":49,"value":378},{"type":26,"tag":126,"props":7796,"children":7797},{"style":210},[7798],{"type":49,"value":7799}," 3956",{"type":26,"tag":126,"props":7801,"children":7802},{"style":771},[7803],{"type":49,"value":7804}," # miles\n",{"type":26,"tag":126,"props":7806,"children":7807},{"class":128,"line":900},[7808,7812,7817,7821],{"type":26,"tag":126,"props":7809,"children":7810},{"style":375},[7811],{"type":49,"value":990},{"type":26,"tag":126,"props":7813,"children":7814},{"style":139},[7815],{"type":49,"value":7816}," c ",{"type":26,"tag":126,"props":7818,"children":7819},{"style":375},[7820],{"type":49,"value":7720},{"type":26,"tag":126,"props":7822,"children":7823},{"style":139},[7824],{"type":49,"value":7825}," r\n",{"type":26,"tag":27,"props":7827,"children":7828},{},[7829],{"type":49,"value":7830},"This formula assumes that the earth is a perfect sphere. Another approach would be to use the the Vincety Formula:",{"type":26,"tag":66,"props":7832,"children":7833},{},[7834],{"type":26,"tag":27,"props":7835,"children":7836},{},[7837],{"type":49,"value":7838},"Vincenty's formulae are two related iterative methods used in geodesy to calculate the distance between two points on the surface of a spheroid, developed by Thaddeus Vincenty (1975a). They are based on the assumption that the figure of the Earth is an oblate spheroid, and hence are more accurate than methods that assume a spherical Earth, such as great-circle distance.",{"type":26,"tag":27,"props":7840,"children":7841},{},[7842,7844,7850],{"type":49,"value":7843},"This distance is packaged in ",{"type":26,"tag":102,"props":7845,"children":7847},{"className":7846},[],[7848],{"type":49,"value":7849},"geopy",{"type":49,"value":7851}," and can be calculated easily:",{"type":26,"tag":116,"props":7853,"children":7855},{"code":7854,"language":319,"meta":8,"className":320,"style":8},"import geopy.distance\n\ncoords_1 = (52.2296756, 21.0122287)\ncoords_2 = (52.406374, 16.9251681)\n\nprint geopy.distance.vincenty(coords_1, coords_2).km\n",[7856],{"type":26,"tag":102,"props":7857,"children":7858},{"__ignoreMap":8},[7859,7871,7878,7913,7947,7954],{"type":26,"tag":126,"props":7860,"children":7861},{"class":128,"line":129},[7862,7866],{"type":26,"tag":126,"props":7863,"children":7864},{"style":375},[7865],{"type":49,"value":3506},{"type":26,"tag":126,"props":7867,"children":7868},{"style":139},[7869],{"type":49,"value":7870}," geopy.distance\n",{"type":26,"tag":126,"props":7872,"children":7873},{"class":128,"line":155},[7874],{"type":26,"tag":126,"props":7875,"children":7876},{"emptyLinePlaceholder":12},[7877],{"type":49,"value":705},{"type":26,"tag":126,"props":7879,"children":7880},{"class":128,"line":170},[7881,7886,7890,7895,7900,7904,7909],{"type":26,"tag":126,"props":7882,"children":7883},{"style":139},[7884],{"type":49,"value":7885},"coords_1 ",{"type":26,"tag":126,"props":7887,"children":7888},{"style":375},[7889],{"type":49,"value":378},{"type":26,"tag":126,"props":7891,"children":7892},{"style":139},[7893],{"type":49,"value":7894}," (",{"type":26,"tag":126,"props":7896,"children":7897},{"style":210},[7898],{"type":49,"value":7899},"52.2296756",{"type":26,"tag":126,"props":7901,"children":7902},{"style":139},[7903],{"type":49,"value":439},{"type":26,"tag":126,"props":7905,"children":7906},{"style":210},[7907],{"type":49,"value":7908},"21.0122287",{"type":26,"tag":126,"props":7910,"children":7911},{"style":139},[7912],{"type":49,"value":403},{"type":26,"tag":126,"props":7914,"children":7915},{"class":128,"line":179},[7916,7921,7925,7929,7934,7938,7943],{"type":26,"tag":126,"props":7917,"children":7918},{"style":139},[7919],{"type":49,"value":7920},"coords_2 ",{"type":26,"tag":126,"props":7922,"children":7923},{"style":375},[7924],{"type":49,"value":378},{"type":26,"tag":126,"props":7926,"children":7927},{"style":139},[7928],{"type":49,"value":7894},{"type":26,"tag":126,"props":7930,"children":7931},{"style":210},[7932],{"type":49,"value":7933},"52.406374",{"type":26,"tag":126,"props":7935,"children":7936},{"style":139},[7937],{"type":49,"value":439},{"type":26,"tag":126,"props":7939,"children":7940},{"style":210},[7941],{"type":49,"value":7942},"16.9251681",{"type":26,"tag":126,"props":7944,"children":7945},{"style":139},[7946],{"type":49,"value":403},{"type":26,"tag":126,"props":7948,"children":7949},{"class":128,"line":188},[7950],{"type":26,"tag":126,"props":7951,"children":7952},{"emptyLinePlaceholder":12},[7953],{"type":49,"value":705},{"type":26,"tag":126,"props":7955,"children":7956},{"class":128,"line":201},[7957,7962],{"type":26,"tag":126,"props":7958,"children":7959},{"style":2818},[7960],{"type":49,"value":7961},"print",{"type":26,"tag":126,"props":7963,"children":7964},{"style":139},[7965],{"type":49,"value":7966}," geopy.distance.vincenty(coords_1, coords_2).km\n",{"type":26,"tag":27,"props":7968,"children":7969},{},[7970,7972,7977],{"type":49,"value":7971},"Here's a look at the function I wrote for the ",{"type":26,"tag":102,"props":7973,"children":7975},{"className":7974},[],[7976],{"type":49,"value":3976},{"type":49,"value":7978}," view. I have commented out parts that aren't related to finding nearby books:",{"type":26,"tag":116,"props":7980,"children":7982},{"code":7981,"language":319,"meta":8,"className":320,"style":8},"def book_detail(request, id, slug):\n\n    book = Book.objects.get(id=id, slug=slug)\n    b_coords = (book.lat, book.lon)\n    all_books = Book.objects.all()\n    coords = [((b.lat, b.lon),b) for b in all_books]\n\n    distance_dict = {}\n    for c in coords:\n        if c[0] != b_coords:\n            distance_dict[c[0]]=(distance(c[0],b_coords),c)\n\n    sorted_nearby = sorted(distance_dict.items(), key=lambda x: x[1][0])[:5]\n\n    # map_book = [{'loc':[float(book.lon), float(book.lat)],\n    #              'title':book.title,\n    #              'url':book.get_absolute_url()}]\n    context = {\n        'book':book,\n        # 'map_book':mark_safe(escapejs(json.dumps(map_book))),\n        'sorted_nearby':sorted_nearby,\n    }\n    return render(request, 'books/book_detail.html', context)\n",[7983],{"type":26,"tag":102,"props":7984,"children":7985},{"__ignoreMap":8},[7986,8028,8035,8081,8098,8114,8149,8156,8173,8193,8222,8257,8264,8335,8342,8350,8358,8366,8381,8394,8402,8415,8422],{"type":26,"tag":126,"props":7987,"children":7988},{"class":128,"line":129},[7989,7993,7998,8002,8006,8010,8015,8019,8024],{"type":26,"tag":126,"props":7990,"children":7991},{"style":330},[7992],{"type":49,"value":580},{"type":26,"tag":126,"props":7994,"children":7995},{"style":144},[7996],{"type":49,"value":7997}," book_detail",{"type":26,"tag":126,"props":7999,"children":8000},{"style":139},[8001],{"type":49,"value":344},{"type":26,"tag":126,"props":8003,"children":8004},{"style":592},[8005],{"type":49,"value":595},{"type":26,"tag":126,"props":8007,"children":8008},{"style":139},[8009],{"type":49,"value":439},{"type":26,"tag":126,"props":8011,"children":8012},{"style":592},[8013],{"type":49,"value":8014},"id",{"type":26,"tag":126,"props":8016,"children":8017},{"style":139},[8018],{"type":49,"value":439},{"type":26,"tag":126,"props":8020,"children":8021},{"style":592},[8022],{"type":49,"value":8023},"slug",{"type":26,"tag":126,"props":8025,"children":8026},{"style":139},[8027],{"type":49,"value":364},{"type":26,"tag":126,"props":8029,"children":8030},{"class":128,"line":155},[8031],{"type":26,"tag":126,"props":8032,"children":8033},{"emptyLinePlaceholder":12},[8034],{"type":49,"value":705},{"type":26,"tag":126,"props":8036,"children":8037},{"class":128,"line":170},[8038,8043,8047,8052,8056,8060,8064,8068,8072,8076],{"type":26,"tag":126,"props":8039,"children":8040},{"style":139},[8041],{"type":49,"value":8042},"    book ",{"type":26,"tag":126,"props":8044,"children":8045},{"style":375},[8046],{"type":49,"value":378},{"type":26,"tag":126,"props":8048,"children":8049},{"style":139},[8050],{"type":49,"value":8051}," Book.objects.get(",{"type":26,"tag":126,"props":8053,"children":8054},{"style":386},[8055],{"type":49,"value":8014},{"type":26,"tag":126,"props":8057,"children":8058},{"style":375},[8059],{"type":49,"value":378},{"type":26,"tag":126,"props":8061,"children":8062},{"style":2818},[8063],{"type":49,"value":8014},{"type":26,"tag":126,"props":8065,"children":8066},{"style":139},[8067],{"type":49,"value":439},{"type":26,"tag":126,"props":8069,"children":8070},{"style":386},[8071],{"type":49,"value":8023},{"type":26,"tag":126,"props":8073,"children":8074},{"style":375},[8075],{"type":49,"value":378},{"type":26,"tag":126,"props":8077,"children":8078},{"style":139},[8079],{"type":49,"value":8080},"slug)\n",{"type":26,"tag":126,"props":8082,"children":8083},{"class":128,"line":179},[8084,8089,8093],{"type":26,"tag":126,"props":8085,"children":8086},{"style":139},[8087],{"type":49,"value":8088},"    b_coords ",{"type":26,"tag":126,"props":8090,"children":8091},{"style":375},[8092],{"type":49,"value":378},{"type":26,"tag":126,"props":8094,"children":8095},{"style":139},[8096],{"type":49,"value":8097}," (book.lat, book.lon)\n",{"type":26,"tag":126,"props":8099,"children":8100},{"class":128,"line":188},[8101,8106,8110],{"type":26,"tag":126,"props":8102,"children":8103},{"style":139},[8104],{"type":49,"value":8105},"    all_books ",{"type":26,"tag":126,"props":8107,"children":8108},{"style":375},[8109],{"type":49,"value":378},{"type":26,"tag":126,"props":8111,"children":8112},{"style":139},[8113],{"type":49,"value":639},{"type":26,"tag":126,"props":8115,"children":8116},{"class":128,"line":201},[8117,8122,8126,8131,8135,8140,8144],{"type":26,"tag":126,"props":8118,"children":8119},{"style":139},[8120],{"type":49,"value":8121},"    coords ",{"type":26,"tag":126,"props":8123,"children":8124},{"style":375},[8125],{"type":49,"value":378},{"type":26,"tag":126,"props":8127,"children":8128},{"style":139},[8129],{"type":49,"value":8130}," [((b.lat, b.lon),b) ",{"type":26,"tag":126,"props":8132,"children":8133},{"style":375},[8134],{"type":49,"value":864},{"type":26,"tag":126,"props":8136,"children":8137},{"style":139},[8138],{"type":49,"value":8139}," b ",{"type":26,"tag":126,"props":8141,"children":8142},{"style":375},[8143],{"type":49,"value":874},{"type":26,"tag":126,"props":8145,"children":8146},{"style":139},[8147],{"type":49,"value":8148}," all_books]\n",{"type":26,"tag":126,"props":8150,"children":8151},{"class":128,"line":220},[8152],{"type":26,"tag":126,"props":8153,"children":8154},{"emptyLinePlaceholder":12},[8155],{"type":49,"value":705},{"type":26,"tag":126,"props":8157,"children":8158},{"class":128,"line":238},[8159,8164,8168],{"type":26,"tag":126,"props":8160,"children":8161},{"style":139},[8162],{"type":49,"value":8163},"    distance_dict ",{"type":26,"tag":126,"props":8165,"children":8166},{"style":375},[8167],{"type":49,"value":378},{"type":26,"tag":126,"props":8169,"children":8170},{"style":139},[8171],{"type":49,"value":8172}," {}\n",{"type":26,"tag":126,"props":8174,"children":8175},{"class":128,"line":256},[8176,8180,8184,8188],{"type":26,"tag":126,"props":8177,"children":8178},{"style":375},[8179],{"type":49,"value":2080},{"type":26,"tag":126,"props":8181,"children":8182},{"style":139},[8183],{"type":49,"value":7816},{"type":26,"tag":126,"props":8185,"children":8186},{"style":375},[8187],{"type":49,"value":874},{"type":26,"tag":126,"props":8189,"children":8190},{"style":139},[8191],{"type":49,"value":8192}," coords:\n",{"type":26,"tag":126,"props":8194,"children":8195},{"class":128,"line":265},[8196,8200,8205,8209,8213,8217],{"type":26,"tag":126,"props":8197,"children":8198},{"style":375},[8199],{"type":49,"value":2834},{"type":26,"tag":126,"props":8201,"children":8202},{"style":139},[8203],{"type":49,"value":8204}," c[",{"type":26,"tag":126,"props":8206,"children":8207},{"style":210},[8208],{"type":49,"value":1781},{"type":26,"tag":126,"props":8210,"children":8211},{"style":139},[8212],{"type":49,"value":4955},{"type":26,"tag":126,"props":8214,"children":8215},{"style":375},[8216],{"type":49,"value":2844},{"type":26,"tag":126,"props":8218,"children":8219},{"style":139},[8220],{"type":49,"value":8221}," b_coords:\n",{"type":26,"tag":126,"props":8223,"children":8224},{"class":128,"line":731},[8225,8230,8234,8239,8243,8248,8252],{"type":26,"tag":126,"props":8226,"children":8227},{"style":139},[8228],{"type":49,"value":8229},"            distance_dict[c[",{"type":26,"tag":126,"props":8231,"children":8232},{"style":210},[8233],{"type":49,"value":1781},{"type":26,"tag":126,"props":8235,"children":8236},{"style":139},[8237],{"type":49,"value":8238},"]]",{"type":26,"tag":126,"props":8240,"children":8241},{"style":375},[8242],{"type":49,"value":378},{"type":26,"tag":126,"props":8244,"children":8245},{"style":139},[8246],{"type":49,"value":8247},"(distance(c[",{"type":26,"tag":126,"props":8249,"children":8250},{"style":210},[8251],{"type":49,"value":1781},{"type":26,"tag":126,"props":8253,"children":8254},{"style":139},[8255],{"type":49,"value":8256},"],b_coords),c)\n",{"type":26,"tag":126,"props":8258,"children":8259},{"class":128,"line":759},[8260],{"type":26,"tag":126,"props":8261,"children":8262},{"emptyLinePlaceholder":12},[8263],{"type":49,"value":705},{"type":26,"tag":126,"props":8265,"children":8266},{"class":128,"line":767},[8267,8272,8276,8281,8286,8291,8295,8299,8303,8308,8312,8317,8321,8326,8331],{"type":26,"tag":126,"props":8268,"children":8269},{"style":139},[8270],{"type":49,"value":8271},"    sorted_nearby ",{"type":26,"tag":126,"props":8273,"children":8274},{"style":375},[8275],{"type":49,"value":378},{"type":26,"tag":126,"props":8277,"children":8278},{"style":2818},[8279],{"type":49,"value":8280}," sorted",{"type":26,"tag":126,"props":8282,"children":8283},{"style":139},[8284],{"type":49,"value":8285},"(distance_dict.items(), ",{"type":26,"tag":126,"props":8287,"children":8288},{"style":386},[8289],{"type":49,"value":8290},"key",{"type":26,"tag":126,"props":8292,"children":8293},{"style":375},[8294],{"type":49,"value":378},{"type":26,"tag":126,"props":8296,"children":8297},{"style":330},[8298],{"type":49,"value":5446},{"type":26,"tag":126,"props":8300,"children":8301},{"style":592},[8302],{"type":49,"value":5451},{"type":26,"tag":126,"props":8304,"children":8305},{"style":139},[8306],{"type":49,"value":8307},": x[",{"type":26,"tag":126,"props":8309,"children":8310},{"style":210},[8311],{"type":49,"value":2460},{"type":26,"tag":126,"props":8313,"children":8314},{"style":139},[8315],{"type":49,"value":8316},"][",{"type":26,"tag":126,"props":8318,"children":8319},{"style":210},[8320],{"type":49,"value":1781},{"type":26,"tag":126,"props":8322,"children":8323},{"style":139},[8324],{"type":49,"value":8325},"])[:",{"type":26,"tag":126,"props":8327,"children":8328},{"style":210},[8329],{"type":49,"value":8330},"5",{"type":26,"tag":126,"props":8332,"children":8333},{"style":139},[8334],{"type":49,"value":523},{"type":26,"tag":126,"props":8336,"children":8337},{"class":128,"line":777},[8338],{"type":26,"tag":126,"props":8339,"children":8340},{"emptyLinePlaceholder":12},[8341],{"type":49,"value":705},{"type":26,"tag":126,"props":8343,"children":8344},{"class":128,"line":786},[8345],{"type":26,"tag":126,"props":8346,"children":8347},{"style":771},[8348],{"type":49,"value":8349},"    # map_book = [{'loc':[float(book.lon), float(book.lat)],\n",{"type":26,"tag":126,"props":8351,"children":8352},{"class":128,"line":834},[8353],{"type":26,"tag":126,"props":8354,"children":8355},{"style":771},[8356],{"type":49,"value":8357},"    #              'title':book.title,\n",{"type":26,"tag":126,"props":8359,"children":8360},{"class":128,"line":848},[8361],{"type":26,"tag":126,"props":8362,"children":8363},{"style":771},[8364],{"type":49,"value":8365},"    #              'url':book.get_absolute_url()}]\n",{"type":26,"tag":126,"props":8367,"children":8368},{"class":128,"line":882},[8369,8373,8377],{"type":26,"tag":126,"props":8370,"children":8371},{"style":139},[8372],{"type":49,"value":888},{"type":26,"tag":126,"props":8374,"children":8375},{"style":375},[8376],{"type":49,"value":378},{"type":26,"tag":126,"props":8378,"children":8379},{"style":139},[8380],{"type":49,"value":897},{"type":26,"tag":126,"props":8382,"children":8383},{"class":128,"line":900},[8384,8389],{"type":26,"tag":126,"props":8385,"children":8386},{"style":159},[8387],{"type":49,"value":8388},"        'book'",{"type":26,"tag":126,"props":8390,"children":8391},{"style":139},[8392],{"type":49,"value":8393},":book,\n",{"type":26,"tag":126,"props":8395,"children":8396},{"class":128,"line":914},[8397],{"type":26,"tag":126,"props":8398,"children":8399},{"style":771},[8400],{"type":49,"value":8401},"        # 'map_book':mark_safe(escapejs(json.dumps(map_book))),\n",{"type":26,"tag":126,"props":8403,"children":8404},{"class":128,"line":923},[8405,8410],{"type":26,"tag":126,"props":8406,"children":8407},{"style":159},[8408],{"type":49,"value":8409},"        'sorted_nearby'",{"type":26,"tag":126,"props":8411,"children":8412},{"style":139},[8413],{"type":49,"value":8414},":sorted_nearby,\n",{"type":26,"tag":126,"props":8416,"children":8417},{"class":128,"line":932},[8418],{"type":26,"tag":126,"props":8419,"children":8420},{"style":139},[8421],{"type":49,"value":1633},{"type":26,"tag":126,"props":8423,"children":8424},{"class":128,"line":946},[8425,8429,8433,8438],{"type":26,"tag":126,"props":8426,"children":8427},{"style":375},[8428],{"type":49,"value":990},{"type":26,"tag":126,"props":8430,"children":8431},{"style":139},[8432],{"type":49,"value":995},{"type":26,"tag":126,"props":8434,"children":8435},{"style":159},[8436],{"type":49,"value":8437},"'books/book_detail.html'",{"type":26,"tag":126,"props":8439,"children":8440},{"style":139},[8441],{"type":49,"value":1005},{"type":26,"tag":27,"props":8443,"children":8444},{},[8445,8447,8453,8455,8461,8463,8469,8471,8477,8479,8485,8487,8493,8495,8501,8503,8509,8511,8517,8519,8525,8527,8533,8535,8541,8543,8549],{"type":49,"value":8446},"To find the 5 closest books I arrived at a solution that seems fairly convoluted and should be refactored, but works! I start with a queryset of all books, then use list comprehension to make a list of tuples containing ",{"type":26,"tag":102,"props":8448,"children":8450},{"className":8449},[],[8451],{"type":49,"value":8452},"((\u003C longitutde >, \u003C latitude >), \u003C Book Object >)",{"type":49,"value":8454},". Then I loop over this list and create a dictionary where the keys are ",{"type":26,"tag":102,"props":8456,"children":8458},{"className":8457},[],[8459],{"type":49,"value":8460},"(\u003C longitutde >, \u003C latitude >)",{"type":49,"value":8462}," and the values are tuples of the form: ",{"type":26,"tag":102,"props":8464,"children":8466},{"className":8465},[],[8467],{"type":49,"value":8468},"(\u003C distance in miles >, \u003C Book Object >)",{"type":49,"value":8470},". Finally, I use ",{"type":26,"tag":102,"props":8472,"children":8474},{"className":8473},[],[8475],{"type":49,"value":8476},"sorted",{"type":49,"value":8478}," on ",{"type":26,"tag":102,"props":8480,"children":8482},{"className":8481},[],[8483],{"type":49,"value":8484},"dictionary_dict.items()",{"type":49,"value":8486}," where the key is ",{"type":26,"tag":102,"props":8488,"children":8490},{"className":8489},[],[8491],{"type":49,"value":8492},"lambda x: x[1][0]",{"type":49,"value":8494},". The ",{"type":26,"tag":102,"props":8496,"children":8498},{"className":8497},[],[8499],{"type":49,"value":8500},"[1]",{"type":49,"value":8502}," accesses the ",{"type":26,"tag":102,"props":8504,"children":8506},{"className":8505},[],[8507],{"type":49,"value":8508},"value",{"type":49,"value":8510}," of the ",{"type":26,"tag":102,"props":8512,"children":8514},{"className":8513},[],[8515],{"type":49,"value":8516},"(\u003C key >, \u003C value>)",{"type":49,"value":8518}," tuple returned by ",{"type":26,"tag":102,"props":8520,"children":8522},{"className":8521},[],[8523],{"type":49,"value":8524},"items()",{"type":49,"value":8526},", and the ",{"type":26,"tag":102,"props":8528,"children":8530},{"className":8529},[],[8531],{"type":49,"value":8532},"[0]",{"type":49,"value":8534}," access the first item, which is the ",{"type":26,"tag":102,"props":8536,"children":8538},{"className":8537},[],[8539],{"type":49,"value":8540},"distance",{"type":49,"value":8542}," value we calculated. Finally, I take the first ",{"type":26,"tag":102,"props":8544,"children":8546},{"className":8545},[],[8547],{"type":49,"value":8548},"[:5]",{"type":49,"value":8550}," items of this sorted list.",{"type":26,"tag":27,"props":8552,"children":8553},{},[8554],{"type":49,"value":8555},"With this approach I think I avoided the possible issue of ambiguity if we have two books with the same coordinates. I'll need to add this scenario to my test suite later.",{"type":26,"tag":293,"props":8557,"children":8559},{"id":8558},"testing-travis-ci",[8560],{"type":49,"value":8561},"Testing & Travis CI",{"type":26,"tag":27,"props":8563,"children":8564},{},[8565],{"type":49,"value":8566},"Speaking of testing, this applcation includes a simple testing suite (that I am currently working on expanding). I have also managed to setup Travis CI for this project. When I push code from my local repo to GitHub, Travis CI automatically runs test, and the commit message contains additional information about whether or not all of the tests were successful.",{"type":26,"tag":27,"props":8568,"children":8569},{},[8570,8572,8578,8580,8585],{"type":49,"value":8571},"Setting up Travis CI is very simple. We need to grant Travis CI (.org) access to our GitHub account, enable Travis CI on the repository we are working with, and then add a ",{"type":26,"tag":102,"props":8573,"children":8575},{"className":8574},[],[8576],{"type":49,"value":8577},".travis.yml",{"type":49,"value":8579}," file to the top level of the project directory. Here's the ",{"type":26,"tag":102,"props":8581,"children":8583},{"className":8582},[],[8584],{"type":49,"value":8577},{"type":49,"value":8586}," file I have for this project:",{"type":26,"tag":116,"props":8588,"children":8592},{"code":8589,"language":8590,"meta":8,"className":8591,"style":8},"language: python\n\npython:\n  - '3.5'\n\nservices:\n  - postgresql\n\nenv: -DJANGO=2.0 DB=postgresql\n\ninstall:\n  - pip install -r requirements.txt\n\nbefore_script:\n  - psql -c \"CREATE USER u_brian WITH PASSWORD 'password'; ALTER USER u_brian CREATEDB;\" -U postgres\n\nscript:\n  - python manage.py test books/\n","yml","language-yml shiki shiki-themes github-light github-dark monokai",[8593],{"type":26,"tag":102,"props":8594,"children":8595},{"__ignoreMap":8},[8596,8613,8620,8631,8644,8651,8663,8675,8682,8699,8706,8718,8730,8737,8749,8761,8768,8779],{"type":26,"tag":126,"props":8597,"children":8598},{"class":128,"line":129},[8599,8604,8608],{"type":26,"tag":126,"props":8600,"children":8601},{"style":1396},[8602],{"type":49,"value":8603},"language",{"type":26,"tag":126,"props":8605,"children":8606},{"style":139},[8607],{"type":49,"value":3579},{"type":26,"tag":126,"props":8609,"children":8610},{"style":159},[8611],{"type":49,"value":8612},"python\n",{"type":26,"tag":126,"props":8614,"children":8615},{"class":128,"line":155},[8616],{"type":26,"tag":126,"props":8617,"children":8618},{"emptyLinePlaceholder":12},[8619],{"type":49,"value":705},{"type":26,"tag":126,"props":8621,"children":8622},{"class":128,"line":170},[8623,8627],{"type":26,"tag":126,"props":8624,"children":8625},{"style":1396},[8626],{"type":49,"value":319},{"type":26,"tag":126,"props":8628,"children":8629},{"style":139},[8630],{"type":49,"value":2854},{"type":26,"tag":126,"props":8632,"children":8633},{"class":128,"line":179},[8634,8639],{"type":26,"tag":126,"props":8635,"children":8636},{"style":139},[8637],{"type":49,"value":8638},"  - ",{"type":26,"tag":126,"props":8640,"children":8641},{"style":159},[8642],{"type":49,"value":8643},"'3.5'\n",{"type":26,"tag":126,"props":8645,"children":8646},{"class":128,"line":188},[8647],{"type":26,"tag":126,"props":8648,"children":8649},{"emptyLinePlaceholder":12},[8650],{"type":49,"value":705},{"type":26,"tag":126,"props":8652,"children":8653},{"class":128,"line":201},[8654,8659],{"type":26,"tag":126,"props":8655,"children":8656},{"style":1396},[8657],{"type":49,"value":8658},"services",{"type":26,"tag":126,"props":8660,"children":8661},{"style":139},[8662],{"type":49,"value":2854},{"type":26,"tag":126,"props":8664,"children":8665},{"class":128,"line":220},[8666,8670],{"type":26,"tag":126,"props":8667,"children":8668},{"style":139},[8669],{"type":49,"value":8638},{"type":26,"tag":126,"props":8671,"children":8672},{"style":159},[8673],{"type":49,"value":8674},"postgresql\n",{"type":26,"tag":126,"props":8676,"children":8677},{"class":128,"line":238},[8678],{"type":26,"tag":126,"props":8679,"children":8680},{"emptyLinePlaceholder":12},[8681],{"type":49,"value":705},{"type":26,"tag":126,"props":8683,"children":8684},{"class":128,"line":256},[8685,8690,8694],{"type":26,"tag":126,"props":8686,"children":8687},{"style":1396},[8688],{"type":49,"value":8689},"env",{"type":26,"tag":126,"props":8691,"children":8692},{"style":139},[8693],{"type":49,"value":3579},{"type":26,"tag":126,"props":8695,"children":8696},{"style":159},[8697],{"type":49,"value":8698},"-DJANGO=2.0 DB=postgresql\n",{"type":26,"tag":126,"props":8700,"children":8701},{"class":128,"line":265},[8702],{"type":26,"tag":126,"props":8703,"children":8704},{"emptyLinePlaceholder":12},[8705],{"type":49,"value":705},{"type":26,"tag":126,"props":8707,"children":8708},{"class":128,"line":731},[8709,8714],{"type":26,"tag":126,"props":8710,"children":8711},{"style":1396},[8712],{"type":49,"value":8713},"install",{"type":26,"tag":126,"props":8715,"children":8716},{"style":139},[8717],{"type":49,"value":2854},{"type":26,"tag":126,"props":8719,"children":8720},{"class":128,"line":759},[8721,8725],{"type":26,"tag":126,"props":8722,"children":8723},{"style":139},[8724],{"type":49,"value":8638},{"type":26,"tag":126,"props":8726,"children":8727},{"style":159},[8728],{"type":49,"value":8729},"pip install -r requirements.txt\n",{"type":26,"tag":126,"props":8731,"children":8732},{"class":128,"line":767},[8733],{"type":26,"tag":126,"props":8734,"children":8735},{"emptyLinePlaceholder":12},[8736],{"type":49,"value":705},{"type":26,"tag":126,"props":8738,"children":8739},{"class":128,"line":777},[8740,8745],{"type":26,"tag":126,"props":8741,"children":8742},{"style":1396},[8743],{"type":49,"value":8744},"before_script",{"type":26,"tag":126,"props":8746,"children":8747},{"style":139},[8748],{"type":49,"value":2854},{"type":26,"tag":126,"props":8750,"children":8751},{"class":128,"line":786},[8752,8756],{"type":26,"tag":126,"props":8753,"children":8754},{"style":139},[8755],{"type":49,"value":8638},{"type":26,"tag":126,"props":8757,"children":8758},{"style":159},[8759],{"type":49,"value":8760},"psql -c \"CREATE USER u_brian WITH PASSWORD 'password'; ALTER USER u_brian CREATEDB;\" -U postgres\n",{"type":26,"tag":126,"props":8762,"children":8763},{"class":128,"line":834},[8764],{"type":26,"tag":126,"props":8765,"children":8766},{"emptyLinePlaceholder":12},[8767],{"type":49,"value":705},{"type":26,"tag":126,"props":8769,"children":8770},{"class":128,"line":848},[8771,8775],{"type":26,"tag":126,"props":8772,"children":8773},{"style":1396},[8774],{"type":49,"value":1399},{"type":26,"tag":126,"props":8776,"children":8777},{"style":139},[8778],{"type":49,"value":2854},{"type":26,"tag":126,"props":8780,"children":8781},{"class":128,"line":882},[8782,8786],{"type":26,"tag":126,"props":8783,"children":8784},{"style":139},[8785],{"type":49,"value":8638},{"type":26,"tag":126,"props":8787,"children":8788},{"style":159},[8789],{"type":49,"value":8790},"python manage.py test books/\n",{"type":26,"tag":27,"props":8792,"children":8793},{},[8794],{"type":49,"value":8795},"We can generate a Travis CI badge that shows the status of the current Github deploy with the following code:",{"type":26,"tag":116,"props":8797,"children":8799},{"code":8798,"language":1380,"meta":8,"className":1381,"style":8},"[![Build\nStatus](https://travis-ci.org/briancaffey/django-leaflet-demo.svg?branch=master)](https://travis-ci.org/briancaffey/django-leaflet-demo)\n",[8800],{"type":26,"tag":102,"props":8801,"children":8802},{"__ignoreMap":8},[8803,8811],{"type":26,"tag":126,"props":8804,"children":8805},{"class":128,"line":129},[8806],{"type":26,"tag":126,"props":8807,"children":8808},{"style":139},[8809],{"type":49,"value":8810},"[![Build\n",{"type":26,"tag":126,"props":8812,"children":8813},{"class":128,"line":155},[8814],{"type":26,"tag":126,"props":8815,"children":8816},{"style":139},[8817],{"type":49,"value":8818},"Status](https://travis-ci.org/briancaffey/django-leaflet-demo.svg?branch=master)](https://travis-ci.org/briancaffey/django-leaflet-demo)\n",{"type":26,"tag":27,"props":8820,"children":8821},{},[8822],{"type":26,"tag":42,"props":8823,"children":8826},{"href":8824,"rel":8825},"https://travis-ci.org/briancaffey/django-leaflet-demo",[46],[8827],{"type":26,"tag":31,"props":8828,"children":8831},{"alt":8829,"src":8830},"Build Status","https://travis-ci.org/briancaffey/django-leaflet-demo.svg?branch=master",[],{"type":26,"tag":293,"props":8833,"children":8835},{"id":8834},"deploying-to-digitalocean",[8836],{"type":49,"value":8837},"Deploying to DigitalOcean",{"type":26,"tag":27,"props":8839,"children":8840},{},[8841],{"type":49,"value":8842},"Finally, I used DigitalOcean to deploy this app. I have used Heroku for most of my previous projects, but I decided to use DigitalOcean for this one to learn something new and get more experience with using Ubuntu and related tools for running a website: nginx and gunicorn.",{"type":26,"tag":27,"props":8844,"children":8845},{},[8846,8848,8855,8857,8863,8865,8871],{"type":49,"value":8847},"Again, for I turned to Vitor's blog for a very straightforward introduction to deploying on DigitalOcean with a simple Droplet. You can read more about the instructions for deployment ",{"type":26,"tag":42,"props":8849,"children":8852},{"href":8850,"rel":8851},"https://simpleisbetterthancomplex.com/tutorial/2016/10/14/how-to-deploy-to-digital-ocean.html",[46],[8853],{"type":49,"value":8854},"here",{"type":49,"value":8856},", and I can say that I had no problems following the instructions step by step. Here are the ",{"type":26,"tag":102,"props":8858,"children":8860},{"className":8859},[],[8861],{"type":49,"value":8862},"gunicorn",{"type":49,"value":8864}," and ",{"type":26,"tag":102,"props":8866,"children":8868},{"className":8867},[],[8869],{"type":49,"value":8870},"nginx",{"type":49,"value":8872}," scripts I have used to successfully deploy my project:",{"type":26,"tag":27,"props":8874,"children":8875},{},[8876],{"type":26,"tag":8877,"props":8878,"children":8879},"em",{},[8880],{"type":49,"value":8881},"/home/brian/bin/gunicorn_start",{"type":26,"tag":116,"props":8883,"children":8887},{"code":8884,"language":8885,"meta":8,"className":8886,"style":8},"#!/bin/bash\n\nNAME=\"django-leaflet-demo\"\nDIR=/home/brian/django-leaflet-demo\nUSER=brian\nGROUP=brian\nWORKERS=3\nBIND=unix:/home/brian/run/gunicorn.sock\nDJANGO_SETTINGS_MODULE=djangoapp.settings\nDJANGO_WSGI_MODULE=djangoapp.wsgi\nLOG_LEVEL=error\ncd $DIR\nsource ../bin/activate\n\nexport DJANGO_SETTINGS_MODULE=$DJANGO_SETTINGS_MODULE\nexport PYTHONPATH=$DIR:$PYTHONPATH\n\nexec ../bin/gunicorn ${DJANGO_WSGI_MODULE}:application \\\n  --name=$NAME \\\n  --workers=$WORKERS \\\n  --user=$USER \\\n  --group=$GROUP \\\n  --bind=$BIND \\\n  --log-level=$LOG_LEVEL \\\n  --log-file=-\n","bash","language-bash shiki shiki-themes github-light github-dark monokai",[8888],{"type":26,"tag":102,"props":8889,"children":8890},{"__ignoreMap":8},[8891,8899,8906,8923,8940,8957,8973,8990,9007,9024,9041,9058,9071,9084,9091,9113,9134,9141,9168,9185,9202,9219,9236,9253,9270],{"type":26,"tag":126,"props":8892,"children":8893},{"class":128,"line":129},[8894],{"type":26,"tag":126,"props":8895,"children":8896},{"style":771},[8897],{"type":49,"value":8898},"#!/bin/bash\n",{"type":26,"tag":126,"props":8900,"children":8901},{"class":128,"line":155},[8902],{"type":26,"tag":126,"props":8903,"children":8904},{"emptyLinePlaceholder":12},[8905],{"type":49,"value":705},{"type":26,"tag":126,"props":8907,"children":8908},{"class":128,"line":170},[8909,8914,8918],{"type":26,"tag":126,"props":8910,"children":8911},{"style":139},[8912],{"type":49,"value":8913},"NAME",{"type":26,"tag":126,"props":8915,"children":8916},{"style":375},[8917],{"type":49,"value":378},{"type":26,"tag":126,"props":8919,"children":8920},{"style":159},[8921],{"type":49,"value":8922},"\"django-leaflet-demo\"\n",{"type":26,"tag":126,"props":8924,"children":8925},{"class":128,"line":179},[8926,8931,8935],{"type":26,"tag":126,"props":8927,"children":8928},{"style":139},[8929],{"type":49,"value":8930},"DIR",{"type":26,"tag":126,"props":8932,"children":8933},{"style":375},[8934],{"type":49,"value":378},{"type":26,"tag":126,"props":8936,"children":8937},{"style":159},[8938],{"type":49,"value":8939},"/home/brian/django-leaflet-demo\n",{"type":26,"tag":126,"props":8941,"children":8942},{"class":128,"line":188},[8943,8948,8952],{"type":26,"tag":126,"props":8944,"children":8945},{"style":139},[8946],{"type":49,"value":8947},"USER",{"type":26,"tag":126,"props":8949,"children":8950},{"style":375},[8951],{"type":49,"value":378},{"type":26,"tag":126,"props":8953,"children":8954},{"style":159},[8955],{"type":49,"value":8956},"brian\n",{"type":26,"tag":126,"props":8958,"children":8959},{"class":128,"line":201},[8960,8965,8969],{"type":26,"tag":126,"props":8961,"children":8962},{"style":139},[8963],{"type":49,"value":8964},"GROUP",{"type":26,"tag":126,"props":8966,"children":8967},{"style":375},[8968],{"type":49,"value":378},{"type":26,"tag":126,"props":8970,"children":8971},{"style":159},[8972],{"type":49,"value":8956},{"type":26,"tag":126,"props":8974,"children":8975},{"class":128,"line":220},[8976,8981,8985],{"type":26,"tag":126,"props":8977,"children":8978},{"style":139},[8979],{"type":49,"value":8980},"WORKERS",{"type":26,"tag":126,"props":8982,"children":8983},{"style":375},[8984],{"type":49,"value":378},{"type":26,"tag":126,"props":8986,"children":8987},{"style":159},[8988],{"type":49,"value":8989},"3\n",{"type":26,"tag":126,"props":8991,"children":8992},{"class":128,"line":238},[8993,8998,9002],{"type":26,"tag":126,"props":8994,"children":8995},{"style":139},[8996],{"type":49,"value":8997},"BIND",{"type":26,"tag":126,"props":8999,"children":9000},{"style":375},[9001],{"type":49,"value":378},{"type":26,"tag":126,"props":9003,"children":9004},{"style":159},[9005],{"type":49,"value":9006},"unix:/home/brian/run/gunicorn.sock\n",{"type":26,"tag":126,"props":9008,"children":9009},{"class":128,"line":256},[9010,9015,9019],{"type":26,"tag":126,"props":9011,"children":9012},{"style":139},[9013],{"type":49,"value":9014},"DJANGO_SETTINGS_MODULE",{"type":26,"tag":126,"props":9016,"children":9017},{"style":375},[9018],{"type":49,"value":378},{"type":26,"tag":126,"props":9020,"children":9021},{"style":159},[9022],{"type":49,"value":9023},"djangoapp.settings\n",{"type":26,"tag":126,"props":9025,"children":9026},{"class":128,"line":265},[9027,9032,9036],{"type":26,"tag":126,"props":9028,"children":9029},{"style":139},[9030],{"type":49,"value":9031},"DJANGO_WSGI_MODULE",{"type":26,"tag":126,"props":9033,"children":9034},{"style":375},[9035],{"type":49,"value":378},{"type":26,"tag":126,"props":9037,"children":9038},{"style":159},[9039],{"type":49,"value":9040},"djangoapp.wsgi\n",{"type":26,"tag":126,"props":9042,"children":9043},{"class":128,"line":731},[9044,9049,9053],{"type":26,"tag":126,"props":9045,"children":9046},{"style":139},[9047],{"type":49,"value":9048},"LOG_LEVEL",{"type":26,"tag":126,"props":9050,"children":9051},{"style":375},[9052],{"type":49,"value":378},{"type":26,"tag":126,"props":9054,"children":9055},{"style":159},[9056],{"type":49,"value":9057},"error\n",{"type":26,"tag":126,"props":9059,"children":9060},{"class":128,"line":759},[9061,9066],{"type":26,"tag":126,"props":9062,"children":9063},{"style":2818},[9064],{"type":49,"value":9065},"cd",{"type":26,"tag":126,"props":9067,"children":9068},{"style":139},[9069],{"type":49,"value":9070}," $DIR\n",{"type":26,"tag":126,"props":9072,"children":9073},{"class":128,"line":767},[9074,9079],{"type":26,"tag":126,"props":9075,"children":9076},{"style":2818},[9077],{"type":49,"value":9078},"source",{"type":26,"tag":126,"props":9080,"children":9081},{"style":159},[9082],{"type":49,"value":9083}," ../bin/activate\n",{"type":26,"tag":126,"props":9085,"children":9086},{"class":128,"line":777},[9087],{"type":26,"tag":126,"props":9088,"children":9089},{"emptyLinePlaceholder":12},[9090],{"type":49,"value":705},{"type":26,"tag":126,"props":9092,"children":9093},{"class":128,"line":786},[9094,9099,9104,9108],{"type":26,"tag":126,"props":9095,"children":9096},{"style":375},[9097],{"type":49,"value":9098},"export",{"type":26,"tag":126,"props":9100,"children":9101},{"style":139},[9102],{"type":49,"value":9103}," DJANGO_SETTINGS_MODULE",{"type":26,"tag":126,"props":9105,"children":9106},{"style":375},[9107],{"type":49,"value":378},{"type":26,"tag":126,"props":9109,"children":9110},{"style":139},[9111],{"type":49,"value":9112},"$DJANGO_SETTINGS_MODULE\n",{"type":26,"tag":126,"props":9114,"children":9115},{"class":128,"line":834},[9116,9120,9125,9129],{"type":26,"tag":126,"props":9117,"children":9118},{"style":375},[9119],{"type":49,"value":9098},{"type":26,"tag":126,"props":9121,"children":9122},{"style":139},[9123],{"type":49,"value":9124}," PYTHONPATH",{"type":26,"tag":126,"props":9126,"children":9127},{"style":375},[9128],{"type":49,"value":378},{"type":26,"tag":126,"props":9130,"children":9131},{"style":139},[9132],{"type":49,"value":9133},"$DIR:$PYTHONPATH\n",{"type":26,"tag":126,"props":9135,"children":9136},{"class":128,"line":848},[9137],{"type":26,"tag":126,"props":9138,"children":9139},{"emptyLinePlaceholder":12},[9140],{"type":49,"value":705},{"type":26,"tag":126,"props":9142,"children":9143},{"class":128,"line":882},[9144,9149,9154,9159,9164],{"type":26,"tag":126,"props":9145,"children":9146},{"style":2818},[9147],{"type":49,"value":9148},"exec",{"type":26,"tag":126,"props":9150,"children":9151},{"style":159},[9152],{"type":49,"value":9153}," ../bin/gunicorn",{"type":26,"tag":126,"props":9155,"children":9156},{"style":139},[9157],{"type":49,"value":9158}," ${DJANGO_WSGI_MODULE}",{"type":26,"tag":126,"props":9160,"children":9161},{"style":159},[9162],{"type":49,"value":9163},":application",{"type":26,"tag":126,"props":9165,"children":9166},{"style":210},[9167],{"type":49,"value":5321},{"type":26,"tag":126,"props":9169,"children":9170},{"class":128,"line":900},[9171,9176,9181],{"type":26,"tag":126,"props":9172,"children":9173},{"style":210},[9174],{"type":49,"value":9175},"  --name=",{"type":26,"tag":126,"props":9177,"children":9178},{"style":139},[9179],{"type":49,"value":9180},"$NAME",{"type":26,"tag":126,"props":9182,"children":9183},{"style":210},[9184],{"type":49,"value":5321},{"type":26,"tag":126,"props":9186,"children":9187},{"class":128,"line":914},[9188,9193,9198],{"type":26,"tag":126,"props":9189,"children":9190},{"style":210},[9191],{"type":49,"value":9192},"  --workers=",{"type":26,"tag":126,"props":9194,"children":9195},{"style":139},[9196],{"type":49,"value":9197},"$WORKERS",{"type":26,"tag":126,"props":9199,"children":9200},{"style":210},[9201],{"type":49,"value":5321},{"type":26,"tag":126,"props":9203,"children":9204},{"class":128,"line":923},[9205,9210,9215],{"type":26,"tag":126,"props":9206,"children":9207},{"style":210},[9208],{"type":49,"value":9209},"  --user=",{"type":26,"tag":126,"props":9211,"children":9212},{"style":139},[9213],{"type":49,"value":9214},"$USER",{"type":26,"tag":126,"props":9216,"children":9217},{"style":210},[9218],{"type":49,"value":5321},{"type":26,"tag":126,"props":9220,"children":9221},{"class":128,"line":932},[9222,9227,9232],{"type":26,"tag":126,"props":9223,"children":9224},{"style":210},[9225],{"type":49,"value":9226},"  --group=",{"type":26,"tag":126,"props":9228,"children":9229},{"style":139},[9230],{"type":49,"value":9231},"$GROUP",{"type":26,"tag":126,"props":9233,"children":9234},{"style":210},[9235],{"type":49,"value":5321},{"type":26,"tag":126,"props":9237,"children":9238},{"class":128,"line":946},[9239,9244,9249],{"type":26,"tag":126,"props":9240,"children":9241},{"style":210},[9242],{"type":49,"value":9243},"  --bind=",{"type":26,"tag":126,"props":9245,"children":9246},{"style":139},[9247],{"type":49,"value":9248},"$BIND",{"type":26,"tag":126,"props":9250,"children":9251},{"style":210},[9252],{"type":49,"value":5321},{"type":26,"tag":126,"props":9254,"children":9255},{"class":128,"line":970},[9256,9261,9266],{"type":26,"tag":126,"props":9257,"children":9258},{"style":210},[9259],{"type":49,"value":9260},"  --log-level=",{"type":26,"tag":126,"props":9262,"children":9263},{"style":139},[9264],{"type":49,"value":9265},"$LOG_LEVEL",{"type":26,"tag":126,"props":9267,"children":9268},{"style":210},[9269],{"type":49,"value":5321},{"type":26,"tag":126,"props":9271,"children":9272},{"class":128,"line":984},[9273],{"type":26,"tag":126,"props":9274,"children":9275},{"style":210},[9276],{"type":49,"value":9277},"  --log-file=-\n",{"type":26,"tag":27,"props":9279,"children":9280},{},[9281],{"type":26,"tag":8877,"props":9282,"children":9283},{},[9284],{"type":49,"value":9285},"/etc/nginx/sites-available",{"type":26,"tag":116,"props":9287,"children":9289},{"code":9288,"language":8590,"meta":8,"className":8591,"style":8},"upstream app_server {\nserver unix:/home/brian/run/gunicorn.sock fail_timeout=0;\n}\n\nserver {\nlisten 80;\nserver_name 159.89.235.193\nkeepalive_timeout 5;\nclient_max_body_size 4G;\naccess_log /home/brian/logs/nginx-access.log;\nerror_log /home/brian/logs/nginx-error.log;\n\nlocation /static/ {\nalias /home/brian/static/;\n}\n\nlocation / {\ntry_files $uri @proxy_to_app;\n}\n\nlocation @proxy_to_app {\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\nproxy_set_header Host $http_host;\nproxy_redirect off;\nproxy_pass http://app_server;\n}\n}\n",[9290],{"type":26,"tag":102,"props":9291,"children":9292},{"__ignoreMap":8},[9293,9301,9309,9316,9323,9331,9339,9347,9355,9363,9371,9379,9386,9394,9402,9409,9416,9424,9432,9439,9446,9454,9462,9470,9478,9486,9493],{"type":26,"tag":126,"props":9294,"children":9295},{"class":128,"line":129},[9296],{"type":26,"tag":126,"props":9297,"children":9298},{"style":159},[9299],{"type":49,"value":9300},"upstream app_server {\n",{"type":26,"tag":126,"props":9302,"children":9303},{"class":128,"line":155},[9304],{"type":26,"tag":126,"props":9305,"children":9306},{"style":159},[9307],{"type":49,"value":9308},"server unix:/home/brian/run/gunicorn.sock fail_timeout=0;\n",{"type":26,"tag":126,"props":9310,"children":9311},{"class":128,"line":170},[9312],{"type":26,"tag":126,"props":9313,"children":9314},{"style":139},[9315],{"type":49,"value":1362},{"type":26,"tag":126,"props":9317,"children":9318},{"class":128,"line":179},[9319],{"type":26,"tag":126,"props":9320,"children":9321},{"emptyLinePlaceholder":12},[9322],{"type":49,"value":705},{"type":26,"tag":126,"props":9324,"children":9325},{"class":128,"line":188},[9326],{"type":26,"tag":126,"props":9327,"children":9328},{"style":159},[9329],{"type":49,"value":9330},"server {\n",{"type":26,"tag":126,"props":9332,"children":9333},{"class":128,"line":201},[9334],{"type":26,"tag":126,"props":9335,"children":9336},{"style":159},[9337],{"type":49,"value":9338},"listen 80;\n",{"type":26,"tag":126,"props":9340,"children":9341},{"class":128,"line":220},[9342],{"type":26,"tag":126,"props":9343,"children":9344},{"style":159},[9345],{"type":49,"value":9346},"server_name 159.89.235.193\n",{"type":26,"tag":126,"props":9348,"children":9349},{"class":128,"line":238},[9350],{"type":26,"tag":126,"props":9351,"children":9352},{"style":159},[9353],{"type":49,"value":9354},"keepalive_timeout 5;\n",{"type":26,"tag":126,"props":9356,"children":9357},{"class":128,"line":256},[9358],{"type":26,"tag":126,"props":9359,"children":9360},{"style":159},[9361],{"type":49,"value":9362},"client_max_body_size 4G;\n",{"type":26,"tag":126,"props":9364,"children":9365},{"class":128,"line":265},[9366],{"type":26,"tag":126,"props":9367,"children":9368},{"style":159},[9369],{"type":49,"value":9370},"access_log /home/brian/logs/nginx-access.log;\n",{"type":26,"tag":126,"props":9372,"children":9373},{"class":128,"line":731},[9374],{"type":26,"tag":126,"props":9375,"children":9376},{"style":159},[9377],{"type":49,"value":9378},"error_log /home/brian/logs/nginx-error.log;\n",{"type":26,"tag":126,"props":9380,"children":9381},{"class":128,"line":759},[9382],{"type":26,"tag":126,"props":9383,"children":9384},{"emptyLinePlaceholder":12},[9385],{"type":49,"value":705},{"type":26,"tag":126,"props":9387,"children":9388},{"class":128,"line":767},[9389],{"type":26,"tag":126,"props":9390,"children":9391},{"style":159},[9392],{"type":49,"value":9393},"location /static/ {\n",{"type":26,"tag":126,"props":9395,"children":9396},{"class":128,"line":777},[9397],{"type":26,"tag":126,"props":9398,"children":9399},{"style":159},[9400],{"type":49,"value":9401},"alias /home/brian/static/;\n",{"type":26,"tag":126,"props":9403,"children":9404},{"class":128,"line":786},[9405],{"type":26,"tag":126,"props":9406,"children":9407},{"style":139},[9408],{"type":49,"value":1362},{"type":26,"tag":126,"props":9410,"children":9411},{"class":128,"line":834},[9412],{"type":26,"tag":126,"props":9413,"children":9414},{"emptyLinePlaceholder":12},[9415],{"type":49,"value":705},{"type":26,"tag":126,"props":9417,"children":9418},{"class":128,"line":848},[9419],{"type":26,"tag":126,"props":9420,"children":9421},{"style":159},[9422],{"type":49,"value":9423},"location / {\n",{"type":26,"tag":126,"props":9425,"children":9426},{"class":128,"line":882},[9427],{"type":26,"tag":126,"props":9428,"children":9429},{"style":159},[9430],{"type":49,"value":9431},"try_files $uri @proxy_to_app;\n",{"type":26,"tag":126,"props":9433,"children":9434},{"class":128,"line":900},[9435],{"type":26,"tag":126,"props":9436,"children":9437},{"style":139},[9438],{"type":49,"value":1362},{"type":26,"tag":126,"props":9440,"children":9441},{"class":128,"line":914},[9442],{"type":26,"tag":126,"props":9443,"children":9444},{"emptyLinePlaceholder":12},[9445],{"type":49,"value":705},{"type":26,"tag":126,"props":9447,"children":9448},{"class":128,"line":923},[9449],{"type":26,"tag":126,"props":9450,"children":9451},{"style":159},[9452],{"type":49,"value":9453},"location @proxy_to_app {\n",{"type":26,"tag":126,"props":9455,"children":9456},{"class":128,"line":932},[9457],{"type":26,"tag":126,"props":9458,"children":9459},{"style":159},[9460],{"type":49,"value":9461},"proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n",{"type":26,"tag":126,"props":9463,"children":9464},{"class":128,"line":946},[9465],{"type":26,"tag":126,"props":9466,"children":9467},{"style":159},[9468],{"type":49,"value":9469},"proxy_set_header Host $http_host;\n",{"type":26,"tag":126,"props":9471,"children":9472},{"class":128,"line":970},[9473],{"type":26,"tag":126,"props":9474,"children":9475},{"style":159},[9476],{"type":49,"value":9477},"proxy_redirect off;\n",{"type":26,"tag":126,"props":9479,"children":9480},{"class":128,"line":984},[9481],{"type":26,"tag":126,"props":9482,"children":9483},{"style":159},[9484],{"type":49,"value":9485},"proxy_pass http://app_server;\n",{"type":26,"tag":126,"props":9487,"children":9488},{"class":128,"line":1880},[9489],{"type":26,"tag":126,"props":9490,"children":9491},{"style":139},[9492],{"type":49,"value":1362},{"type":26,"tag":126,"props":9494,"children":9495},{"class":128,"line":1888},[9496],{"type":26,"tag":126,"props":9497,"children":9498},{"style":139},[9499],{"type":49,"value":1362},{"type":26,"tag":27,"props":9501,"children":9502},{},[9503],{"type":49,"value":9504},"Finally, here is the Supervisor configuration file that runs the gunicorn server:",{"type":26,"tag":116,"props":9506,"children":9508},{"code":9507},"[program:django-leaflet-demo]\ncommand=/home/brian/bin/gunicorn_start\nuser=brian\nautostart=true\nautorestart=true\nredirect_stderr=true\nstdout_logfile=/home/brian/logs/gunicorn-error.log\n",[9509],{"type":26,"tag":102,"props":9510,"children":9511},{"__ignoreMap":8},[9512],{"type":49,"value":9507},{"type":26,"tag":27,"props":9514,"children":9515},{},[9516],{"type":49,"value":9517},"I would definitely like to dive into DigitalOcean deployment in more depth in my next post.",{"type":26,"tag":27,"props":9519,"children":9520},{},[9521,9523,9528],{"type":49,"value":9522},"For now, you can view the live project on DigitalOcean here: ",{"type":26,"tag":42,"props":9524,"children":9526},{"href":44,"rel":9525},[46],[9527],{"type":49,"value":44},{"type":49,"value":9529},". In the future I would like to use this Droplet to do more demo apps like this one as I continue to learn the ins and outs of using Django and more frontend tools. Thanks for reading to the end and let me know if you have any comments or critiques on how I went about this project, I would be happy to hear from you!",{"type":26,"tag":9531,"props":9532,"children":9533},"style",{},[9534],{"type":49,"value":9535},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}",{"title":8,"searchDepth":155,"depth":155,"links":9537},[9538,9539,9540,9541,9542,9543,9544,9545,9546,9547],{"id":39,"depth":170,"text":50},{"id":295,"depth":155,"text":298},{"id":531,"depth":155,"text":534},{"id":2544,"depth":155,"text":2547},{"id":3338,"depth":155,"text":3341},{"id":4100,"depth":155,"text":4103},{"id":5724,"depth":155,"text":5727},{"id":7408,"depth":155,"text":7411},{"id":8558,"depth":155,"text":8561},{"id":8834,"depth":155,"text":8837},"markdown","content:2018:02:19:leaflet-maps-with-django.md","content","2018/02/19/leaflet-maps-with-django.md","2018/02/19/leaflet-maps-with-django","md",1731145377933]