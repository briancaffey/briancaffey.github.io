<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Detailed setup of a mini Django News App project with Bootstrap, AJAX, Celery and RabbitMQ</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Brian Caffey's personal website"><meta data-n-head="ssr" name="robots" content="all"><meta data-n-head="ssr" property="og:title" content="Detailed setup of a mini Django News App project with Bootstrap, AJAX, Celery and RabbitMQ"><meta data-n-head="ssr" property="og:description" content="undefined"><meta data-n-head="ssr" property="og:image" content="https://briancaffey.github.ioundefined"><meta data-n-head="ssr" property="twitter:card" content="https://briancaffey.github.ioundefined"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><script data-n-head="ssr" data-hid="adsbygoogle-script" defer crossorigin="anonymous" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4924597640144289"></script><script data-n-head="ssr" data-hid="adsbygoogle">window.__abg_called||((adsbygoogle=window.adsbygoogle||[]).pauseAdRequests=0,(window.adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-4924597640144289",enable_page_level_ads:!1,overlays:{bottom:!1}}),window.__abg_called=!0)</script><link rel="preload" href="/_nuxt/e9c2366.js" as="script"><link rel="preload" href="/_nuxt/9ee0ef6.js" as="script"><link rel="preload" href="/_nuxt/f51c3d4.js" as="script"><link rel="preload" href="/_nuxt/0f451e7.js" as="script"><link rel="preload" href="/_nuxt/b5afa39.js" as="script"><style data-vue-ssr-id="38dfa7e4:0 f52d43e0:0 9592d830:0 517a8dd7:0 072b2f8a:0 fa7ff0ca:0 56b15182:0 5a4b6265:0 14b1eaf9:0 a0fa61ae:0 7f6c3ed0:0 64516d8e:0 5586ddaf:0">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}details{display:block}summary{display:list-item}[hidden],template{display:none}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{box-sizing:border-box;border:0 solid #e2e8f0}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#a0aec0}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#a0aec0}input::placeholder,textarea::placeholder{color:#a0aec0}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}.bg-black{--bg-opacity:1;background-color:#000;background-color:rgba(0,0,0,var(--bg-opacity))}.bg-white{--bg-opacity:1;background-color:#fff;background-color:rgba(255,255,255,var(--bg-opacity))}.bg-red-300{--bg-opacity:1;background-color:#feb2b2;background-color:rgba(254,178,178,var(--bg-opacity))}.border-white{--border-opacity:1;border-color:#fff;border-color:rgba(255,255,255,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-md{border-radius:.375rem}.rounded-lg{border-radius:.5rem}.rounded-full{border-radius:9999px}.rounded-t{border-top-left-radius:.25rem;border-top-right-radius:.25rem}.border{border-width:1px}.cursor-pointer{cursor:pointer}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.table{display:table}.grid{display:grid}.contents{display:contents}.hidden{display:none}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.flex-1{flex:1 1 0%}.flex-grow{flex-grow:1}.float-right{float:right}.font-bold{font-weight:700}.h-3{height:.75rem}.h-4{height:1rem}.h-12{height:3rem}.h-32{height:8rem}.h-64{height:16rem}.text-lg{font-size:1.125rem}.text-xl{font-size:1.25rem}.text-2xl{font-size:1.5rem}.text-3xl{font-size:1.875rem}.leading-8{line-height:2rem}.leading-9{line-height:2.25rem}.m-2{margin:.5rem}.m-4{margin:1rem}.mx-1{margin-left:.25rem;margin-right:.25rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mx-auto{margin-left:auto;margin-right:auto}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.-ml-1{margin-left:-.25rem}.max-w-5xl{max-width:64rem}.max-w-6xl{max-width:72rem}.object-cover{-o-object-fit:cover;object-fit:cover}.p-3{padding:.75rem}.p-4{padding:1rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.px-1{padding-left:.25rem;padding-right:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-4{padding-left:1rem;padding-right:1rem}.py-8{padding-top:2rem;padding-bottom:2rem}.py-32{padding-top:8rem;padding-bottom:8rem}.pt-2{padding-top:.5rem}.pt-4{padding-top:1rem}.pr-4{padding-right:1rem}.pb-4{padding-bottom:1rem}.pt-8{padding-top:2rem}.pb-8{padding-bottom:2rem}.pt-16{padding-top:4rem}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{top:0;right:0;bottom:0;left:0}.top-0{top:0}.right-0{right:0}.bottom-0{bottom:0}.left-0{left:0}.resize{resize:both}.shadow{box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06)}.shadow-md{box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06)}.fill-current{fill:currentColor}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-black{--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity))}.text-white{--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity))}.text-gray-500{--text-opacity:1;color:#a0aec0;color:rgba(160,174,192,var(--text-opacity))}.text-gray-600{--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity))}.text-red-400{--text-opacity:1;color:#fc8181;color:rgba(252,129,129,var(--text-opacity))}.text-red-600{--text-opacity:1;color:#e53e3e;color:rgba(229,62,62,var(--text-opacity))}.uppercase{text-transform:uppercase}.visible{visibility:visible}.w-3{width:.75rem}.w-4{width:1rem}.w-12{width:3rem}.w-32{width:8rem}.w-full{width:100%}.z-10{z-index:10}.gap-4{grid-gap:1rem;gap:1rem}.gap-6{grid-gap:1.5rem;gap:1.5rem}.gap-8{grid-gap:2rem;gap:2rem}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.transform{--transform-translate-x:0;--transform-translate-y:0;--transform-rotate:0;--transform-skew-x:0;--transform-skew-y:0;--transform-scale-x:1;--transform-scale-y:1;transform:translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y))}.transition-all{transition-property:all}.transition{transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform}.duration-150{transition-duration:.15s}.delay-150{transition-delay:.15s}@-webkit-keyframes spin{to{transform:rotate(1turn)}}@keyframes spin{to{transform:rotate(1turn)}}@-webkit-keyframes ping{75%,to{transform:scale(2);opacity:0}}@keyframes ping{75%,to{transform:scale(2);opacity:0}}@-webkit-keyframes pulse{50%{opacity:.5}}@keyframes pulse{50%{opacity:.5}}@-webkit-keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@media (min-width:640px){.sm\:inline{display:inline}.sm\:hidden{display:none}.sm\:p-16{padding:4rem}.sm\:px-4{padding-left:1rem;padding-right:1rem}.sm\:w-2\/3{width:66.666667%}.sm\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width:768px){.md\:flex{display:flex}.md\:hidden{display:none}.md\:px-1{padding-left:.25rem;padding-right:.25rem}.md\:px-4{padding-left:1rem;padding-right:1rem}.md\:w-1\/2{width:50%}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}@media (min-width:1024px){.lg\:px-16{padding-left:4rem;padding-right:4rem}.lg\:px-32{padding-left:8rem;padding-right:8rem}.lg\:pl-64{padding-left:16rem}.lg\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width:1280px){.xl\:pb-16{padding-bottom:4rem}}:root{--color:#243746;--color-primary:#158876;--color-secondary:#0e2233;--bg:#f3f5f4;--bg-secondary:#fff;--bg-code:#ddd;--border-color:#ddd}.dark-mode{--color:#ebf4f1;--color-primary:#41b38a;--color-secondary:#fdf9f3;--bg:#091a28;--bg-secondary:#071521;--bg-code:#ddd;--border-color:#0d2538}.sepia-mode{--color:#433422;--color-primary:#504231;--color-secondary:#504231;--bg:#f1e7d0;--bg-code:#ddd;--bg-secondary:#eae0c9;--border-color:#ded0bf}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;background-color:#f3f5f4;background-color:var(--bg);color:#243746;color:var(--color);transition:background-color .7s}a{color:#158876;color:var(--color-primary)}.py-05{padding-top:.125rem;padding-bottom:.125rem}.markdown{--text-opacity:1;color:#1a202c;color:rgba(26,32,44,var(--text-opacity));line-height:1.5;color:#0e2233;color:var(--color-secondary)}.markdown .token.operator{background:0 0}.markdown>*+*{margin-top:0;margin-bottom:1rem}.markdown li+li{margin-top:.25rem}.markdown li>p+p{margin-top:1.5rem;color:#158876;color:var(--color-primary)}.markdown img{margin:auto}.markdown a,.markdown strong{font-weight:600}.markdown strong a{font-weight:700}.markdown h1{font-size:2.25rem}.markdown h1,.markdown h2{border-color:#158876;border-color:var(--color-primary);line-height:1.25;border-bottom-width:1px;font-weight:600;margin-bottom:1rem;margin-top:1.5rem;padding-bottom:.5rem}.markdown h2{font-size:1.5rem}.markdown h3{line-height:1.375;font-size:1.125rem}.markdown h3,.markdown h4{border-color:#158876;border-color:var(--color-primary);font-weight:600;margin-bottom:1rem;margin-top:1.5rem}.markdown h4{line-height:1;font-size:1rem}.markdown h5{border-color:#158876;border-color:var(--color-primary)}.markdown h5,.markdown h6{line-height:1.25;font-size:.875rem;font-weight:600;margin-bottom:1rem;margin-top:1.5rem}.markdown blockquote,.markdown h6{--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity))}.markdown blockquote{font-size:1rem;border-left-width:4px;--border-opacity:1;border-color:#e2e8f0;border-color:rgba(226,232,240,var(--border-opacity));padding-left:1rem;padding-right:1rem;border-color:#158876;border-color:var(--color-primary)}.markdown code{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:.875rem;display:inline;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity));padding:.125rem .25rem;background-color:#ddd;background-color:var(--bg-code);color:#000}.markdown code,.markdown pre{--bg-opacity:1;border-radius:.25rem}.markdown pre{background-color:#f7fafc;background-color:rgba(247,250,252,var(--bg-opacity));padding:1rem}.markdown pre code{display:block;background-color:transparent;padding:0;overflow:visible;border-radius:0;color:#000}.markdown p{margin-bottom:10px}code[class*=language-],pre[class*=language-]{background:#ddd!important;background:var(--bg-code)!important;text-shadow:none!important}.markdown ul{list-style-type:disc}.markdown ol,.markdown ul{font-size:1rem;padding-left:2rem}.markdown ol{list-style-type:decimal}.markdown kbd{font-size:.75rem;display:inline-block;border-radius:.25rem;border-width:1px;padding:.125rem .25rem;vertical-align:middle;font-weight:400;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06)}.markdown table,td,th{font-size:1rem;border:1px solid #243746;border-color:var(--color)}.markdown table{overflow-x:scroll}.markdown td,.markdown th{border-width:1px;padding:.25rem .75rem}.markdown .highlight pre{--bg-opacity:1!important;background-color:#f7fafc!important;background-color:rgba(247,250,252,var(--bg-opacity))!important}.article-card{box-shadow:0 5px 10px 0 #0e2233;box-shadow:0 5px 10px 0 var(--color-secondary);transition:box-shadow .2s,transform .2s;height:100%}.article-card:hover{box-shadow:0 10px 40px 0 #0e2233;box-shadow:0 10px 40px 0 var(--color-secondary);transform:scale(1.025)}.blog-card-description,.blog-date{color:#0e2233;color:var(--color-secondary)}.blog-date{font-style:italic}hr{background-color:#243746;background-color:var(--color);border:none;height:1px}.menu-icon{background-color:#ddd;background-color:var(--border-color)}.menu-icon,.mobile-menu{color:#243746;color:var(--color)}.mobile-menu{background-color:#fff;background-color:var(--bg-secondary)}.btn{border-radius:1;border-color:#158876;border-color:var(--color-primary)}.btn:hover{background-color:#fff;background-color:var(--bg-secondary)}.hero{border-color:#158876;border-color:var(--color-primary)}.markdown{word-wrap:break-word}.markdown h2:before,.markdown h3:before{content:" ";margin-top:-85px;pointer-events:none}.markdown h2>a,.markdown h3>a{margin-left:1.25rem}.markdown h2>a:before,.markdown h3>a:before{content:"#";font-weight:400;font-size:1.25rem;line-height:2rem;margin-left:-1.25rem;padding-right:.5rem;position:absolute;opacity:1}@media (min-width:1024px){.markdown h2>a,.markdown h3>a{margin-left:0}.markdown h2>a:before,.markdown h3>a:before{opacity:0}}.markdown h2:hover>a:before,.markdown h3:hover>a:before{opacity:1}& pre[class*=language-]{--bg-opacity:1;background-color:#2d3748;background-color:rgba(45,55,72,var(--bg-opacity));position:static}.mc{background-color:#f3f5f4;background-color:var(--bg);border-color:#158876;border-color:var(--color-primary);border-width:1px;color:#158876;color:var(--color-primary);justify-content:center;padding:5px 10px;border-radius:5px;width:100%}.mc-btn{color:#fff;color:var(--bg-secondary);background-color:#0e2233;background-color:var(--color-secondary);cursor:pointer}.page-enter-active,.page-leave-active{transition:filter 2s linear;transition:margin-top .15s,opacity .15s}.page-enter,.page-leave-to{opacity:0;margin-top:5px}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.emoji-mart,.emoji-mart *{-webkit-box-sizing:border-box;box-sizing:border-box;line-height:1.15}.emoji-mart{font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",sans-serif;font-size:16px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:420px;color:#222427;border:1px solid #d9d9d9;border-radius:5px;background:#fff}.emoji-mart-emoji{padding:6px;border:none;background:0 0;-webkit-box-shadow:none;box-shadow:none}.emoji-mart-emoji span{display:inline-block}.emoji-mart-preview-emoji .emoji-mart-emoji span{width:38px;height:38px;font-size:32px}.emoji-type-native{font-family:"Segoe UI Emoji","Segoe UI Symbol","Segoe UI","Apple Color Emoji","Twemoji Mozilla","Noto Color Emoji","EmojiOne Color","Android Emoji";word-break:keep-all}.emoji-type-image{background-size:5700%}.emoji-type-image.emoji-set-apple{background-image:url(https://unpkg.com/emoji-datasource-apple@6.0.1/img/apple/sheets-256/64.png)}.emoji-type-image.emoji-set-facebook{background-image:url(https://unpkg.com/emoji-datasource-facebook@6.0.1/img/facebook/sheets-256/64.png)}.emoji-type-image.emoji-set-google{background-image:url(https://unpkg.com/emoji-datasource-google@6.0.1/img/google/sheets-256/64.png)}.emoji-type-image.emoji-set-twitter{background-image:url(https://unpkg.com/emoji-datasource-twitter@6.0.1/img/twitter/sheets-256/64.png)}.emoji-mart-bar{border:0 solid #d9d9d9}.emoji-mart-bar:first-child{border-bottom-width:1px;border-top-left-radius:5px;border-top-right-radius:5px}.emoji-mart-bar:last-child{border-top-width:1px;border-bottom-left-radius:5px;border-bottom-right-radius:5px}.emoji-mart-scroll{position:relative;overflow-y:scroll;-webkit-box-flex:1;-ms-flex:1;flex:1;padding:0 6px 6px;z-index:0;will-change:transform;-webkit-overflow-scrolling:touch}.emoji-mart-anchors{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:0 6px;color:#858585;line-height:0}.emoji-mart-anchor{position:relative;display:block;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;text-align:center;padding:12px 4px;overflow:hidden;-webkit-transition:color .1s ease-out;-o-transition:color .1s ease-out;transition:color .1s ease-out;border:none;background:0 0;-webkit-box-shadow:none;box-shadow:none}.emoji-mart-anchor-selected,.emoji-mart-anchor:hover{color:#464646}.emoji-mart-anchor-selected .emoji-mart-anchor-bar{bottom:0}.emoji-mart-anchor-bar{position:absolute;bottom:-3px;left:0;width:100%;height:3px;background-color:#464646}.emoji-mart-anchors i{display:inline-block;width:100%;max-width:22px}.emoji-mart-anchors svg{fill:currentColor;max-height:18px}.emoji-mart .scroller{height:250px;position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1;padding:0 6px 6px;z-index:0;will-change:transform;-webkit-overflow-scrolling:touch}.emoji-mart-search{margin-top:6px;padding:0 6px}.emoji-mart-search input{font-size:16px;display:block;width:100%;padding:.2em .6em;border-radius:25px;border:1px solid #d9d9d9;outline:0}.emoji-mart-search-results{height:250px;overflow-y:scroll}.emoji-mart-category{position:relative}.emoji-mart-category .emoji-mart-emoji span{z-index:1;position:relative;text-align:center;cursor:default}.emoji-mart-category .emoji-mart-emoji:hover:before,.emoji-mart-emoji-selected:before{z-index:0;content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-color:#f4f4f4;border-radius:100%;opacity:0;opacity:1}.emoji-mart-category-label{position:-webkit-sticky;position:sticky;top:0}.emoji-mart-static .emoji-mart-category-label{z-index:2;position:relative}.emoji-mart-category-label h3{display:block;font-size:16px;width:100%;font-weight:500;padding:5px 6px;background-color:#fff;background-color:hsla(0,0%,100%,.95)}.emoji-mart-emoji{position:relative;display:inline-block;font-size:0}.emoji-mart-no-results{font-size:14px;text-align:center;padding-top:70px;color:#858585}.emoji-mart-no-results .emoji-mart-category-label{display:none}.emoji-mart-no-results .emoji-mart-no-results-label{margin-top:.2em}.emoji-mart-no-results .emoji-mart-emoji:hover:before{content:none}.emoji-mart-preview{position:relative;height:70px}.emoji-mart-preview-data,.emoji-mart-preview-emoji,.emoji-mart-preview-skins{position:absolute;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%)}.emoji-mart-preview-emoji{left:12px}.emoji-mart-preview-data{left:68px;right:12px;word-break:break-all}.emoji-mart-preview-skins{right:30px;text-align:right}.emoji-mart-preview-name{font-size:14px}.emoji-mart-preview-shortname{font-size:12px;color:#888}.emoji-mart-preview-emoticon+.emoji-mart-preview-emoticon,.emoji-mart-preview-shortname+.emoji-mart-preview-emoticon,.emoji-mart-preview-shortname+.emoji-mart-preview-shortname{margin-left:.5em}.emoji-mart-preview-emoticon{font-size:11px;color:#bbb}.emoji-mart-title span{display:inline-block;vertical-align:middle}.emoji-mart-title .emoji-mart-emoji{padding:0}.emoji-mart-title-label{color:#999a9c;font-size:21px;font-weight:300}.emoji-mart-skin-swatches{font-size:0;padding:2px 0;border:1px solid #d9d9d9;border-radius:12px;background-color:#fff}.emoji-mart-skin-swatches-opened .emoji-mart-skin-swatch{width:16px;padding:0 2px}.emoji-mart-skin-swatches-opened .emoji-mart-skin-swatch-selected:after{opacity:.75}.emoji-mart-skin-swatch{display:inline-block;width:0;vertical-align:middle;-webkit-transition-property:width,padding;-o-transition-property:width,padding;transition-property:width,padding;-webkit-transition-duration:.125s;-o-transition-duration:.125s;transition-duration:.125s;-webkit-transition-timing-function:ease-out;-o-transition-timing-function:ease-out;transition-timing-function:ease-out}.emoji-mart-skin-swatch:first-child{-webkit-transition-delay:0s;-o-transition-delay:0s;transition-delay:0s}.emoji-mart-skin-swatch:nth-child(2){-webkit-transition-delay:.03s;-o-transition-delay:.03s;transition-delay:.03s}.emoji-mart-skin-swatch:nth-child(3){-webkit-transition-delay:.06s;-o-transition-delay:.06s;transition-delay:.06s}.emoji-mart-skin-swatch:nth-child(4){-webkit-transition-delay:.09s;-o-transition-delay:.09s;transition-delay:.09s}.emoji-mart-skin-swatch:nth-child(5){-webkit-transition-delay:.12s;-o-transition-delay:.12s;transition-delay:.12s}.emoji-mart-skin-swatch:nth-child(6){-webkit-transition-delay:.15s;-o-transition-delay:.15s;transition-delay:.15s}.emoji-mart-skin-swatch-selected{position:relative;width:16px;padding:0 2px}.emoji-mart-skin-swatch-selected:after{content:"";position:absolute;top:50%;left:50%;width:4px;height:4px;margin:-2px 0 0 -2px;background-color:#fff;border-radius:100%;pointer-events:none;opacity:0;-webkit-transition:opacity .2s ease-out;-o-transition:opacity .2s ease-out;transition:opacity .2s ease-out}.emoji-mart-skin{display:inline-block;width:100%;padding-top:100%;max-width:12px;border-radius:100%}.emoji-mart-skin-tone-1{background-color:#ffc93a}.emoji-mart-skin-tone-2{background-color:#fadcbc}.emoji-mart-skin-tone-3{background-color:#e0bb95}.emoji-mart-skin-tone-4{background-color:#bf8f68}.emoji-mart-skin-tone-5{background-color:#9b643d}.emoji-mart-skin-tone-6{background-color:#594539}.emoji-mart .vue-recycle-scroller{position:relative}.emoji-mart .vue-recycle-scroller.direction-vertical:not(.page-mode){overflow-y:auto}.emoji-mart .vue-recycle-scroller.direction-horizontal:not(.page-mode){overflow-x:auto}.emoji-mart .vue-recycle-scroller.direction-horizontal{display:-webkit-box;display:-ms-flexbox;display:flex}.emoji-mart .vue-recycle-scroller__slot{-webkit-box-flex:1;-ms-flex:auto 0 0px;flex:auto 0 0}.emoji-mart .vue-recycle-scroller__item-wrapper{-webkit-box-flex:1;-ms-flex:1;flex:1;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;position:relative}.emoji-mart .vue-recycle-scroller.ready .vue-recycle-scroller__item-view{position:absolute;top:0;left:0;will-change:transform}.emoji-mart .vue-recycle-scroller.direction-vertical .vue-recycle-scroller__item-wrapper{width:100%}.emoji-mart .vue-recycle-scroller.direction-horizontal .vue-recycle-scroller__item-wrapper{height:100%}.emoji-mart .vue-recycle-scroller.ready.direction-vertical .vue-recycle-scroller__item-view{width:100%}.emoji-mart .vue-recycle-scroller.ready.direction-horizontal .vue-recycle-scroller__item-view{height:100%}.emoji-mart .resize-observer[data-v-b329ee4c]{border:none;background-color:transparent;opacity:0}.emoji-mart .resize-observer[data-v-b329ee4c],.emoji-mart .resize-observer[data-v-b329ee4c] object{position:absolute;top:0;left:0;z-index:-1;width:100%;height:100%;pointer-events:none;display:block;overflow:hidden}.emoji-mart-search .hidden{display:none;visibility:hidden}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}html{font-family:"Source Sans Pro",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;font-size:16px;word-spacing:1px;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;box-sizing:border-box}*,:after,:before{box-sizing:border-box;margin:0}.button--green{display:inline-block;border-radius:4px;border:1px solid #3b8070;color:#3b8070;text-decoration:none;padding:10px 30px}.button--green:hover{color:#fff;background-color:#3b8070}.button--grey{display:inline-block;border-radius:4px;border:1px solid #35495e;color:#35495e;text-decoration:none;padding:10px 30px;margin-left:15px}.button--grey:hover{color:#fff;background-color:#35495e}span.emoji-mart-emoji[data-v-3f691362]{padding:0}.selected[data-v-3f691362]{text-shadow:.25px 0 0 #000}.picker[data-v-3f691362]{position:absolute;top:10px;margin-left:auto;margin-right:auto;transform:translate(50%,50%)}.top[data-v-3f691362]{width:100%;background-color:var(--color-primary);height:3px}.selected[data-v-107ae01e]{text-shadow:.9px 0 0}span.emoji-mart-emoji[data-v-288717a6]{padding:0;transition:transform .2s}span.emoji-mart-emoji[data-v-288717a6]:hover{transform:scale(1.3)}.centered[data-v-288717a6]{position:absolute;left:50vw;right:50vw;margin-left:auto;margin-right:auto}span.emoji-mart-emoji[data-v-4f7c5820]{padding:0}.modal[data-v-4f7c5820]{z-index:100000000;top:0;-webkit-backdrop-filter:blur(.4px);backdrop-filter:blur(.4px);background-color:rgba(0,0,0,.2)}.modal[data-v-4f7c5820],.picker[data-v-4f7c5820]{position:absolute;left:0}.picker[data-v-4f7c5820]{z-index:10000000000;right:0;margin-left:auto;margin-right:auto}.cover-image[data-v-4b9599ea]{transition:transform .2s}.cover-image[data-v-4b9599ea]:hover{transform:scale(1.025)}.tag[data-v-3fbcd028]{background-color:var(--color-primary);transition:transform .2s}.tag[data-v-3fbcd028]:hover{transform:scale(1.05)}</style><link rel="preload" href="/_nuxt/static/1656266236/2018/02/09/a-sample-django-news-app.html/state.js" as="script"><link rel="preload" href="/_nuxt/static/1656266236/2018/02/09/a-sample-django-news-app.html/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1656266236/manifest.js" as="script">
  </head>
  <body>
    <script data-n-head="ssr" data-hid="nuxt-color-mode-script" data-pbody="true">!function(){"use strict";var t=window,r=document,s=r.documentElement,n=["dark","light"],e=function(){for(var e="nuxt-color-mode=",t=r.cookie.split(";"),s=0;s<t.length;s++){for(var n=t[s];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(e))return n.substring(e.length,n.length)}return null}()||"system",a="system"===e?l():e;function c(e){e+="-mode";s.classList?s.classList.add(e):s.className+=" "+e}function o(e){return t.matchMedia("(prefers-color-scheme"+e+")")}function l(){if(t.matchMedia&&"not all"!==o("").media)for(var e of n)if(o(":"+e).matches)return e;return"light"}c(a),t.__NUXT_COLOR_MODE__={preference:e,value:a,getColorScheme:l,addClass:c,removeClass:function(e){e+="-mode";s.classList?s.classList.remove(e):s.className=s.className.replace(new RegExp(e,"g"),"")}}}()</script><div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><div data-v-3f691362><div class="top" data-v-3f691362></div> <div class="mx-auto flex py-2 px-2 sm:px-4 items-center max-w-6xl justify-center" data-v-3f691362><div class="justify-left flex-grow flex-cols-4" data-v-3f691362><a href="/" class="text-xl nuxt-link-active" data-v-3f691362><span class="hidden sm:inline text-2xl" data-v-3f691362>Brian Caffey</span><span class="inline sm:hidden" data-v-3f691362>JBC</span></a></div> <div class="flex-grow relative" data-v-3f691362><nav z-index="10000" data-v-107ae01e data-v-3f691362><div data-v-107ae01e><ul class="items-right float-right hidden md:flex" data-v-107ae01e><li class="px-4 text-lg" data-v-107ae01e><a href="/blog/1" data-v-107ae01e>
          Blog
        </a></li> <li class="px-4 text-lg" data-v-107ae01e><a href="/projects" data-v-107ae01e>
          Projects
        </a></li> <li class="px-4 text-lg" data-v-107ae01e><a href="/contact" data-v-107ae01e>
          Contact
        </a></li></ul> <div class="flex justify-end md:hidden z-1000" data-v-107ae01e><button class="flex items-center px-3 py-2 border rounded menu-icon" data-v-107ae01e><svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="fill-current h-3 w-3" data-v-107ae01e><title data-v-107ae01e>Menu</title> <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" data-v-107ae01e></path></svg></button></div> <!----></div></nav></div></div> <div class="picker" data-v-3f691362><div class="centered" data-v-288717a6 data-v-3f691362><div class="grid items-center justify-center" data-v-288717a6><ul class="flex px-4" data-v-288717a6><li class="md:px-1 px-1 cursor-pointer" data-v-288717a6><span aria-label="üñ•Ô∏è, desktop_computer" class="emoji-mart-emoji" data-v-288717a6><span class="emoji-set-apple emoji-type-image" style="background-position:52.63% 12.28%;width:32px;height:32px"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-288717a6><span aria-label="üåû, sun_with_face" class="emoji-mart-emoji" data-v-288717a6><span class="emoji-set-apple emoji-type-image" style="background-position:8.77% 77.19%;width:32px;height:32px"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-288717a6><span aria-label="üåö, new_moon_with_face" class="emoji-mart-emoji" data-v-288717a6><span class="emoji-set-apple emoji-type-image" style="background-position:8.77% 70.18%;width:32px;height:32px"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-288717a6><span aria-label="‚òï, coffee" class="emoji-mart-emoji" data-v-288717a6><span class="emoji-set-apple emoji-type-image" style="background-position:94.74% 8.77%;width:32px;height:32px"></span></span></li> <li class="md:px-1 px-1 cursor-pointer" data-v-288717a6><div data-v-4f7c5820 data-v-288717a6><!----> <ul data-v-4f7c5820><li class="md:px-1 px-1 cursor-pointer" data-v-4f7c5820><span aria-label="üá∫üá∏, us, flag-us" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:7.02% 68.42%;width:32px;height:32px"></span></span></li></ul> <div class="rounded-md z-10 picker" data-v-4f7c5820><div class="bg-white shadow-md rounded px-4 py-2 w-32 text" style="display:none" data-v-4f7c5820><a href="/2018/02/09/a-sample-django-news-app.html" aria-current="page" class="nuxt-link-exact-active nuxt-link-active" data-v-4f7c5820><span aria-label="üá∫üá∏, us, flag-us" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:7.02% 68.42%;width:16px;height:16px"></span></span> English <br data-v-4f7c5820></a><a href="/fr/2018/02/09/a-sample-django-news-app.html" data-v-4f7c5820><span aria-label="üá´üá∑, fr, flag-fr" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:1.75% 91.23%;width:16px;height:16px"></span></span> Fran√ßais <br data-v-4f7c5820></a><a href="/zh/2018/02/09/a-sample-django-news-app.html" data-v-4f7c5820><span aria-label="üá®üá≥, cn, flag-cn" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:1.75% 36.84%;width:16px;height:16px"></span></span> ÁÆÄ‰Ωì‰∏≠Êñá <br data-v-4f7c5820></a><a href="/ru/2018/02/09/a-sample-django-news-app.html" data-v-4f7c5820><span aria-label="üá∑üá∫, ru, flag-ru" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:5.26% 92.98%;width:16px;height:16px"></span></span> –†—É—Å—Å–∫–∏–π <br data-v-4f7c5820></a><a href="/jp/2018/02/09/a-sample-django-news-app.html" data-v-4f7c5820><span aria-label="üáØüáµ, jp, flag-jp" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:3.51% 59.65%;width:16px;height:16px"></span></span> Êó•Êú¨Ë™û <br data-v-4f7c5820></a><a href="/in/2018/02/09/a-sample-django-news-app.html" data-v-4f7c5820><span aria-label="üáÆüá≥, flag-in" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:3.51% 43.86%;width:16px;height:16px"></span></span> ‡§π‡§ø‡§Ç‡§¶‡•Ä <br data-v-4f7c5820></a></div></div></div></li></ul></div></div></div></div> <article data-v-4b9599ea><!----> <div class="mx-auto max-w-5xl px-2 sm:px-4 md:px-4 lg:px-16 mt-2" data-v-4b9599ea><h1 class="prose text-3xl leading-9" data-v-4b9599ea>
      Detailed setup of a mini Django News App project with Bootstrap, AJAX, Celery and RabbitMQ
    </h1> <div class="flex flex-wrap -ml-1 py-2" data-v-21780fb6 data-v-4b9599ea><a href="/blog/tags/django" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    django üè∑Ô∏è
    <!----></div></a></div> <!----> <p class="blog-date text-gray-500 mb-4" data-v-4b9599ea>
      Last Updated on
      February 9, 2018
    </p> <!----> <div class="markdown nuxt-content" data-v-4b9599ea data-v-4b9599ea><p data-v-4b9599ea data-v-4b9599ea>The Django project started in the news room. This article will offer detailed documentation of the setup process for a simple news application. This project was given as a takehome assignment for another Django position I am interview for. I won't focus on any production considerations as this is only a demo project that is supposed to work locally.</p>
<p data-v-4b9599ea data-v-4b9599ea>For reference, the code is on <a href="https://github.com/briancaffey/django-news-app" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>this Github repository</a>.</p>
<h2 id="requirements" data-v-4b9599ea data-v-4b9599ea><a href="#requirements" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Requirements</h2>
<p data-v-4b9599ea data-v-4b9599ea>This project included some interesting requirements that were outside of the scope of simple apps I have put together with Django. Two import ones were page caching and using celery to execute tasks asynchronously. I also set up a unit tests and functional tests and tested the core functionalities of the application. Here are some the basic requirements:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>Implement a news model with fields such as title, body, content, author, etc.</li>
<li data-v-4b9599ea data-v-4b9599ea>Display published posts on a page styled with Bootstrap</li>
<li data-v-4b9599ea data-v-4b9599ea>Implement and admin page that allows staff to create and publish posts</li>
<li data-v-4b9599ea data-v-4b9599ea>Cache the public facing home page</li>
<li data-v-4b9599ea data-v-4b9599ea>On the home page use jQuery to poll a URL for updates, and refresh the page if an update is found.</li>
<li data-v-4b9599ea data-v-4b9599ea>Add a button on the public facing page that when pressed launches a celery task that send an email to the site admin.</li>
</ul>
<h2 id="release-notes-and-code-snippets" data-v-4b9599ea data-v-4b9599ea><a href="#release-notes-and-code-snippets" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Release Notes and code snippets</h2>
<p data-v-4b9599ea data-v-4b9599ea>Here's a quick description of the design decisions I made for the various specifications with code snippets:</p>
<h4 id="post-model" data-v-4b9599ea data-v-4b9599ea><a href="#post-model" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Post Model</h4>
<p data-v-4b9599ea data-v-4b9599ea>For the Post model I decided to use two DateTimeFields: <code data-v-4b9599ea data-v-4b9599ea>updated</code> and <code data-v-4b9599ea data-v-4b9599ea>timestamp</code>. <code data-v-4b9599ea data-v-4b9599ea>timestamp</code> is the public-facing time that shows on each article. <code data-v-4b9599ea data-v-4b9599ea>updated</code> is changed when a publish or unpublish action is taken on a Post.</p>
<p data-v-4b9599ea data-v-4b9599ea>When a <code data-v-4b9599ea data-v-4b9599ea>POST</code> request is made to the <code data-v-4b9599ea data-v-4b9599ea>toggle_publish</code> view, three things happen:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>The Post's <code data-v-4b9599ea data-v-4b9599ea>published</code> field is toggled and the Post's <code data-v-4b9599ea data-v-4b9599ea>updated</code> field is set to the current time.</p>
</li>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>The only record in <code data-v-4b9599ea data-v-4b9599ea>LastUpdate</code> is updated. This model only contains a <code data-v-4b9599ea data-v-4b9599ea>DateTimeField</code> also called <code data-v-4b9599ea data-v-4b9599ea>updated</code>.</p>
</li>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>The cache is cleared, clearing any pages cached from the <code data-v-4b9599ea data-v-4b9599ea>home</code> view.</p>
</li>
</ul>
<h4 id="home-page" data-v-4b9599ea data-v-4b9599ea><a href="#home-page" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Home Page</h4>
<p data-v-4b9599ea data-v-4b9599ea>For the public facing home page, I return a list of Posts where <code data-v-4b9599ea data-v-4b9599ea>published</code> is set to <code data-v-4b9599ea data-v-4b9599ea>True</code> and also return a UNIX time epoch of the Post with the most recent <code data-v-4b9599ea data-v-4b9599ea>updated</code> field.</p>
<p data-v-4b9599ea data-v-4b9599ea><em data-v-4b9599ea data-v-4b9599ea>views.py</em></p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-python" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea><span class="token decorator annotation punctuation" data-v-4b9599ea data-v-4b9599ea>@cache_page</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token boolean" data-v-4b9599ea data-v-4b9599ea>None</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>def</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>home</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>request<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
    <span class="token triple-quoted-string string" data-v-4b9599ea data-v-4b9599ea>"""
    This is the public view that displays only published posts.
    The view also returns a UNIX timestamp of the most recently updated post.
    This timestamp is compared with the `LastUpdate` value to determine when the page should be refreshed.
    Every 5 seconds, the `latest` timestamp is compared with the `LastUpdate` timestamp.
    If `LastUpdate` is greater that `latest`, this implies that a Post has either been published or unpublished.
    """</span>

    posts <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> Post<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>objects<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span><span class="token builtin" data-v-4b9599ea data-v-4b9599ea>filter</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>published<span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span><span class="token boolean" data-v-4b9599ea data-v-4b9599ea>True</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
    latest <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token number" data-v-4b9599ea data-v-4b9599ea>0</span>
    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>if</span> posts<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
        latest <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> Post<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>objects<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>latest<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'updated'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>unix_time<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>return</span> render<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>request<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'posts/home.html'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>{</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'posts'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>posts<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'latest'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>latest<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>}</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
</code></pre></div>
<h4 id="ajax-poll-on-home-page" data-v-4b9599ea data-v-4b9599ea><a href="#ajax-poll-on-home-page" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>AJAX poll on home page</h4>
<p data-v-4b9599ea data-v-4b9599ea>I use an AJAX poll that returns a JSON response containing the <code data-v-4b9599ea data-v-4b9599ea>updated</code> field of <code data-v-4b9599ea data-v-4b9599ea>LastUpdate</code> as a UNIX time epoch called <code data-v-4b9599ea data-v-4b9599ea>latest</code>. I compare this UNIX time epoch with the the UNIX time epoch returned with context data in <code data-v-4b9599ea data-v-4b9599ea>home</code>. If the <code data-v-4b9599ea data-v-4b9599ea>latest</code> value is greater than the the UNIX time stamp of the most recently updated article, then the page is reloaded. At this point, the cache will have been cleared by <code data-v-4b9599ea data-v-4b9599ea>toggle_publish</code>, and the new Posts are displayed.</p>
<p data-v-4b9599ea data-v-4b9599ea><em data-v-4b9599ea data-v-4b9599ea>home.html</em> (AJAX poll)</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-html" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea><span class="token tag" data-v-4b9599ea data-v-4b9599ea><span class="token tag" data-v-4b9599ea data-v-4b9599ea><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>&lt;</span>script</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>></span></span><span class="token script" data-v-4b9599ea data-v-4b9599ea><span class="token language-javascript" data-v-4b9599ea data-v-4b9599ea>
    <span class="token console class-name" data-v-4b9599ea data-v-4b9599ea>console</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span><span class="token method function property-access" data-v-4b9599ea data-v-4b9599ea>log</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>"working"</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
    <span class="token function-variable function" data-v-4b9599ea data-v-4b9599ea>poll</span> <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>function</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span> <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>{</span>
        $<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span><span class="token method function property-access" data-v-4b9599ea data-v-4b9599ea>ajax</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>{</span>
        url<span class="token operator" data-v-4b9599ea data-v-4b9599ea>:</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'/refresh'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span>
        dataType<span class="token operator" data-v-4b9599ea data-v-4b9599ea>:</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'json'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span>
        type<span class="token operator" data-v-4b9599ea data-v-4b9599ea>:</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'get'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span>
        <span class="token function-variable function" data-v-4b9599ea data-v-4b9599ea>success</span><span class="token operator" data-v-4b9599ea data-v-4b9599ea>:</span> <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>function</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token parameter" data-v-4b9599ea data-v-4b9599ea>data</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span> <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>{</span>
            <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>var</span> latest <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>parseInt</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>data<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span><span class="token property-access" data-v-4b9599ea data-v-4b9599ea>latest</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
            <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>var</span> latest_local <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>parseInt</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token function" data-v-4b9599ea data-v-4b9599ea>$</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>"#last"</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span><span class="token method function property-access" data-v-4b9599ea data-v-4b9599ea>attr</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'data'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
            <span class="token keyword control-flow" data-v-4b9599ea data-v-4b9599ea>if</span> <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>latest <span class="token operator" data-v-4b9599ea data-v-4b9599ea>></span> latest_local <span class="token operator" data-v-4b9599ea data-v-4b9599ea>+</span> <span class="token number" data-v-4b9599ea data-v-4b9599ea>2</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>{</span>
                <span class="token dom variable" data-v-4b9599ea data-v-4b9599ea>location</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span><span class="token method function property-access" data-v-4b9599ea data-v-4b9599ea>reload</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
            <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>}</span>
        <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>}</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span>
        <span class="token function-variable function" data-v-4b9599ea data-v-4b9599ea>error</span><span class="token operator" data-v-4b9599ea data-v-4b9599ea>:</span> <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>function</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span> <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>{</span>
            <span class="token console class-name" data-v-4b9599ea data-v-4b9599ea>console</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span><span class="token method function property-access" data-v-4b9599ea data-v-4b9599ea>log</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'The refresh poll was not successful'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>;</span>
        <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>}</span>
        <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>}</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>;</span>
    <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>}</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span>
    pollInterval <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>setInterval</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token keyword" data-v-4b9599ea data-v-4b9599ea>function</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span> <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>{</span>
        <span class="token function" data-v-4b9599ea data-v-4b9599ea>poll</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>;</span>
        <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>}</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> <span class="token number" data-v-4b9599ea data-v-4b9599ea>5000</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>;</span>
</span></span><span class="token tag" data-v-4b9599ea data-v-4b9599ea><span class="token tag" data-v-4b9599ea data-v-4b9599ea><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>&lt;/</span>script</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>></span></span>
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea><em data-v-4b9599ea data-v-4b9599ea>views.py</em> (the view that the AJAX poll requests; return JSON)</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-python" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea><span class="token keyword" data-v-4b9599ea data-v-4b9599ea>def</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>refresh</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>request<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
    <span class="token triple-quoted-string string" data-v-4b9599ea data-v-4b9599ea>"""
    This is the URL that is polled by the public-facing page.
    It returns a UNIX timestamp of the last time an article was published or unpublished.
    This timestamp comes from the `LastUpdated`, a table that stores and updates only one row with one datetime column.
    Publishing and unpublishing are the only two actions that clear the cached homepage.
    When the returned UNIX timestamp is greater than the UNIX timestamp of the most recently updated article,
    The page is refreshed with `location.reload()`.
    """</span>

    t<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> created <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> LastUpdate<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>objects<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>get_or_create<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token builtin" data-v-4b9599ea data-v-4b9599ea>id</span><span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span><span class="token number" data-v-4b9599ea data-v-4b9599ea>1</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>if</span> created<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
        t<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>save<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        t <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> t<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>unix_time<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>else</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
        t <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> t<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>unix_time<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
    latest <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token builtin" data-v-4b9599ea data-v-4b9599ea>int</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>t<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span> <span class="token operator" data-v-4b9599ea data-v-4b9599ea>-</span> <span class="token number" data-v-4b9599ea data-v-4b9599ea>2</span>
    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>return</span> JsonResponse<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>{</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'latest'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span><span class="token builtin" data-v-4b9599ea data-v-4b9599ea>int</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>latest<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>}</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
</code></pre></div>
<h4 id="email-admin-through-a-celery-task" data-v-4b9599ea data-v-4b9599ea><a href="#email-admin-through-a-celery-task" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Email admin through a celery task</h4>
<p data-v-4b9599ea data-v-4b9599ea>The email feature is functional, but the button returns a JSON response that says "successful" if the message was sent to celery. My plan was to make another AJAX call and then updated the <code data-v-4b9599ea data-v-4b9599ea>Email Admin</code> link to say <code data-v-4b9599ea data-v-4b9599ea>Your email was sent.</code> if it the task was sent the messaging service.</p>
<p data-v-4b9599ea data-v-4b9599ea>For details on how celery can be set up with a Django project, I reference on of my favorite Django blogs, <a href="https://simpleisbetterthancomplex.com/tutorial/2017/08/20/how-to-use-celery-with-django.html" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>simpleisbetterthancomplex.com</a>. This article shows how to set up celery in a Django project and my set up almost exactly mirrors this setup, but my celery task simply sends an email.</p>
<h4 id="admin-page" data-v-4b9599ea data-v-4b9599ea><a href="#admin-page" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Admin Page</h4>
<p data-v-4b9599ea data-v-4b9599ea>The admin page contains a list of all articles. Each article contains a link to manage publish settings. This calls the <code data-v-4b9599ea data-v-4b9599ea>toggle_publish</code> page that displays the selected article and contains a button that says <code data-v-4b9599ea data-v-4b9599ea>Publish</code> or <code data-v-4b9599ea data-v-4b9599ea>Unpublish</code> depending on the value of the Post's <code data-v-4b9599ea data-v-4b9599ea>published</code> value.</p>
<h4 id="cache" data-v-4b9599ea data-v-4b9599ea><a href="#cache" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Cache</h4>
<p data-v-4b9599ea data-v-4b9599ea>For caching I chose the memcached backend. Other options included using file caching and database caching, but this seemed to be the simplest approach. I used a decorator function to cache the results of the <code data-v-4b9599ea data-v-4b9599ea>home</code> view.</p>
<p data-v-4b9599ea data-v-4b9599ea>Here are some additional notes on how I used caching in this project:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>To cache a page from the <code data-v-4b9599ea data-v-4b9599ea>home</code> view, I used a decorator: <code data-v-4b9599ea data-v-4b9599ea>from django.views.decorators.cache import cache_page</code>:</li>
</ul>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-python" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea><span class="token decorator annotation punctuation" data-v-4b9599ea data-v-4b9599ea>@cache_page</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token boolean" data-v-4b9599ea data-v-4b9599ea>None</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>def</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>home</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>request<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
    <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>[</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>]</span>
</code></pre></div>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>We pass the argument of <code data-v-4b9599ea data-v-4b9599ea>None</code> so that the page cache does not expire; we will manually clear the cache when a staff member publishes an article.</p>
</li>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>The first time we access the <code data-v-4b9599ea data-v-4b9599ea>home</code> view, we will see our print statement, in subsequent requests, the cached page will be used and we will not see the print statement.</p>
</li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>In order for caching to work we need to add the following to <code data-v-4b9599ea data-v-4b9599ea>settings.py</code>:</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-python" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>CACHES <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>{</span>
    <span class="token string" data-v-4b9599ea data-v-4b9599ea>'default'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span> <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>{</span>
        <span class="token string" data-v-4b9599ea data-v-4b9599ea>'BACKEND'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'django.core.cache.backends.memcached.MemcachedCache'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span>
        <span class="token string" data-v-4b9599ea data-v-4b9599ea>'LOCATION'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'127.0.0.1:11211'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span>
    <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>}</span>
<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>}</span>
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea>Next, we need to install the following packages:</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-text" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>(virtualenv) $ pip install memcache
# pacman -S memcached
# systemctl start memcached
# systemctl enable memcached
</code></pre></div>
<h5 id="clearing-the-cache" data-v-4b9599ea data-v-4b9599ea><a href="#clearing-the-cache" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Clearing the cache</h5>
<p data-v-4b9599ea data-v-4b9599ea>To clear the cache, we can simply do the following in a view:</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-python" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea><span class="token keyword" data-v-4b9599ea data-v-4b9599ea>from</span> django<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>core<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>cache <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>import</span> cache

<span class="token decorator annotation punctuation" data-v-4b9599ea data-v-4b9599ea>@login_required</span>
<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>def</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>toggle_publish</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>request<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span><span class="token builtin" data-v-4b9599ea data-v-4b9599ea>id</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
    instance <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> get_object_or_404<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>Post<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> <span class="token builtin" data-v-4b9599ea data-v-4b9599ea>id</span><span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span><span class="token builtin" data-v-4b9599ea data-v-4b9599ea>id</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>if</span> request<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>method<span class="token operator" data-v-4b9599ea data-v-4b9599ea>==</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>"POST"</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
        instance<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>published <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>not</span> instance<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>published
        instance<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>save<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

        t <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> LastUpdate<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>objects<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span><span class="token builtin" data-v-4b9599ea data-v-4b9599ea>all</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>first<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        t<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>updated <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> instance<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>updated
        t<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>save<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

        cache<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>clear<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>return</span> redirect<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'posts:home'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

    context <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>{</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'post'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>instance<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>}</span>

    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>return</span> render<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>request<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'posts/publish.html'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> context<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>cache.clear()</code> clears the cache, and the <code data-v-4b9599ea data-v-4b9599ea>home</code> view is regenerated from the Queryset and template rather the being served directly from the cache. This newly generated page is then saved to the cache and used on subsequent calls to <code data-v-4b9599ea data-v-4b9599ea>home</code> until the cache is cleared again.</p>
<h2 id="basic-setup" data-v-4b9599ea data-v-4b9599ea><a href="#basic-setup" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Basic setup</h2>
<p data-v-4b9599ea data-v-4b9599ea>Here are the first steps need to set up the project correctly:</p>
<p data-v-4b9599ea data-v-4b9599ea>First, let's start with creating a virtual environment:</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-text" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>$ virtualenv -p python3 virtualenv
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea>Next, let's activate the virtual environment with:</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-text" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>$ source virtualenv/bin/activate
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea>Next, let's install <code data-v-4b9599ea data-v-4b9599ea>django</code> and <code data-v-4b9599ea data-v-4b9599ea>selenium</code>:</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-text" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>(virtualenv) $ pip install django selenium
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea>Next, let's start our app:</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-text" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>(virtualenv) $ django-admin.py startproject news .
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea>The <code data-v-4b9599ea data-v-4b9599ea>.</code> will start the project in the current environment. Let's take a look at the directory structure:</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-text" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>(virtualenv) $ tree -L 2
 $ tree -L 2
.
‚îú‚îÄ‚îÄ manage.py
‚îú‚îÄ‚îÄ news
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ settings.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ urls.py
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ wsgi.py
‚îî‚îÄ‚îÄ virtualenv
    ‚îú‚îÄ‚îÄ bin
    ‚îú‚îÄ‚îÄ include
    ‚îú‚îÄ‚îÄ lib
    ‚îú‚îÄ‚îÄ pip-selfcheck.json
    ‚îî‚îÄ‚îÄ selenium
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea>At this point, we can start the local server:</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-text" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>(virtualenv) $ python manage.py runserver
Performing system checks...

System check identified no issues (0 silenced).

You have 14 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.
Run 'python manage.py migrate' to apply them.

February 10, 2018 - 02:16:47
Django version 2.0.2, using settings 'news.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea>Now we should see the new Django 2 startup screen in our browser if we navigate to <a href="" data-v-4b9599ea data-v-4b9599ea>http://127.0.0.1:8000/</a>:</p>
<p data-v-4b9599ea data-v-4b9599ea><img alt="png" src="/static/news/django2.png" data-v-4b9599ea data-v-4b9599ea></p>
<h2 id="testing" data-v-4b9599ea data-v-4b9599ea><a href="#testing" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Testing</h2>
<p data-v-4b9599ea data-v-4b9599ea>I had a few difficulties setting up selenium testing with this projects. Here the <code data-v-4b9599ea data-v-4b9599ea>functional_tests.py</code> file that is hopefully configured correctly:</p>
<p data-v-4b9599ea data-v-4b9599ea><strong data-v-4b9599ea data-v-4b9599ea>functional_tests.py</strong></p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="line-numbers language-python" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea><span class="token keyword" data-v-4b9599ea data-v-4b9599ea>from</span> selenium <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>import</span> webdriver
<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>from</span> django<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>conf <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>import</span> settings

<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>import</span> os
os<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>environ<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>setdefault<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'DJANGO_SETTINGS_MODULE'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'news.settings'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>from</span> django<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>test <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>import</span> LiveServerTestCase
<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>import</span> unittest
<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>import</span> time
<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>import</span> factory

<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>from</span> django<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>contrib<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>auth <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>import</span> get_user_model
<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>from</span> selenium <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>import</span> webdriver

User <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> get_user_model<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>class</span> <span class="token class-name" data-v-4b9599ea data-v-4b9599ea>UserFactory</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>factory<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>DjangoModelFactory<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
    <span class="token triple-quoted-string string" data-v-4b9599ea data-v-4b9599ea>"""This class sets up a staff user that we can use for testing using factory"""</span>

    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>class</span> <span class="token class-name" data-v-4b9599ea data-v-4b9599ea>Meta</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
        model <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> User

    email <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'brian@djangonews.com'</span>
    username <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'brian1'</span>
    password <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> factory<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>PostGenerationMethodCall<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'set_password'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'qwer1234'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

    is_superuser <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token boolean" data-v-4b9599ea data-v-4b9599ea>True</span>
    is_staff <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token boolean" data-v-4b9599ea data-v-4b9599ea>True</span>
    is_active <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token boolean" data-v-4b9599ea data-v-4b9599ea>True</span>

<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>class</span> <span class="token class-name" data-v-4b9599ea data-v-4b9599ea>NewsAppTest</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>LiveServerTestCase<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
    <span class="token triple-quoted-string string" data-v-4b9599ea data-v-4b9599ea>"""Main Tests"""</span>

    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>def</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>setUp</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> webdriver<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>Firefox<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>domain <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>'http://127.0.0.1:8081'</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>user <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> UserFactory<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>create<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>def</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>tearDown</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>quit<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>


    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>def</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>test_page_title_is_correct</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>get<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>domain<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>assertIn<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'Django News'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>title<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>


    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>def</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>test_staff_can_create_and_publish_article</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
        <span class="token triple-quoted-string string" data-v-4b9599ea data-v-4b9599ea>"""
        Tests the core functionality of a staff member loging in, creating an article, then publishing that article
        """</span>

        <span class="token comment" data-v-4b9599ea data-v-4b9599ea># staff logs into admin page</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>get<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>domain<span class="token operator" data-v-4b9599ea data-v-4b9599ea>+</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>"/admin"</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>find_element_by_id<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'id_username'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>send_keys<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'brian1'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>find_element_by_id<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'id_password'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>send_keys<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'qwer1234'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>find_element_by_class_name<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'submit-row'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>click<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

        <span class="token comment" data-v-4b9599ea data-v-4b9599ea># navigate to homepage</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>get<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>domain<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        time<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>sleep<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token number" data-v-4b9599ea data-v-4b9599ea>2</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

        <span class="token comment" data-v-4b9599ea data-v-4b9599ea># navigate to new article page and write sample article</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>find_element_by_id<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'new-article'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>click<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        html <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token builtin" data-v-4b9599ea data-v-4b9599ea>str</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>page_source<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>encode<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'utf-8'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>assertIn<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'Write your Django News article here'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> html<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>find_element_by_id<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'id_title'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>send_keys<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'testing with selenium'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>find_element_by_id<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'id_content'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>send_keys<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'about testing with selenium'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>find_element_by_id<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'id_submit'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>click<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        html <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token builtin" data-v-4b9599ea data-v-4b9599ea>str</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>page_source<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>encode<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'utf-8'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>assertIn<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'publish settings'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> html<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

        <span class="token comment" data-v-4b9599ea data-v-4b9599ea># go back to home page and check that the article is not displayed</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>get<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>domain<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        html <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token builtin" data-v-4b9599ea data-v-4b9599ea>str</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>page_source<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>encode<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'utf-8'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>assertNotIn<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'testing with selenium'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> html<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>back<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>find_element_by_id<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'toggle-publish'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>click<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        html <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> <span class="token builtin" data-v-4b9599ea data-v-4b9599ea>str</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>browser<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>page_source<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>encode<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'utf-8'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>assertIn<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>'testing with selenium'</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> html<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

    <span class="token keyword" data-v-4b9599ea data-v-4b9599ea>def</span> <span class="token function" data-v-4b9599ea data-v-4b9599ea>test_public_page_reloads_when_article_is_published</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
        browser2 <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> webdriver<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>Firefox<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        browser2<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>get<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>domain<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        html <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> browser2<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>page_source
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>test_staff_can_create_and_publish_article<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        time<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>sleep<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token number" data-v-4b9599ea data-v-4b9599ea>2</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        browser2<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>get<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>domain<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        html_after_publish <span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span> browser2<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>page_source
        self<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>assertNotEqual<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>html<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>,</span> html_after_publish<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
        browser2<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>quit<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>

<span class="token keyword" data-v-4b9599ea data-v-4b9599ea>if</span> __name__ <span class="token operator" data-v-4b9599ea data-v-4b9599ea>==</span> <span class="token string" data-v-4b9599ea data-v-4b9599ea>"__main__"</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>:</span>
    unittest<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>.</span>main<span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>(</span>warnings<span class="token operator" data-v-4b9599ea data-v-4b9599ea>=</span><span class="token string" data-v-4b9599ea data-v-4b9599ea>"ignore"</span><span class="token punctuation" data-v-4b9599ea data-v-4b9599ea>)</span>
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea>I used the package called <code data-v-4b9599ea data-v-4b9599ea>factory_boy</code> to setup create a user that I could use in my test. This project didn't include a staff registration page, so to test regular staff functionality I used <code data-v-4b9599ea data-v-4b9599ea>factory</code> to create a dummy user that can login and perform tasks.</p>
<p data-v-4b9599ea data-v-4b9599ea>For the full repo, please find it on my github account: <a href="https://github.com/briancaffey/django-news-app" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>https://github.com/briancaffey/django-news-app</a>.</p></div> <div class="text-center pb-4 pt-8" data-v-4b9599ea><button class="mc-btn rounded py-1 px-2" data-v-4b9599ea>
        Show Disqus Comments üí¨
      </button></div> <!----> <h1 data-v-4b9599ea></h1></div></article> <div class="mx-auto max-w-6xl p-4 lg:px-16 text-center" data-v-27f2d9d4><hr class="mt-4" data-v-27f2d9d4> <div class="mx-auto py-4" data-v-27f2d9d4><div class="pb-4" data-v-27f2d9d4>
      Join my mailing list to get updated whenever I publish a new article.
    </div> <div class="mx-auto" data-v-89248ae4 data-v-27f2d9d4><div id="mc_embed_signup" class="mx-auto w-full md:w-1/2" data-v-89248ae4><form id="mc-embedded-subscribe-form" action="https://github.us2.list-manage.com/subscribe/post?u=43a795784ca963e25903a0da6&id=9937fe4fc5" method="post" name="mc-embedded-subscribe-form" target="_blank" novalidate class="validate" data-v-89248ae4><div id="mc_embed_signup_scroll" class="grid grid-cols-1 sm:grid-cols-2 gap-4 items-center" data-v-89248ae4><input id="mce-EMAIL" type="email" name="EMAIL" placeholder="Enter your email address" class="rounded mc text-center" data-v-89248ae4> <div aria-hidden="true" style="position:absolute;left:-5000px" data-v-89248ae4><input name="b_43a795784ca963e25903a0da6_9937fe4fc5" tabindex="-1" data-v-89248ae4></div> <div data-v-89248ae4><input id="mc-embedded-subscribe" type="submit" name="subscribe" value="Subscribe" class="mc-btn rounded px-2 py-1 w-full" data-v-89248ae4></div></div></form></div></div></div> <hr data-v-27f2d9d4> <div class="py-4" data-v-27f2d9d4>
    Thanks for checking out my site!
  </div> <div class="pb-4" data-v-27f2d9d4>
    ¬© 2021 Brian Caffey
  </div></div></div></div></div><script defer src="/_nuxt/static/1656266236/2018/02/09/a-sample-django-news-app.html/state.js"></script><script src="/_nuxt/e9c2366.js" defer></script><script src="/_nuxt/b5afa39.js" defer></script><script src="/_nuxt/9ee0ef6.js" defer></script><script src="/_nuxt/f51c3d4.js" defer></script><script src="/_nuxt/0f451e7.js" defer></script>
  </body>
</html>
