<!DOCTYPE html><html  lang="en" data-capo=""><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Display, filter and export geographical data in a Django app with Leaflet, Mapbox, DataTables, Bootstrap 4 and Travis-CI</title>
<style>/*! tailwindcss v3.4.9 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.visible{visibility:visible}.collapse{visibility:collapse}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0}.right-0{right:0}.top-0{top:0}.isolate{isolation:isolate}.z-10{z-index:10}.float-right{float:right}.m-2{margin:.5rem}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-auto{margin-left:auto;margin-right:auto}.my-4{margin-bottom:1rem;margin-top:1rem}.-ml-1{margin-left:-.25rem}.mb-1{margin-bottom:.25rem}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.mt-8{margin-top:2rem}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.table{display:table}.grid{display:grid}.contents{display:contents}.hidden{display:none}.h-12{height:3rem}.h-3{height:.75rem}.h-32{height:8rem}.h-64{height:16rem}.w-12{width:3rem}.w-3{width:.75rem}.w-32{width:8rem}.w-full{width:100%}.max-w-5xl{max-width:64rem}.max-w-6xl{max-width:72rem}.flex-1{flex:1 1 0%}.flex-shrink{flex-shrink:1}.flex-grow,.grow{flex-grow:1}.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.resize{resize:both}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.gap-16{gap:4rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.rounded{border-radius:.25rem}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.rounded-t-lg{border-top-left-radius:.5rem;border-top-right-radius:.5rem}.border{border-width:1px}.border-white{--tw-border-opacity:1;border-color:rgb(255 255 255/var(--tw-border-opacity))}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0/var(--tw-bg-opacity))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231/var(--tw-bg-opacity))}.bg-red-300{--tw-bg-opacity:1;background-color:rgb(252 165 165/var(--tw-bg-opacity))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity))}.fill-current{fill:currentColor}.object-cover{-o-object-fit:cover;object-fit:cover}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-16{padding-left:4rem;padding-right:4rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-1{padding-bottom:.25rem;padding-top:.25rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-3{padding-bottom:.75rem;padding-top:.75rem}.py-32{padding-bottom:8rem;padding-top:8rem}.py-4{padding-bottom:1rem;padding-top:1rem}.py-8{padding-bottom:2rem;padding-top:2rem}.pb-2{padding-bottom:.5rem}.pb-4{padding-bottom:1rem}.pb-8{padding-bottom:2rem}.pr-4{padding-right:1rem}.pt-16{padding-top:4rem}.pt-2{padding-top:.5rem}.pt-8{padding-top:2rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem}.text-lg,.text-xl{line-height:1.75rem}.text-xl{font-size:1.25rem}.font-bold{font-weight:700}.uppercase{text-transform:uppercase}.leading-8{line-height:2rem}.leading-9{line-height:2.25rem}.text-black{--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128/var(--tw-text-opacity))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38/var(--tw-text-opacity))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.antialiased{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.shadow{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color)}.shadow,.shadow-xl{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 8px 10px -6px rgba(0,0,0,.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color),0 8px 10px -6px var(--tw-shadow-color)}.outline{outline-style:solid}.ring{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(3px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.grayscale{--tw-grayscale:grayscale(100%)}.grayscale,.sepia{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.sepia{--tw-sepia:sepia(100%)}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-all{transition-duration:.15s;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.delay-150{transition-delay:.15s}.duration-150{transition-duration:.15s}.\[program\:django-leaflet-demo\]{program:django-leaflet-demo}@media (min-width:640px){.sm\:inline{display:inline}.sm\:hidden{display:none}.sm\:w-2\/3{width:66.666667%}.sm\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.sm\:px-4{padding-left:1rem;padding-right:1rem}.sm\:py-16{padding-bottom:4rem;padding-top:4rem}}@media (min-width:768px){.md\:flex{display:flex}.md\:hidden{display:none}.md\:w-1\/2{width:50%}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.md\:px-1{padding-left:.25rem;padding-right:.25rem}.md\:px-4{padding-left:1rem;padding-right:1rem}}@media (min-width:1024px){.lg\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.lg\:px-16{padding-left:4rem;padding-right:4rem}.lg\:px-32{padding-left:8rem;padding-right:8rem}}</style>
<style>:root{--color:#243746;--color-primary:#158876;--color-secondary:#0e2233;--bg:#f3f5f4;--bg-secondary:#fff;--bg-code:#ddd;--border-color:#ddd;--color-tag:#2e604e;--color-title:#2e604e}.dark-mode{--color:#ebf4f1;--color-primary:#41b38a;--color-secondary:#fdf9f3;--bg:#091a28;--bg-secondary:#071521;--bg-code:#ddd;--border-color:#0d2538;--color-tag:#2e604e;--color-title:#ebf4f1}.sepia-mode{--color:#433422;--color-primary:#504231;--color-secondary:#504231;--bg:#f1e7d0;--bg-code:#ddd;--bg-secondary:#eae0c9;--border-color:#ded0bf;--color-tag:#504231;--color-title:#504231}body{background-color:var(--bg);color:var(--color);font-family:Montserrat,Arial,Sans Serif;transition:background-color .7s}a{color:var(--color-primary)}.py-05{padding-bottom:.125rem;padding-top:.125rem}.markdown{line-height:1.5;--tw-text-opacity:1;color:rgb(17 24 39/var(--tw-text-opacity));color:var(--color-secondary)}.markdown .token.operator{background:none}.markdown>*+*{margin-bottom:1rem;margin-top:0}.markdown li+li{margin-top:.25rem}.markdown li>p+p{color:var(--color-primary);margin-top:1.5rem}.markdown img{margin:auto;margin-bottom:1.5rem;margin-top:1.5rem}.markdown a,.markdown strong{font-weight:600}.markdown strong a{font-weight:700}.markdown h1{font-size:2.25rem;line-height:2.5rem;line-height:1.25}.markdown h1,.markdown h2{border-bottom-width:1px;border-color:var(--color-primary);font-weight:600;margin-bottom:1rem;margin-top:1.5rem;padding-bottom:.5rem}.markdown h2{font-size:1.5rem;line-height:2rem;line-height:1.25}.markdown h3{font-size:1.125rem;line-height:1.75rem;line-height:1.375}.markdown h3,.markdown h4{border-color:var(--color-primary);font-weight:600;margin-bottom:1rem;margin-top:1.5rem}.markdown h4{font-size:1rem;line-height:1.5rem;line-height:1}.markdown h5{border-color:var(--color-primary)}.markdown h5,.markdown h6{font-size:.875rem;font-weight:600;line-height:1.25rem;line-height:1.25;margin-bottom:1rem;margin-top:1.5rem}.markdown h6{--tw-text-opacity:1}.markdown blockquote,.markdown h6{color:rgb(75 85 99/var(--tw-text-opacity))}.markdown blockquote{border-left-width:4px;--tw-border-opacity:1;border-color:rgb(209 213 219/var(--tw-border-opacity));font-size:1rem;line-height:1.5rem;padding-left:1rem;padding-right:1rem;--tw-text-opacity:1;border-color:var(--color-primary)}.markdown code{background-color:rgb(229 231 235/var(--tw-bg-opacity));background-color:var(--bg-code);color:#000;display:inline;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:.875rem;line-height:1.25rem;padding:.125rem .25rem}.markdown code,.markdown pre{border-radius:.25rem;--tw-bg-opacity:1}.markdown pre{background-color:rgb(243 244 246/var(--tw-bg-opacity));overflow-x:auto;padding:1rem}.markdown pre code{background-color:transparent;border-radius:0;color:#000;display:block;overflow:visible;padding:0}.markdown p{margin-bottom:10px}code[class*=language-],pre[class*=language-]{background:var(--bg-code)!important;text-shadow:none!important}.markdown ul{list-style-type:disc}.markdown ol,.markdown ul{font-size:1rem;line-height:1.5rem;padding-left:2rem}.markdown ol{list-style-type:decimal}.markdown kbd{border-radius:.25rem;border-width:1px;display:inline-block;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:.75rem;font-weight:400;line-height:1rem;vertical-align:middle;--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow);padding:.125rem .25rem}.markdown table,td,th{border:1px solid #000;border-color:var(--color);font-size:1rem;line-height:1.5rem}.markdown table{overflow-x:scroll}.markdown td,.markdown th{border-width:1px;padding:.25rem .75rem}.markdown .highlight pre{--tw-bg-opacity:1!important;background-color:rgb(243 244 246/var(--tw-bg-opacity))!important}.article-card{box-shadow:0 0 0 0 var(--color-secondary);height:100%;transition:box-shadow .2s,transform .2s}.article-title{color:var(--color-title);font-weight:700}.article-card:hover{box-shadow:0 0 30px 2px var(--color-secondary);transform:scale(1.025)}.blog-card-description,.blog-date{color:var(--color-secondary)}.blog-date{font-size:smaller}hr{background-color:var(--color);border:none;height:1px}.menu-icon{background-color:var(--border-color);color:var(--color)}.mobile-menu{background-color:var(--bg-secondary);color:var(--color)}.btn{border-color:var(--color-primary);border-radius:1}.btn:hover{background-color:var(--bg-secondary)}.hero{border-color:var(--color-primary);color:var(--color-primary)}.markdown{overflow-wrap:break-word}.markdown h2:before,.markdown h3:before{content:" ";margin-top:-85px;pointer-events:none}.markdown h2>a,.markdown h3>a{margin-left:1.25rem}.markdown h2>a:before,.markdown h3>a:before{content:"#";font-size:1.25rem;font-weight:400;line-height:2rem;margin-left:-1.25rem;opacity:1;padding-right:.5rem;position:absolute}@media (min-width:1024px){.markdown h2>a,.markdown h3>a{margin-left:0}.markdown h2>a:before,.markdown h3>a:before{opacity:0}}.markdown h2:hover>a:before,.markdown h3:hover>a:before{opacity:1}& pre[class*=language-]{position:static;--tw-bg-opacity:1;background-color:rgb(31 41 55/var(--tw-bg-opacity))}.mc{background-color:var(--bg);border-color:var(--color-primary);border-radius:5px;border-width:1px;color:var(--color-primary);justify-content:center;padding:5px 10px;width:100%}.mc-btn{background-color:var(--color-secondary);color:var(--bg-secondary);cursor:pointer}</style>
<style>html{font-family:Montserrat,Arial,Sans Serif;font-size:16px;word-spacing:1px;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;box-sizing:border-box}*,:after,:before{box-sizing:border-box;margin:0}.button--green{border:1px solid #3b8070;border-radius:4px;color:#3b8070;display:inline-block;padding:10px 30px;text-decoration:none}.button--green:hover{background-color:#3b8070;color:#fff}.button--grey{border:1px solid #35495e;border-radius:4px;color:#35495e;display:inline-block;margin-left:15px;padding:10px 30px;text-decoration:none}.button--grey:hover{background-color:#35495e;color:#fff}</style>
<style>span.emoji-mart-emoji[data-v-d2ff5fdf]{padding:0}.selected[data-v-d2ff5fdf]{text-shadow:.25px 0 0 #000}.picker[data-v-d2ff5fdf]{margin-left:auto;margin-right:auto;position:absolute;top:10px;transform:translate(50%,50%)}.top[data-v-d2ff5fdf]{background-color:var(--color-primary);height:3px;width:100%}</style>
<style>.selected[data-v-ed0088f5]{text-shadow:.9px 0 0}</style>
<style>span.emoji-mart-emoji[data-v-2649ce61]{padding:0;transition:transform .2s}span.emoji-mart-emoji[data-v-2649ce61]:hover{transform:scale(1.3)}.centered[data-v-2649ce61]{left:50vw;margin-left:auto;margin-right:auto;position:absolute;right:50vw}</style>
<style>.emoji-mart,.emoji-mart *{-webkit-box-sizing:border-box;box-sizing:border-box;line-height:1.15}.emoji-mart{display:-webkit-box;display:-ms-flexbox;display:flex;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,sans-serif;font-size:16px;-webkit-box-orient:vertical;-webkit-box-direction:normal;background:#fff;border:1px solid #d9d9d9;border-radius:5px;color:#222427;-ms-flex-direction:column;flex-direction:column;height:420px}.emoji-mart-emoji{background:none;border:none;-webkit-box-shadow:none;box-shadow:none;padding:6px}.emoji-mart-emoji span{display:inline-block}.emoji-mart-preview-emoji .emoji-mart-emoji span{font-size:32px;height:38px;width:38px}.emoji-type-native{font-family:Segoe UI Emoji,Segoe UI Symbol,Segoe UI,Apple Color Emoji,Twemoji Mozilla,Noto Color Emoji,EmojiOne Color,Android Emoji;word-break:keep-all}.emoji-type-image{background-size:6100%}.emoji-type-image.emoji-set-apple{background-image:url(https://unpkg.com/emoji-datasource-apple@15.0.1/img/apple/sheets-256/64.png)}.emoji-type-image.emoji-set-facebook{background-image:url(https://unpkg.com/emoji-datasource-facebook@15.0.1/img/facebook/sheets-256/64.png)}.emoji-type-image.emoji-set-google{background-image:url(https://unpkg.com/emoji-datasource-google@15.0.1/img/google/sheets-256/64.png)}.emoji-type-image.emoji-set-twitter{background-image:url(https://unpkg.com/emoji-datasource-twitter@15.0.1/img/twitter/sheets-256/64.png)}.emoji-mart-bar{border:0 solid #d9d9d9}.emoji-mart-bar:first-child{border-bottom-width:1px;border-top-left-radius:5px;border-top-right-radius:5px}.emoji-mart-bar:last-child{border-bottom-left-radius:5px;border-bottom-right-radius:5px;border-top-width:1px}.emoji-mart-scroll{overflow-y:scroll;position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1;padding:0 6px 6px;will-change:transform;z-index:0;-webkit-overflow-scrolling:touch}.emoji-mart-anchors{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;color:#858585;justify-content:space-between;line-height:0;padding:0 6px}.emoji-mart-anchor{display:block;position:relative;-webkit-box-flex:1;background:none;border:none;-webkit-box-shadow:none;box-shadow:none;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;padding:12px 4px;text-align:center;-webkit-transition:color .1s ease-out;transition:color .1s ease-out}.emoji-mart-anchor-selected,.emoji-mart-anchor:hover{color:#464646}.emoji-mart-anchor-selected .emoji-mart-anchor-bar{bottom:0}.emoji-mart-anchor-bar{background-color:#464646;bottom:-3px;height:3px;left:0;position:absolute;width:100%}.emoji-mart-anchors i{display:inline-block;max-width:22px;width:100%}.emoji-mart-anchors svg{fill:currentColor;max-height:18px}.emoji-mart .scroller{height:250px;position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1;padding:0 6px 6px;will-change:transform;z-index:0;-webkit-overflow-scrolling:touch}.emoji-mart-search{margin-top:6px;padding:0 6px}.emoji-mart-search input{border:1px solid #d9d9d9;border-radius:25px;display:block;font-size:16px;outline:0;padding:.2em .6em;width:100%}.emoji-mart-search-results{height:250px;overflow-y:scroll}.emoji-mart-category{position:relative}.emoji-mart-category .emoji-mart-emoji span{cursor:default;position:relative;text-align:center;z-index:1}.emoji-mart-category .emoji-mart-emoji:hover:before,.emoji-mart-emoji-selected:before{background-color:#f4f4f4;border-radius:100%;content:"";height:100%;left:0;opacity:1;position:absolute;top:0;width:100%;z-index:0}.emoji-mart-category-label{position:-webkit-sticky;position:sticky;top:0}.emoji-mart-static .emoji-mart-category-label{position:relative;z-index:2}.emoji-mart-category-label h3{background-color:#fff;background-color:hsla(0,0%,100%,.95);display:block;font-size:16px;font-weight:500;padding:5px 6px;width:100%}.emoji-mart-emoji{display:inline-block;font-size:0;position:relative}.emoji-mart-no-results{color:#858585;font-size:14px;padding-top:70px;text-align:center}.emoji-mart-no-results .emoji-mart-category-label{display:none}.emoji-mart-no-results .emoji-mart-no-results-label{margin-top:.2em}.emoji-mart-no-results .emoji-mart-emoji:hover:before{content:none}.emoji-mart-preview{height:70px;position:relative}.emoji-mart-preview-data,.emoji-mart-preview-emoji,.emoji-mart-preview-skins{position:absolute;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%)}.emoji-mart-preview-emoji{left:12px}.emoji-mart-preview-data{left:68px;right:12px;word-break:break-all}.emoji-mart-preview-skins{right:30px;text-align:right}.emoji-mart-preview-name{font-size:14px}.emoji-mart-preview-shortname{color:#888;font-size:12px}.emoji-mart-preview-emoticon+.emoji-mart-preview-emoticon,.emoji-mart-preview-shortname+.emoji-mart-preview-emoticon,.emoji-mart-preview-shortname+.emoji-mart-preview-shortname{margin-left:.5em}.emoji-mart-preview-emoticon{color:#bbb;font-size:11px}.emoji-mart-title span{display:inline-block;vertical-align:middle}.emoji-mart-title .emoji-mart-emoji{padding:0}.emoji-mart-title-label{color:#999a9c;font-size:21px;font-weight:300}.emoji-mart-skin-swatches{background-color:#fff;border:1px solid #d9d9d9;border-radius:12px;font-size:0;padding:2px 0}.emoji-mart-skin-swatches-opened .emoji-mart-skin-swatch{padding:0 2px;width:16px}.emoji-mart-skin-swatches-opened .emoji-mart-skin-swatch-selected:after{opacity:.75}.emoji-mart-skin-swatch{display:inline-block;-webkit-transition-duration:.125s;transition-duration:.125s;-webkit-transition-property:width,padding;transition-property:width,padding;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out;vertical-align:middle;width:0}.emoji-mart-skin-swatch:first-child{-webkit-transition-delay:0s;transition-delay:0s}.emoji-mart-skin-swatch:nth-child(2){-webkit-transition-delay:.03s;transition-delay:.03s}.emoji-mart-skin-swatch:nth-child(3){-webkit-transition-delay:.06s;transition-delay:.06s}.emoji-mart-skin-swatch:nth-child(4){-webkit-transition-delay:.09s;transition-delay:.09s}.emoji-mart-skin-swatch:nth-child(5){-webkit-transition-delay:.12s;transition-delay:.12s}.emoji-mart-skin-swatch:nth-child(6){-webkit-transition-delay:.15s;transition-delay:.15s}.emoji-mart-skin-swatch-selected{padding:0 2px;position:relative;width:16px}.emoji-mart-skin-swatch-selected:after{background-color:#fff;border-radius:100%;content:"";height:4px;left:50%;margin:-2px 0 0 -2px;opacity:0;pointer-events:none;position:absolute;top:50%;-webkit-transition:opacity .2s ease-out;transition:opacity .2s ease-out;width:4px}.emoji-mart-skin{border-radius:100%;display:inline-block;max-width:12px;padding-top:100%;width:100%}.emoji-mart-skin-tone-1{background-color:#ffc93a}.emoji-mart-skin-tone-2{background-color:#fadcbc}.emoji-mart-skin-tone-3{background-color:#e0bb95}.emoji-mart-skin-tone-4{background-color:#bf8f68}.emoji-mart-skin-tone-5{background-color:#9b643d}.emoji-mart-skin-tone-6{background-color:#594539}.emoji-mart .vue-recycle-scroller{position:relative}.emoji-mart .vue-recycle-scroller.direction-vertical:not(.page-mode){overflow-y:auto}.emoji-mart .vue-recycle-scroller.direction-horizontal:not(.page-mode){overflow-x:auto}.emoji-mart .vue-recycle-scroller.direction-horizontal{display:-webkit-box;display:-ms-flexbox;display:flex}.emoji-mart .vue-recycle-scroller__slot{-webkit-box-flex:1;-ms-flex:auto 0 0px;flex:auto 0 0}.emoji-mart .vue-recycle-scroller__item-wrapper{-webkit-box-flex:1;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-flex:1;flex:1;overflow:hidden;position:relative}.emoji-mart .vue-recycle-scroller.ready .vue-recycle-scroller__item-view{left:0;position:absolute;top:0;will-change:transform}.emoji-mart .vue-recycle-scroller.direction-vertical .vue-recycle-scroller__item-wrapper{width:100%}.emoji-mart .vue-recycle-scroller.direction-horizontal .vue-recycle-scroller__item-wrapper{height:100%}.emoji-mart .vue-recycle-scroller.ready.direction-vertical .vue-recycle-scroller__item-view{width:100%}.emoji-mart .vue-recycle-scroller.ready.direction-horizontal .vue-recycle-scroller__item-view{height:100%}.emoji-mart .resize-observer[data-v-b329ee4c]{background-color:transparent;border:none;opacity:0}.emoji-mart .resize-observer[data-v-b329ee4c],.emoji-mart .resize-observer[data-v-b329ee4c] object{display:block;height:100%;left:0;overflow:hidden;pointer-events:none;position:absolute;top:0;width:100%;z-index:-1}.emoji-mart-search .hidden{display:none;visibility:hidden}</style>
<style>span.emoji-mart-emoji[data-v-03afe4fa]{padding:0;transition:transform .2s}span.emoji-mart-emoji[data-v-03afe4fa]:hover{transform:scale(1.3)}.picker[data-v-03afe4fa]{left:0;margin-left:auto;margin-right:auto;position:absolute;right:0;z-index:10000000000}.localepicker[data-v-03afe4fa]{background-color:var(--bg)}.localeText[data-v-03afe4fa]{color:var(--color-primary)}</style>
<style>.tag[data-v-eb2063c1]{background-color:var(--color-tag);transition:transform .2s}.tag[data-v-eb2063c1]:hover{transform:scale(1.05)}</style>
<style>pre code .line{display:block;min-height:1rem}</style>
<link rel="stylesheet" href="/_nuxt/Tag.B5osjxLm.css">
<link rel="stylesheet" href="/_nuxt/ProseCode.CchFRBtv.css">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/2018/02/19/leaflet-maps-with-django/_payload.json?0e22c824-be41-43ea-9d89-8a708e47c85d">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/B62bJQeK.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BqaMSzVs.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/WqfcNW8K.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/B_TnsaRU.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DgfUhz8V.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DKePYFev.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BHITfFuX.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BNV7_Kes.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/B3irbfW_.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BWBchnvz.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CjosxUxL.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C-v3KzvZ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dnd51l0P.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BZqLGvcs.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BmJYSW1t.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/s24-AG7g.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/ByuDeUAE.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/n0lCaP9C.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CRwQNCDI.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CHYhpBkX.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/8oTzhj2U.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/rm5XWLwK.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CWwJJRHo.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BiIj3VRU.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BLh76Vea.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bh4hRww3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/j2LixwTd.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/nlLfrwHt.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CBbO6mFV.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/BwXdWV9z.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DKQ-wWG3.js">
<meta name="description" content="Brian Caffey's personal website">
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<meta name="robots" content="all">
<meta property="twitter:creator" content="@briancaffey">
<meta property="twitter:site" content="@briancaffey">
<meta property="og:description" content>
<meta property="twitter:image" content="https://briancaffey.github.io/static/map_homepage.png">
<meta property="twitter:card" content="summary_large_image">
<meta property="og:title" content="Display, filter and export geographical data in a Django app with Leaflet, Mapbox, DataTables, Bootstrap 4 and Travis-CI">
<meta property="og:image" content="/static/map_homepage.png">
<script type="module" src="/_nuxt/B62bJQeK.js" crossorigin></script><script>"use strict";(()=>{const a=window,e=document.documentElement,c=window.localStorage,d=["dark","light"],n=c&&c.getItem&&c.getItem("nuxt-color-mode")||"system";let l=n==="system"?f():n;const i=e.getAttribute("data-color-mode-forced");i&&(l=i),r(l),a["__NUXT_COLOR_MODE__"]={preference:n,value:l,getColorScheme:f,addColorScheme:r,removeColorScheme:u};function r(o){const t=""+o+"-mode",s="";e.classList?e.classList.add(t):e.className+=" "+t,s&&e.setAttribute("data-"+s,o)}function u(o){const t=""+o+"-mode",s="";e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp(t,"g"),""),s&&e.removeAttribute("data-"+s)}function m(o){return a.matchMedia("(prefers-color-scheme"+o+")")}function f(){if(a.matchMedia&&m("").media!=="not all"){for(const o of d)if(m(":"+o).matches)return o}return"light"}})();</script></head><body><div id="__nuxt"><div><div><div data-v-d2ff5fdf><div class="mx-auto flex py-2 px-2 sm:px-4 items-center max-w-6xl justify-center" data-v-d2ff5fdf><div class="justify-left flex-grow flex-cols-4" data-v-d2ff5fdf><a href="/" class="text-xl" data-v-d2ff5fdf><span class="hidden sm:inline text-2xl" data-v-d2ff5fdf>Brian Caffey</span><span class="inline sm:hidden" data-v-d2ff5fdf>JBC</span></a></div><div class="flex-grow relative" data-v-d2ff5fdf><nav z-index="10000" data-v-d2ff5fdf data-v-ed0088f5><div data-v-ed0088f5><ul class="items-right float-right hidden md:flex" data-v-ed0088f5><li class="px-4 text-lg" data-v-ed0088f5><a href="/blog/1" class="" data-v-ed0088f5>Blog</a></li><li class="px-4 text-lg" data-v-ed0088f5><a href="/contact" class="" data-v-ed0088f5>Contact</a></li></ul><div class="flex justify-end md:hidden z-1000" data-v-ed0088f5><button class="flex items-center px-3 py-2 border rounded menu-icon" data-v-ed0088f5><svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-v-ed0088f5><title data-v-ed0088f5>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" data-v-ed0088f5></path></svg></button></div><!----></div></nav></div></div><div class="picker" data-v-d2ff5fdf><div class="centered" data-v-d2ff5fdf data-v-2649ce61><div class="grid items-center justify-center" data-v-2649ce61><ul class="flex px-4" data-v-2649ce61><!--[--><li class="md:px-1 px-1 cursor-pointer" data-v-2649ce61><span aria-label="üñ•Ô∏è, desktop_computer" class="emoji-mart-emoji" data-v-2649ce61><span class="emoji-set-apple emoji-type-image" style="background-position:51.67% 95%;width:32px;height:32px;"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-2649ce61><span aria-label="üåû, sun_with_face" class="emoji-mart-emoji" data-v-2649ce61><span class="emoji-set-apple emoji-type-image" style="background-position:8.33% 48.33%;width:32px;height:32px;"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-2649ce61><span aria-label="üåö, new_moon_with_face" class="emoji-mart-emoji" data-v-2649ce61><span class="emoji-set-apple emoji-type-image" style="background-position:8.33% 41.67%;width:32px;height:32px;"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-2649ce61><span aria-label="‚òï, coffee" class="emoji-mart-emoji" data-v-2649ce61><span class="emoji-set-apple emoji-type-image" style="background-position:95% 30%;width:32px;height:32px;"></span></span></li><!--]--><li class="md:px-1 px-1 cursor-pointer" data-v-2649ce61><div data-v-2649ce61 data-v-03afe4fa><ul data-v-03afe4fa><li class="md:px-1 px-1 cursor-pointer" data-v-03afe4fa><span aria-label="üá∫üá∏, us, flag-us" class="emoji-mart-emoji" data-v-03afe4fa><span class="emoji-set-apple emoji-type-image" style="background-position:6.67% 45%;width:32px;height:32px;"></span></span></li></ul><div class="rounded-md z-10 picker" data-v-03afe4fa><!----></div></div></li></ul></div></div></div></div><!--[--><article><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt data-nuxt-img srcset="/_ipx/f_webp/static/map_homepage.png 1x, /_ipx/f_webp/static/map_homepage.png 2x" style="height:32rem;" src="/_ipx/f_webp/static/map_homepage.png" class="pt-2 w-full object-cover"><div class="mx-auto max-w-5xl px-2 sm:px-4 md:px-4 lg:px-16 mt-2"><h1 class="prose text-4xl leading-9 py-4 font-bold">Display, filter and export geographical data in a Django app with Leaflet, Mapbox, DataTables, Bootstrap 4 and Travis-CI</h1><div class="flex flex-wrap -ml-1 py-2"><!--[--><a href="/blog/tags/leaflet/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>leaflet üè∑Ô∏è <!----></div></a><a href="/blog/tags/django/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>django üè∑Ô∏è <!----></div></a><a href="/blog/tags/mapbox/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>mapbox üè∑Ô∏è <!----></div></a><a href="/blog/tags/data-tables/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>data-tables üè∑Ô∏è <!----></div></a><a href="/blog/tags/bootstrap/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>bootstrap üè∑Ô∏è <!----></div></a><a href="/blog/tags/travis-ci/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>travis-ci üè∑Ô∏è <!----></div></a><!--]--></div><!----><p class="blog-date text-gray-500 mb-4">Last updated February 19, 2018</p><!----><!--[--><div class="markdown"><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="png" data-nuxt-img srcset="/_ipx/_/static/map_entire.png 1x, /_ipx/_/static/map_entire.png 2x" class="" src="/_ipx/_/static/map_entire.png"><!--]--></p><h3 id="live-demo-on-digitalocean"><a href="#live-demo-on-digitalocean"><!--[--><a href="http://159.89.235.193/books/" rel="nofollow"><!--[-->Live Demo on DigitalOcean<!--]--></a><!--]--></a></h3><p><!--[-->This post is a review of my first attempt at using geographical data in a Django project. I have been interested in working with map APIs, and I once looked into the Google Maps API. For this project I chose to use <a href="http://leafletjs.com/" rel="nofollow"><!--[-->Leaflet<!--]--></a>:<!--]--></p><blockquote><!--[--><p><!--[-->an open-source JavaScript library for mobile-friendly interactive maps<!--]--></p><!--]--></blockquote><p><!--[-->Getting started with Leaflet is easy. All you need to do is request a public Mapbox API key which is free (with no credit card required). You can get a key from <a href="https://www.mapbox.com/account/access-tokens/" rel="nofollow"><!--[-->https://www.mapbox.com/account/access-tokens/<!--]--></a>.<!--]--></p><p><!--[-->Then you will follow steps on the <a href="http://leafletjs.com/examples/quick-start/" rel="nofollow"><!--[-->quickstart guide<!--]--></a> and replace <code class=""><!--[-->your.mapbox.access.token<!--]--></code> with your Mapbox API key.<!--]--></p><p><!--[-->{% raw %}<!--]--></p><!--[--><pre class="language-javascript shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2">L</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">tileLayer</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(
</span></span><span class="line" line="2"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">  &#39;https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  {
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    attribution:
</span></span><span class="line" line="5"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">      &#39;Map data &amp;copy; &lt;a href=&quot;http://openstreetmap.org&quot;&gt;OpenStreetMap&lt;/a&gt; contributors, &lt;a href=&quot;http://creativecommons.org/licenses/by-sa/2.0/&quot;&gt;CC-BY-SA&lt;/a&gt;, Imagery ¬© &lt;a href=&quot;http://mapbox.com&quot;&gt;Mapbox&lt;/a&gt;&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    maxZoom: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">18</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    id: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;mapbox.streets&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    accessToken: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;your.mapbox.access.token&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="9"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  }
</span></span><span class="line" line="10"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">).</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">addTo</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(mymap)
</span></span></code><!--]--></pre><!--]--><p><!--[-->{% endraw %}<!--]--></p><p><!--[-->I&#39;ll come back to using Leaflet later on, and also show how to use Leaflet plugins that can be used to add functionality such as aggregating markers on a map.<!--]--></p><h2 id="django-model"><a href="#django-model"><!--[-->Django model<!--]--></a></h2><p><!--[-->Next, let&#39;s look at the Django setup. For now I&#39;m simply working with a local project and SQLite3 backend.<!--]--></p><p><!--[-->To store latitude and longitude data, we can use <code class=""><!--[-->DecimalField<!--]--></code>:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">class</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"> Book</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline">models</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline">Model</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">):
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    title </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> models.CharField(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">max_length</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">300</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    lat </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> models.DecimalField(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">max_digits</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">9</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">decimal_places</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">6</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    lon </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> models.DecimalField(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">max_digits</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">9</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">decimal_places</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">6</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    [</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">...</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">]
</span></span></code><!--]--></pre><!--]--><p><!--[-->This allows us to store numbers to six decimal places. The difference between 0 and 0.00001 is about 3 feet, so this gives us plenty of accuracy for our geographical coordinate data.<!--]--></p><h2 id="plotting-books-on-a-map"><a href="#plotting-books-on-a-map"><!--[-->Plotting books on a map<!--]--></a></h2><p><!--[-->Plotting our books on a map is fairly straightforward, but there were a few obstacles to work around. Initially I setup an additional endpoint that returned an AJAX response with the longitude, latitude, title and link for each book. The <code class=""><!--[-->success<!--]--></code> function in the AJAX call then passed the returned JSON into a function that populated the book data in the map.<!--]--></p><p><!--[-->The main <code class=""><!--[-->books<!--]--></code> page displays book data in two places: on the map and on the DataTable below the map. Since I was already making one database query for DataTables, I decided to reuse this data for the map and not use a separate request and database query. There are a few helpful idioms in Python and JavaScript to accomplish this.<!--]--></p><p><!--[-->First, let&#39;s look at the request with some added comments:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">def</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> all_books</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">request</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">):
</span></span><span class="line" line="2"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">    &quot;&quot;&quot;
</span></span><span class="line" line="3"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">    Main view for books. request.GET parameters are used to filter books
</span></span><span class="line" line="4"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">    &quot;&quot;&quot;
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Book.objects.all()
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    form </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> QueryForm(request.</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">GET</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> or</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> None</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    paramDict </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> request.</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">GET
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> filter_books(books, paramDict)
</span></span><span class="line" line="10"><span emptylineplaceholder="true">
</span></span><span class="line" line="11"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    page_count </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> books.aggregate(Sum(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;pages&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">))
</span></span><span class="line" line="12"><span emptylineplaceholder="true">
</span></span><span class="line" line="13"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">    # This takes the first book query an reformats the data so it can be read
</span></span><span class="line" line="14"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">    # by the map script on the frontend.
</span></span><span class="line" line="15"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    map_books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> [{</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;loc&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:[</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">float</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(book.lon), </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">float</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(book.lat)],
</span></span><span class="line" line="16"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">                  &#39;title&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:book.title,
</span></span><span class="line" line="17"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">                  &#39;url&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:book.get_absolute_url()} </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> book </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> books]
</span></span><span class="line" line="18"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    context </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> {
</span></span><span class="line" line="19"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;books&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:books,
</span></span><span class="line" line="20"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">        # Here, we apply `json.dumps`, `escapejs` and `marksafe` for security
</span></span><span class="line" line="21"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">        # and proper formatting
</span></span><span class="line" line="22"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;map_books&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: mark_safe(escapejs(json.dumps(map_books))),
</span></span><span class="line" line="23"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;page_count&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:page_count[</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;pages__sum&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">],
</span></span><span class="line" line="24"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;form&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:form}
</span></span><span class="line" line="25"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    return</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> render(request, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;books/books.html&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, context)
</span></span></code><!--]--></pre><!--]--><p><!--[-->On the frontend, I passed the <code class=""><!--[-->map_books<!--]--></code> variable to the template like this:<!--]--></p><!--[--><pre class="language-javascript shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">var</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> map_books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2"> JSON</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">parse</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;{{ map_books }}&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span></code><!--]--></pre><!--]--><p><!--[-->Now that I have <code class=""><!--[-->map_books<!--]--></code> as a JavaScript object, I can simply pass it into the map function that populates data in the Leaflet map. Here&#39;s the function that does that:<!--]--></p><!--[--><pre class="language-javascript shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">function</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> populateMap</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">data</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">) {
</span></span><span class="line" line="2"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">  for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> (i </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> data) {
</span></span><span class="line" line="3"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">    var</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> title </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> data[i].title, </span><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">//value searched
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">      loc </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> data[i].loc, </span><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">//position found
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">      url </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> data[i].url,
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">      marker </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> new</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2"> L</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">Marker</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">new</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2"> L</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">latLng</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(loc), { title: title, icon: bookIcon }) </span><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">//se property searched
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    marker.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">bindPopup</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;&lt;p&gt;&lt;a href=&quot;&#39;</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> +</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> url </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">+</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> &#39;&quot;&gt;&#39;</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> +</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> title </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">+</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> &#39;&lt;/a&gt;&lt;/p&gt;&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    markersLayer.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">addLayer</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(marker)
</span></span><span class="line" line="9"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  }
</span></span><span class="line" line="10"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">}
</span></span></code><!--]--></pre><!--]--><p><!--[-->This adds our markers to the map, and also passes link and title data to the popup box when a marker is clicked.<!--]--></p><p><!--[-->Here&#39;s the entire script that is used to populate map data:<!--]--></p><p><!--[-->{% raw %}<!--]--></p><!--[--><pre class="language-html shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">script</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="2"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">  var</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> mymap </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> new</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2"> L</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">Map</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;mapid&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, { zoom: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">9</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, center: </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">new</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2"> L</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">latLng</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">([</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">40</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">13</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">]) }) </span><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">//set center from first location
</span></span><span class="line" line="3"><span emptylineplaceholder="true">
</span></span><span class="line" line="4"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2">  L</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">tileLayer</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(
</span></span><span class="line" line="5"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">    &#39;https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    {
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">      attribution:
</span></span><span class="line" line="8"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;Map data &amp;copy; &lt;a href=&quot;http://openstreetmap.org&quot;&gt;OpenStreetMap&lt;/a&gt; contributors, &lt;a href=&quot;http://creativecommons.org/licenses/by-sa/2.0/&quot;&gt;CC-BY-SA&lt;/a&gt;, Imagery ¬© &lt;a href=&quot;http://mapbox.com&quot;&gt;Mapbox&lt;/a&gt;&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="9"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">      maxZoom: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">18</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="10"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">      id: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;mapbox.streets&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="11"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">      accessToken:
</span></span><span class="line" line="12"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;pk.eyJ1IjoiYnJpYW5jYWZmZXkiLCJhIjoiY2pkczJycjl5MmhqbTMzbzQ3bHJuaHA3aiJ9.cvRYYPNjQJVpFjdUcmIHzA&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="13"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    }
</span></span><span class="line" line="14"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  ).</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">addTo</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(mymap)
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">  var</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> bookIcon </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2"> L</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">icon</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">({
</span></span><span class="line" line="17"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    iconUrl: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;/static/images/marker-icon.png&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="18"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    iconSize: [</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">35</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">35</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">], </span><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">// size of the icon
</span></span><span class="line" line="19"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    iconAnchor: [</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">17</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">35</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">], </span><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">// point of the icon which will correspond to marker&#39;s location
</span></span><span class="line" line="20"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    popupAnchor: [</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">0</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">-</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">30</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">], </span><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">// point from which the popup should open relative to the iconAnchor
</span></span><span class="line" line="21"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  })
</span></span><span class="line" line="22"><span emptylineplaceholder="true">
</span></span><span class="line" line="23"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">  var</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> markersLayer </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2"> L</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">markerClusterGroup</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">()
</span></span><span class="line" line="24"><span emptylineplaceholder="true">
</span></span><span class="line" line="25"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  mymap.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">addLayer</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(markersLayer)
</span></span><span class="line" line="26"><span emptylineplaceholder="true">
</span></span><span class="line" line="27"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">  var</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> controlSearch </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> new</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2"> L</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.Control.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">Search</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">({
</span></span><span class="line" line="28"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    position: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;topright&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="29"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    layer: markersLayer,
</span></span><span class="line" line="30"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    initial: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">false</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="31"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    zoom: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">12</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="32"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    marker: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">false</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="33"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  })
</span></span><span class="line" line="34"><span emptylineplaceholder="true">
</span></span><span class="line" line="35"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  mymap.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">addControl</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(controlSearch)
</span></span><span class="line" line="36"><span emptylineplaceholder="true">
</span></span><span class="line" line="37"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">  function</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> populateMap</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">data</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">) {
</span></span><span class="line" line="38"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> (i </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> data) {
</span></span><span class="line" line="39"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">      var</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> title </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> data[i].title, </span><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">//value searched
</span></span><span class="line" line="40"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">        loc </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> data[i].loc, </span><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">//position found
</span></span><span class="line" line="41"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">        url </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> data[i].url,
</span></span><span class="line" line="42"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">        marker </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> new</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2"> L</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">Marker</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">new</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2"> L</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">latLng</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(loc), {
</span></span><span class="line" line="43"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">          title: title,
</span></span><span class="line" line="44"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">          icon: bookIcon,
</span></span><span class="line" line="45"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">        }) </span><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">//se property searched
</span></span><span class="line" line="46"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">      marker.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">bindPopup</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;&lt;p&gt;&lt;a href=&quot;&#39;</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> +</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> url </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">+</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> &#39;&quot;&gt;&#39;</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> +</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> title </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">+</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> &#39;&lt;/a&gt;&lt;/p&gt;&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="47"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">      markersLayer.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">addLayer</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(marker)
</span></span><span class="line" line="48"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    }
</span></span><span class="line" line="49"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  }
</span></span><span class="line" line="50"><span emptylineplaceholder="true">
</span></span><span class="line" line="51"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">  // use context variable instead of making AJAX call
</span></span><span class="line" line="52"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">  var</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> map_books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#F8F8F2"> JSON</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">parse</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;{{ map_books }}&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="53"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">  var</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> new_lat </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> map_books[</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">0</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">].loc[</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">0</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">]
</span></span><span class="line" line="54"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">  var</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> new_lon </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> map_books[</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">0</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">].loc[</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">1</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">]
</span></span><span class="line" line="55"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  mymap.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">setView</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">([</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">0</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">0</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">], </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">2</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="56"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">  populateMap</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(map_books)
</span></span><span class="line" line="57"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">script</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span></code><!--]--></pre><!--]--><p><!--[-->{% endraw %}<!--]--></p><h2 id="login-redirect"><a href="#login-redirect"><!--[-->Login Redirect<!--]--></a></h2><p><!--[-->I wanted to include a small note on a simple issue that I previously had trouble with, which is using the <code class=""><!--[-->next<!--]--></code> parameter to do a redirect to a page that an unauthenticated user will be redirected to after they successfully login.<!--]--></p><p><!--[-->Here&#39;s the login view:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">def</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> login_view</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">request</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">):
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    next_redirect </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> request.</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">GET</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.get(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;next&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    form </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> UserLoginForm(request.</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">POST</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> or</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> None</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="4"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    if</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> form.is_valid():
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">        next_redirect </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> request.</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">POST</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.get(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;next&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">        username </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> form.cleaned_data.get(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;username&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">        password </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> form.cleaned_data.get(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;password&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">        user </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> authenticate(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">username</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">username, </span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">password</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">password)
</span></span><span class="line" line="9"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">        login(request, user)
</span></span><span class="line" line="10"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF">        print</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(next_redirect)
</span></span><span class="line" line="11"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">        if</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> next_redirect </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">!=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> &#39;None&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:
</span></span><span class="line" line="12"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">            return</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> redirect(next_redirect)
</span></span><span class="line" line="13"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">        return</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> redirect(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;books:all&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="14"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    context </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> { </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;form&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:form, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;next&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:next_redirect }
</span></span><span class="line" line="15"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    return</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> render(request, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;accounts/login_form.html&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, context)
</span></span></code><!--]--></pre><!--]--><p><!--[-->Notice that I pass <code class=""><!--[-->next<!--]--></code> as a context variable. I use this in the login form here:<!--]--></p><p><!--[-->{% raw %}<!--]--></p><!--[--><pre class="language-html shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">form</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> method</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;POST&quot;</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> action</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;.&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  {% csrf_token %} {{ form | crispy }}
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">input</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> type</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;hidden&quot;</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> value</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;{{ next }}&quot;</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> name</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;next&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> /&gt;
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">div</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> class</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;login-center&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">input</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> class</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;btn btn-success login-center&quot;</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> type</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;submit&quot;</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> value</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;Login&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> /&gt;
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">div</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">br</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> /&gt;
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  or &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">a</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> href</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;{% url &#39;accounts:register&#39; %}&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;create an account&lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">a</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="9"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">form</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span></code><!--]--></pre><!--]--><p><!--[-->{% endraw %}<!--]--></p><p><!--[-->By passing this as a hidden value to the form, when a <code class=""><!--[-->POST<!--]--></code> request is made, we are redirected to the value of <code class=""><!--[-->next<!--]--></code> if it is not <code class=""><!--[-->None<!--]--></code>, or if there is no redirect.<!--]--></p><p><!--[-->When a <code class=""><!--[-->@login_required<!--]--></code> decorator is used, and we want to access a url such as <code class=""><!--[-->/books/add<!--]--></code>, we are redirected to a url that looks like this:<!--]--></p><!--[--><pre class="language-html shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">http://localhost:8000/accounts/login/?next=/books/new/
</span></span></code><!--]--></pre><!--]--><p><!--[-->In this way we can pass the next parameter from the <code class=""><!--[-->GET<!--]--></code> request to the <code class=""><!--[-->POST<!--]--></code> request that is made when the login view is hit.<!--]--></p><h2 id="authors"><a href="#authors"><!--[-->Authors<!--]--></a></h2><p><!--[-->For illustration purposes, I included an <code class=""><!--[-->Author<!--]--></code> model. Since a book can have zero, one or many Authors, I used a many-to-many relationship to link authors to books. Here is how we do this in our Book model:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">class</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"> Book</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline">models</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline">Model</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">):
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    [</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">...</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">other fields</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">...</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">]
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    authors </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> models.ManyToManyField(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;authors.Author&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span></code><!--]--></pre><!--]--><p><!--[-->This dot notation with <code class=""><!--[-->&#39;authors.Author&#39;<!--]--></code> is important. Previously I would have just imported the <code class=""><!--[-->Author<!--]--></code>model and then referenced that in the ManyToManyField. However, this can lead to circular import errors which are hard to debug unless you know what a circular import is.<!--]--></p><p><!--[-->Now let&#39;s look at how to find all <code class=""><!--[-->Books<!--]--></code> by a certain author, as well as all <code class=""><!--[-->Authors<!--]--></code> of a given book. Uing the Django shell, we can do the following:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">from</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> authors.models </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">import</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Author
</span></span><span class="line" line="2"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">from</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> books.models </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">import</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Book
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">a </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Author.objects.all().first()
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">a.book_set.values()
</span></span><span class="line" line="5"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">&lt;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">QuerySet [{</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;id&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">583</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;title&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;None Or Other&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;lat&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: Decimal(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;-118.035345&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">), </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;lon&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: Decimal(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;34.139729&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">), </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;pages&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">1881</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;publish_date&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: datetime.date(</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">2018</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">3</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">18</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">), </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;website&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;https://www.fleming-mitchell.com/&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;synopsis&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;Option ever large throw dinner worker ahead realize clearly congress as smile size spend expert chair well. Brother item win follow hope coach garden later arrive who if ago voice analysis simply reflect. Amount under data drug kind book fish still information president minute stage dog. Focus full green society parent door according my management sell arrive only send international tonight. Player character financial detail oil check bring pressure possible former. Learn politics compare position large loss exactly probably approach physical international machine as model. &#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;slug&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;none-or-other&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;status&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">True</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">}, {</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;id&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">601</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;title&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;Teacher Them Step&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;lat&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: Decimal(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;-80.268357&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">), </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;lon&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: Decimal(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;26.661763&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">), </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;pages&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">206</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;publish_date&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: datetime.date(</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">2018</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">2</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">27</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">), </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;website&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;http://www.rodriguez.net/&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;synopsis&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;Drug fact behavior environment green try account where training brother building particular window even reach. Pressure lawyer dog world thought near institution we get force market can guy receive matter structure research foot of small. Professor production very this practice car wind wish relationship after follow professor news card concern media property have. According majority owner go mention reach store computer project kitchen group quality present several another time school and will. Before during central artist page only health region happen share traditional section well out human. Mention quite short race only education heavy book up recent official here spring oil buy which language information practice. Time mother better peace girl defense rock mr never feeling tax city stock bar tv others right conference skin. &#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;slug&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;teacher-them-step&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;status&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">True</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">}]</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">&gt;
</span></span></code><!--]--></pre><!--]--><p><!--[-->This gave us two books by an author.<!--]--></p><p><!--[-->Now, let&#39;s look at how to find all authors of a given book. For this example, we can get authors directly in the template from a book object. This example come from the <code class=""><!--[-->book_detail<!--]--></code> template:<!--]--></p><p><!--[-->{% raw %}<!--]--></p><!--[--><pre class="language-html shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">h3</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  Authors: {% for author in book.authors.all %}
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">a</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> href</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;{% url &#39;authors:author_detail&#39; id=author.id %}&quot;
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    &gt;{{ author.full_name }}&lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">a
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &gt;
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  {% endfor %}
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">h3</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span></code><!--]--></pre><!--]--><p><!--[-->{% endraw %}<!--]--></p><p><!--[-->We could just as well access <code class=""><!--[-->books.authors.all<!--]--></code> in the view and pass authors in a variable that we can iterate over in the template, but this keeps things simpler without much more code to write.<!--]--></p><h2 id="filtering-data"><a href="#filtering-data"><!--[-->Filtering Data<!--]--></a></h2><p><!--[-->One other question I wanted to answer with this project is how to do relatively complex data filtering. To do this, I used Django forms to create a form that calls a <code class=""><!--[-->GET<!--]--></code> request to the same view it came from, which is to say, a filter form on the template for the <code class=""><!--[-->all<!--]--></code> books view has a form action with an <code class=""><!--[-->action<!--]--></code> value of the url that returns the <code class=""><!--[-->all<!--]--></code> view.<!--]--></p><p><!--[-->Here&#39;s a look at the form I put together for filtering data:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">class</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline"> QueryForm</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline">forms</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic;--shiki-default-text-decoration:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia-text-decoration:underline">Form</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">):
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    publish_date_before </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> forms.DateField(
</span></span><span class="line" line="4"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">        label</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="5"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">        required</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">False</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="6"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">        # initial = datetime.datetime.now(),
</span></span><span class="line" line="7"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">        widget</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> =</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> forms.TextInput(
</span></span><span class="line" line="8"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">            attrs</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">{
</span></span><span class="line" line="9"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">                &#39;class&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;form-control&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="10"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">                &#39;id&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;datepicker1&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="11"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">                &#39;placeholder&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;published before&#39;
</span></span><span class="line" line="12"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            }))
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    publish_date_after </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> forms.DateField(
</span></span><span class="line" line="15"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">        label</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="16"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">        required</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">False</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="17"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">        # initial = datetime.datetime.now(),
</span></span><span class="line" line="18"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">        widget</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> =</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> forms.TextInput(
</span></span><span class="line" line="19"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">            attrs</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">{
</span></span><span class="line" line="20"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">                &#39;class&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;form-control&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="21"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">                &#39;id&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;datepicker2&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="22"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">                &#39;placeholder&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;published after&#39;
</span></span><span class="line" line="23"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            }))
</span></span><span class="line" line="24"><span emptylineplaceholder="true">
</span></span><span class="line" line="25"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    keywords </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> forms.CharField(
</span></span><span class="line" line="26"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">        required</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">False</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="27"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">        label</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="28"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">        widget</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">forms.TextInput(
</span></span><span class="line" line="29"><span emptylineplaceholder="true">
</span></span><span class="line" line="30"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">            attrs</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">{
</span></span><span class="line" line="31"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">                &#39;class&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;form-control&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="32"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">                &#39;placeholder&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;space-separated words matching title, synopsis, website or tags&#39;
</span></span><span class="line" line="33"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            }))
</span></span></code><!--]--></pre><!--]--><p><!--[-->Here we are using three fields to filter data, a <code class=""><!--[-->published_before<!--]--></code> date, a <code class=""><!--[-->published_after<!--]--></code> date and a <code class=""><!--[-->keywords<!--]--></code> field.<!--]--></p><p><!--[-->Filtering this data can really clog up code in <code class=""><!--[-->views.py<!--]--></code>, and I know I was going to need this same code again for filtering data for CSV and XLS file downloads (more on this in a minute), so I decided to wrote a utility function that takes a <code class=""><!--[-->Book<!--]--></code> queryset and parameter dictionary (<code class=""><!--[-->request.GET<!--]--></code>), and returns a filtered <code class=""><!--[-->Book<!--]--></code> queryset. Here&#39;s what that function looks like:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">from</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> django.db.models </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">import</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Q
</span></span><span class="line" line="2"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">from</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> functools </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">import</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#F8F8F2"> reduce
</span></span><span class="line" line="3"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">from</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> ..models </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">import</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Book
</span></span><span class="line" line="4"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">import</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> datetime
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">def</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> filter_books</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">books</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">paramDict</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">):
</span></span><span class="line" line="7"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">    # paramDict = request.GET
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    params </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> paramDict.keys()
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line" line="10"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">    # data filtering
</span></span><span class="line" line="11"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    if</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF"> any</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(x</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">!=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;&#39;</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> x </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> paramDict.values()):
</span></span><span class="line" line="12"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">        if</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> paramDict[</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;publish_date_after&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">] </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">!=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> &#39;&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:
</span></span><span class="line" line="13"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            after_date </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> paramDict[</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;publish_date_after&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">]
</span></span><span class="line" line="14"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            _after_date </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> datetime.datetime.strptime(after_date, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;%m/</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">%d</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">/%Y&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> books.filter(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">publish_date__gte</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">_after_date)
</span></span><span class="line" line="17"><span emptylineplaceholder="true">
</span></span><span class="line" line="18"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">        if</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> paramDict[</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;publish_date_before&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">] </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">!=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> &#39;&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:
</span></span><span class="line" line="19"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            before_date </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> paramDict[</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;publish_date_before&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">]
</span></span><span class="line" line="20"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            _before_date </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> datetime.datetime.strptime(before_date, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;%m/</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">%d</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">/%Y&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="21"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> books.filter(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">publish_date__lte</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">_before_date)
</span></span><span class="line" line="22"><span emptylineplaceholder="true">
</span></span><span class="line" line="23"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">        # filters records that contain any of the following keywords
</span></span><span class="line" line="24"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">        if</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> paramDict[</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;keywords&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">] </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">!=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> &#39;&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:
</span></span><span class="line" line="25"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            kws </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> paramDict[</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;keywords&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">].split()
</span></span><span class="line" line="26"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            q_lookups </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> [Q(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">title__icontains</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">kw) </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kw </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kws] </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">+</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> \
</span></span><span class="line" line="27"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">                        [Q(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">synopsis__icontains</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">kw) </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kw </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kws] </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">+</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> \
</span></span><span class="line" line="28"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">                        [Q(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">website__icontains</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">kw) </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kw </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kws]
</span></span><span class="line" line="29"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            filters </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Q()
</span></span><span class="line" line="30"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            filters </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">|=</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#F8F8F2"> reduce</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">lambda</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"> x</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">y</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: x </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">|</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> y, q_lookups)
</span></span><span class="line" line="31"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> books.filter(filters)
</span></span><span class="line" line="32"><span emptylineplaceholder="true">
</span></span><span class="line" line="33"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    return</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> books
</span></span></code><!--]--></pre><!--]--><p><!--[-->This makes things much more simple in our views. Here&#39;s the code in the main <code class=""><!--[-->books<!--]--></code> view that uses this filter function, truncated for simplicity:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">def</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> all_books</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">request</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">):
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Book.objects.all()
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    form </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> QueryForm(request.</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">GET</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> or</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> None</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    paramDict </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> request.</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">GET
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> filter_books(books, paramDict)
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    [</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">...</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">]
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    context </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> {
</span></span><span class="line" line="8"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;books&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:books,
</span></span><span class="line" line="9"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;form&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:form,
</span></span><span class="line" line="10"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">        [</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">...</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">],}
</span></span><span class="line" line="11"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    return</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> render(request, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;books/books.html&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, context)
</span></span></code><!--]--></pre><!--]--><h2 id="exporting-data-as-csv-or-xls"><a href="#exporting-data-as-csv-or-xls"><!--[-->Exporting data as CSV or XLS<!--]--></a></h2><p><!--[-->One other requirement I gave myself for this project was giving users the option to export data in CSV or XLS file formats.<!--]--></p><p><!--[-->With the filter data function, I was able to keep things DRY (Don&#39;t Repeart Yourself). This task taught me about a few aspects of HTML5 and forms that I wasn&#39;t aware of. First, let&#39;s take a look at the CSV export function that I learned about throught <a href="https://simpleisbetterthancomplex.com/tutorial/2016/07/29/how-to-export-to-excel.html" rel="nofollow"><!--[-->this blog post<!--]--></a>, from a great Django blog called <a href="https://simpleisbetterthancomplex.com/tutorial/2016/07/29/how-to-export-to-excel.html" rel="nofollow"><!--[-->Simple is Better than Complex<!--]--></a> by <a href="https://github.com/vitorfs" rel="nofollow"><!--[-->Vitor Freitas<!--]--></a>:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">def</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> export_filtered_books_csv</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">request</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">):
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    response </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> HttpResponse(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">content_type</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;text/csv&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    response[</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;Content-Disposition&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">] </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> &#39;attachment; filename=&quot;books.csv&quot;&#39;
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    writer </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> csv.writer(response)
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    writer.writerow([</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;Title&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;Synopsis&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;Pages&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">])
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Book.objects.all()
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    paramDict </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> request.</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">GET
</span></span><span class="line" line="9"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> filter_books(books, paramDict)
</span></span><span class="line" line="10"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> books.values_list(
</span></span><span class="line" line="11"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;title&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="12"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;synopsis&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">,
</span></span><span class="line" line="13"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;pages&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="14"><span emptylineplaceholder="true">
</span></span><span class="line" line="15"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> book </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> books:
</span></span><span class="line" line="16"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">        writer.writerow(book)
</span></span><span class="line" line="17"><span emptylineplaceholder="true">
</span></span><span class="line" line="18"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    return</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> response
</span></span></code><!--]--></pre><!--]--><p><!--[-->I wanted to put this button in the filter form on the main <code class=""><!--[-->books<!--]--></code> page, but I need to place the button outside of the form tag. To get around this, here is the HTML I used:<!--]--></p><p><!--[-->{% raw %}<!--]--></p><!--[--><pre class="language-html shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">form</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> action</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;{% url &#39;books:csv&#39; %}&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">a
</span></span><span class="line" line="3"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    class</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;btn btn-primary&quot;
</span></span><span class="line" line="4"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    data-toggle</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;collapse&quot;
</span></span><span class="line" line="5"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    href</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;#collapseExample&quot;
</span></span><span class="line" line="6"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    aria-expanded</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;false&quot;
</span></span><span class="line" line="7"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    aria-controls</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;collapseExample&quot;
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &gt;
</span></span><span class="line" line="9"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    Filter Books
</span></span><span class="line" line="10"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">a</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="11"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">input
</span></span><span class="line" line="12"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    type</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;submit&quot;
</span></span><span class="line" line="13"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    class</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;btn btn-info&quot;
</span></span><span class="line" line="14"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    form</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;id_query_form&quot;
</span></span><span class="line" line="15"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    formaction</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;{% url &#39;books:csv&#39; %}&quot;
</span></span><span class="line" line="16"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    value</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;Export CSV&quot;
</span></span><span class="line" line="17"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  /&gt;
</span></span><span class="line" line="18"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">input
</span></span><span class="line" line="19"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    type</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;submit&quot;
</span></span><span class="line" line="20"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    class</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;btn btn-default&quot;
</span></span><span class="line" line="21"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    form</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;id_query_form&quot;
</span></span><span class="line" line="22"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    formaction</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;{% url &#39;books:xls&#39; %}&quot;
</span></span><span class="line" line="23"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">    value</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;Export XLS&quot;
</span></span><span class="line" line="24"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  /&gt;
</span></span><span class="line" line="25"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">form</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="26"><span emptylineplaceholder="true">
</span></span><span class="line" line="27"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">form</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> method</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;get&quot;</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> action</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;.&quot;</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> id</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;id_query_form&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="28"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">p</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;{{ form.keywords }}&lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">p</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="29"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">div</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> class</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;row&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="30"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">div</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> class</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;col-md-6&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;{{ form.publish_date_before }}&lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">div</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="31"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">div</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> class</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;col-md-6&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;{{ form.publish_date_after }}&lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">div</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="32"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">div</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="33"><span emptylineplaceholder="true">
</span></span><span class="line" line="34"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">p</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;&lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">p</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="35"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">p</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="36"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">input</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> class</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;btn btn-success&quot;</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> type</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;submit&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> /&gt;
</span></span><span class="line" line="37"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">button</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> type</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;reset&quot;</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> class</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;btn btn-info&quot;</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> value</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;Reset filters&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="38"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">      Reset filters
</span></span><span class="line" line="39"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    &lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">button</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="40"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    &lt;</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">button
</span></span><span class="line" line="41"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">      type</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;reset&quot;
</span></span><span class="line" line="42"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">      class</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;btn btn-warning&quot;
</span></span><span class="line" line="43"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">      id</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;id_clear_filters&quot;
</span></span><span class="line" line="44"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E">      onclick</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">return</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> resetForm</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">(</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F">this</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">.</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">form</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">);&quot;
</span></span><span class="line" line="45"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    &gt;
</span></span><span class="line" line="46"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">      Clear Filters
</span></span><span class="line" line="47"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    &lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">button</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="48"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  &lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">p</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span><span class="line" line="49"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&lt;/</span><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">form</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">&gt;
</span></span></code><!--]--></pre><!--]--><p><!--[-->{% endraw %}<!--]--></p><p><!--[-->There are two forms here, but the first form has an <code class=""><!--[-->input<!--]--></code> of <code class=""><!--[-->type=submit<!--]--></code> that references another form with <code class=""><!--[-->form=&quot;id_query_form&quot;<!--]--></code>, and this button&#39;s action is the url for the <code class=""><!--[-->export_filtered_books_csv<!--]--></code> function shown above.<!--]--></p><p><!--[-->For the filter function, I make a <code class=""><!--[-->utils<!--]--></code> folder in the app I am working with, so the directory structure looks like this (for the <code class=""><!--[-->books<!--]--></code> app):<!--]--></p><!--[--><pre class="" style=""><!--[--><code>.
‚îú‚îÄ‚îÄ admin.py
‚îú‚îÄ‚îÄ apps.py
‚îú‚îÄ‚îÄ forms.py
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ migrations
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ 0001_initial.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ 0002_book_authors.py
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ models.py
‚îú‚îÄ‚îÄ templates
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ books
‚îú‚îÄ‚îÄ tests.py
‚îú‚îÄ‚îÄ urls.py
‚îú‚îÄ‚îÄ utils
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ filter.py
‚îÇ¬†¬† ‚îú‚îÄ‚îÄ __init__.py
‚îÇ¬†¬† ‚îî‚îÄ‚îÄ nearby.py
‚îî‚îÄ‚îÄ views.py
</code><!--]--></pre><!--]--><p><!--[-->I initially had a litte bit of confusion on how to write a simple search query. I wanted a user to be able to enter terms that would return a query set where the items in the query set contained at least on of the terms in at least on of a few different fields (<code class=""><!--[-->title<!--]--></code>, <code class=""><!--[-->synopsis<!--]--></code>, <code class=""><!--[-->website<!--]--></code>).<!--]--></p><p><!--[-->To make this filter, I found a nice idiomatic pattern:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">if</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> paramDict[</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;keywords&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">] </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">!=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> &#39;&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    kws </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> paramDict[</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;keywords&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">].split()
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    q_lookups </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> [Q(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">title__icontains</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">kw) </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kw </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kws] </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">+</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> \
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">                [Q(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">synopsis__icontains</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">kw) </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kw </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kws] </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">+</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> \
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">                [Q(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">website__icontains</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">kw) </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kw </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> kws]
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    filters </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Q()
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    filters </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">|=</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#F8F8F2"> reduce</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">lambda</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"> x</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">y</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: x </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">|</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> y, q_lookups)
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> books.filter(filters)
</span></span></code><!--]--></pre><!--]--><p><!--[-->This is good for a small database, but could end up having to do lots of operations, especially if I decided that I want to add more fields to be searched, such as category or tags.<!--]--></p><p><!--[-->One option that I have considered to simplify the search query is to make one field called something like <code class=""><!--[-->search_string<!--]--></code>. This field would be modified on <code class=""><!--[-->save<!--]--></code>, and it would simply appends the text from all of the fields I&#39;m interested in searching. Then, instead of doing Q lookups for each word over many different fields, I could search each word in <code class=""><!--[-->keywords<!--]--></code> over one field. I haven&#39;t implemented this here, but I would like to test this in the future.<!--]--></p><h2 id="finding-books-nearby"><a href="#finding-books-nearby"><!--[-->Finding &quot;Books Nearby&quot;<!--]--></a></h2><p><!--[-->On the pages that show details for each book I wanted to add additional information. I thought it would be interesting to show the 5 books closest to the book we are currently showing. Since we are dealing with coordinate points on a globe, the best way to calculate distance between two points is to use the Halversine formula:<!--]--></p><blockquote><!--[--><p><!--[-->The haversine formula determines the great-circle distance between two points on a sphere given their longitudes and latitudes. Important in navigation, it is a special case of a more general formula in spherical trigonometry, the law of haversines, that relates the sides and angles of spherical triangles.<!--]--></p><!--]--></blockquote><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="png" data-nuxt-img srcset="/_ipx/_/static/great_circle.png 1x, /_ipx/_/static/great_circle.png 2x" class="" src="/_ipx/_/static/great_circle.png"><!--]--></p><p><!--[-->Here&#39;s the code I used for calculating distance (using the Halversine formula):<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">from</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> math </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">import</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> radians, cos, sin, asin, sqrt
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">def</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> distance</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">origin</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">destination</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">):
</span></span><span class="line" line="4"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">    &quot;&quot;&quot;
</span></span><span class="line" line="5"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">    Calculate the great circle distance between two points
</span></span><span class="line" line="6"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">    on the earth (specified in decimal degrees)
</span></span><span class="line" line="7"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">    &quot;&quot;&quot;
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    lon1, lat1 </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> origin
</span></span><span class="line" line="10"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    lon2, lat2 </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> destination
</span></span><span class="line" line="11"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">    # convert decimal degrees to radians
</span></span><span class="line" line="12"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    lon1, lat1, lon2, lat2 </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF"> map</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(radians, [lon1, lat1, lon2, lat2])
</span></span><span class="line" line="13"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">    # haversine formula
</span></span><span class="line" line="14"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    dlon </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> lon2 </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">-</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> lon1
</span></span><span class="line" line="15"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    dlat </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> lat2 </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">-</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> lat1
</span></span><span class="line" line="16"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    a </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> sin(dlat</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">/</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">2</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">**</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">2</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> +</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> cos(lat1) </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">*</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> cos(lat2) </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">*</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> sin(dlon</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">/</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">2</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">**</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">2
</span></span><span class="line" line="17"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    c </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> 2</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672"> *</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> asin(sqrt(a))
</span></span><span class="line" line="18"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    r </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> 3956</span><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F"> # miles
</span></span><span class="line" line="19"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    return</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> c </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">*</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> r
</span></span></code><!--]--></pre><!--]--><p><!--[-->This formula assumes that the earth is a perfect sphere. Another approach would be to use the the Vincety Formula:<!--]--></p><blockquote><!--[--><p><!--[-->Vincenty&#39;s formulae are two related iterative methods used in geodesy to calculate the distance between two points on the surface of a spheroid, developed by Thaddeus Vincenty (1975a). They are based on the assumption that the figure of the Earth is an oblate spheroid, and hence are more accurate than methods that assume a spherical Earth, such as great-circle distance.<!--]--></p><!--]--></blockquote><p><!--[-->This distance is packaged in <code class=""><!--[-->geopy<!--]--></code> and can be calculated easily:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">import</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> geopy.distance
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">coords_1 </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> (</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">52.2296756</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">21.0122287</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">coords_2 </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> (</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">52.406374</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">16.9251681</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">)
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF">print</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> geopy.distance.vincenty(coords_1, coords_2).km
</span></span></code><!--]--></pre><!--]--><p><!--[-->Here&#39;s a look at the function I wrote for the <code class=""><!--[-->book_detail<!--]--></code> view. I have commented out parts that aren&#39;t related to finding nearby books:<!--]--></p><!--[--><pre class="language-python shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">def</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E"> book_detail</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">request</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">id</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">slug</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">):
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    book </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Book.objects.get(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">id</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF">id</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, </span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">slug</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">slug)
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    b_coords </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> (book.lat, book.lon)
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    all_books </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> Book.objects.all()
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    coords </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> [((b.lat, b.lon),b) </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> b </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> all_books]
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    distance_dict </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> {}
</span></span><span class="line" line="9"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    for</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> c </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">in</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> coords:
</span></span><span class="line" line="10"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">        if</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> c[</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">0</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">] </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">!=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> b_coords:
</span></span><span class="line" line="11"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">            distance_dict[c[</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">0</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">]]</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(distance(c[</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">0</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">],b_coords),c)
</span></span><span class="line" line="12"><span emptylineplaceholder="true">
</span></span><span class="line" line="13"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    sorted_nearby </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF"> sorted</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">(distance_dict.items(), </span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">key</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#66D9EF;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic">lambda</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#FD971F;--shiki-default-font-style:inherit;--shiki-dark-font-style:inherit;--shiki-sepia-font-style:italic"> x</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: x[</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">1</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">][</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">0</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">])[:</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">5</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">]
</span></span><span class="line" line="14"><span emptylineplaceholder="true">
</span></span><span class="line" line="15"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">    # map_book = [{&#39;loc&#39;:[float(book.lon), float(book.lat)],
</span></span><span class="line" line="16"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">    #              &#39;title&#39;:book.title,
</span></span><span class="line" line="17"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">    #              &#39;url&#39;:book.get_absolute_url()}]
</span></span><span class="line" line="18"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    context </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> {
</span></span><span class="line" line="19"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;book&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:book,
</span></span><span class="line" line="20"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">        # &#39;map_book&#39;:mark_safe(escapejs(json.dumps(map_book))),
</span></span><span class="line" line="21"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">        &#39;sorted_nearby&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:sorted_nearby,
</span></span><span class="line" line="22"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">    }
</span></span><span class="line" line="23"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">    return</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> render(request, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;books/book_detail.html&#39;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">, context)
</span></span></code><!--]--></pre><!--]--><p><!--[-->To find the 5 closest books I arrived at a solution that seems fairly convoluted and should be refactored, but works! I start with a queryset of all books, then use list comprehension to make a list of tuples containing <code class=""><!--[-->((&lt; longitutde &gt;, &lt; latitude &gt;), &lt; Book Object &gt;)<!--]--></code>. Then I loop over this list and create a dictionary where the keys are <code class=""><!--[-->(&lt; longitutde &gt;, &lt; latitude &gt;)<!--]--></code> and the values are tuples of the form: <code class=""><!--[-->(&lt; distance in miles &gt;, &lt; Book Object &gt;)<!--]--></code>. Finally, I use <code class=""><!--[-->sorted<!--]--></code> on <code class=""><!--[-->dictionary_dict.items()<!--]--></code> where the key is <code class=""><!--[-->lambda x: x[1][0]<!--]--></code>. The <code class=""><!--[-->[1]<!--]--></code> accesses the <code class=""><!--[-->value<!--]--></code> of the <code class=""><!--[-->(&lt; key &gt;, &lt; value&gt;)<!--]--></code> tuple returned by <code class=""><!--[-->items()<!--]--></code>, and the <code class=""><!--[-->[0]<!--]--></code> access the first item, which is the <code class=""><!--[-->distance<!--]--></code> value we calculated. Finally, I take the first <code class=""><!--[-->[:5]<!--]--></code> items of this sorted list.<!--]--></p><p><!--[-->With this approach I think I avoided the possible issue of ambiguity if we have two books with the same coordinates. I&#39;ll need to add this scenario to my test suite later.<!--]--></p><h2 id="testing-travis-ci"><a href="#testing-travis-ci"><!--[-->Testing &amp; Travis CI<!--]--></a></h2><p><!--[-->Speaking of testing, this applcation includes a simple testing suite (that I am currently working on expanding). I have also managed to setup Travis CI for this project. When I push code from my local repo to GitHub, Travis CI automatically runs test, and the commit message contains additional information about whether or not all of the tests were successful.<!--]--></p><p><!--[-->Setting up Travis CI is very simple. We need to grant Travis CI (.org) access to our GitHub account, enable Travis CI on the repository we are working with, and then add a <code class=""><!--[-->.travis.yml<!--]--></code> file to the top level of the project directory. Here&#39;s the <code class=""><!--[-->.travis.yml<!--]--></code> file I have for this project:<!--]--></p><!--[--><pre class="language-yml shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">language</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">python
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">python</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  - </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&#39;3.5&#39;
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">services</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  - </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">postgresql
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">env</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">: </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">-DJANGO=2.0 DB=postgresql
</span></span><span class="line" line="10"><span emptylineplaceholder="true">
</span></span><span class="line" line="11"><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">install</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:
</span></span><span class="line" line="12"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  - </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">pip install -r requirements.txt
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">before_script</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:
</span></span><span class="line" line="15"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  - </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">psql -c &quot;CREATE USER u_brian WITH PASSWORD &#39;password&#39;; ALTER USER u_brian CREATEDB;&quot; -U postgres
</span></span><span class="line" line="16"><span emptylineplaceholder="true">
</span></span><span class="line" line="17"><span style="--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672">script</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">:
</span></span><span class="line" line="18"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">  - </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">python manage.py test books/
</span></span></code><!--]--></pre><!--]--><p><!--[-->We can generate a Travis CI badge that shows the status of the current Github deploy with the following code:<!--]--></p><!--[--><pre class="language-html shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">[![Build
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">Status](https://travis-ci.org/briancaffey/django-leaflet-demo.svg?branch=master)](https://travis-ci.org/briancaffey/django-leaflet-demo)
</span></span></code><!--]--></pre><!--]--><p><!--[--><a href="https://travis-ci.org/briancaffey/django-leaflet-demo" rel="nofollow"><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="Build Status" data-nuxt-img srcset="https://travis-ci.org/briancaffey/django-leaflet-demo.svg?branch=master 1x, https://travis-ci.org/briancaffey/django-leaflet-demo.svg?branch=master 2x" class="" src="https://travis-ci.org/briancaffey/django-leaflet-demo.svg?branch=master"><!--]--></a><!--]--></p><h2 id="deploying-to-digitalocean"><a href="#deploying-to-digitalocean"><!--[-->Deploying to DigitalOcean<!--]--></a></h2><p><!--[-->Finally, I used DigitalOcean to deploy this app. I have used Heroku for most of my previous projects, but I decided to use DigitalOcean for this one to learn something new and get more experience with using Ubuntu and related tools for running a website: nginx and gunicorn.<!--]--></p><p><!--[-->Again, for I turned to Vitor&#39;s blog for a very straightforward introduction to deploying on DigitalOcean with a simple Droplet. You can read more about the instructions for deployment <a href="https://simpleisbetterthancomplex.com/tutorial/2016/10/14/how-to-deploy-to-digital-ocean.html" rel="nofollow"><!--[-->here<!--]--></a>, and I can say that I had no problems following the instructions step by step. Here are the <code class=""><!--[-->gunicorn<!--]--></code> and <code class=""><!--[-->nginx<!--]--></code> scripts I have used to successfully deploy my project:<!--]--></p><p><!--[--><em><!--[-->/home/brian/bin/gunicorn_start<!--]--></em><!--]--></p><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D;--shiki-sepia:#88846F">#!/bin/bash
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">NAME</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">&quot;django-leaflet-demo&quot;
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">DIR</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">/home/brian/django-leaflet-demo
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">USER</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">brian
</span></span><span class="line" line="6"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">GROUP</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">brian
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">WORKERS</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">3
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">BIND</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">unix:/home/brian/run/gunicorn.sock
</span></span><span class="line" line="9"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">DJANGO_SETTINGS_MODULE</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">djangoapp.settings
</span></span><span class="line" line="10"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">DJANGO_WSGI_MODULE</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">djangoapp.wsgi
</span></span><span class="line" line="11"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">LOG_LEVEL</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">error
</span></span><span class="line" line="12"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF">cd</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> $DIR
</span></span><span class="line" line="13"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF">source</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> ../bin/activate
</span></span><span class="line" line="14"><span emptylineplaceholder="true">
</span></span><span class="line" line="15"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">export</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> DJANGO_SETTINGS_MODULE</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">$DJANGO_SETTINGS_MODULE
</span></span><span class="line" line="16"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">export</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> PYTHONPATH</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">$DIR:$PYTHONPATH
</span></span><span class="line" line="17"><span emptylineplaceholder="true">
</span></span><span class="line" line="18"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF">exec</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74"> ../bin/gunicorn</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2"> ${DJANGO_WSGI_MODULE}</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">:application</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> \
</span></span><span class="line" line="19"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">  --name=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">$NAME</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> \
</span></span><span class="line" line="20"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">  --workers=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">$WORKERS</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> \
</span></span><span class="line" line="21"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">  --user=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">$USER</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> \
</span></span><span class="line" line="22"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">  --group=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">$GROUP</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> \
</span></span><span class="line" line="23"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">  --bind=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">$BIND</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> \
</span></span><span class="line" line="24"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">  --log-level=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">$LOG_LEVEL</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF"> \
</span></span><span class="line" line="25"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF">  --log-file=-
</span></span></code><!--]--></pre><!--]--><p><!--[--><em><!--[-->/etc/nginx/sites-available<!--]--></em><!--]--></p><!--[--><pre class="language-yml shiki shiki-themes github-light github-dark monokai" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">upstream app_server {
</span></span><span class="line" line="2"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">server unix:/home/brian/run/gunicorn.sock fail_timeout=0;
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">}
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">server {
</span></span><span class="line" line="6"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">listen 80;
</span></span><span class="line" line="7"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">server_name 159.89.235.193
</span></span><span class="line" line="8"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">keepalive_timeout 5;
</span></span><span class="line" line="9"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">client_max_body_size 4G;
</span></span><span class="line" line="10"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">access_log /home/brian/logs/nginx-access.log;
</span></span><span class="line" line="11"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">error_log /home/brian/logs/nginx-error.log;
</span></span><span class="line" line="12"><span emptylineplaceholder="true">
</span></span><span class="line" line="13"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">location /static/ {
</span></span><span class="line" line="14"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">alias /home/brian/static/;
</span></span><span class="line" line="15"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">}
</span></span><span class="line" line="16"><span emptylineplaceholder="true">
</span></span><span class="line" line="17"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">location / {
</span></span><span class="line" line="18"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">try_files $uri @proxy_to_app;
</span></span><span class="line" line="19"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">}
</span></span><span class="line" line="20"><span emptylineplaceholder="true">
</span></span><span class="line" line="21"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">location @proxy_to_app {
</span></span><span class="line" line="22"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span></span><span class="line" line="23"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">proxy_set_header Host $http_host;
</span></span><span class="line" line="24"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">proxy_redirect off;
</span></span><span class="line" line="25"><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74">proxy_pass http://app_server;
</span></span><span class="line" line="26"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">}
</span></span><span class="line" line="27"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2">}
</span></span></code><!--]--></pre><!--]--><p><!--[-->Finally, here is the Supervisor configuration file that runs the gunicorn server:<!--]--></p><!--[--><pre class="" style=""><!--[--><code>[program:django-leaflet-demo]
command=/home/brian/bin/gunicorn_start
user=brian
autostart=true
autorestart=true
redirect_stderr=true
stdout_logfile=/home/brian/logs/gunicorn-error.log
</code><!--]--></pre><!--]--><p><!--[-->I would definitely like to dive into DigitalOcean deployment in more depth in my next post.<!--]--></p><p><!--[-->For now, you can view the live project on DigitalOcean here: <a href="http://159.89.235.193/books/" rel="nofollow"><!--[-->http://159.89.235.193/books/<!--]--></a>. In the future I would like to use this Droplet to do more demo apps like this one as I continue to learn the ins and outs of using Django and more frontend tools. Thanks for reading to the end and let me know if you have any comments or critiques on how I went about this project, I would be happy to hear from you!<!--]--></p><style>html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}</style></div><!--]--><div class="text-center pb-4 pt-8"><button class="mc-btn rounded py-1 px-2"> Show Disqus Comments üí¨ </button></div><!----><h1></h1></div></article><!--]--><div class="mx-auto max-w-6xl p-4 lg:px-16 text-center"><hr class="mt-4"><div class="align-center py-4"><div class="pb-4">Join my mailing list to get updated whenever I publish a new article.</div><div class="flex align-center justify-center"><div id="mc_embed_signup" class="w-full md:w-1/2 flex-shrink justify-center"><form id="mc-embedded-subscribe-form" action="https://github.us2.list-manage.com/subscribe/post?u=43a795784ca963e25903a0da6&amp;id=9937fe4fc5" method="post" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate><div id="mc_embed_signup_scroll" class="grid grid-cols-1 sm:grid-cols-2 gap-4"><input id="mce-EMAIL" type="email" value="" name="EMAIL" placeholder="Enter your email address" class="rounded mc text-center" autocomplete="on"><div style="position:absolute;left:-5000px;" aria-hidden="true"><input type="text" name="b_43a795784ca963e25903a0da6_9937fe4fc5" tabindex="-1" value=""></div><div class="text-right" style="width:100%;"><input id="mc-embedded-subscribe" type="submit" value="Subscribe" name="subscribe" class="mc-btn rounded px-2 py-1 w-full"></div></div></form></div></div></div><hr><div class="py-4">Thanks for checking out my site!</div><div class="pb-4"> ¬© 2025 Brian Caffey </div></div></div></div></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true" data-src="/2018/02/19/leaflet-maps-with-django/_payload.json?0e22c824-be41-43ea-9d89-8a708e47c85d">[{"state":1,"once":13,"_errors":14,"serverRendered":5,"path":17,"pinia":18,"prerenderedAt":20},["Reactive",2],{"$scolor-mode":3,"$snuxt-i18n-meta":7,"$ssite-config":8},{"preference":4,"value":4,"unknown":5,"forced":6},"system",true,false,{},{"currentLocale":9,"defaultLocale":9,"env":10,"name":11,"url":12},"en","production","briancaffey.github.io","https://briancaffey.github.io",["Set"],["ShallowReactive",15],{"leaflet-maps-with-django":16,"content-query-P8bdsSNdLO":16},null,"/2018/02/19/leaflet-maps-with-django",["Reactive",19],{},1753036568219]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{url:"https://briancaffey.github.io",mdc:{useNuxtImage:true,components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1753036511474,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{langs:["py","python","bash","cpp","yaml","yml","powershell","json","sql","html","vue-html","javascript","js","php","dockerfile","docker","make","makefile","typescript","ts","terraform"],theme:{default:"github-light",dark:"github-dark",sepia:"monokai"},highlighter:"shiki"},wsUrl:"",documentDriven:false,host:"",trailingSlash:false,search:"",contentHead:true,anchorLinks:{depth:4,exclude:[1]}},i18n:{baseUrl:"",defaultLocale:"en",defaultDirection:"ltr",strategy:"no_prefix",lazy:false,rootRedirect:"",routesNameSeparator:"___",defaultLocaleRouteNameSuffix:"default",skipSettingLocaleOnNavigate:false,differentDomains:false,trailingSlash:false,configLocales:[{code:"en",emoji:"flag-us",iso:"en-US",name:"English",flag:"üá∫üá∏",files:["i18n/en-US.js"]},{code:"fr",emoji:"flag-fr",iso:"fr-FR",name:"Fran√ßais",flag:"üá´üá∑",files:["i18n/fr-FR.js"]},{code:"zh",emoji:"flag-cn",iso:"zh-ZH",name:"ÁÆÄ‰Ωì‰∏≠Êñá",flag:"üá®üá≥",files:["i18n/zh-ZH.js"]},{code:"ru",emoji:"flag-ru",iso:"ru-RU",name:"–†—É—Å—Å–∫–∏–π",flag:"üá∑üá∫",files:["i18n/ru-RU.js"]},{code:"ja",emoji:"flag-jp",iso:"ja-JP",name:"Êó•Êú¨Ë™û",flag:"üáØüáµ",files:["i18n/jp-JP.js"]},{code:"in",emoji:"flag-in",iso:"hi-IN",name:"‡§π‡§ø‡§Ç‡§¶‡•Ä",flag:"üáÆüá≥",files:["i18n/hi-IN.js"]}],locales:{en:{domain:""},fr:{domain:""},zh:{domain:""},ru:{domain:""},ja:{domain:""},in:{domain:""}},detectBrowserLanguage:{alwaysRedirect:false,cookieCrossOrigin:false,cookieDomain:"",cookieKey:"i18n_redirected",cookieSecure:false,fallbackLocale:"",redirectOn:"root",useCookie:true},experimental:{localeDetector:"",switchLocalePathLinkSSR:false,autoImportTranslationFunctions:false}},gtag:{enabled:true,id:"G-S8TVBBMW66",initCommands:[],config:{},tags:[],loadingStrategy:"defer",url:"https://www.googletagmanager.com/gtag/js"}},app:{baseURL:"/",buildId:"0e22c824-be41-43ea-9d89-8a708e47c85d",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>