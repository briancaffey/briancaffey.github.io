<!DOCTYPE html><html  lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Agents of Inference: Speed of Light -- Accelerating my Generative AI Agents project with NVIDIA NIMs, TensorRT and TensorRT-LLM</title><style>html{font-family:Montserrat,Arial,Sans Serif;font-size:16px;word-spacing:1px;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;box-sizing:border-box}*,:after,:before{box-sizing:border-box;margin:0}.button--green{border:1px solid #3b8070;border-radius:4px;color:#3b8070;display:inline-block;padding:10px 30px;text-decoration:none}.button--green:hover{background-color:#3b8070;color:#fff}.button--grey{border:1px solid #35495e;border-radius:4px;color:#35495e;display:inline-block;margin-left:15px;padding:10px 30px;text-decoration:none}.button--grey:hover{background-color:#35495e;color:#fff}</style><style>span.emoji-mart-emoji[data-v-d2ff5fdf]{padding:0}.selected[data-v-d2ff5fdf]{text-shadow:.25px 0 0 #000}.picker[data-v-d2ff5fdf]{margin-left:auto;margin-right:auto;position:absolute;top:10px;transform:translate(50%,50%)}.top[data-v-d2ff5fdf]{background-color:var(--color-primary);height:3px;width:100%}</style><style>.selected[data-v-ed0088f5]{text-shadow:.9px 0 0}</style><style>span.emoji-mart-emoji[data-v-2649ce61]{padding:0;transition:transform .2s}span.emoji-mart-emoji[data-v-2649ce61]:hover{transform:scale(1.3)}.centered[data-v-2649ce61]{left:50vw;margin-left:auto;margin-right:auto;position:absolute;right:50vw}</style><style>.emoji-mart,.emoji-mart *{-webkit-box-sizing:border-box;box-sizing:border-box;line-height:1.15}.emoji-mart{display:-webkit-box;display:-ms-flexbox;display:flex;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,sans-serif;font-size:16px;-webkit-box-orient:vertical;-webkit-box-direction:normal;background:#fff;border:1px solid #d9d9d9;border-radius:5px;color:#222427;-ms-flex-direction:column;flex-direction:column;height:420px}.emoji-mart-emoji{background:none;border:none;-webkit-box-shadow:none;box-shadow:none;padding:6px}.emoji-mart-emoji span{display:inline-block}.emoji-mart-preview-emoji .emoji-mart-emoji span{font-size:32px;height:38px;width:38px}.emoji-type-native{font-family:Segoe UI Emoji,Segoe UI Symbol,Segoe UI,Apple Color Emoji,Twemoji Mozilla,Noto Color Emoji,EmojiOne Color,Android Emoji;word-break:keep-all}.emoji-type-image{background-size:6100%}.emoji-type-image.emoji-set-apple{background-image:url(https://unpkg.com/emoji-datasource-apple@15.0.1/img/apple/sheets-256/64.png)}.emoji-type-image.emoji-set-facebook{background-image:url(https://unpkg.com/emoji-datasource-facebook@15.0.1/img/facebook/sheets-256/64.png)}.emoji-type-image.emoji-set-google{background-image:url(https://unpkg.com/emoji-datasource-google@15.0.1/img/google/sheets-256/64.png)}.emoji-type-image.emoji-set-twitter{background-image:url(https://unpkg.com/emoji-datasource-twitter@15.0.1/img/twitter/sheets-256/64.png)}.emoji-mart-bar{border:0 solid #d9d9d9}.emoji-mart-bar:first-child{border-bottom-width:1px;border-top-left-radius:5px;border-top-right-radius:5px}.emoji-mart-bar:last-child{border-bottom-left-radius:5px;border-bottom-right-radius:5px;border-top-width:1px}.emoji-mart-scroll{overflow-y:scroll;position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1;padding:0 6px 6px;will-change:transform;z-index:0;-webkit-overflow-scrolling:touch}.emoji-mart-anchors{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;color:#858585;justify-content:space-between;line-height:0;padding:0 6px}.emoji-mart-anchor{display:block;position:relative;-webkit-box-flex:1;background:none;border:none;-webkit-box-shadow:none;box-shadow:none;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;padding:12px 4px;text-align:center;-webkit-transition:color .1s ease-out;transition:color .1s ease-out}.emoji-mart-anchor-selected,.emoji-mart-anchor:hover{color:#464646}.emoji-mart-anchor-selected .emoji-mart-anchor-bar{bottom:0}.emoji-mart-anchor-bar{background-color:#464646;bottom:-3px;height:3px;left:0;position:absolute;width:100%}.emoji-mart-anchors i{display:inline-block;max-width:22px;width:100%}.emoji-mart-anchors svg{fill:currentColor;max-height:18px}.emoji-mart .scroller{height:250px;position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1;padding:0 6px 6px;will-change:transform;z-index:0;-webkit-overflow-scrolling:touch}.emoji-mart-search{margin-top:6px;padding:0 6px}.emoji-mart-search input{border:1px solid #d9d9d9;border-radius:25px;display:block;font-size:16px;outline:0;padding:.2em .6em;width:100%}.emoji-mart-search-results{height:250px;overflow-y:scroll}.emoji-mart-category{position:relative}.emoji-mart-category .emoji-mart-emoji span{cursor:default;position:relative;text-align:center;z-index:1}.emoji-mart-category .emoji-mart-emoji:hover:before,.emoji-mart-emoji-selected:before{background-color:#f4f4f4;border-radius:100%;content:"";height:100%;left:0;opacity:1;position:absolute;top:0;width:100%;z-index:0}.emoji-mart-category-label{position:-webkit-sticky;position:sticky;top:0}.emoji-mart-static .emoji-mart-category-label{position:relative;z-index:2}.emoji-mart-category-label h3{background-color:#fff;background-color:#fffffff2;display:block;font-size:16px;font-weight:500;padding:5px 6px;width:100%}.emoji-mart-emoji{display:inline-block;font-size:0;position:relative}.emoji-mart-no-results{color:#858585;font-size:14px;padding-top:70px;text-align:center}.emoji-mart-no-results .emoji-mart-category-label{display:none}.emoji-mart-no-results .emoji-mart-no-results-label{margin-top:.2em}.emoji-mart-no-results .emoji-mart-emoji:hover:before{content:none}.emoji-mart-preview{height:70px;position:relative}.emoji-mart-preview-data,.emoji-mart-preview-emoji,.emoji-mart-preview-skins{position:absolute;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%)}.emoji-mart-preview-emoji{left:12px}.emoji-mart-preview-data{left:68px;right:12px;word-break:break-all}.emoji-mart-preview-skins{right:30px;text-align:right}.emoji-mart-preview-name{font-size:14px}.emoji-mart-preview-shortname{color:#888;font-size:12px}.emoji-mart-preview-emoticon+.emoji-mart-preview-emoticon,.emoji-mart-preview-shortname+.emoji-mart-preview-emoticon,.emoji-mart-preview-shortname+.emoji-mart-preview-shortname{margin-left:.5em}.emoji-mart-preview-emoticon{color:#bbb;font-size:11px}.emoji-mart-title span{display:inline-block;vertical-align:middle}.emoji-mart-title .emoji-mart-emoji{padding:0}.emoji-mart-title-label{color:#999a9c;font-size:21px;font-weight:300}.emoji-mart-skin-swatches{background-color:#fff;border:1px solid #d9d9d9;border-radius:12px;font-size:0;padding:2px 0}.emoji-mart-skin-swatches-opened .emoji-mart-skin-swatch{padding:0 2px;width:16px}.emoji-mart-skin-swatches-opened .emoji-mart-skin-swatch-selected:after{opacity:.75}.emoji-mart-skin-swatch{display:inline-block;-webkit-transition-duration:.125s;transition-duration:.125s;-webkit-transition-property:width,padding;transition-property:width,padding;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out;vertical-align:middle;width:0}.emoji-mart-skin-swatch:first-child{-webkit-transition-delay:0s;transition-delay:0s}.emoji-mart-skin-swatch:nth-child(2){-webkit-transition-delay:.03s;transition-delay:.03s}.emoji-mart-skin-swatch:nth-child(3){-webkit-transition-delay:.06s;transition-delay:.06s}.emoji-mart-skin-swatch:nth-child(4){-webkit-transition-delay:.09s;transition-delay:.09s}.emoji-mart-skin-swatch:nth-child(5){-webkit-transition-delay:.12s;transition-delay:.12s}.emoji-mart-skin-swatch:nth-child(6){-webkit-transition-delay:.15s;transition-delay:.15s}.emoji-mart-skin-swatch-selected{padding:0 2px;position:relative;width:16px}.emoji-mart-skin-swatch-selected:after{background-color:#fff;border-radius:100%;content:"";height:4px;left:50%;margin:-2px 0 0 -2px;opacity:0;pointer-events:none;position:absolute;top:50%;-webkit-transition:opacity .2s ease-out;transition:opacity .2s ease-out;width:4px}.emoji-mart-skin{border-radius:100%;display:inline-block;max-width:12px;padding-top:100%;width:100%}.emoji-mart-skin-tone-1{background-color:#ffc93a}.emoji-mart-skin-tone-2{background-color:#fadcbc}.emoji-mart-skin-tone-3{background-color:#e0bb95}.emoji-mart-skin-tone-4{background-color:#bf8f68}.emoji-mart-skin-tone-5{background-color:#9b643d}.emoji-mart-skin-tone-6{background-color:#594539}.emoji-mart .vue-recycle-scroller{position:relative}.emoji-mart .vue-recycle-scroller.direction-vertical:not(.page-mode){overflow-y:auto}.emoji-mart .vue-recycle-scroller.direction-horizontal:not(.page-mode){overflow-x:auto}.emoji-mart .vue-recycle-scroller.direction-horizontal{display:-webkit-box;display:-ms-flexbox;display:flex}.emoji-mart .vue-recycle-scroller__slot{-webkit-box-flex:1;-ms-flex:auto 0 0px;flex:auto 0 0}.emoji-mart .vue-recycle-scroller__item-wrapper{-webkit-box-flex:1;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-flex:1;flex:1;overflow:hidden;position:relative}.emoji-mart .vue-recycle-scroller.ready .vue-recycle-scroller__item-view{left:0;position:absolute;top:0;will-change:transform}.emoji-mart .vue-recycle-scroller.direction-vertical .vue-recycle-scroller__item-wrapper{width:100%}.emoji-mart .vue-recycle-scroller.direction-horizontal .vue-recycle-scroller__item-wrapper{height:100%}.emoji-mart .vue-recycle-scroller.ready.direction-vertical .vue-recycle-scroller__item-view{width:100%}.emoji-mart .vue-recycle-scroller.ready.direction-horizontal .vue-recycle-scroller__item-view{height:100%}.emoji-mart .resize-observer[data-v-b329ee4c]{background-color:transparent;border:none;opacity:0}.emoji-mart .resize-observer[data-v-b329ee4c],.emoji-mart .resize-observer[data-v-b329ee4c] object{display:block;height:100%;left:0;overflow:hidden;pointer-events:none;position:absolute;top:0;width:100%;z-index:-1}.emoji-mart-search .hidden{display:none;visibility:hidden}</style><style>span.emoji-mart-emoji[data-v-03afe4fa]{padding:0;transition:transform .2s}span.emoji-mart-emoji[data-v-03afe4fa]:hover{transform:scale(1.3)}.picker[data-v-03afe4fa]{left:0;margin-left:auto;margin-right:auto;position:absolute;right:0;z-index:10000000000}.localepicker[data-v-03afe4fa]{background-color:var(--bg)}.localeText[data-v-03afe4fa]{color:var(--color-primary)}</style><style>.tag[data-v-eb2063c1]{background-color:var(--color-tag);transition:transform .2s}.tag[data-v-eb2063c1]:hover{transform:scale(1.05)}</style><style>pre code .line{display:block}</style><link rel="stylesheet" href="/_nuxt/entry.C_qR6n1r.css" crossorigin><link rel="stylesheet" href="/_nuxt/app.BAXwoxDU.css" crossorigin><link rel="preload" as="fetch" crossorigin="anonymous" href="/2024/06/24/agents-of-inference-speed-of-light-nvidia-langchain-generative-ai-agents-developer-contest-update/_payload.json?711989cd-b755-45e7-b273-f0754c0f755f"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/U2gz5u3s.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/D3Q7tgbv.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CAEbC5FA.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BE4wn3fs.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ivQeT1ix.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BwRoW_yn.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cz9IHiFo.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/C_-EP1mu.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CeeZmN6j.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/BWfwsB7c.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CDdUvEIO.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/PV-tEdEs.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/B5fv-1Xq.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/iyVKi4R7.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/Fo6dHlhp.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/CZYsndi7.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/C94jHEjt.js"><link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/_nuxt/builds/meta/711989cd-b755-45e7-b273-f0754c0f755f.json"><link rel="prefetch" as="script" crossorigin href="/_nuxt/Dk67likk.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/BU1UZLbD.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/CZvWFDQc.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/yEdly4JE.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/CvvIFhEj.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/DFI9gCi9.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/DE3BAxce.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/uYY1jy-2.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/BiTVazLu.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/DnLIRtEt.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/CZsi5-5V.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/BDjFqGfp.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/Cebmboq7.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/CRRfaG9P.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/fV3BeRRD.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/6PKCu2pi.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/HSA0rOnf.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/Dbk39hGM.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/DlT8tiJO.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/b04OUO_Q.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/DPR8_a9D.js"><meta hid="description" name="description" content="Brian Caffey's personal website"><link rel="icon" type="image/x-icon" href="/favicon.ico"><meta name="robots" content="all"><meta property="twitter:creator" content="@briancaffey"><meta property="twitter:site" content="@briancaffey"><meta property="og:title" content="Agents of Inference: Speed of Light -- Accelerating my Generative AI Agents project with NVIDIA NIMs, TensorRT and TensorRT-LLM"><meta property="og:description" content="This article is a brief discusion on recent updates to my project for the Generative AI Agents Developer Contest by NVIDIA and LangChain"><meta property="og:image" content="https://briancaffey.github.io/static/aoi/aoi_title.png"><meta property="twitter:image" content="https://briancaffey.github.io/static/aoi/aoi_title.png"><meta property="twitter:card" content="summary_large_image"><script type="module" src="/_nuxt/U2gz5u3s.js" crossorigin></script><script>"use strict";(()=>{const t=window,e=document.documentElement,c=["dark","light"],n=getStorageValue("localStorage","nuxt-color-mode")||"system";let i=n==="system"?u():n;const r=e.getAttribute("data-color-mode-forced");r&&(i=r),l(i),t["__NUXT_COLOR_MODE__"]={preference:n,value:i,getColorScheme:u,addColorScheme:l,removeColorScheme:d};function l(o){const s=""+o+"-mode",a="";e.classList?e.classList.add(s):e.className+=" "+s,a&&e.setAttribute("data-"+a,o)}function d(o){const s=""+o+"-mode",a="";e.classList?e.classList.remove(s):e.className=e.className.replace(new RegExp(s,"g"),""),a&&e.removeAttribute("data-"+a)}function f(o){return t.matchMedia("(prefers-color-scheme"+o+")")}function u(){if(t.matchMedia&&f("").media!=="not all"){for(const o of c)if(f(":"+o).matches)return o}return"light"}})();function getStorageValue(t,e){switch(t){case"localStorage":return window.localStorage.getItem(e);case"sessionStorage":return window.sessionStorage.getItem(e);case"cookie":return getCookie(e);default:return null}}function getCookie(t){const c=("; "+window.document.cookie).split("; "+t+"=");if(c.length===2)return c.pop()?.split(";").shift()}</script></head><body><div id="__nuxt"><div><div><div data-v-d2ff5fdf><div class="mx-auto flex py-2 px-2 sm:px-4 items-center max-w-6xl justify-center" data-v-d2ff5fdf><div class="justify-left flex-grow flex-cols-4" data-v-d2ff5fdf><a href="/" class="text-xl" data-v-d2ff5fdf><span class="hidden sm:inline text-2xl" data-v-d2ff5fdf>Brian Caffey</span><span class="inline sm:hidden" data-v-d2ff5fdf>JBC</span></a></div><div class="flex-grow relative" data-v-d2ff5fdf><nav z-index="10000" data-v-d2ff5fdf data-v-ed0088f5><div data-v-ed0088f5><ul class="items-right float-right hidden md:flex" data-v-ed0088f5><li class="px-4 text-lg" data-v-ed0088f5><a href="/blog/1" class="" data-v-ed0088f5>Blog</a></li><li class="px-4 text-lg" data-v-ed0088f5><a href="/contact" class="" data-v-ed0088f5>Contact</a></li></ul><div class="flex justify-end md:hidden z-1000" data-v-ed0088f5><button class="flex items-center px-3 py-2 border rounded menu-icon" data-v-ed0088f5><svg class="fill-current h-3 w-3" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" data-v-ed0088f5><title data-v-ed0088f5>Menu</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" data-v-ed0088f5></path></svg></button></div><!----></div></nav></div></div><div class="picker" data-v-d2ff5fdf><div class="centered" data-v-d2ff5fdf data-v-2649ce61><div class="grid items-center justify-center" data-v-2649ce61><ul class="flex px-4" data-v-2649ce61><!--[--><li class="md:px-1 px-1 cursor-pointer" data-v-2649ce61><span aria-label="🖥️, desktop_computer" class="emoji-mart-emoji" data-v-2649ce61><span class="emoji-set-apple emoji-type-image" style="background-position:51.67% 95%;width:32px;height:32px;"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-2649ce61><span aria-label="🌞, sun_with_face" class="emoji-mart-emoji" data-v-2649ce61><span class="emoji-set-apple emoji-type-image" style="background-position:8.33% 48.33%;width:32px;height:32px;"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-2649ce61><span aria-label="🌚, new_moon_with_face" class="emoji-mart-emoji" data-v-2649ce61><span class="emoji-set-apple emoji-type-image" style="background-position:8.33% 41.67%;width:32px;height:32px;"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-2649ce61><span aria-label="☕, coffee" class="emoji-mart-emoji" data-v-2649ce61><span class="emoji-set-apple emoji-type-image" style="background-position:95% 30%;width:32px;height:32px;"></span></span></li><!--]--><li class="md:px-1 px-1 cursor-pointer" data-v-2649ce61><div data-v-2649ce61 data-v-03afe4fa><ul data-v-03afe4fa><li class="md:px-1 px-1 cursor-pointer" data-v-03afe4fa><span aria-label="🇺🇸, us, flag-us" class="emoji-mart-emoji" data-v-03afe4fa><span class="emoji-set-apple emoji-type-image" style="background-position:6.67% 45%;width:32px;height:32px;"></span></span></li></ul><div class="rounded-md z-10 picker" data-v-03afe4fa><!----></div></div></li></ul></div></div></div></div><!--[--><article><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="This article is a brief discusion on recent updates to my project for the Generative AI Agents Developer Contest by NVIDIA and LangChain" data-nuxt-img srcset="/_ipx/f_webp/static/aoi/aoi_title.png 1x, /_ipx/f_webp/static/aoi/aoi_title.png 2x" class="pt-2 w-full object-cover" style="height:32rem;" src="/_ipx/f_webp/static/aoi/aoi_title.png"><div class="mx-auto max-w-5xl px-2 sm:px-4 md:px-4 lg:px-16 mt-2"><h1 class="prose text-4xl leading-9 py-4 font-bold">Agents of Inference: Speed of Light -- Accelerating my Generative AI Agents project with NVIDIA NIMs, TensorRT and TensorRT-LLM</h1><div class="flex flex-wrap -ml-1 py-2"><!--[--><a href="/blog/tags/nvidia/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>nvidia 🏷️ <!----></div></a><a href="/blog/tags/langchain/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>langchain 🏷️ <!----></div></a><a href="/blog/tags/agents/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>agents 🏷️ <!----></div></a><a href="/blog/tags/rtx/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>rtx 🏷️ <!----></div></a><a href="/blog/tags/gpu/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>gpu 🏷️ <!----></div></a><a href="/blog/tags/tensorrt/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>tensorrt 🏷️ <!----></div></a><a href="/blog/tags/tensorrt-llm/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>tensorrt-llm 🏷️ <!----></div></a><a href="/blog/tags/ai/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>ai 🏷️ <!----></div></a><a href="/blog/tags/llm/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>llm 🏷️ <!----></div></a><a href="/blog/tags/llama/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>llama 🏷️ <!----></div></a><a href="/blog/tags/007/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>007 🏷️ <!----></div></a><a href="/blog/tags/stable-diffusion/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>stable-diffusion 🏷️ <!----></div></a><a href="/blog/tags/stable-video-diffusion/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>stable-video-diffusion 🏷️ <!----></div></a><a href="/blog/tags/comfyui/" class="" data-v-eb2063c1><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mb-1 uppercase cursor-pointer tag" data-v-eb2063c1>comfyui 🏷️ <!----></div></a><!--]--></div><div class="flex py-2"><!--[--><div class="pr-4 rounded"><a href="https://x.com/briancaffey/status/1802754703207583886"><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" width="25" alt="https://x.com/briancaffey/status/1802754703207583886" data-nuxt-img sizes="25px" srcset="/_ipx/w_25&amp;f_webp/icons/x.png 25w, /_ipx/w_50&amp;f_webp/icons/x.png 50w" class="rounded" src="/_ipx/w_50&amp;f_webp/icons/x.png"></a></div><!--]--></div><p class="blog-date text-gray-500 mb-4">Last updated June 24, 2024</p><!----><div class="markdown"><h2 id="tldr"><a href="#tldr"><!--[-->tl;dr<!--]--></a></h2><p><!--[-->&quot;Agents of Inference: Speed of Light&quot; is an update to my original entry for the Generative AI Agents Developer Contest by NVIDIA and LangChain. This update focuses on how I accelerated local text, image and video generation using TensorRT, TensorRT-LLM and NVIDIA NIMs. You can read the original article about &quot;Agents of Inference&quot; <a href="https://briancaffey.github.io/2024/06/17/agents-of-inference-nvidia-and-langchain-generative-ai-agent-developer-contest" rel="nofollow"><!--[-->here<!--]--></a>.<!--]--></p><p><!--[-->Here&#39;s my original project submission post on 𝕏 that introduces the idea of generating short 007-style films using agents, LLMs and stable diffusion:<!--]--></p><!--[--><blockquote class="twitter-tweet tw-align-center" data-theme="dark"><p lang="en" dir="ltr">Agents of Inference<br>🍸🤵🏼‍♂️⚡️🎥🎬<a href="https://twitter.com/hashtag/NVIDIADevContest?src=hash&amp;ref_src=twsrc%5Etfw">#NVIDIADevContest</a> <a href="https://twitter.com/hashtag/LangChain?src=hash&amp;ref_src=twsrc%5Etfw">#LangChain</a> <a href="https://twitter.com/NVIDIAAIDev?ref_src=twsrc%5Etfw">@NVIDIAAIDev</a> <a href="https://t.co/VT3rgzFbD6">pic.twitter.com/VT3rgzFbD6</a></p>— Brian Caffey (@briancaffey) <a href="https://twitter.com/briancaffey/status/1802754703207583886?ref_src=twsrc%5Etfw">June 17, 2024</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><!--]--><p><!--[-->Here&#39;s a link to the <a href="https://github.com/briancaffey/agents-of-inference" rel="nofollow"><!--[-->Agents of Inference code repository on GitHub<!--]--></a>.<!--]--></p><h2 id="nvidia-nim-inference-microservices"><a href="#nvidia-nim-inference-microservices"><!--[-->NVIDIA NIM inference microservices<!--]--></a></h2><p><!--[-->I thought NVIDIA NIMs was one of the most exciting announcements from GTC 2024. I&#39;m a big fan of using docker containers everywhere, and the idea of standardizing NVIDIA tools and dependencies seemed to make a lot of sense. I had previously struggled to get TensorRT-LLM installed on Windows using example repos provided by NVIDIA.<!--]--></p><p><!--[-->A few weeks ago NVIDIA announced that NVIDIA NIMs can be downloaded and run anywhere. I was able to download this NIM for the <code><!--[-->meta/llama3-8b-instruct<!--]--></code> model:<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="llama3 nim" data-nuxt-img srcset="/_ipx/_/static/aoi/meta-llama3-nim.png 1x, /_ipx/_/static/aoi/meta-llama3-nim.png 2x" src="/_ipx/_/static/aoi/meta-llama3-nim.png"><!--]--></p><p><!--[-->Here are the logs for my NVIDIA NIM <code><!--[-->Meta/Llama-3-8B-Instruct<!--]--></code> running in docker container on Windows Subsystem for Linux on my NVIDIA GeForce RTX 4090 GPU-powered PC. Notice that it generates over 50 tokens per second!<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="trt llama3 local" data-nuxt-img srcset="/_ipx/_/static/aoi/trt-llama3.png 1x, /_ipx/_/static/aoi/trt-llama3.png 2x" src="/_ipx/_/static/aoi/trt-llama3.png"><!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="token factory" data-nuxt-img srcset="/_ipx/_/static/aoi/token-factory.png 1x, /_ipx/_/static/aoi/token-factory.png 2x" src="/_ipx/_/static/aoi/token-factory.png"><!--]--></p><p><!--[-->The one main hurdle I faced when running the NIM local was an error about no runnable profiles being available:<!--]--></p><pre class="language-text"><!--[--><code>ERROR 06-23 15:41:21.19 utils.py:21] Could not find a profile that is currently runnable with the detected hardware. Please check the system information below and make sure you have enough free GPUs.
SYSTEM INFO
- Free GPUs: &lt;None&gt;
- Non-free GPUs:
  -  [2684:10de] (0) NVIDIA GeForce RTX 4090 [current utilization: 7%]
</code><!--]--></pre><p><!--[-->This seemed odd, and I found another user with the same issue on the NVIDIA Developer Forum. I was able to get around this by going into the EUFI/BIOS of my PC and switch to integrated graphics:<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="bios" data-nuxt-img srcset="/_ipx/_/static/aoi/bios.jpg 1x, /_ipx/_/static/aoi/bios.jpg 2x" src="/_ipx/_/static/aoi/bios.jpg"><!--]--></p><p><!--[-->It was great to be able to run &quot;Agents of Inference&quot; using NVIDIA NIM because it is just as simple as running a docker container:<!--]--></p><pre class="language-text"><!--[--><code>export CONTAINER_NAME=llama3-8b-instruct
export IMG_NAME=&quot;nvcr.io/nim/meta/${CONTAINER_NAME}:1.0.0&quot;
export LOCAL_NIM_CACHE=~/.cache/nim
mkdir -p &quot;$LOCAL_NIM_CACHE&quot;
docker run -it --rm --name=$CONTAINER_NAME \
  --runtime=nvidia \
  --gpus all \
  --shm-size=16GB \
  -e NGC_API_KEY \
  -v &quot;$LOCAL_NIM_CACHE:/opt/nim/.cache&quot; \
  -u $(id -u) \
  -p 8000:8000 \
  $IMG_NAME
</code><!--]--></pre><p><!--[-->Before getting this to work, I was able to get a <code><!--[-->/chat/completions<!--]--></code> endpoint working with the Llama3 model on my fork of the <a href="https://github.com/briancaffey/trt-llm-as-openai-windows/commit/edaa15fd026fe95e645e3d4ae9718dc3ecc3bb65" rel="nofollow"><!--[-->trt-llm-as-openai-windows<!--]--></a>. I borrowed code for the <code><!--[-->TrtLlmAPI<!--]--></code> from the <a href="https://github.com/NVIDIA/ChatRTX" rel="nofollow"><!--[--><code><!--[-->NVIDIA/ChatRTX<!--]--></code><!--]--></a> repo and a function from <code><!--[-->llama-index<!--]--></code> called <code><!--[-->messages_to_prompt_v3_instruct<!--]--></code> which encodes messages with special tokens for chat. This was an interesting exercise and it taught me a lot about how LLMs do chat. I would like to continue working on this fork and see how to implement streaming endpoints for the Llama 3 model.<!--]--></p><p><!--[-->Here is how Llama 3 does the instruct prompting:<!--]--></p><pre class="language-text"><!--[--><code>&lt;|begin_of_text|&gt;&lt;|start_header_id|&gt;system&lt;|end_header_id|&gt;

You are a helpful AI assistant for travel tips and recommendations&lt;|eot_id|&gt;&lt;|start_header_id|&gt;user&lt;|end_header_id|&gt;

What can you help me with?&lt;|eot_id|&gt;&lt;|start_header_id|&gt;assistant&lt;|end_header_id|&gt;
</code><!--]--></pre><p><!--[-->Compare this with how it was done with Llama2 chat:<!--]--></p><pre class="language-text"><!--[--><code>&lt;s&gt;[INST] &lt;&lt;SYS&gt;&gt;
{{ system_prompt }}
&lt;&lt;/SYS&gt;&gt;

{{ user_message_1 }} [/INST] {{ model_answer_1 }} &lt;/s&gt;
&lt;s&gt;[INST] {{ user_message_2 }} [/INST]
</code><!--]--></pre><p><!--[-->You can read more about the difference between Llama 2 and 3 on the <a href="https://llama.meta.com/docs/model-cards-and-prompt-formats" rel="nofollow"><!--[-->Model Card &amp; Prompt formats<!--]--></a> page on Meta&#39;s Llama website.<!--]--></p><h2 id="langsmith"><a href="#langsmith"><!--[-->LangSmith<!--]--></a></h2><p><!--[-->I recently started using LangSmith. It is an awesome product and it ties in really well to doing prototype work like in my project &quot;Agents of Inference&quot;. I wish I had started using it earlier in my development cycle! All you need to do is add an API key to your environment and your application automatically starts tracing LLM calls. It also works well with LangGraph and allows you to trace the execution path of your graph. Also it is good to be aware that there are other products similar to LangSmith like LangFuse. I also saw a really neat demo from Datadog at GTC showing an alpha version of their LLM tracing and observability product.<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="langsmith screenshot" data-nuxt-img srcset="/_ipx/_/static/aoi/langsmith.png 1x, /_ipx/_/static/aoi/langsmith.png 2x" src="/_ipx/_/static/aoi/langsmith.png"><!--]--></p><p><!--[-->LangSmith can also be helpful when the wrong JSON shape is parsed. I had a lot of difficulty with this in my project. When I used the Q4_K_M gguf quantized <code><!--[-->Meta-Llama-3 8B-Instruct<!--]--></code> model I had no issues with output parsing. Switching to the TensorRT-LLM model provided by the NIM resulted in some parsing errors. The application would report that JSON could not be parsed because the result contained text like: &quot;Here is the JSON that you requested&quot;. I was able to get around this by changing the prompt template from:<!--]--></p><pre class="language-text"><!--[--><code>Answer the user query.
</code><!--]--></pre><p><!--[-->to<!--]--></p><pre class="language-text"><!--[--><code>Don&#39;t include ANYTHING except for valid JSON in your response. Answer the user query.
</code><!--]--></pre><p><!--[-->This was the most frustrating part of development, and I&#39;m still getting occasional errors that I just skip over. I&#39;m also probably have not exhausted all of the tools that LangChain provides to avoid these types of errors. Don&#39;t assume that output parsing that works with one model will work with another! This is another good reason to use something like LangSmith when developing LLM-based applications.<!--]--></p><h2 id="comfyui-tensorrt"><a href="#comfyui-tensorrt"><!--[-->ComfyUI TensorRT<!--]--></a></h2><p><!--[-->My goal with &quot;Agents of Inference&quot; was to be able to test out how small upstream prompt changes can impact the quality and consistency of a series of generated images and videos. Iteration speed is very important! I was able to significantly speed up image and video generation by using the <a href="https://github.com/comfyanonymous/ComfyUI_TensorRT" rel="nofollow"><!--[-->ComfyUI TensorRT custom nodes<!--]--></a>. These nodes allow you to build engines with specifications for parameters that can be either static or dynamic. I had better luck with building dynamic engines. I was able to build and use engines for Stable Diffusion SDXL and Stable Video Diffusion XT.<!--]--></p><p><!--[-->Building a TensorRT engine for ComfyUI can be done using the following workflow:<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="trt comfyUI build process" data-nuxt-img srcset="/_ipx/_/static/aoi/comfyui-trt-svd-xt.png 1x, /_ipx/_/static/aoi/comfyui-trt-svd-xt.png 2x" src="/_ipx/_/static/aoi/comfyui-trt-svd-xt.png"><!--]--></p><p><!--[-->The engines can then be used in custom workflows like the following:<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="trt comfyui workflow" data-nuxt-img srcset="/_ipx/_/static/aoi/svd-workflow-trt.png 1x, /_ipx/_/static/aoi/svd-workflow-trt.png 2x" src="/_ipx/_/static/aoi/svd-workflow-trt.png"><!--]--></p><p><!--[-->Once these workflows are configured and are working as expected, you can export them in API format (JSON) and use them to make API calls to the ComfyUI backend. The agents for stable diffusion and stable video diffusion made API calls in this way and it worked pretty well.<!--]--></p><p><!--[--><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" alt="comfy its" data-nuxt-img srcset="/_ipx/_/static/aoi/comfy-its.png 1x, /_ipx/_/static/aoi/comfy-its.png 2x" src="/_ipx/_/static/aoi/comfy-its.png"><!--]--></p><p><!--[-->Using 50 iterations, I was able to generate 1024x576 images in 3 seconds or about 19 iterations per second (it/s). Videos<!--]--></p><p><!--[-->ComfyUI is still early in development and it refers to itself as &quot;alpha software&quot; even though it has a large adoption by a very active community already. I&#39;m excited to see what is next from the developers of ComfyUI.<!--]--></p><h2 id="speed-of-light"><a href="#speed-of-light"><!--[-->Speed of Light<!--]--></a></h2><p><!--[-->&quot;Speed of Light&quot; is a term that I learned from a stable diffusion talk at GTC.<!--]--></p><blockquote><!--[--><p><!--[-->SOL analysis reveals how your code performs, and device utilization compared to relevant maximums.<!--]--></p><!--]--></blockquote><p><!--[-->Adding TensorRT and TensorRT-LLM to inference services on my RTX PC helped increase the throughput of text, image and video generation for my &quot;Agents of Inference&quot; project. I&#39;m looking forward to learning more about profiling and optimization techniques for both LLMs and Stable Diffusion workloads.<!--]--></p><p><!--[-->Thanks again to NVIDIA and LangChain for organizing this contest! It was a lot of fun to learn about builing agents with LangChain and LangGraph and the latest developments from NVIDIA in Generative AI.<!--]--></p></div><div class="text-center pb-4 pt-8"><button class="mc-btn rounded py-1 px-2"> Show Disqus Comments 💬 </button></div><!----><h1></h1></div></article><!--]--><div class="mx-auto max-w-6xl p-4 lg:px-16 text-center"><hr class="mt-4"><div class="align-center py-4"><div class="pb-4">Join my mailing list to get updated whenever I publish a new article.</div><div class="flex align-center justify-center"><div id="mc_embed_signup" class="w-full md:w-1/2 flex-shrink justify-center"><form id="mc-embedded-subscribe-form" action="https://github.us2.list-manage.com/subscribe/post?u=43a795784ca963e25903a0da6&amp;id=9937fe4fc5" method="post" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate><div id="mc_embed_signup_scroll" class="grid grid-cols-1 sm:grid-cols-2 gap-4"><input id="mce-EMAIL" type="email" value="" name="EMAIL" placeholder="Enter your email address" class="rounded mc text-center" autocomplete="on"><div style="position:absolute;left:-5000px;" aria-hidden="true"><input type="text" name="b_43a795784ca963e25903a0da6_9937fe4fc5" tabindex="-1" value=""></div><div class="text-right" style="width:100%;"><input id="mc-embedded-subscribe" type="submit" value="Subscribe" name="subscribe" class="mc-btn rounded px-2 py-1 w-full"></div></div></form></div></div></div><hr><div class="py-4">Thanks for checking out my site!</div><div class="pb-4"> © 2025 Brian Caffey </div></div></div></div></div><div id="teleports"></div><script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/2024/06/24/agents-of-inference-speed-of-light-nvidia-langchain-generative-ai-agents-developer-contest-update/_payload.json?711989cd-b755-45e7-b273-f0754c0f755f">[{"state":1,"once":18,"_errors":19,"serverRendered":5,"path":21,"pinia":22,"prerenderedAt":23},["Reactive",2],{"$scolor-mode":3,"$si18n:cached-locale-configs":7,"$si18n:resolved-locale":8,"$ssite-config":9},{"preference":4,"value":4,"unknown":5,"forced":6},"system",true,false,{},"",{"_priority":10,"currentLocale":14,"defaultLocale":14,"env":15,"name":16,"url":17},{"name":11,"env":12,"url":11,"defaultLocale":13,"currentLocale":13},-3,-15,-2,"en-US","production","briancaffey.github.io","https://briancaffey.github.io",["Set"],["ShallowReactive",20],{"agents-of-inference-speed-of-light-nvidia-langchain-generative-ai-agents-developer-contest-update":-1},"/2024/06/24/agents-of-inference-speed-of-light-nvidia-langchain-generative-ai-agents-developer-contest-update",{},1753130128210]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{url:"https://briancaffey.github.io",content:{wsUrl:""},mdc:{components:{prose:true,map:{}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},gtag:{enabled:true,initMode:"auto",id:"G-S8TVBBMW66",initCommands:[],config:{},tags:[],loadingStrategy:"defer",url:"https://www.googletagmanager.com/gtag/js"},i18n:{baseUrl:"",defaultLocale:"en",rootRedirect:"",redirectStatusCode:302,skipSettingLocaleOnNavigate:false,locales:[{code:"en",emoji:"flag-us",iso:"en-US",name:"English",flag:"🇺🇸",language:"en-US",_hreflang:"en-US",_sitemap:"en-US"},{code:"fr",emoji:"flag-fr",iso:"fr-FR",name:"Français",flag:"🇫🇷",language:"fr-FR",_hreflang:"fr-FR",_sitemap:"fr-FR"},{code:"zh",emoji:"flag-cn",iso:"zh-ZH",name:"简体中文",flag:"🇨🇳",language:"zh-ZH",_hreflang:"zh-ZH",_sitemap:"zh-ZH"},{code:"ru",emoji:"flag-ru",iso:"ru-RU",name:"Русский",flag:"🇷🇺",language:"ru-RU",_hreflang:"ru-RU",_sitemap:"ru-RU"},{code:"ja",emoji:"flag-jp",iso:"ja-JP",name:"日本語",flag:"🇯🇵",language:"ja-JP",_hreflang:"ja-JP",_sitemap:"ja-JP"},{code:"in",emoji:"flag-in",iso:"hi-IN",name:"हिंदी",flag:"🇮🇳",language:"hi-IN",_hreflang:"hi-IN",_sitemap:"hi-IN"}],detectBrowserLanguage:{alwaysRedirect:false,cookieCrossOrigin:false,cookieDomain:"",cookieKey:"i18n_redirected",cookieSecure:false,fallbackLocale:"",redirectOn:"root",useCookie:true},experimental:{localeDetector:"",typedPages:true,typedOptionsAndMessages:false,alternateLinkCanonicalQueries:true,devCache:false,cacheLifetime:"",stripMessagesPayload:false,preload:false,strictSeo:false,nitroContextDetection:true},domainLocales:{en:{domain:""},fr:{domain:""},zh:{domain:""},ru:{domain:""},ja:{domain:""},in:{domain:""}}}},app:{baseURL:"/",buildId:"711989cd-b755-45e7-b273-f0754c0f755f",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>