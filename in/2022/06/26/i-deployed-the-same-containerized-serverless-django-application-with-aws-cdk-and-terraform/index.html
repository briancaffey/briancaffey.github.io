<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>My Infrastructure as Code Rosetta Stone - Deploying the same web application on AWS ECS with CDK, Terraform and Pulumi</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Brian Caffey's personal website"><meta data-n-head="ssr" name="robots" content="noindex"><meta data-n-head="ssr" property="og:title" content="My Infrastructure as Code Rosetta Stone - Deploying the same web application on AWS ECS with CDK, Terraform and Pulumi"><meta data-n-head="ssr" property="og:description" content="I wrote three reusable infrastructure as code libraries to develop high-level abstractions for deploying containerized web apps on AWS ECS. This article will provide an overview of my experience working with CDK, Terraform and Pulumi and will cover how I use these libraries in automated infrastructure deployment pipelines using GitHub Actions"><meta data-n-head="ssr" property="og:image" content="https://briancaffey.github.ioundefined"><meta data-n-head="ssr" property="twitter:card" content="https://briancaffey.github.ioundefined"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><script data-n-head="ssr" data-hid="adsbygoogle-script" defer crossorigin="anonymous" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4924597640144289"></script><script data-n-head="ssr" data-hid="adsbygoogle">window.__abg_called||((adsbygoogle=window.adsbygoogle||[]).pauseAdRequests=0,(window.adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-4924597640144289",enable_page_level_ads:!1,overlays:{bottom:!1}}),window.__abg_called=!0)</script><link rel="preload" href="/_nuxt/e9c2366.js" as="script"><link rel="preload" href="/_nuxt/9ee0ef6.js" as="script"><link rel="preload" href="/_nuxt/f51c3d4.js" as="script"><link rel="preload" href="/_nuxt/0f451e7.js" as="script"><link rel="preload" href="/_nuxt/b5afa39.js" as="script"><style data-vue-ssr-id="38dfa7e4:0 f52d43e0:0 9592d830:0 517a8dd7:0 072b2f8a:0 fa7ff0ca:0 56b15182:0 5a4b6265:0 14b1eaf9:0 a0fa61ae:0 7f6c3ed0:0 64516d8e:0 5586ddaf:0">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}details{display:block}summary{display:list-item}[hidden],template{display:none}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{box-sizing:border-box;border:0 solid #e2e8f0}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#a0aec0}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#a0aec0}input::placeholder,textarea::placeholder{color:#a0aec0}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}.bg-black{--bg-opacity:1;background-color:#000;background-color:rgba(0,0,0,var(--bg-opacity))}.bg-white{--bg-opacity:1;background-color:#fff;background-color:rgba(255,255,255,var(--bg-opacity))}.bg-red-300{--bg-opacity:1;background-color:#feb2b2;background-color:rgba(254,178,178,var(--bg-opacity))}.border-white{--border-opacity:1;border-color:#fff;border-color:rgba(255,255,255,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-md{border-radius:.375rem}.rounded-lg{border-radius:.5rem}.rounded-full{border-radius:9999px}.rounded-t{border-top-left-radius:.25rem;border-top-right-radius:.25rem}.border{border-width:1px}.cursor-pointer{cursor:pointer}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.table{display:table}.grid{display:grid}.contents{display:contents}.hidden{display:none}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.flex-1{flex:1 1 0%}.flex-grow{flex-grow:1}.float-right{float:right}.font-bold{font-weight:700}.h-3{height:.75rem}.h-4{height:1rem}.h-12{height:3rem}.h-32{height:8rem}.h-64{height:16rem}.text-lg{font-size:1.125rem}.text-xl{font-size:1.25rem}.text-2xl{font-size:1.5rem}.text-3xl{font-size:1.875rem}.leading-8{line-height:2rem}.leading-9{line-height:2.25rem}.m-2{margin:.5rem}.m-4{margin:1rem}.mx-1{margin-left:.25rem;margin-right:.25rem}.my-4{margin-top:1rem;margin-bottom:1rem}.mx-auto{margin-left:auto;margin-right:auto}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.-ml-1{margin-left:-.25rem}.max-w-5xl{max-width:64rem}.max-w-6xl{max-width:72rem}.object-cover{-o-object-fit:cover;object-fit:cover}.p-3{padding:.75rem}.p-4{padding:1rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.px-1{padding-left:.25rem;padding-right:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-4{padding-left:1rem;padding-right:1rem}.py-8{padding-top:2rem;padding-bottom:2rem}.py-32{padding-top:8rem;padding-bottom:8rem}.pt-2{padding-top:.5rem}.pt-4{padding-top:1rem}.pr-4{padding-right:1rem}.pb-4{padding-bottom:1rem}.pt-8{padding-top:2rem}.pb-8{padding-bottom:2rem}.pt-16{padding-top:4rem}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{top:0;right:0;bottom:0;left:0}.top-0{top:0}.right-0{right:0}.bottom-0{bottom:0}.left-0{left:0}.resize{resize:both}.shadow{box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06)}.shadow-md{box-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06)}.fill-current{fill:currentColor}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-black{--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity))}.text-white{--text-opacity:1;color:#fff;color:rgba(255,255,255,var(--text-opacity))}.text-gray-500{--text-opacity:1;color:#a0aec0;color:rgba(160,174,192,var(--text-opacity))}.text-gray-600{--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity))}.text-red-400{--text-opacity:1;color:#fc8181;color:rgba(252,129,129,var(--text-opacity))}.text-red-600{--text-opacity:1;color:#e53e3e;color:rgba(229,62,62,var(--text-opacity))}.uppercase{text-transform:uppercase}.visible{visibility:visible}.w-3{width:.75rem}.w-4{width:1rem}.w-12{width:3rem}.w-32{width:8rem}.w-full{width:100%}.z-10{z-index:10}.gap-4{grid-gap:1rem;gap:1rem}.gap-6{grid-gap:1.5rem;gap:1.5rem}.gap-8{grid-gap:2rem;gap:2rem}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.transform{--transform-translate-x:0;--transform-translate-y:0;--transform-rotate:0;--transform-skew-x:0;--transform-skew-y:0;--transform-scale-x:1;--transform-scale-y:1;transform:translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y))}.transition-all{transition-property:all}.transition{transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform}.duration-150{transition-duration:.15s}.delay-150{transition-delay:.15s}@-webkit-keyframes spin{to{transform:rotate(1turn)}}@keyframes spin{to{transform:rotate(1turn)}}@-webkit-keyframes ping{75%,to{transform:scale(2);opacity:0}}@keyframes ping{75%,to{transform:scale(2);opacity:0}}@-webkit-keyframes pulse{50%{opacity:.5}}@keyframes pulse{50%{opacity:.5}}@-webkit-keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@media (min-width:640px){.sm\:inline{display:inline}.sm\:hidden{display:none}.sm\:p-16{padding:4rem}.sm\:px-4{padding-left:1rem;padding-right:1rem}.sm\:w-2\/3{width:66.666667%}.sm\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width:768px){.md\:flex{display:flex}.md\:hidden{display:none}.md\:px-1{padding-left:.25rem;padding-right:.25rem}.md\:px-4{padding-left:1rem;padding-right:1rem}.md\:w-1\/2{width:50%}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}@media (min-width:1024px){.lg\:px-16{padding-left:4rem;padding-right:4rem}.lg\:px-32{padding-left:8rem;padding-right:8rem}.lg\:pl-64{padding-left:16rem}.lg\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width:1280px){.xl\:pb-16{padding-bottom:4rem}}:root{--color:#243746;--color-primary:#158876;--color-secondary:#0e2233;--bg:#f3f5f4;--bg-secondary:#fff;--bg-code:#ddd;--border-color:#ddd}.dark-mode{--color:#ebf4f1;--color-primary:#41b38a;--color-secondary:#fdf9f3;--bg:#091a28;--bg-secondary:#071521;--bg-code:#ddd;--border-color:#0d2538}.sepia-mode{--color:#433422;--color-primary:#504231;--color-secondary:#504231;--bg:#f1e7d0;--bg-code:#ddd;--bg-secondary:#eae0c9;--border-color:#ded0bf}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;background-color:#f3f5f4;background-color:var(--bg);color:#243746;color:var(--color);transition:background-color .7s}a{color:#158876;color:var(--color-primary)}.py-05{padding-top:.125rem;padding-bottom:.125rem}.markdown{--text-opacity:1;color:#1a202c;color:rgba(26,32,44,var(--text-opacity));line-height:1.5;color:#0e2233;color:var(--color-secondary)}.markdown .token.operator{background:0 0}.markdown>*+*{margin-top:0;margin-bottom:1rem}.markdown li+li{margin-top:.25rem}.markdown li>p+p{margin-top:1.5rem;color:#158876;color:var(--color-primary)}.markdown img{margin:auto}.markdown a,.markdown strong{font-weight:600}.markdown strong a{font-weight:700}.markdown h1{font-size:2.25rem}.markdown h1,.markdown h2{border-color:#158876;border-color:var(--color-primary);line-height:1.25;border-bottom-width:1px;font-weight:600;margin-bottom:1rem;margin-top:1.5rem;padding-bottom:.5rem}.markdown h2{font-size:1.5rem}.markdown h3{line-height:1.375;font-size:1.125rem}.markdown h3,.markdown h4{border-color:#158876;border-color:var(--color-primary);font-weight:600;margin-bottom:1rem;margin-top:1.5rem}.markdown h4{line-height:1;font-size:1rem}.markdown h5{border-color:#158876;border-color:var(--color-primary)}.markdown h5,.markdown h6{line-height:1.25;font-size:.875rem;font-weight:600;margin-bottom:1rem;margin-top:1.5rem}.markdown blockquote,.markdown h6{--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity))}.markdown blockquote{font-size:1rem;border-left-width:4px;--border-opacity:1;border-color:#e2e8f0;border-color:rgba(226,232,240,var(--border-opacity));padding-left:1rem;padding-right:1rem;border-color:#158876;border-color:var(--color-primary)}.markdown code{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:.875rem;display:inline;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity));padding:.125rem .25rem;background-color:#ddd;background-color:var(--bg-code);color:#000}.markdown code,.markdown pre{--bg-opacity:1;border-radius:.25rem}.markdown pre{background-color:#f7fafc;background-color:rgba(247,250,252,var(--bg-opacity));padding:1rem}.markdown pre code{display:block;background-color:transparent;padding:0;overflow:visible;border-radius:0;color:#000}.markdown p{margin-bottom:10px}code[class*=language-],pre[class*=language-]{background:#ddd!important;background:var(--bg-code)!important;text-shadow:none!important}.markdown ul{list-style-type:disc}.markdown ol,.markdown ul{font-size:1rem;padding-left:2rem}.markdown ol{list-style-type:decimal}.markdown kbd{font-size:.75rem;display:inline-block;border-radius:.25rem;border-width:1px;padding:.125rem .25rem;vertical-align:middle;font-weight:400;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06)}.markdown table,td,th{font-size:1rem;border:1px solid #243746;border-color:var(--color)}.markdown table{overflow-x:scroll}.markdown td,.markdown th{border-width:1px;padding:.25rem .75rem}.markdown .highlight pre{--bg-opacity:1!important;background-color:#f7fafc!important;background-color:rgba(247,250,252,var(--bg-opacity))!important}.article-card{box-shadow:0 5px 10px 0 #0e2233;box-shadow:0 5px 10px 0 var(--color-secondary);transition:box-shadow .2s,transform .2s;height:100%}.article-card:hover{box-shadow:0 10px 40px 0 #0e2233;box-shadow:0 10px 40px 0 var(--color-secondary);transform:scale(1.025)}.blog-card-description,.blog-date{color:#0e2233;color:var(--color-secondary)}.blog-date{font-style:italic}hr{background-color:#243746;background-color:var(--color);border:none;height:1px}.menu-icon{background-color:#ddd;background-color:var(--border-color)}.menu-icon,.mobile-menu{color:#243746;color:var(--color)}.mobile-menu{background-color:#fff;background-color:var(--bg-secondary)}.btn{border-radius:1;border-color:#158876;border-color:var(--color-primary)}.btn:hover{background-color:#fff;background-color:var(--bg-secondary)}.hero{border-color:#158876;border-color:var(--color-primary)}.markdown{word-wrap:break-word}.markdown h2:before,.markdown h3:before{content:" ";margin-top:-85px;pointer-events:none}.markdown h2>a,.markdown h3>a{margin-left:1.25rem}.markdown h2>a:before,.markdown h3>a:before{content:"#";font-weight:400;font-size:1.25rem;line-height:2rem;margin-left:-1.25rem;padding-right:.5rem;position:absolute;opacity:1}@media (min-width:1024px){.markdown h2>a,.markdown h3>a{margin-left:0}.markdown h2>a:before,.markdown h3>a:before{opacity:0}}.markdown h2:hover>a:before,.markdown h3:hover>a:before{opacity:1}& pre[class*=language-]{--bg-opacity:1;background-color:#2d3748;background-color:rgba(45,55,72,var(--bg-opacity));position:static}.mc{background-color:#f3f5f4;background-color:var(--bg);border-color:#158876;border-color:var(--color-primary);border-width:1px;color:#158876;color:var(--color-primary);justify-content:center;padding:5px 10px;border-radius:5px;width:100%}.mc-btn{color:#fff;color:var(--bg-secondary);background-color:#0e2233;background-color:var(--color-secondary);cursor:pointer}.page-enter-active,.page-leave-active{transition:filter 2s linear;transition:margin-top .15s,opacity .15s}.page-enter,.page-leave-to{opacity:0;margin-top:5px}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.emoji-mart,.emoji-mart *{-webkit-box-sizing:border-box;box-sizing:border-box;line-height:1.15}.emoji-mart{font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",sans-serif;font-size:16px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:420px;color:#222427;border:1px solid #d9d9d9;border-radius:5px;background:#fff}.emoji-mart-emoji{padding:6px;border:none;background:0 0;-webkit-box-shadow:none;box-shadow:none}.emoji-mart-emoji span{display:inline-block}.emoji-mart-preview-emoji .emoji-mart-emoji span{width:38px;height:38px;font-size:32px}.emoji-type-native{font-family:"Segoe UI Emoji","Segoe UI Symbol","Segoe UI","Apple Color Emoji","Twemoji Mozilla","Noto Color Emoji","EmojiOne Color","Android Emoji";word-break:keep-all}.emoji-type-image{background-size:5700%}.emoji-type-image.emoji-set-apple{background-image:url(https://unpkg.com/emoji-datasource-apple@6.0.1/img/apple/sheets-256/64.png)}.emoji-type-image.emoji-set-facebook{background-image:url(https://unpkg.com/emoji-datasource-facebook@6.0.1/img/facebook/sheets-256/64.png)}.emoji-type-image.emoji-set-google{background-image:url(https://unpkg.com/emoji-datasource-google@6.0.1/img/google/sheets-256/64.png)}.emoji-type-image.emoji-set-twitter{background-image:url(https://unpkg.com/emoji-datasource-twitter@6.0.1/img/twitter/sheets-256/64.png)}.emoji-mart-bar{border:0 solid #d9d9d9}.emoji-mart-bar:first-child{border-bottom-width:1px;border-top-left-radius:5px;border-top-right-radius:5px}.emoji-mart-bar:last-child{border-top-width:1px;border-bottom-left-radius:5px;border-bottom-right-radius:5px}.emoji-mart-scroll{position:relative;overflow-y:scroll;-webkit-box-flex:1;-ms-flex:1;flex:1;padding:0 6px 6px;z-index:0;will-change:transform;-webkit-overflow-scrolling:touch}.emoji-mart-anchors{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding:0 6px;color:#858585;line-height:0}.emoji-mart-anchor{position:relative;display:block;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;text-align:center;padding:12px 4px;overflow:hidden;-webkit-transition:color .1s ease-out;-o-transition:color .1s ease-out;transition:color .1s ease-out;border:none;background:0 0;-webkit-box-shadow:none;box-shadow:none}.emoji-mart-anchor-selected,.emoji-mart-anchor:hover{color:#464646}.emoji-mart-anchor-selected .emoji-mart-anchor-bar{bottom:0}.emoji-mart-anchor-bar{position:absolute;bottom:-3px;left:0;width:100%;height:3px;background-color:#464646}.emoji-mart-anchors i{display:inline-block;width:100%;max-width:22px}.emoji-mart-anchors svg{fill:currentColor;max-height:18px}.emoji-mart .scroller{height:250px;position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1;padding:0 6px 6px;z-index:0;will-change:transform;-webkit-overflow-scrolling:touch}.emoji-mart-search{margin-top:6px;padding:0 6px}.emoji-mart-search input{font-size:16px;display:block;width:100%;padding:.2em .6em;border-radius:25px;border:1px solid #d9d9d9;outline:0}.emoji-mart-search-results{height:250px;overflow-y:scroll}.emoji-mart-category{position:relative}.emoji-mart-category .emoji-mart-emoji span{z-index:1;position:relative;text-align:center;cursor:default}.emoji-mart-category .emoji-mart-emoji:hover:before,.emoji-mart-emoji-selected:before{z-index:0;content:"";position:absolute;top:0;left:0;width:100%;height:100%;background-color:#f4f4f4;border-radius:100%;opacity:0;opacity:1}.emoji-mart-category-label{position:-webkit-sticky;position:sticky;top:0}.emoji-mart-static .emoji-mart-category-label{z-index:2;position:relative}.emoji-mart-category-label h3{display:block;font-size:16px;width:100%;font-weight:500;padding:5px 6px;background-color:#fff;background-color:hsla(0,0%,100%,.95)}.emoji-mart-emoji{position:relative;display:inline-block;font-size:0}.emoji-mart-no-results{font-size:14px;text-align:center;padding-top:70px;color:#858585}.emoji-mart-no-results .emoji-mart-category-label{display:none}.emoji-mart-no-results .emoji-mart-no-results-label{margin-top:.2em}.emoji-mart-no-results .emoji-mart-emoji:hover:before{content:none}.emoji-mart-preview{position:relative;height:70px}.emoji-mart-preview-data,.emoji-mart-preview-emoji,.emoji-mart-preview-skins{position:absolute;top:50%;-webkit-transform:translateY(-50%);-ms-transform:translateY(-50%);transform:translateY(-50%)}.emoji-mart-preview-emoji{left:12px}.emoji-mart-preview-data{left:68px;right:12px;word-break:break-all}.emoji-mart-preview-skins{right:30px;text-align:right}.emoji-mart-preview-name{font-size:14px}.emoji-mart-preview-shortname{font-size:12px;color:#888}.emoji-mart-preview-emoticon+.emoji-mart-preview-emoticon,.emoji-mart-preview-shortname+.emoji-mart-preview-emoticon,.emoji-mart-preview-shortname+.emoji-mart-preview-shortname{margin-left:.5em}.emoji-mart-preview-emoticon{font-size:11px;color:#bbb}.emoji-mart-title span{display:inline-block;vertical-align:middle}.emoji-mart-title .emoji-mart-emoji{padding:0}.emoji-mart-title-label{color:#999a9c;font-size:21px;font-weight:300}.emoji-mart-skin-swatches{font-size:0;padding:2px 0;border:1px solid #d9d9d9;border-radius:12px;background-color:#fff}.emoji-mart-skin-swatches-opened .emoji-mart-skin-swatch{width:16px;padding:0 2px}.emoji-mart-skin-swatches-opened .emoji-mart-skin-swatch-selected:after{opacity:.75}.emoji-mart-skin-swatch{display:inline-block;width:0;vertical-align:middle;-webkit-transition-property:width,padding;-o-transition-property:width,padding;transition-property:width,padding;-webkit-transition-duration:.125s;-o-transition-duration:.125s;transition-duration:.125s;-webkit-transition-timing-function:ease-out;-o-transition-timing-function:ease-out;transition-timing-function:ease-out}.emoji-mart-skin-swatch:first-child{-webkit-transition-delay:0s;-o-transition-delay:0s;transition-delay:0s}.emoji-mart-skin-swatch:nth-child(2){-webkit-transition-delay:.03s;-o-transition-delay:.03s;transition-delay:.03s}.emoji-mart-skin-swatch:nth-child(3){-webkit-transition-delay:.06s;-o-transition-delay:.06s;transition-delay:.06s}.emoji-mart-skin-swatch:nth-child(4){-webkit-transition-delay:.09s;-o-transition-delay:.09s;transition-delay:.09s}.emoji-mart-skin-swatch:nth-child(5){-webkit-transition-delay:.12s;-o-transition-delay:.12s;transition-delay:.12s}.emoji-mart-skin-swatch:nth-child(6){-webkit-transition-delay:.15s;-o-transition-delay:.15s;transition-delay:.15s}.emoji-mart-skin-swatch-selected{position:relative;width:16px;padding:0 2px}.emoji-mart-skin-swatch-selected:after{content:"";position:absolute;top:50%;left:50%;width:4px;height:4px;margin:-2px 0 0 -2px;background-color:#fff;border-radius:100%;pointer-events:none;opacity:0;-webkit-transition:opacity .2s ease-out;-o-transition:opacity .2s ease-out;transition:opacity .2s ease-out}.emoji-mart-skin{display:inline-block;width:100%;padding-top:100%;max-width:12px;border-radius:100%}.emoji-mart-skin-tone-1{background-color:#ffc93a}.emoji-mart-skin-tone-2{background-color:#fadcbc}.emoji-mart-skin-tone-3{background-color:#e0bb95}.emoji-mart-skin-tone-4{background-color:#bf8f68}.emoji-mart-skin-tone-5{background-color:#9b643d}.emoji-mart-skin-tone-6{background-color:#594539}.emoji-mart .vue-recycle-scroller{position:relative}.emoji-mart .vue-recycle-scroller.direction-vertical:not(.page-mode){overflow-y:auto}.emoji-mart .vue-recycle-scroller.direction-horizontal:not(.page-mode){overflow-x:auto}.emoji-mart .vue-recycle-scroller.direction-horizontal{display:-webkit-box;display:-ms-flexbox;display:flex}.emoji-mart .vue-recycle-scroller__slot{-webkit-box-flex:1;-ms-flex:auto 0 0px;flex:auto 0 0}.emoji-mart .vue-recycle-scroller__item-wrapper{-webkit-box-flex:1;-ms-flex:1;flex:1;-webkit-box-sizing:border-box;box-sizing:border-box;overflow:hidden;position:relative}.emoji-mart .vue-recycle-scroller.ready .vue-recycle-scroller__item-view{position:absolute;top:0;left:0;will-change:transform}.emoji-mart .vue-recycle-scroller.direction-vertical .vue-recycle-scroller__item-wrapper{width:100%}.emoji-mart .vue-recycle-scroller.direction-horizontal .vue-recycle-scroller__item-wrapper{height:100%}.emoji-mart .vue-recycle-scroller.ready.direction-vertical .vue-recycle-scroller__item-view{width:100%}.emoji-mart .vue-recycle-scroller.ready.direction-horizontal .vue-recycle-scroller__item-view{height:100%}.emoji-mart .resize-observer[data-v-b329ee4c]{border:none;background-color:transparent;opacity:0}.emoji-mart .resize-observer[data-v-b329ee4c],.emoji-mart .resize-observer[data-v-b329ee4c] object{position:absolute;top:0;left:0;z-index:-1;width:100%;height:100%;pointer-events:none;display:block;overflow:hidden}.emoji-mart-search .hidden{display:none;visibility:hidden}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}html{font-family:"Source Sans Pro",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;font-size:16px;word-spacing:1px;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;box-sizing:border-box}*,:after,:before{box-sizing:border-box;margin:0}.button--green{display:inline-block;border-radius:4px;border:1px solid #3b8070;color:#3b8070;text-decoration:none;padding:10px 30px}.button--green:hover{color:#fff;background-color:#3b8070}.button--grey{display:inline-block;border-radius:4px;border:1px solid #35495e;color:#35495e;text-decoration:none;padding:10px 30px;margin-left:15px}.button--grey:hover{color:#fff;background-color:#35495e}span.emoji-mart-emoji[data-v-3f691362]{padding:0}.selected[data-v-3f691362]{text-shadow:.25px 0 0 #000}.picker[data-v-3f691362]{position:absolute;top:10px;margin-left:auto;margin-right:auto;transform:translate(50%,50%)}.top[data-v-3f691362]{width:100%;background-color:var(--color-primary);height:3px}.selected[data-v-107ae01e]{text-shadow:.9px 0 0}span.emoji-mart-emoji[data-v-288717a6]{padding:0;transition:transform .2s}span.emoji-mart-emoji[data-v-288717a6]:hover{transform:scale(1.3)}.centered[data-v-288717a6]{position:absolute;left:50vw;right:50vw;margin-left:auto;margin-right:auto}span.emoji-mart-emoji[data-v-4f7c5820]{padding:0}.modal[data-v-4f7c5820]{z-index:100000000;top:0;-webkit-backdrop-filter:blur(.4px);backdrop-filter:blur(.4px);background-color:rgba(0,0,0,.2)}.modal[data-v-4f7c5820],.picker[data-v-4f7c5820]{position:absolute;left:0}.picker[data-v-4f7c5820]{z-index:10000000000;right:0;margin-left:auto;margin-right:auto}.cover-image[data-v-4b9599ea]{transition:transform .2s}.cover-image[data-v-4b9599ea]:hover{transform:scale(1.025)}.tag[data-v-3fbcd028]{background-color:var(--color-primary);transition:transform .2s}.tag[data-v-3fbcd028]:hover{transform:scale(1.05)}</style><link rel="preload" href="/_nuxt/static/1672798569/in/2022/06/26/i-deployed-the-same-containerized-serverless-django-application-with-aws-cdk-and-terraform/state.js" as="script"><link rel="preload" href="/_nuxt/static/1672798569/in/2022/06/26/i-deployed-the-same-containerized-serverless-django-application-with-aws-cdk-and-terraform/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1672798569/manifest.js" as="script">
  </head>
  <body>
    <script data-n-head="ssr" data-hid="nuxt-color-mode-script" data-pbody="true">!function(){"use strict";var t=window,r=document,s=r.documentElement,n=["dark","light"],e=function(){for(var e="nuxt-color-mode=",t=r.cookie.split(";"),s=0;s<t.length;s++){for(var n=t[s];" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(e))return n.substring(e.length,n.length)}return null}()||"system",a="system"===e?l():e;function c(e){e+="-mode";s.classList?s.classList.add(e):s.className+=" "+e}function o(e){return t.matchMedia("(prefers-color-scheme"+e+")")}function l(){if(t.matchMedia&&"not all"!==o("").media)for(var e of n)if(o(":"+e).matches)return e;return"light"}c(a),t.__NUXT_COLOR_MODE__={preference:e,value:a,getColorScheme:l,addClass:c,removeClass:function(e){e+="-mode";s.classList?s.classList.remove(e):s.className=s.className.replace(new RegExp(e,"g"),"")}}}()</script><div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><div data-v-3f691362><div class="top" data-v-3f691362></div> <div class="mx-auto flex py-2 px-2 sm:px-4 items-center max-w-6xl justify-center" data-v-3f691362><div class="justify-left flex-grow flex-cols-4" data-v-3f691362><a href="/in" class="text-xl nuxt-link-active" data-v-3f691362><span class="hidden sm:inline text-2xl" data-v-3f691362>‡§¨‡•ç‡§∞‡§æ‡§Ø‡§® ‡§ï‡•à‡§´‡§º‡•Ä</span><span class="inline sm:hidden" data-v-3f691362>JBC</span></a></div> <div class="flex-grow relative" data-v-3f691362><nav z-index="10000" data-v-107ae01e data-v-3f691362><div data-v-107ae01e><ul class="items-right float-right hidden md:flex" data-v-107ae01e><li class="px-4 text-lg" data-v-107ae01e><a href="/in/blog/1" data-v-107ae01e>
          ‡§¨‡•ç‡§≤‡•â‡§ó
        </a></li> <li class="px-4 text-lg" data-v-107ae01e><a href="/in/projects" data-v-107ae01e>
          ‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ‡§ì‡§Ç
        </a></li> <li class="px-4 text-lg" data-v-107ae01e><a href="/in/contact" data-v-107ae01e>
          ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï
        </a></li></ul> <div class="flex justify-end md:hidden z-1000" data-v-107ae01e><button class="flex items-center px-3 py-2 border rounded menu-icon" data-v-107ae01e><svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="fill-current h-3 w-3" data-v-107ae01e><title data-v-107ae01e>Menu</title> <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" data-v-107ae01e></path></svg></button></div> <!----></div></nav></div></div> <div class="picker" data-v-3f691362><div class="centered" data-v-288717a6 data-v-3f691362><div class="grid items-center justify-center" data-v-288717a6><ul class="flex px-4" data-v-288717a6><li class="md:px-1 px-1 cursor-pointer" data-v-288717a6><span aria-label="üñ•Ô∏è, desktop_computer" class="emoji-mart-emoji" data-v-288717a6><span class="emoji-set-apple emoji-type-image" style="background-position:52.63% 12.28%;width:32px;height:32px"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-288717a6><span aria-label="üåû, sun_with_face" class="emoji-mart-emoji" data-v-288717a6><span class="emoji-set-apple emoji-type-image" style="background-position:8.77% 77.19%;width:32px;height:32px"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-288717a6><span aria-label="üåö, new_moon_with_face" class="emoji-mart-emoji" data-v-288717a6><span class="emoji-set-apple emoji-type-image" style="background-position:8.77% 70.18%;width:32px;height:32px"></span></span></li><li class="md:px-1 px-1 cursor-pointer" data-v-288717a6><span aria-label="‚òï, coffee" class="emoji-mart-emoji" data-v-288717a6><span class="emoji-set-apple emoji-type-image" style="background-position:94.74% 8.77%;width:32px;height:32px"></span></span></li> <li class="md:px-1 px-1 cursor-pointer" data-v-288717a6><div data-v-4f7c5820 data-v-288717a6><!----> <ul data-v-4f7c5820><li class="md:px-1 px-1 cursor-pointer" data-v-4f7c5820><span aria-label="üáÆüá≥, flag-in" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:3.51% 43.86%;width:32px;height:32px"></span></span></li></ul> <div class="rounded-md z-10 picker" data-v-4f7c5820><div class="bg-white shadow-md rounded px-4 py-2 w-32 text" style="display:none" data-v-4f7c5820><a href="/2022/06/26/i-deployed-the-same-containerized-serverless-django-application-with-aws-cdk-and-terraform" data-v-4f7c5820><span aria-label="üá∫üá∏, us, flag-us" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:7.02% 68.42%;width:16px;height:16px"></span></span> English <br data-v-4f7c5820></a><a href="/fr/2022/06/26/i-deployed-the-same-containerized-serverless-django-application-with-aws-cdk-and-terraform" data-v-4f7c5820><span aria-label="üá´üá∑, fr, flag-fr" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:1.75% 91.23%;width:16px;height:16px"></span></span> Fran√ßais <br data-v-4f7c5820></a><a href="/zh/2022/06/26/i-deployed-the-same-containerized-serverless-django-application-with-aws-cdk-and-terraform" data-v-4f7c5820><span aria-label="üá®üá≥, cn, flag-cn" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:1.75% 36.84%;width:16px;height:16px"></span></span> ÁÆÄ‰Ωì‰∏≠Êñá <br data-v-4f7c5820></a><a href="/ru/2022/06/26/i-deployed-the-same-containerized-serverless-django-application-with-aws-cdk-and-terraform" data-v-4f7c5820><span aria-label="üá∑üá∫, ru, flag-ru" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:5.26% 92.98%;width:16px;height:16px"></span></span> –†—É—Å—Å–∫–∏–π <br data-v-4f7c5820></a><a href="/jp/2022/06/26/i-deployed-the-same-containerized-serverless-django-application-with-aws-cdk-and-terraform" data-v-4f7c5820><span aria-label="üáØüáµ, jp, flag-jp" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:3.51% 59.65%;width:16px;height:16px"></span></span> Êó•Êú¨Ë™û <br data-v-4f7c5820></a><a href="/in/2022/06/26/i-deployed-the-same-containerized-serverless-django-application-with-aws-cdk-and-terraform" aria-current="page" class="nuxt-link-exact-active nuxt-link-active" data-v-4f7c5820><span aria-label="üáÆüá≥, flag-in" class="emoji-mart-emoji" data-v-4f7c5820><span class="emoji-set-apple emoji-type-image" style="background-position:3.51% 43.86%;width:16px;height:16px"></span></span> ‡§π‡§ø‡§Ç‡§¶‡•Ä <br data-v-4f7c5820></a></div></div></div></li></ul></div></div></div></div> <article data-v-4b9599ea><!----> <div class="mx-auto max-w-5xl px-2 sm:px-4 md:px-4 lg:px-16 mt-2" data-v-4b9599ea><h1 class="prose text-3xl leading-9" data-v-4b9599ea>
      My Infrastructure as Code Rosetta Stone - Deploying the same web application on AWS ECS with CDK, Terraform and Pulumi
    </h1> <div class="flex flex-wrap -ml-1 py-2" data-v-21780fb6 data-v-4b9599ea><a href="/in/blog/tags/django" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    django üè∑Ô∏è
    <!----></div></a><a href="/in/blog/tags/cdk" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    cdk üè∑Ô∏è
    <!----></div></a><a href="/in/blog/tags/terraform" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    terraform üè∑Ô∏è
    <!----></div></a><a href="/in/blog/tags/pulumi" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    pulumi üè∑Ô∏è
    <!----></div></a><a href="/in/blog/tags/cloudformation" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    cloudformation üè∑Ô∏è
    <!----></div></a><a href="/in/blog/tags/github-actions" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    github-actions üè∑Ô∏è
    <!----></div></a><a href="/in/blog/tags/aws" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    aws üè∑Ô∏è
    <!----></div></a><a href="/in/blog/tags/ecs" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    ecs üè∑Ô∏è
    <!----></div></a><a href="/in/blog/tags/containers" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    containers üè∑Ô∏è
    <!----></div></a><a href="/in/blog/tags/docker" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    docker üè∑Ô∏è
    <!----></div></a><a href="/in/blog/tags/fargate" data-v-3fbcd028 data-v-21780fb6><div class="px-2 text-lg text-white shadow rounded-lg bg-black mx-1 mt-1 uppercase cursor-pointer tag" data-v-3fbcd028>
    fargate üè∑Ô∏è
    <!----></div></a></div> <!----> <p class="blog-date text-gray-500 mb-4" data-v-4b9599ea>
      ‡§Ö‡§Ç‡§§‡§ø‡§Æ ‡§¨‡§æ‡§∞ ‡§Ö‡§¶‡•ç‡§Ø‡§§‡§® ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ
      26 Juni 2022
    </p> <div class="p-4 my-4 bg-red-300 rounded" data-v-4b9599ea><p data-v-4b9599ea><strong data-v-4b9599ea>
          ‚ö†Ô∏è This article is a draft and is not yet complete. ‚ö†Ô∏è
        </strong></p></div> <div class="markdown nuxt-content" data-v-4b9599ea data-v-4b9599ea><h2 id="tldr" data-v-4b9599ea data-v-4b9599ea><a href="#tldr" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>tl;dr</h2>
<p data-v-4b9599ea data-v-4b9599ea>I deployed the same Django application to AWS ECS with Terraform and CDK. This article discusses my experience with these two popular Infrastructure as Code tools. I will show my process for developing and using reusable code modules for provisioning infrastructure on AWS to support a sample micro blogging application built with Django.</p>
<h1 id="my-infrastructure-as-code-rosetta-stone-deploying-the-same-app-on-aws-ecs-with-cdk-terraform-a-nd-pulumi" data-v-4b9599ea data-v-4b9599ea><a href="#my-infrastructure-as-code-rosetta-stone-deploying-the-same-app-on-aws-ecs-with-cdk-terraform-a-nd-pulumi" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>My Infrastructure as Code Rosetta Stone: Deploying the same app on AWS ECS with CDK, Terraform a nd Pulumi</h1>
<h2 id="why-i-made-this-project" data-v-4b9599ea data-v-4b9599ea><a href="#why-i-made-this-project" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Why I made this project</h2>
<ol data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>To learn more about AWS, IaC, CI/CD, Automation and Platform Engineering</li>
</ol>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>learn differences between major IaC tools and how to use them</li>
</ul>
<ol start="2" data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>To fail as many times as possible</li>
</ol>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>Every time I fail when I think I have things right, I learn something new</li>
<li data-v-4b9599ea data-v-4b9599ea>Failed IaC pipelines can sometimes be scary, and every failure I have on these project can teach me about potential failure modes for live projects running in production</li>
</ul>
<ol start="3" data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>To take an application-first approach to DevOps</li>
</ol>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>While learning about IaC, I had a hard time finding in-depth materials covering application development, CI/CD pipelines and automation and Infrastructure as Code and how these three knowledge domains work together</li>
<li data-v-4b9599ea data-v-4b9599ea>this is the main reason why the libraries have <code data-v-4b9599ea data-v-4b9599ea>django</code> in the name</li>
<li data-v-4b9599ea data-v-4b9599ea>You could probably use another framework with these IaC libraries like Flask or Rails, and there isn't really anything that is Django-specific in these libraries</li>
<li data-v-4b9599ea data-v-4b9599ea>I'm more experienced with Django than I am in any other web framework</li>
</ul>
<ol start="4" data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>To develop a project I can reference when helping myself and others</li>
</ol>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>companies and projects that do IaC and CI/CD for the most part have things in private repos</li>
<li data-v-4b9599ea data-v-4b9599ea>for example: how do I split up IaC and application deployments? I see this question asked over. I want to be able to use this project to <strong data-v-4b9599ea data-v-4b9599ea>show</strong> people how it can be done, not just tell them.</li>
<li data-v-4b9599ea data-v-4b9599ea>I'm trying to do what are you doing, thanks so much for sharing. Mine isn't working, and I can't share it with you, can you help me? No!</li>
</ul>
<ol start="5" data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>To encourage others (in the CDK, Terraform and Pulumi communities) to share complete, simple and non-trivial examples of IaC software <strong data-v-4b9599ea data-v-4b9599ea>in use</strong>.</li>
</ol>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>There are many ways one could create "IaC Rosetta Stone" (public cloud providers x CI/CD providers x IaC tools)</li>
<li data-v-4b9599ea data-v-4b9599ea>Application developers who are increasingly being tasked operations tasks</li>
</ul>
<ol start="6" data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>I have nothing to sell you</li>
</ol>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>So many articles about Cloud are trying to sell you some tool. Outside of what I consider to be mainstream, dominant vendors like GitHub and AWS, there are no products that I'm trying to sell. I'm also not trying to sell anyone on using my IaC packages. Hopefully my IaC packages can serve as helpful reference.</li>
</ul>
<ol start="7" data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>Walk before running</li>
</ol>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>Build up confidence with vanilla without getting too fancy</li>
<li data-v-4b9599ea data-v-4b9599ea>Build a foundation for learning about new things (Pulumi Automation API, Terragrunt for Terraform, self-mutating CDK Pipelines)</li>
</ul>
<ol start="8" data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>12 Factor App and DevOps</li>
</ol>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>12 Factor App is great, and has guided how I approach both Django application development and IaC library development</li>
<li data-v-4b9599ea data-v-4b9599ea>It would be better if 12 Factor App had an official companion app in a few major frameworks with the goal of demonstrating <em data-v-4b9599ea data-v-4b9599ea>how</em> to follow the 12Factor App principles with a relatively straightforward example app</li>
</ul>
<h2 id="terminology" data-v-4b9599ea data-v-4b9599ea><a href="#terminology" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Terminology</h2>
<h3 id="constructs-modules-and-components" data-v-4b9599ea data-v-4b9599ea><a href="#constructs-modules-and-components" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>constructs, modules and components</h3>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>CDK: constructs and stacks</li>
<li data-v-4b9599ea data-v-4b9599ea>Terraform: modules (and stacks) <a href="https://discuss.hashicorp.com/t/what-is-a-terraform-stack/31985" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>https://discuss.hashicorp.com/t/what-is-a-terraform-stack/31985</a></li>
<li data-v-4b9599ea data-v-4b9599ea>Pulumi: components and stacks</li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>In this article I will refer to constructs/modules/components as <strong data-v-4b9599ea data-v-4b9599ea>c/m/c</strong> for brevity, and the term stack can generally be used to refer to either a CloudFormation stack, a Pulumi Stack or a Terraform group of resources that are part of a module that has had <code data-v-4b9599ea data-v-4b9599ea>apply</code> ran against it.</p>
<h3 id="what-is-a-stack" data-v-4b9599ea data-v-4b9599ea><a href="#what-is-a-stack" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>What is a stack?</h3>
<p data-v-4b9599ea data-v-4b9599ea>Constructs and Components are similar, but Constructs map to CloudFormation and Components generally seem to map to Terraform resources and modules</p>
<p data-v-4b9599ea data-v-4b9599ea>For the pulumi/aws package, the components generally map directly onto Terraform modules.</p>
<p data-v-4b9599ea data-v-4b9599ea>Transformations are unique to Pulumi
<a href="https://www.pulumi.com/docs/intro/vs/terraform/" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>https://www.pulumi.com/docs/intro/vs/terraform/</a></p>
<h2 id="infrastructure-as-code-library-repos" data-v-4b9599ea data-v-4b9599ea><a href="#infrastructure-as-code-library-repos" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Infrastructure as Code library repos</h2>
<p data-v-4b9599ea data-v-4b9599ea>Let's look at the three repos that I wrote for deploying the same type of 3-tier web application to AWS using ECS Fargate with both CDK, Terraform and Pulumi.</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>terraform-aws-django</li>
<li data-v-4b9599ea data-v-4b9599ea>pulumi-aws-django</li>
<li data-v-4b9599ea data-v-4b9599ea>cdk-django</li>
</ul>
<h3 id="language" data-v-4b9599ea data-v-4b9599ea><a href="#language" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Language</h3>
<p data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>cdk-django</code> and <code data-v-4b9599ea data-v-4b9599ea>pulumi-aws-django</code> are both written in TypeScript. <code data-v-4b9599ea data-v-4b9599ea>terraform-aws-django</code> is written in HCL.</p>
<h3 id="versions" data-v-4b9599ea data-v-4b9599ea><a href="#versions" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Versions</h3>
<p data-v-4b9599ea data-v-4b9599ea>Here are the versions of CDK, Terraform and Pulumi and related dependencies that I'm using at the time of writing:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>CDK</li>
<li data-v-4b9599ea data-v-4b9599ea>Terraform</li>
<li data-v-4b9599ea data-v-4b9599ea>Pulumi</li>
</ul>
<h3 id="release-management-and-publishing" data-v-4b9599ea data-v-4b9599ea><a href="#release-management-and-publishing" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Release management and publishing</h3>
<p data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>pulumi-aws-django</code> and <code data-v-4b9599ea data-v-4b9599ea>terraform-aws-django</code> both use <code data-v-4b9599ea data-v-4b9599ea>release-please</code> for automatically generating a changelog file and bumping versions.</p>
<p data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>cdk-django</code> uses <code data-v-4b9599ea data-v-4b9599ea>projen</code> for maintaining the changelog and bumping versions and publishing to npm.</p>
<h3 id="makefile-and-local-development" data-v-4b9599ea data-v-4b9599ea><a href="#makefile-and-local-development" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Makefile and local development</h3>
<p data-v-4b9599ea data-v-4b9599ea>Each repo has a Makefile that includes commands that I frequently use when developing new features or fixing bugs. Each repo has commands for the following:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>synthesizing CDK to CloudFormation / running <code data-v-4b9599ea data-v-4b9599ea>terraform plan</code> and previewing pulumi up for both the base and app stacks</li>
<li data-v-4b9599ea data-v-4b9599ea>creating/updating an ad-hoc base environment called <code data-v-4b9599ea data-v-4b9599ea>dev</code></li>
<li data-v-4b9599ea data-v-4b9599ea>destroying all resources in the ad-hoc base environment called <code data-v-4b9599ea data-v-4b9599ea>dev</code></li>
<li data-v-4b9599ea data-v-4b9599ea>creating an ad-hoc app environment called <code data-v-4b9599ea data-v-4b9599ea>alpha</code> that uses resources from <code data-v-4b9599ea data-v-4b9599ea>dev</code></li>
<li data-v-4b9599ea data-v-4b9599ea>destroying an ad-hoc app environment called <code data-v-4b9599ea data-v-4b9599ea>alpha</code> that uses resources from <code data-v-4b9599ea data-v-4b9599ea>dev</code></li>
</ul>
<h3 id="ad-hoc-vs-prod" data-v-4b9599ea data-v-4b9599ea><a href="#ad-hoc-vs-prod" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>ad-hoc vs prod</h3>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>the last article I wrote was about ad hoc environments. Also known as "on-demand" environments or "preview" environments.</li>
<li data-v-4b9599ea data-v-4b9599ea>the motivation for ad-hoc environments is speed and cost</li>
<li data-v-4b9599ea data-v-4b9599ea>you can completely ignore "ad-hoc" environments and use the "prod" infrastructure for any number of environments (such as dev, QA, RC, stage and prod)</li>
<li data-v-4b9599ea data-v-4b9599ea>prod can be used for prod and any number of pre-prod environments</li>
<li data-v-4b9599ea data-v-4b9599ea>multiple environments built with "prod" infrastructure can be configured with a "knobs and dials" (e.g., how big are app and DB instances, how many tasks to run in a service, etc.)</li>
<li data-v-4b9599ea data-v-4b9599ea>the "prod" infrastructure should be the same for the "production" environment and the "staging" environment</li>
</ul>
<h3 id="directory-structure" data-v-4b9599ea data-v-4b9599ea><a href="#directory-structure" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Directory structure</h3>
<p data-v-4b9599ea data-v-4b9599ea>The directory structures for each repo are all similar with some minor differences.</p>
<p data-v-4b9599ea data-v-4b9599ea>There are two types of environments: <code data-v-4b9599ea data-v-4b9599ea>ad-hoc</code> and <code data-v-4b9599ea data-v-4b9599ea>production</code>. Within ad-hoc and production, there are two directories <code data-v-4b9599ea data-v-4b9599ea>base</code> and <code data-v-4b9599ea data-v-4b9599ea>app</code>.</p>
<p data-v-4b9599ea data-v-4b9599ea>Each repo has a directory called <code data-v-4b9599ea data-v-4b9599ea>internal</code> which contain building blocks used by the modules/components/constructs that are exposed. The contents of the <code data-v-4b9599ea data-v-4b9599ea>internal</code> directories are not intended to be used by anyone who is using the libraries.</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="language-text line-numbers" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea># CDK construct library repo structure

# Terraform module library repo structure

# Pulumi component library repo structure
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea>There is a balance to be found between single stacks vs micro stacks.
Both the base and app modules/components/constructs could be split out further. For example, the <code data-v-4b9599ea data-v-4b9599ea>base</code> modules/components/constructs could be split into <code data-v-4b9599ea data-v-4b9599ea>networking</code> and <code data-v-4b9599ea data-v-4b9599ea>rds</code>. The <code data-v-4b9599ea data-v-4b9599ea>app</code> stack could be split into different ECS services so that their infrastructure can be deployed independently.</p>
<p data-v-4b9599ea data-v-4b9599ea>The rule of thumbs are:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>single stacks are bad because you don't want to put all your eggs in one basket, however your IaC tool should give you confidence about what is going to change when you try to make a change</li>
<li data-v-4b9599ea data-v-4b9599ea>Lots of small stacks can cause overhead and make things more complex than they need to be</li>
</ul>
<h3 id="cloc" data-v-4b9599ea data-v-4b9599ea><a href="#cloc" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>CLOC</h3>
<h3 id="examples" data-v-4b9599ea data-v-4b9599ea><a href="#examples" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Examples</h3>
<p data-v-4b9599ea data-v-4b9599ea>Each repo contains examples of how to use the respective (module/component/construct) libraries. These examples allow me to make changes in my local repo and then deploy stacks from my computer (as opposed to using GitHub Actions)</p>
<h2 id="communities" data-v-4b9599ea data-v-4b9599ea><a href="#communities" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Communities</h2>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>CDK.dev</li>
<li data-v-4b9599ea data-v-4b9599ea>Pulumi Slack</li>
<li data-v-4b9599ea data-v-4b9599ea>Terraform Discourse Forum</li>
</ul>
<h2 id="Œºblog" data-v-4b9599ea data-v-4b9599ea><a href="#%CE%BCblog" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Œºblog</h2>
<p data-v-4b9599ea data-v-4b9599ea>Œºblog is a micro blogging application that I have written using Django and Vue.js.</p>
<h3 id="mono-repo-structure" data-v-4b9599ea data-v-4b9599ea><a href="#mono-repo-structure" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Mono-repo structure</h3>
<p data-v-4b9599ea data-v-4b9599ea>It lives in a GitHub mono repo called <code data-v-4b9599ea data-v-4b9599ea>django-step-by-step</code>. This mono repo contains a few different things:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>backend Django application</li>
<li data-v-4b9599ea data-v-4b9599ea>frontend Vue.js application</li>
<li data-v-4b9599ea data-v-4b9599ea>IaC code that uses c/m/c from <code data-v-4b9599ea data-v-4b9599ea>cdk-django</code>, <code data-v-4b9599ea data-v-4b9599ea>terraform-aws-django</code> and <code data-v-4b9599ea data-v-4b9599ea>pulumi-aws-django</code></li>
<li data-v-4b9599ea data-v-4b9599ea>GitHub Actions workflows for both Infrastructure deployments and application deployments</li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>Œºblog is the reference application that I deploy to infrastructure created with CDK, Terraform and Pulumi. Œºblog is meant to represent a generic application uses:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>gunicorn for a backend API</li>
<li data-v-4b9599ea data-v-4b9599ea>Vue.js for a client that consumes the backend API</li>
<li data-v-4b9599ea data-v-4b9599ea>celery for async task processing</li>
<li data-v-4b9599ea data-v-4b9599ea>celery beat for scheduling tasks</li>
<li data-v-4b9599ea data-v-4b9599ea>Postgres for relational data</li>
<li data-v-4b9599ea data-v-4b9599ea>Redis for caching and message brokering (and maybe websocket backend)</li>
<li data-v-4b9599ea data-v-4b9599ea>S3 for object storage</li>
<li data-v-4b9599ea data-v-4b9599ea>Django admin for a simple admin interface</li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>There is a lot more I could add on Œºblog. For now I'll just mention that it:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>has a great local development environment (supports both docker-compose and virtual environments)</li>
<li data-v-4b9599ea data-v-4b9599ea>demonstrates how to use Django in different ways. It implements the same application using Function Based View and Class Based Views, and implements both a REST API (both with FBV and CBV) and GraphQL.</li>
<li data-v-4b9599ea data-v-4b9599ea>GitHub Actions for running unit tests</li>
<li data-v-4b9599ea data-v-4b9599ea>k6 for load testing</li>
<li data-v-4b9599ea data-v-4b9599ea>contains a documentation site deployed to GitHub pages (made with VuePress) can be found here: <a href="https://briancaffey.github.io/django-step-by-step/" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>https://briancaffey.github.io/django-step-by-step/</a></li>
</ul>
<h1 id="infrastructure-deep-dive" data-v-4b9599ea data-v-4b9599ea><a href="#infrastructure-deep-dive" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Infrastructure Deep Dive</h1>
<p data-v-4b9599ea data-v-4b9599ea>Let's go through each of the <code data-v-4b9599ea data-v-4b9599ea>c/m/c</code>s used in the three libraries. I'll cover some of the organizational decisions, dependencies and differences between how things are done between CDK, Terraform and Pulumi.</p>
<p data-v-4b9599ea data-v-4b9599ea>I'll first talk about the two stacks used in ad hoc environments: <code data-v-4b9599ea data-v-4b9599ea>base</code> and <code data-v-4b9599ea data-v-4b9599ea>app</code>. Then I'll talk about the prod environments which are also composed of <code data-v-4b9599ea data-v-4b9599ea>base</code> and <code data-v-4b9599ea data-v-4b9599ea>app</code> stacks.</p>
<p data-v-4b9599ea data-v-4b9599ea>Keep in mind that there aren't that many differences between the ad hoc environment base and app stacks and the prod environment app and base stacks. A future optimization could be to use a single base and app stack, but I think there is a tradeoff between readability and DRYness of infrastructure code, <strong data-v-4b9599ea data-v-4b9599ea>especially with Terraform</strong>. In general I try to use very little conditionals with Terraform code. It is much easier to have dynamic configuration in CDK and Pulumi, and probably also for other tools like CDKTF (that I have not yet tried).</p>
<h2 id="splitting-up-the-stacks" data-v-4b9599ea data-v-4b9599ea><a href="#splitting-up-the-stacks" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Splitting up the stacks</h2>
<p data-v-4b9599ea data-v-4b9599ea>While it is possible to put all resources in a single stack with both Terraform, CDK and Pulumi, it is not recommended to do so.</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>Terraform enables this with outputs and <code data-v-4b9599ea data-v-4b9599ea>terraform_remote_state</code></li>
<li data-v-4b9599ea data-v-4b9599ea>Pulumi encourages the use of <a href="https://www.pulumi.com/docs/guides/organizing-projects-stacks/" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>micro stacks</a></li>
<li data-v-4b9599ea data-v-4b9599ea>CDK has an article on how to <a href="https://docs.aws.amazon.com/cdk/v2/guide/stack_how_to_create_multiple_stacks.html" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>create an app with multiple stacks</a></li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>The modules</p>
<p data-v-4b9599ea data-v-4b9599ea>Also, on-demand environments really lends itself to stacks that are split up.</p>
<p data-v-4b9599ea data-v-4b9599ea><a href="https://docs.aws.amazon.com/cdk/v2/guide/resources.html" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>https://docs.aws.amazon.com/cdk/v2/guide/resources.html</a> See the section "Passing unique identifiers"</p>
<h2 id="ad-hoc-base-overview" data-v-4b9599ea data-v-4b9599ea><a href="#ad-hoc-base-overview" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Ad hoc base overview</h2>
<p data-v-4b9599ea data-v-4b9599ea>Here's an overview of the resources used in an ad hoc base environment</p>
<h3 id="vpc" data-v-4b9599ea data-v-4b9599ea><a href="#vpc" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>VPC</h3>
<p data-v-4b9599ea data-v-4b9599ea>The VPC is the first resource that is create as part of the <code data-v-4b9599ea data-v-4b9599ea>base</code> stack.</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>There official, high-level constructs in each IaC tool for building VPCs and all related networking resources.</p>
</li>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>awsx</code> has a VPC module</p>
</li>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>terraform-aws-vpc</code> module</p>
</li>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>L2 VPC Construct in CDK</p>
</li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>The setting in the Terraform VPC module <code data-v-4b9599ea data-v-4b9599ea>one_nat_gateway_per_az = false</code> doesn't seem to exist on the <code data-v-4b9599ea data-v-4b9599ea>awsx.ec2.Vpc</code> module. This will add to cost savings since it will use 1 NAT Gateway instead of 2.</p>
<h3 id="security-groups" data-v-4b9599ea data-v-4b9599ea><a href="#security-groups" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Security Groups</h3>
<p data-v-4b9599ea data-v-4b9599ea>Pulumi and Terraform can be used in a similar way to define security groups. CDK has a much more concise way of defining ingress and egress rules for security groups.</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="language-text line-numbers" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea>TODO
# Pulumi Example

# Terraform example

# CDK example
</code></pre></div>
<h3 id="load-balancer-resources" data-v-4b9599ea data-v-4b9599ea><a href="#load-balancer-resources" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Load Balancer Resources</h3>
<p data-v-4b9599ea data-v-4b9599ea>There's not much to comment on here. In each library I have resource group that defines the following:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>Application Load Balancer</li>
<li data-v-4b9599ea data-v-4b9599ea>A default target group</li>
<li data-v-4b9599ea data-v-4b9599ea>An HTTP listener that redirects to HTTPS</li>
<li data-v-4b9599ea data-v-4b9599ea>An HTTPS listener with a default "fixed-response" action</li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>Properties from these resources are used in the "app" stack to build listener rules for ECS services that are configured with load balancers, such as the backend and frontend web services.</p>
<h3 id="rds-resources" data-v-4b9599ea data-v-4b9599ea><a href="#rds-resources" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>RDS Resources</h3>
<p data-v-4b9599ea data-v-4b9599ea>One decision I made for all three libraries is to put the RDS security group and Subnet Group in the same module as the RDS instance. The SG and DB Subnet group could alternatively be grouped closer to the other network resources.</p>
<p data-v-4b9599ea data-v-4b9599ea>Currently the RDS resources are part of the "base" stack for each library. A future optimization may be to break the RDS instance out of the "base" stack and put it in its own stack. The "RDS" stack would be dependent on the "base" stack, and then "app" stack would then be dependent on both the "base" stack and the "RDS" stack. More stacks isn't necessarily a bad thing, but for my initial implementation of these libraries I have decided to keep the "micro stacks" approach limited to only 2 stacks for an environment.</p>
<h2 id="ad-hoc-app-overview" data-v-4b9599ea data-v-4b9599ea><a href="#ad-hoc-app-overview" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Ad hoc app overview</h2>
<h3 id="ecs-cluster" data-v-4b9599ea data-v-4b9599ea><a href="#ecs-cluster" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>ECS Cluster</h3>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>This is a small component that defines both ECS Cluster and the default capacity providers</li>
<li data-v-4b9599ea data-v-4b9599ea>It defaults to not using <code data-v-4b9599ea data-v-4b9599ea>FARGATE_SPOT</code>; ad hoc environments do use <code data-v-4b9599ea data-v-4b9599ea>FARGATE_SPOT</code> for cost savings</li>
<li data-v-4b9599ea data-v-4b9599ea>This would be a good value to</li>
</ul>
<h3 id="shared-environment-variables" data-v-4b9599ea data-v-4b9599ea><a href="#shared-environment-variables" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Shared environment variables</h3>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>Struggled to get this right in pulumi. A lot of Pulumi examples used <code data-v-4b9599ea data-v-4b9599ea>JSON.stringify</code> for containerDefinitions in task definitions. I was able to get help from the Pulumi Slack channel; someone recommended that I use <code data-v-4b9599ea data-v-4b9599ea>pulumi.jsonStringify</code> which was added in a relatively recent version of <code data-v-4b9599ea data-v-4b9599ea>pulumi/pulumi</code>.</p>
</li>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>CDK allows you to declare environment variables for a containerDefinition like <code data-v-4b9599ea data-v-4b9599ea>{ FOO: "bar" }</code></p>
</li>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>Pulumi and Terraform require that values are passed like <code data-v-4b9599ea data-v-4b9599ea>{ name: "FOO", value: "bar"}</code></p>
</li>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>You could transform <code data-v-4b9599ea data-v-4b9599ea>{ FOO: "bar" }</code> into the name/value format, but I didn't bother to do this</p>
</li>
<li data-v-4b9599ea data-v-4b9599ea>
<p data-v-4b9599ea data-v-4b9599ea>extra env vars in Terraform to allow for dynamically passing extra environment variables</p>
</li>
</ul>
<h3 id="route53-record" data-v-4b9599ea data-v-4b9599ea><a href="#route53-record" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Route53 Record</h3>
<p data-v-4b9599ea data-v-4b9599ea>This is pretty straightforward in each library. Each ad hoc environment gets a Route 53 record, and listener rules for the web services (Django and Vue.js SPA) match on a combination of the host header and path patterns.</p>
<p data-v-4b9599ea data-v-4b9599ea>This part is pretty opinionated in that it assumes you want to host the frontend and backend services on the same URL. For example, requests matching <code data-v-4b9599ea data-v-4b9599ea>example.com/api/*</code> are routed to the backend API and all other requests matching <code data-v-4b9599ea data-v-4b9599ea>example.com/*</code> are routed to the frontend service.</p>
<h3 id="redis" data-v-4b9599ea data-v-4b9599ea><a href="#redis" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Redis</h3>
<p data-v-4b9599ea data-v-4b9599ea>I go into more depth about why I run a Redis instance in an ECS service in my other article. This is only for the ad hoc environments. Production environments will be configured with ElastiCache for managed Redis.</p>
<p data-v-4b9599ea data-v-4b9599ea>I decided to not make this service use any persistent storage. It may be a good idea to not use FARGATE_SPOT for this service, since restarts to the redis service could cause issues in ad hoc environments. For example, you may get a lot of celery errors in ad hoc environments if redis is not reachable.</p>
<h3 id="web-service" data-v-4b9599ea data-v-4b9599ea><a href="#web-service" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Web Service</h3>
<p data-v-4b9599ea data-v-4b9599ea>The web service is what defines the main Django application as well as the frontend website (JavaScript SPA or SSR site). I designed the Web Service resources group to be able to support both traditional Django apps (powered by templates), or for Django apps that service only a limited number of endpoints. This <code data-v-4b9599ea data-v-4b9599ea>c/m/c</code> has an input parameter called <code data-v-4b9599ea data-v-4b9599ea>pathPatterns</code> which determines which paths it serves. For example, you Django container may serve traffic for <code data-v-4b9599ea data-v-4b9599ea>/api/*</code> and <code data-v-4b9599ea data-v-4b9599ea>/admin/*</code> only, or it may want to serve all traffic (<code data-v-4b9599ea data-v-4b9599ea>/*</code>).</p>
<p data-v-4b9599ea data-v-4b9599ea>The way I use these components in ad hoc and prod environments is heavily opinionated in that it:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>assumes that the frontend SPA/SSR site should have a lower priority rule than the backend service and should route request paths matching <code data-v-4b9599ea data-v-4b9599ea>/*</code>, while the backend service routes requests for a specific list of path patterns (<code data-v-4b9599ea data-v-4b9599ea>/api/*</code>, <code data-v-4b9599ea data-v-4b9599ea>/admin/*</code>, <code data-v-4b9599ea data-v-4b9599ea>/graphql/*</code>, etc.).</li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>You may want Django to handle most of your routes and 404 pages, in which case you would want the SPA to only handle requests matching certain paths. This would require some more consideration and careful refactoring.</p>
<h3 id="celery" data-v-4b9599ea data-v-4b9599ea><a href="#celery" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Celery</h3>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>The reason for having a celery service is to be able to have potentially multiple workers that scale independently</li>
<li data-v-4b9599ea data-v-4b9599ea>I use the same Pulumi component for both works and schedulers</li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>The terminology for this resource group could be better. Celery is one of many options for running async task workers, so it should probably be called something like <code data-v-4b9599ea data-v-4b9599ea>AsyncWorker</code> across the board rather than using the term <code data-v-4b9599ea data-v-4b9599ea>celery</code>.</p>
<h3 id="management-command" data-v-4b9599ea data-v-4b9599ea><a href="#management-command" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Management Command</h3>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>Defines a task that can be used to run commands like <code data-v-4b9599ea data-v-4b9599ea>collectstatic</code> and <code data-v-4b9599ea data-v-4b9599ea>migrate</code></li>
<li data-v-4b9599ea data-v-4b9599ea>These tasks are ran both after the initial <code data-v-4b9599ea data-v-4b9599ea>app</code> stack deployment and before rolling application upgrades</li>
</ul>
<h3 id="passing-data-between-stacks" data-v-4b9599ea data-v-4b9599ea><a href="#passing-data-between-stacks" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Passing data between stacks</h3>
<p data-v-4b9599ea data-v-4b9599ea>Pulumi uses stack references, Terraform uses remote state and CDK uses Stack Outputs or Stack References</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="language-text line-numbers" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea># CDK example

# Terraform example

# Pulumi example
</code></pre></div>
<h2 id="design-principles" data-v-4b9599ea data-v-4b9599ea><a href="#design-principles" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Design Principles</h2>
<p data-v-4b9599ea data-v-4b9599ea>Terraform, Pulumi and CDK all do a good job of providing extensive examples covering different languages, cloud resource types and (for Terraform and Pulumi) different cloud providers.</p>
<p data-v-4b9599ea data-v-4b9599ea>Here are some examples of official examples:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>CDK examples</li>
<li data-v-4b9599ea data-v-4b9599ea>Terraform examples</li>
<li data-v-4b9599ea data-v-4b9599ea>Pulumi examples</li>
</ul>
<h2 id="cli-scaffolding" data-v-4b9599ea data-v-4b9599ea><a href="#cli-scaffolding" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>CLI scaffolding</h2>
<p data-v-4b9599ea data-v-4b9599ea>CDK and Pulumi have some good options for how to scaffold a project.</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>Pulumi has <code data-v-4b9599ea data-v-4b9599ea>pulumi new aws-typescript</code> among lots of other options (run <code data-v-4b9599ea data-v-4b9599ea>pulumi new -l</code> to see over 200 project types)</li>
<li data-v-4b9599ea data-v-4b9599ea>CDK has <code data-v-4b9599ea data-v-4b9599ea>projen</code> CLI commands which can help set up either library code or project code</li>
<li data-v-4b9599ea data-v-4b9599ea>The major benefits of these tools is setting up <code data-v-4b9599ea data-v-4b9599ea>tsconfig.json</code> and <code data-v-4b9599ea data-v-4b9599ea>package.json</code> correctly</li>
<li data-v-4b9599ea data-v-4b9599ea>Terraform is so simple that it doesn't really need tooling for this</li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>Across the three project I have created lots of package.json files. Each</p>
<p data-v-4b9599ea data-v-4b9599ea>For <code data-v-4b9599ea data-v-4b9599ea>terraform-aws-django</code>, I tried to follow the recommendations from <a href="https://www.terraform-best-practices.com/" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>terraform-best-practices.com</a> which helped me a lot with things like consistent naming patterns and directory structures. Two recommendations I followed carefully:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>use the name <code data-v-4b9599ea data-v-4b9599ea>this</code> for resources in a module where that resource is the only resource of its type</li>
<li data-v-4b9599ea data-v-4b9599ea>avoid using nested modules</li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>I think CDK and Pulumi lend themselves to more nesting and abstractions because they can be written in more familiar programming languages with better abstractions, function, loops, classes, etc., so there are some differences in directory structure of my libraries when comparing Terraform to both CDK and Pulumi.</p>
<h2 id="environment-configuration" data-v-4b9599ea data-v-4b9599ea><a href="#environment-configuration" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Environment configuration</h2>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>Pulumi defines environment-specific config in files called <code data-v-4b9599ea data-v-4b9599ea>Pulumi.{env}.yaml</code></li>
<li data-v-4b9599ea data-v-4b9599ea>Terraform uses <code data-v-4b9599ea data-v-4b9599ea>{env}.tfvars</code> for this type of configuration</li>
<li data-v-4b9599ea data-v-4b9599ea>CDK has several options for this type of configuration (<code data-v-4b9599ea data-v-4b9599ea>cdk.context.json</code>, extending stack props, etc.)</li>
</ul>
<p data-v-4b9599ea data-v-4b9599ea>I have tried to use sensible defaults for the ad hoc environments. For <code data-v-4b9599ea data-v-4b9599ea>prod</code> environments, it might make more sense to use more config values here. This could help with things like:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>using different instances sizes in QA vs staging vs production environments</li>
<li data-v-4b9599ea data-v-4b9599ea>environment specific config values (application env vars)</li>
</ul>
<h2 id="local-development" data-v-4b9599ea data-v-4b9599ea><a href="#local-development" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Local development</h2>
<p data-v-4b9599ea data-v-4b9599ea>Using the Makefile targets in each library repo, my process for developing c/m/c involves making code changes followed by Makefile targets that preview/plan/diff against my AWS account, then running deploy/apply/up and waiting for things to finish deploying. Once I can validate that things are looking correct in my account, I run the destroy command and make sure that all of the resources are removed successfully. RDS instances can take up to 10 minutes to create, which means that the base stack takes some time to test. The app environment is able to be spun up quickly, but it can sometimes get stuck and take some time to delete services.</p>
<p data-v-4b9599ea data-v-4b9599ea>Here are some sample times for deploying ad hoc stacks with CDK, Terraform and Pulumi.</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="language-text line-numbers" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea># CDK sample time

# Terraform sample time

# Pulumi sample time
</code></pre></div>
<p data-v-4b9599ea data-v-4b9599ea>Here are some examples of what the diff/plan/preview commands show:</p>
<div class="nuxt-content-highlight" data-v-4b9599ea data-v-4b9599ea><pre class="language-text line-numbers" data-v-4b9599ea data-v-4b9599ea><code data-v-4b9599ea data-v-4b9599ea># CDK synth

# Terraform plan

# Pulumi preview
</code></pre></div>
<h2 id="github-actions" data-v-4b9599ea data-v-4b9599ea><a href="#github-actions" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>GitHub Actions</h2>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>pulumi action</li>
<li data-v-4b9599ea data-v-4b9599ea>terraform commands (wrapper)</li>
<li data-v-4b9599ea data-v-4b9599ea>CDK commands</li>
</ul>
<h2 id="what-i-did-not-put-in-iac" data-v-4b9599ea data-v-4b9599ea><a href="#what-i-did-not-put-in-iac" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>What I did not put in IaC</h2>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>ECR</li>
<li data-v-4b9599ea data-v-4b9599ea>ACM</li>
</ul>
<h2 id="tagging" data-v-4b9599ea data-v-4b9599ea><a href="#tagging" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Tagging</h2>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>Terraform and CDK both make it easy to automatically tag all resources in a stack</li>
<li data-v-4b9599ea data-v-4b9599ea>It is possible to do this in Pulumi, but you need to write a little bit of code.</li>
<li data-v-4b9599ea data-v-4b9599ea><a href="https://www.pulumi.com/blog/automatically-enforcing-aws-resource-tagging-policies/" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>https://www.pulumi.com/blog/automatically-enforcing-aws-resource-tagging-policies/</a></li>
<li data-v-4b9599ea data-v-4b9599ea><a href="https://github.com/joeduffy/aws-tags-example/tree/master/autotag-ts" rel="nofollow noopener noreferrer" target="_blank" data-v-4b9599ea data-v-4b9599ea>https://github.com/joeduffy/aws-tags-example/tree/master/autotag-ts</a></li>
<li data-v-4b9599ea data-v-4b9599ea>Tagging is important since I look up resources by tag in GitHub Actions pipelines (for example, the Bastion Host is looked up by tag)</li>
</ul>
<h2 id="next-steps" data-v-4b9599ea data-v-4b9599ea><a href="#next-steps" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Next steps</h2>
<p data-v-4b9599ea data-v-4b9599ea>Here are some of the next things I'll be working on in these project, in order of importance:</p>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>Introduce manual approvals in GitHub Actions and allow for the previewing or "planning" before proceeding with an live operations in infrastructure pipelines</li>
<li data-v-4b9599ea data-v-4b9599ea>For Pulumi and Terraform, use a Secrets Manager secret for the database instead of hardcoding it. Use the <code data-v-4b9599ea data-v-4b9599ea>random</code> functions to do this</li>
<li data-v-4b9599ea data-v-4b9599ea>Refactor GitHub Actions and make them reusable across different projects</li>
<li data-v-4b9599ea data-v-4b9599ea>Writing tests for Pulumi and CDK. Figure out how to write tests for Terraform modules</li>
<li data-v-4b9599ea data-v-4b9599ea>Use graviton instances and have the option to select between different architectures</li>
<li data-v-4b9599ea data-v-4b9599ea>Standardize all resources names</li>
<li data-v-4b9599ea data-v-4b9599ea>The Pulumi components that define the resources associated with each ECS service are not very dry</li>
<li data-v-4b9599ea data-v-4b9599ea>Interfaces could be constructed with inheritance (base set of properties that is extended for different types of services)</li>
<li data-v-4b9599ea data-v-4b9599ea>Make all three of the libraries less opinionated about how the application as a whole. Celery worker and scheduler should be optional, the frontend component should also be optional</li>
<li data-v-4b9599ea data-v-4b9599ea>experiment with using a frontend with SSR. This is supported by Quasar, the framework I'm currently using to build my frontend SPA site.</li>
</ul>
<h2 id="sharing" data-v-4b9599ea data-v-4b9599ea><a href="#sharing" aria-hidden="true" tabindex="-1" data-v-4b9599ea data-v-4b9599ea><span class="icon icon-link" data-v-4b9599ea data-v-4b9599ea></span></a>Sharing</h2>
<ul data-v-4b9599ea data-v-4b9599ea>
<li data-v-4b9599ea data-v-4b9599ea>my personal blog (briancaffey.github.io)</li>
<li data-v-4b9599ea data-v-4b9599ea>DEV.to</li>
<li data-v-4b9599ea data-v-4b9599ea>Ops Community</li>
<li data-v-4b9599ea data-v-4b9599ea>Medium</li>
<li data-v-4b9599ea data-v-4b9599ea>Substack</li>
<li data-v-4b9599ea data-v-4b9599ea>My MailChimp mailing list</li>
<li data-v-4b9599ea data-v-4b9599ea>Hacker News</li>
<li data-v-4b9599ea data-v-4b9599ea>Twitter</li>
<li data-v-4b9599ea data-v-4b9599ea>LinkedIn</li>
<li data-v-4b9599ea data-v-4b9599ea>Facebook</li>
<li data-v-4b9599ea data-v-4b9599ea>HashNode</li>
<li data-v-4b9599ea data-v-4b9599ea>Hackernoon</li>
<li data-v-4b9599ea data-v-4b9599ea>Reddit (r/aws, r/Terraform, r/pulumi, r/django, r/devops)</li>
<li data-v-4b9599ea data-v-4b9599ea>Terraform Forum</li>
<li data-v-4b9599ea data-v-4b9599ea>Pulumi Slack channel</li>
<li data-v-4b9599ea data-v-4b9599ea>CDK.dev Slack channel</li>
</ul></div> <div class="text-center pb-4 pt-8" data-v-4b9599ea><button class="mc-btn rounded py-1 px-2" data-v-4b9599ea>
        Show Disqus Comments üí¨
      </button></div> <!----> <h1 data-v-4b9599ea></h1></div></article> <div class="mx-auto max-w-6xl p-4 lg:px-16 text-center" data-v-27f2d9d4><hr class="mt-4" data-v-27f2d9d4> <div class="mx-auto py-4" data-v-27f2d9d4><div class="pb-4" data-v-27f2d9d4>
      ‡§ú‡§¨ ‡§≠‡•Ä ‡§Æ‡•à‡§Ç ‡§ï‡•ã‡§à ‡§®‡§Ø‡§æ ‡§≤‡•á‡§ñ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂‡§ø‡§§ ‡§ï‡§∞‡•Ç‡§Ç ‡§§‡•ã ‡§Ö‡§™‡§°‡•á‡§ü ‡§π‡•ã‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡•á‡§∞‡•á ‡§®‡•ç‡§Ø‡•Ç‡§ú‡§≤‡•á‡§ü‡§∞ ‡§∏‡•á ‡§ú‡•Å‡§°‡§º‡•á‡§Ç‡•§
    </div> <div class="mx-auto" data-v-89248ae4 data-v-27f2d9d4><div id="mc_embed_signup" class="mx-auto w-full md:w-1/2" data-v-89248ae4><form id="mc-embedded-subscribe-form" action="https://github.us2.list-manage.com/subscribe/post?u=43a795784ca963e25903a0da6&id=9937fe4fc5" method="post" name="mc-embedded-subscribe-form" target="_blank" novalidate class="validate" data-v-89248ae4><div id="mc_embed_signup_scroll" class="grid grid-cols-1 sm:grid-cols-2 gap-4 items-center" data-v-89248ae4><input id="mce-EMAIL" type="email" name="EMAIL" placeholder="‡§Ö‡§™‡§®‡§æ ‡§à‡§Æ‡•á‡§≤ ‡§™‡§§‡§æ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç" class="rounded mc text-center" data-v-89248ae4> <div aria-hidden="true" style="position:absolute;left:-5000px" data-v-89248ae4><input name="b_43a795784ca963e25903a0da6_9937fe4fc5" tabindex="-1" data-v-89248ae4></div> <div data-v-89248ae4><input id="mc-embedded-subscribe" type="submit" name="subscribe" value="‡§∏‡§¶‡§∏‡•ç‡§Ø‡§§‡§æ ‡§≤‡•á‡§®‡•á ‡§ï‡•á" class="mc-btn rounded px-2 py-1 w-full" data-v-89248ae4></div></div></form></div></div></div> <hr data-v-27f2d9d4> <div class="py-4" data-v-27f2d9d4>
    ‡§Æ‡•á‡§∞‡•Ä ‡§∏‡§æ‡§á‡§ü ‡§¨‡§æ‡§π‡§∞ ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶!
  </div> <div class="pb-4" data-v-27f2d9d4>
    ¬© 2021 Brian Caffey
  </div></div></div></div></div><script defer src="/_nuxt/static/1672798569/in/2022/06/26/i-deployed-the-same-containerized-serverless-django-application-with-aws-cdk-and-terraform/state.js"></script><script src="/_nuxt/e9c2366.js" defer></script><script src="/_nuxt/b5afa39.js" defer></script><script src="/_nuxt/9ee0ef6.js" defer></script><script src="/_nuxt/f51c3d4.js" defer></script><script src="/_nuxt/0f451e7.js" defer></script>
  </body>
</html>
