__NUXT_JSONP__("/blog/2017-11-11-creating-a-heroku-deploy-button-for-django-template-project", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V){return {data:[{article:{layout:"post",title:"Automating Django deployment with a Deploy-to-Heroku button",date:"2017-11-11T00:00:00.000Z",comments:true,toc:[{id:E,depth:F,text:G},{id:H,depth:F,text:I}],body:{type:"root",children:[{type:b,tag:i,props:{},children:[{type:a,value:"For recent project and hackathons I have been using the same Django project template outlined in an article I wrote last year about how to deploy a Django project on Heroku. In this article I want to update the process I have been using to deploy Django projects and get a \"Deploy to Heroku\" button working so I (or anyone else) can spin up a new project as fast as possible. This is what the button looks like: "}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:s,props:{href:"#"},children:[{type:b,tag:J,props:{alt:K,src:L},children:[]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Here are some things that I will be adding to the project that I didn't include in my last article\u002Ftutorial: "}]},{type:a,value:e},{type:b,tag:"ul",props:{},children:[{type:a,value:e},{type:b,tag:C,props:{},children:[{type:a,value:"Django Rest Framework (DRF)"}]},{type:a,value:e},{type:b,tag:C,props:{},children:[{type:a,value:"Enabling CORS (useful if you are using Django as your backend only with a separate front-end)"}]},{type:a,value:e},{type:b,tag:C,props:{},children:[{type:a,value:"A sample app with a simple model to show how I organize API related info"}]},{type:a,value:e}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"There is pretty good "},{type:b,tag:s,props:{href:"https:\u002F\u002Fblog.heroku.com\u002Fheroku-button",rel:[y,z,A],target:B},children:[{type:a,value:"documentation"}]},{type:a,value:" from Heroku on how to set up a one-click deploy button with Heroku, but I had to troubleshoot a few issues that were giving me errors during the deploy process. "}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"The process of making a one-click deploy button is very simple. For Django projects, we just need to add an "},{type:b,tag:h,props:{},children:[{type:a,value:u}]},{type:a,value:" file to our base directory. Here is the "},{type:b,tag:h,props:{},children:[{type:a,value:u}]},{type:a,value:" file for my Django template app:"}]},{type:a,value:e},{type:b,tag:o,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,"language-javascript"]},children:[{type:b,tag:h,props:{},children:[{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:w}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"name\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"Django One Click App\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"A Template for a Django Projec that uses Django Rest Framework\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"repository\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"https:\u002F\u002Fgithub.com\u002Fbriancaffey\u002Foneclickapp\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"keywords\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:N}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"django\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"python\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"heroku\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:O}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"success_url\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"\u002Fsuccess\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"env\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:w}]},{type:a,value:v},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"DISABLE_COLLECTSTATIC\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"1\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:" \n    "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"SECRET_KEY\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:w}]},{type:a,value:D},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:M}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"A secret key for verifying the integrity of signed cookies.\""}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:D},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"generator\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:a,value:n},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"secret\""}]},{type:a,value:v},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"addons\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:N}]},{type:a,value:v},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:w}]},{type:a,value:"\n        "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"plan\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"heroku-postgresql\""}]},{type:a,value:v},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:m},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:O}]},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:l}]},{type:a,value:" \n  "},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"scripts\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:a,value:v},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:w}]},{type:a,value:D},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\"postdeploy\""}]},{type:b,tag:c,props:{className:[d,j]},children:[{type:a,value:k}]},{type:b,tag:c,props:{className:[d,g]},children:[{type:a,value:"\".\u002Fpostdeploy.sh\""}]},{type:a,value:v},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:e},{type:b,tag:c,props:{className:[d,f]},children:[{type:a,value:x}]},{type:a,value:e}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"It is very important that you include "},{type:b,tag:h,props:{},children:[{type:a,value:"\"DISABLE_COLLECTSTATIC\":\"1\","}]},{type:a,value:" in the "},{type:b,tag:h,props:{},children:[{type:a,value:"env"}]},{type:a,value:" section of "},{type:b,tag:h,props:{},children:[{type:a,value:u}]},{type:a,value:P},{type:b,tag:s,props:{href:"https:\u002F\u002Fdevcenter.heroku.com\u002Farticles\u002Fdjango-assets",rel:[y,z,A],target:B},children:[{type:a,value:"Here"}]},{type:a,value:" is a Heroku article that explains this issue in more detail."}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"I found a "},{type:b,tag:s,props:{href:"https:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F40985063\u002Fhow-to-run-postdeploy-scripts-in-heroku-button-app-json",rel:[y,z,A],target:B},children:[{type:a,value:"helpful answer"}]},{type:a,value:" on StackOverflow regarding the "},{type:b,tag:h,props:{},children:[{type:a,value:"scripts"}]},{type:a,value:" portion of "},{type:b,tag:h,props:{},children:[{type:a,value:u}]},{type:a,value:". If you want to call multiple commands once the app has been built successfully, you can simply execute a bash script. Make sure that this script has execute permissions by running the following command on the file locally before committing it to your repo: "}]},{type:a,value:e},{type:b,tag:o,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,t]},children:[{type:b,tag:h,props:{},children:[{type:a,value:"sudo chmod +x postdeploy.sh\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Here is my "},{type:b,tag:h,props:{},children:[{type:a,value:"postdeploy.sh"}]},{type:a,value:" script: "}]},{type:a,value:e},{type:b,tag:o,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,t]},children:[{type:b,tag:h,props:{},children:[{type:a,value:"python manage.py migrate\necho \"from django.contrib.auth.models import User; User.objects.create_superuser('admin', 'admin@example.com', 'password')\" | python manage.py shell\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"First, I make migrations and then I run the equivalent of "},{type:b,tag:h,props:{},children:[{type:a,value:"python manage.py createsuperuser"}]},{type:a,value:" with a default username and password for a simple admin user. "}]},{type:a,value:e},{type:b,tag:Q,props:{id:E},children:[{type:b,tag:s,props:{href:"#the-deploy-button",ariaHidden:R,tabIndex:S},children:[{type:b,tag:c,props:{className:[T,U]},children:[]}]},{type:a,value:G}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Here's an example of how to make this with markdown: "}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"{% raw %}"}]},{type:a,value:e},{type:b,tag:o,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,t]},children:[{type:b,tag:h,props:{},children:[{type:a,value:"[![Deploy](https:\u002F\u002Fwww.herokucdn.com\u002Fdeploy\u002Fbutton.png)](https:\u002F\u002Fheroku.com\u002Fdeploy?template=https:\u002F\u002Fgithub.com\u002Fbriancaffey\u002Foneclickapp\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"{% endraw %}"}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"To clarify, the link portion should be: "}]},{type:a,value:e},{type:b,tag:o,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,t]},children:[{type:b,tag:h,props:{},children:[{type:a,value:"\"https:\u002F\u002Fheroku.com\u002Fdeploy\" + \"?template=\" + \u003Cgithub repo URL\u003E \n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"This needs to be a GitHub repo. "}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"This should result in a button that looks like this: "}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:b,tag:s,props:{href:"https:\u002F\u002Fheroku.com\u002Fdeploy?template=https:\u002F\u002Fgithub.com\u002Fbriancaffey\u002Foneclickapp",rel:[y,z,A],target:B},children:[{type:b,tag:J,props:{alt:K,src:L},children:[]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Feel free to try it out! This button will bring you to a Heroku page that lets you choose a custom name (a Heroku subdomain) for your new app. Once you click \"Deploy\", you will see the build process and then you will be able to click \"View\". This takes you to the "},{type:b,tag:h,props:{},children:[{type:a,value:"success"}]},{type:a,value:" page that I specified in the "},{type:b,tag:h,props:{},children:[{type:a,value:"success_url"}]},{type:a,value:" field of "},{type:b,tag:h,props:{},children:[{type:a,value:u}]},{type:a,value:P}]},{type:a,value:e},{type:b,tag:Q,props:{id:H},children:[{type:b,tag:s,props:{href:"#how-to-edit-a-newly-deployed-project",ariaHidden:R,tabIndex:S},children:[{type:b,tag:c,props:{className:[T,U]},children:[]}]},{type:a,value:I}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Once you have deployed the app to Heroku you should clone the Heroku git repo to your local machine with the following command: "}]},{type:a,value:e},{type:b,tag:o,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,t]},children:[{type:b,tag:h,props:{},children:[{type:a,value:"heroku git:clone -a yourappname\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Replace "},{type:b,tag:h,props:{},children:[{type:a,value:"yourappname"}]},{type:a,value:" with the name of your app. For Django projects like this you should first create a virtual environment in your workspace and then create an "},{type:b,tag:h,props:{},children:[{type:a,value:V}]},{type:a,value:" folder in which you clone this repo. Then you should run the following command from inside the "},{type:b,tag:h,props:{},children:[{type:a,value:V}]},{type:a,value:" folder: "}]},{type:a,value:e},{type:b,tag:o,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,t]},children:[{type:b,tag:h,props:{},children:[{type:a,value:"cp yourappname\u002Fsettings\u002Fbase.py yourappname\u002Fsettings\u002Flocal.py\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"This will give you a settings file that you can use locally. Finally, run the app locally to make sure it is working properly: "}]},{type:a,value:e},{type:b,tag:o,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,t]},children:[{type:b,tag:h,props:{},children:[{type:a,value:"python manage.py runserver\n"}]}]}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"There is more you can do with "},{type:b,tag:h,props:{},children:[{type:a,value:u}]},{type:a,value:" to customize how the app behaves when deployed, such as specifying deployment environments, but I won't touch on those for now. "}]},{type:a,value:e},{type:b,tag:i,props:{},children:[{type:a,value:"Hopefully this helps you if you are trying to create a \"Deploy-to-Heroku\" button for a Django project. Thanks for reading!"}]}]},dir:"\u002Fblog",path:"\u002Fblog\u002F2017-11-11-creating-a-heroku-deploy-button-for-django-template-project",extension:".md",slug:"2017-11-11-creating-a-heroku-deploy-button-for-django-template-project",createdAt:"1970-01-01T00:00:00.000Z",updatedAt:"2020-09-23T04:18:01.153Z",raw:"\nFor recent project and hackathons I have been using the same Django project template outlined in an article I wrote last year about how to deploy a Django project on Heroku. In this article I want to update the process I have been using to deploy Django projects and get a \"Deploy to Heroku\" button working so I (or anyone else) can spin up a new project as fast as possible. This is what the button looks like: \n\n[![Deploy](https:\u002F\u002Fwww.herokucdn.com\u002Fdeploy\u002Fbutton.png)](#)\n\nHere are some things that I will be adding to the project that I didn't include in my last article\u002Ftutorial: \n\n- Django Rest Framework (DRF)\n- Enabling CORS (useful if you are using Django as your backend only with a separate front-end)\n- A sample app with a simple model to show how I organize API related info\n\nThere is pretty good [documentation](https:\u002F\u002Fblog.heroku.com\u002Fheroku-button) from Heroku on how to set up a one-click deploy button with Heroku, but I had to troubleshoot a few issues that were giving me errors during the deploy process. \n\nThe process of making a one-click deploy button is very simple. For Django projects, we just need to add an `app.json` file to our base directory. Here is the `app.json` file for my Django template app:\n\n```javascript\n{\n  \"name\": \"Django One Click App\",\n  \"description\": \"A Template for a Django Projec that uses Django Rest Framework\",\n  \"repository\": \"https:\u002F\u002Fgithub.com\u002Fbriancaffey\u002Foneclickapp\",\n  \"keywords\": [\"django\", \"python\", \"heroku\"],\n  \"success_url\":\"\u002Fsuccess\",\n  \"env\":{\n    \"DISABLE_COLLECTSTATIC\":\"1\", \n    \"SECRET_KEY\": {\n      \"description\": \"A secret key for verifying the integrity of signed cookies.\",\n      \"generator\": \"secret\"\n    },\n  },\n  \"addons\":[\n    {\n\t    \"plan\":\"heroku-postgresql\"\n    }\n  ], \n  \"scripts\":\n    {\n      \"postdeploy\":\".\u002Fpostdeploy.sh\"\n    }\n}\n```\n\nIt is very important that you include `\"DISABLE_COLLECTSTATIC\":\"1\",` in the `env` section of `app.json`. [Here](https:\u002F\u002Fdevcenter.heroku.com\u002Farticles\u002Fdjango-assets) is a Heroku article that explains this issue in more detail.\n\nI found a [helpful answer](https:\u002F\u002Fstackoverflow.com\u002Fquestions\u002F40985063\u002Fhow-to-run-postdeploy-scripts-in-heroku-button-app-json) on StackOverflow regarding the `scripts` portion of `app.json`. If you want to call multiple commands once the app has been built successfully, you can simply execute a bash script. Make sure that this script has execute permissions by running the following command on the file locally before committing it to your repo: \n\n```terminal\nsudo chmod +x postdeploy.sh\n```\n\nHere is my `postdeploy.sh` script: \n\n```terminal\npython manage.py migrate\necho \"from django.contrib.auth.models import User; User.objects.create_superuser('admin', 'admin@example.com', 'password')\" | python manage.py shell\n```\n\nFirst, I make migrations and then I run the equivalent of `python manage.py createsuperuser` with a default username and password for a simple admin user. \n\n## The Deploy Button\n\nHere's an example of how to make this with markdown: \n\n{% raw %}\n```\n[![Deploy](https:\u002F\u002Fwww.herokucdn.com\u002Fdeploy\u002Fbutton.png)](https:\u002F\u002Fheroku.com\u002Fdeploy?template=https:\u002F\u002Fgithub.com\u002Fbriancaffey\u002Foneclickapp\n```\n{% endraw %}\n\nTo clarify, the link portion should be: \n\n```\n\"https:\u002F\u002Fheroku.com\u002Fdeploy\" + \"?template=\" + \u003Cgithub repo URL\u003E \n```\n\nThis needs to be a GitHub repo. \n\nThis should result in a button that looks like this: \n\n[![Deploy](https:\u002F\u002Fwww.herokucdn.com\u002Fdeploy\u002Fbutton.png)](https:\u002F\u002Fheroku.com\u002Fdeploy?template=https:\u002F\u002Fgithub.com\u002Fbriancaffey\u002Foneclickapp\n)\n\nFeel free to try it out! This button will bring you to a Heroku page that lets you choose a custom name (a Heroku subdomain) for your new app. Once you click \"Deploy\", you will see the build process and then you will be able to click \"View\". This takes you to the `success` page that I specified in the `success_url` field of `app.json`. \n\n## How to edit a newly deployed project\n\nOnce you have deployed the app to Heroku you should clone the Heroku git repo to your local machine with the following command: \n\n```terminal\nheroku git:clone -a yourappname\n```\n\nReplace `yourappname` with the name of your app. For Django projects like this you should first create a virtual environment in your workspace and then create an `src` folder in which you clone this repo. Then you should run the following command from inside the `src` folder: \n\n```terminal\ncp yourappname\u002Fsettings\u002Fbase.py yourappname\u002Fsettings\u002Flocal.py\n```\n\nThis will give you a settings file that you can use locally. Finally, run the app locally to make sure it is working properly: \n\n```terminal\npython manage.py runserver\n```\n\nThere is more you can do with `app.json` to customize how the app behaves when deployed, such as specifying deployment environments, but I won't touch on those for now. \n\nHopefully this helps you if you are trying to create a \"Deploy-to-Heroku\" button for a Django project. Thanks for reading!"}}],fetch:[],mutations:void 0}}("text","element","span","token","\n","punctuation","string","code","p","operator",":",",","\n  "," ","div","nuxt-content-highlight","pre","line-numbers","a","language-text","app.json","\n    ","{","}","nofollow","noopener","noreferrer","_blank","li","\n      ","the-deploy-button",2,"The Deploy Button","how-to-edit-a-newly-deployed-project","How to edit a newly deployed project","img","Deploy","https:\u002F\u002Fwww.herokucdn.com\u002Fdeploy\u002Fbutton.png","\"description\"","[","]",". ","h2","true",-1,"icon","icon-link","src")));