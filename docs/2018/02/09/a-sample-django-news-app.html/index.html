<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Detailed setup of a mini Django News App project with Bootstrap, AJAX, Celery and RabbitMQ</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Brian Caffey's personal website"><meta data-n-head="ssr" property="og:title" content="Detailed setup of a mini Django News App project with Bootstrap, AJAX, Celery and RabbitMQ"><meta data-n-head="ssr" property="og:description" content="undefined"><meta data-n-head="ssr" property="og:image" content="https://briancaffey.github.ioundefined"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" href="/_nuxt/e60f785.js" as="script"><link rel="preload" href="/_nuxt/5025c59.js" as="script"><link rel="preload" href="/_nuxt/88085e0.js" as="script"><link rel="preload" href="/_nuxt/e0416f5.js" as="script"><link rel="preload" href="/_nuxt/a3433a8.js" as="script"><style data-vue-ssr-id="38dfa7e4:0 f52d43e0:0 517a8dd7:0 fa7ff0ca:0 56b15182:0 b20e2cbc:0">/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}details{display:block}summary{display:list-item}[hidden],template{display:none}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}fieldset,ol,ul{margin:0;padding:0}ol,ul{list-style:none}html{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif,BlinkMacSystemFont,"Segoe UI","Helvetica Neue",Arial,"Noto Sans","Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}*,:after,:before{box-sizing:border-box;border:0 solid #e2e8f0}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#a0aec0}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#a0aec0}input::placeholder,textarea::placeholder{color:#a0aec0}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}.bg-white{--bg-opacity:1;background-color:#fff;background-color:rgba(255,255,255,var(--bg-opacity))}.border-white{--border-opacity:1;border-color:#fff;border-color:rgba(255,255,255,var(--border-opacity))}.rounded{border-radius:.25rem}.rounded-lg{border-radius:.5rem}.rounded-full{border-radius:9999px}.rounded-t{border-top-left-radius:.25rem;border-top-right-radius:.25rem}.border{border-width:1px}.cursor-pointer{cursor:pointer}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.table{display:table}.grid{display:grid}.contents{display:contents}.hidden{display:none}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.font-bold{font-weight:700}.h-2{height:.5rem}.h-3{height:.75rem}.h-12{height:3rem}.h-32{height:8rem}.h-64{height:16rem}.text-sm{font-size:.875rem}.text-xl{font-size:1.25rem}.text-2xl{font-size:1.5rem}.text-3xl{font-size:1.875rem}.leading-8{line-height:2rem}.leading-9{line-height:2.25rem}.m-2{margin:.5rem}.m-4{margin:1rem}.mx-1{margin-left:.25rem;margin-right:.25rem}.mx-auto{margin-left:auto;margin-right:auto}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-4{margin-top:1rem}.mb-4{margin-bottom:1rem}.-ml-1{margin-left:-.25rem}.max-w-5xl{max-width:64rem}.max-w-6xl{max-width:72rem}.object-cover{-o-object-fit:cover;object-fit:cover}.p-3{padding:.75rem}.p-4{padding:1rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.px-1{padding-left:.25rem;padding-right:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-3{padding-left:.75rem;padding-right:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.px-4{padding-left:1rem;padding-right:1rem}.py-8{padding-top:2rem;padding-bottom:2rem}.py-32{padding-top:8rem;padding-bottom:8rem}.pb-4{padding-bottom:1rem}.pt-8{padding-top:2rem}.pb-8{padding-bottom:2rem}.pt-16{padding-top:4rem}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{top:0;right:0;bottom:0;left:0}.top-0{top:0}.right-0{right:0}.bottom-0{bottom:0}.left-0{left:0}.resize{resize:both}.shadow{box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06)}.fill-current{fill:currentColor}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.text-black{--text-opacity:1;color:#000;color:rgba(0,0,0,var(--text-opacity))}.text-gray-500{--text-opacity:1;color:#a0aec0;color:rgba(160,174,192,var(--text-opacity))}.text-gray-600{--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity))}.text-red-400{--text-opacity:1;color:#fc8181;color:rgba(252,129,129,var(--text-opacity))}.text-red-600{--text-opacity:1;color:#e53e3e;color:rgba(229,62,62,var(--text-opacity))}.uppercase{text-transform:uppercase}.visible{visibility:visible}.w-2{width:.5rem}.w-3{width:.75rem}.w-12{width:3rem}.w-full{width:100%}.z-10{z-index:10}.gap-4{grid-gap:1rem;gap:1rem}.gap-6{grid-gap:1.5rem;gap:1.5rem}.gap-8{grid-gap:2rem;gap:2rem}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.transform{--transform-translate-x:0;--transform-translate-y:0;--transform-rotate:0;--transform-skew-x:0;--transform-skew-y:0;--transform-scale-x:1;--transform-scale-y:1;transform:translateX(var(--transform-translate-x)) translateY(var(--transform-translate-y)) rotate(var(--transform-rotate)) skewX(var(--transform-skew-x)) skewY(var(--transform-skew-y)) scaleX(var(--transform-scale-x)) scaleY(var(--transform-scale-y))}.transition-all{transition-property:all}.transition{transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform}.duration-150{transition-duration:.15s}.delay-150{transition-delay:.15s}@-webkit-keyframes spin{to{transform:rotate(1turn)}}@keyframes spin{to{transform:rotate(1turn)}}@-webkit-keyframes ping{75%,to{transform:scale(2);opacity:0}}@keyframes ping{75%,to{transform:scale(2);opacity:0}}@-webkit-keyframes pulse{50%{opacity:.5}}@keyframes pulse{50%{opacity:.5}}@-webkit-keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@keyframes bounce{0%,to{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@media (min-width:640px){.sm\:inline{display:inline}.sm\:hidden{display:none}.sm\:p-16{padding:4rem}.sm\:px-4{padding-left:1rem;padding-right:1rem}.sm\:w-2\/3{width:66.666667%}.sm\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width:768px){.md\:flex{display:flex}.md\:hidden{display:none}.md\:px-4{padding-left:1rem;padding-right:1rem}.md\:w-1\/2{width:50%}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}@media (min-width:1024px){.lg\:px-16{padding-left:4rem;padding-right:4rem}.lg\:px-32{padding-left:8rem;padding-right:8rem}.lg\:pl-64{padding-left:16rem}.lg\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width:1280px){.xl\:pb-16{padding-bottom:4rem}}:root{--color:#243746;--color-primary:#158876;--color-secondary:#0e2233;--bg:#f3f5f4;--bg-secondary:#fff;--bg-code:#ddd;--border-color:#ddd}.dark-mode{--color:#ebf4f1;--color-primary:#41b38a;--color-secondary:#fdf9f3;--bg:#091a28;--bg-secondary:#071521;--bg-code:#ddd;--border-color:#0d2538}.sepia-mode{--color:#433422;--color-primary:#504231;--color-secondary:#504231;--bg:#f1e7d0;--bg-code:#ddd;--bg-secondary:#eae0c9;--border-color:#ded0bf}body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Open Sans","Helvetica Neue",sans-serif;background-color:#f3f5f4;background-color:var(--bg);color:#243746;color:var(--color);transition:background-color .3s}a{color:#158876;color:var(--color-primary)}.py-05{padding-top:.125rem;padding-bottom:.125rem}.markdown{--text-opacity:1;color:#1a202c;color:rgba(26,32,44,var(--text-opacity));line-height:1.5;color:#0e2233;color:var(--color-secondary)}.markdown .token.operator{background:0 0}.markdown>*+*{margin-top:0;margin-bottom:1rem}.markdown li+li{margin-top:.25rem}.markdown li>p+p{margin-top:1.5rem;color:#158876;color:var(--color-primary)}.markdown img{margin:auto}.markdown a,.markdown strong{font-weight:600}.markdown strong a{font-weight:700}.markdown h1{font-size:2.25rem}.markdown h1,.markdown h2{border-color:#158876;border-color:var(--color-primary);line-height:1.25;border-bottom-width:1px;font-weight:600;margin-bottom:1rem;margin-top:1.5rem;padding-bottom:.5rem}.markdown h2{font-size:1.5rem}.markdown h3{line-height:1.375;font-size:1.125rem}.markdown h3,.markdown h4{border-color:#158876;border-color:var(--color-primary);font-weight:600;margin-bottom:1rem;margin-top:1.5rem}.markdown h4{line-height:1;font-size:1rem}.markdown h5{border-color:#158876;border-color:var(--color-primary)}.markdown h5,.markdown h6{line-height:1.25;font-size:.875rem;font-weight:600;margin-bottom:1rem;margin-top:1.5rem}.markdown blockquote,.markdown h6{--text-opacity:1;color:#718096;color:rgba(113,128,150,var(--text-opacity))}.markdown blockquote{font-size:1rem;border-left-width:4px;--border-opacity:1;border-color:#e2e8f0;border-color:rgba(226,232,240,var(--border-opacity));padding-left:1rem;padding-right:1rem;border-color:#158876;border-color:var(--color-primary)}.markdown code{font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:.875rem;display:inline;background-color:#edf2f7;background-color:rgba(237,242,247,var(--bg-opacity));padding:.125rem .25rem;background-color:#ddd;background-color:var(--bg-code);color:#000}.markdown code,.markdown pre{--bg-opacity:1;border-radius:.25rem}.markdown pre{background-color:#f7fafc;background-color:rgba(247,250,252,var(--bg-opacity));padding:1rem}.markdown pre code{display:block;background-color:transparent;padding:0;overflow:visible;border-radius:0;color:#000}.markdown p{margin-bottom:10px}code[class*=language-],pre[class*=language-]{background:#ddd!important;background:var(--bg-code)!important;text-shadow:none!important}.markdown ul{list-style-type:disc}.markdown ol,.markdown ul{font-size:1rem;padding-left:2rem}.markdown ol{list-style-type:decimal}.markdown kbd{font-size:.75rem;display:inline-block;border-radius:.25rem;border-width:1px;padding:.125rem .25rem;vertical-align:middle;font-weight:400;font-family:Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;box-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px 0 rgba(0,0,0,.06)}.markdown table,td,th{font-size:1rem;border:1px solid #243746;border-color:var(--color)}.markdown table{overflow-x:scroll}.markdown td,.markdown th{border-width:1px;padding:.25rem .75rem}.markdown .highlight pre{--bg-opacity:1!important;background-color:#f7fafc!important;background-color:rgba(247,250,252,var(--bg-opacity))!important}.article-card{box-shadow:0 5px 10px 1px #0e2233;box-shadow:0 5px 10px 1px var(--color-secondary);height:100%}.article-card:hover{box-shadow:0 5px 15px 5px #158876;box-shadow:0 5px 15px 5px var(--color-primary)}hr{background-color:#243746;background-color:var(--color);border:none;height:1px}.menu-icon{background-color:#ddd;background-color:var(--border-color)}.menu-icon,.mobile-menu{color:#243746;color:var(--color)}.mobile-menu{background-color:#fff;background-color:var(--bg-secondary)}.btn{border-radius:1;border-color:#158876;border-color:var(--color-primary)}.btn:hover{background-color:#fff;background-color:var(--bg-secondary)}.hero{border-color:#158876;border-color:var(--color-primary)}.markdown{word-wrap:break-word}.markdown h2:before,.markdown h3:before{display:block;content:" ";margin-top:-85px;height:85px;visibility:hidden;pointer-events:none}.markdown h2>a,.markdown h3>a{margin-left:1.25rem}.markdown h2>a:before,.markdown h3>a:before{content:"#";font-weight:400;font-size:1.25rem;line-height:2rem;margin-left:-1.25rem;padding-right:.5rem;position:absolute;opacity:1}@media (min-width:1024px){.markdown h2>a,.markdown h3>a{margin-left:0}.markdown h2>a:before,.markdown h3>a:before{opacity:0}}.markdown h2:hover>a:before,.markdown h3:hover>a:before{opacity:1}& pre[class*=language-]{--bg-opacity:1;background-color:#2d3748;background-color:rgba(45,55,72,var(--bg-opacity));position:static}.mc{background-color:#f3f5f4;background-color:var(--bg);border-color:#158876;border-color:var(--color-primary);border-width:1px;color:#158876;color:var(--color-primary);justify-content:center;padding:5px 10px;border-radius:5px;width:100%}.mc-btn{color:#fff;color:var(--bg-secondary);background-color:#0e2233;background-color:var(--color-secondary);cursor:pointer}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}html{font-family:"Source Sans Pro",-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;font-size:16px;word-spacing:1px;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;box-sizing:border-box}*,:after,:before{box-sizing:border-box;margin:0}.button--green{display:inline-block;border-radius:4px;border:1px solid #3b8070;color:#3b8070;text-decoration:none;padding:10px 30px}.button--green:hover{color:#fff;background-color:#3b8070}.button--grey{display:inline-block;border-radius:4px;border:1px solid #35495e;color:#35495e;text-decoration:none;padding:10px 30px;margin-left:15px}.button--grey:hover{color:#fff;background-color:#35495e}span[data-v-32244446]{position:absolute;left:50%;transform:translateX(-50%);text-align:center;top:2px}</style><link rel="preload" href="/_nuxt/static/1606696780/2018/02/09/a-sample-django-news-app.html/state.js" as="script"><link rel="preload" href="/_nuxt/static/1606696780/2018/02/09/a-sample-django-news-app.html/payload.js" as="script">
  </head>
  <body>
    <script data-n-head="ssr" data-hid="nuxt-color-mode-script" data-pbody="true">!function (){"use strict";var e=window,s=document,t=s.documentElement,n=["dark","light"],o=function(e){for(var t=e+"=",n=s.cookie.split(";"),o=0;o<n.length;o++){for(var a=n[o];" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(t))return a.substring(t.length,a.length)}return null}("nuxt-color-mode")||"system",a="system"===o?c():o;function i(e){var s=""+e+"-mode";t.classList?t.classList.add(s):t.className+=" "+s}function r(s){return e.matchMedia("(prefers-color-scheme"+s+")")}function c(){if(e.matchMedia&&"not all"!==r("").media)for(var s of n)if(r(":"+s).matches)return s;return"light"}i(a),e["__NUXT_COLOR_MODE__"]={preference:o,value:a,getColorScheme:c,addClass:i,removeClass:function(e){var s=""+e+"-mode";t.classList?t.classList.remove(s):t.className=t.className.replace(new RegExp(s,"g"),"")}}}();
</script><div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><div class="mx-auto grid grid-cols-3 py-2 px-2 sm:px-4 items-center max-w-6xl" data-v-6ffa713e><div class="justify-left" data-v-6ffa713e><a href="/" class="text-xl nuxt-link-active" data-v-6ffa713e><span class="hidden sm:inline" data-v-6ffa713e>Brian Caffey</span><span class="inline sm:hidden" data-v-6ffa713e>JBC</span></a></div> <div class="justify-center" data-v-6ffa713e><div class="grid items-center justify-center" data-v-6ffa713e><ul class="flex px-4"><li class="md:px-4 px-1 cursor-pointer">
      🖥️
    </li><li class="md:px-4 px-1 cursor-pointer">
      🌞
    </li><li class="md:px-4 px-1 cursor-pointer">
      🌚
    </li><li class="md:px-4 px-1 cursor-pointer">
      ☕
    </li></ul></div></div> <div class="flex justify-end" data-v-6ffa713e><nav data-v-cd9cc810 data-v-6ffa713e><ul class="items-right justify-end hidden md:flex" data-v-cd9cc810><li class="px-4" data-v-cd9cc810><a href="/blog" data-v-cd9cc810>Blog</a></li> <li class="px-4" data-v-cd9cc810><a href="/projects" data-v-cd9cc810>Projects</a></li> <li class="px-4" data-v-cd9cc810><a href="/contact" data-v-cd9cc810>Contact</a></li></ul> <div class="flex justify-end md:hidden z-1000" data-v-cd9cc810><button class="flex items-center px-3 py-2 border rounded menu-icon" data-v-cd9cc810><svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="fill-current h-3 w-3" data-v-cd9cc810><title data-v-cd9cc810>Menu</title> <path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" data-v-cd9cc810></path></svg></button></div> <!----></nav></div></div> <article><!----> <div class="mx-auto max-w-5xl px-2 sm:px-4 md:px-4 lg:px-16 mt-2"><h1 class="prose text-3xl leading-9">Detailed setup of a mini Django News App project with Bootstrap, AJAX, Celery and RabbitMQ</h1> <!----> <p class="text-gray-500 mb-4">
      Last updated: February 8, 2018
    </p> <div class="markdown nuxt-content"><p>The Django project started in the news room. This article will offer detailed documentation of the setup process for a simple news application. This project was given as a takehome assignment for another Django position I am interview for. I won't focus on any production considerations as this is only a demo project that is supposed to work locally. </p>
<p>For reference, the code is on <a href="https://github.com/briancaffey/django-news-app" rel="nofollow noopener noreferrer" target="_blank">this Github repository</a>.</p>
<h2 id="requirements"><a href="#requirements" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Requirements</h2>
<p>This project included some interesting requirements that were outside of the scope of simple apps I have put together with Django. Two import ones were page caching and using celery to execute tasks asynchronously. I also set up a unit tests and functional tests and tested the core functionalities of the application. Here are some the basic requirements:</p>
<ul>
<li>Implement a news model with fields such as title, body, content, author, etc.</li>
<li>Display published posts on a page styled with Bootstrap</li>
<li>Implement and admin page that allows staff to create and publish posts</li>
<li>Cache the public facing home page</li>
<li>On the home page use jQuery to poll a URL for updates, and refresh the page if an update is found. </li>
<li>Add a button on the public facing page that when pressed launches a celery task that send an email to the site admin.</li>
</ul>
<h2 id="release-notes-and-code-snippets"><a href="#release-notes-and-code-snippets" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Release Notes and code snippets</h2>
<p>Here's a quick description of the design decisions I made for the various specifications with code snippets: </p>
<h4 id="post-model"><a href="#post-model" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Post Model</h4>
<p>For the Post model I decided to use two DateTimeFields: <code>updated</code> and <code>timestamp</code>. <code>timestamp</code> is the public-facing time that shows on each article. <code>updated</code> is changed when a publish or unpublish action is taken on a Post. </p>
<p>When a <code>POST</code> request is made to the <code>toggle_publish</code> view, three things happen:</p>
<ul>
<li>
<p>The Post's <code>published</code> field is toggled and the Post's <code>updated</code> field is set to the current time. </p>
</li>
<li>
<p>The only record in <code>LastUpdate</code> is updated. This model only contains a <code>DateTimeField</code> also called <code>updated</code>. </p>
</li>
<li>
<p>The cache is cleared, clearing any pages cached from the <code>home</code> view. </p>
</li>
</ul>
<h4 id="home-page"><a href="#home-page" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Home Page</h4>
<p>For the public facing home page, I return a list of Posts where <code>published</code> is set to <code>True</code> and also return a UNIX time epoch of the Post with the most recent <code>updated</code> field. </p>
<p><em>views.py</em></p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token decorator annotation punctuation">@cache_page</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">home</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    This is the public view that displays only published posts. 
    The view also returns a UNIX timestamp of the most recently updated post.
    This timestamp is compared with the `LastUpdate` value to determine when the page should be refreshed.
    Every 5 seconds, the `latest` timestamp is compared with the `LastUpdate` timestamp. 
    If `LastUpdate` is greater that `latest`, this implies that a Post has either been published or unpublished.
    """</span>

    posts <span class="token operator">=</span> Post<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>published<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    latest <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">if</span> posts<span class="token punctuation">:</span>
        latest <span class="token operator">=</span> Post<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>latest<span class="token punctuation">(</span><span class="token string">'updated'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>unix_time<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'posts/home.html'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'posts'</span><span class="token punctuation">:</span>posts<span class="token punctuation">,</span> <span class="token string">'latest'</span><span class="token punctuation">:</span>latest<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div>
<h4 id="ajax-poll-on-home-page"><a href="#ajax-poll-on-home-page" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>AJAX poll on home page</h4>
<p>I use an AJAX poll that returns a JSON response containing the <code>updated</code> field of <code>LastUpdate</code> as a UNIX time epoch called <code>latest</code>. I compare this UNIX time epoch with the the UNIX time epoch returned with context data in <code>home</code>. If the <code>latest</code> value is greater than the the UNIX time stamp of the most recently updated article, then the page is reloaded. At this point, the cache will have been cleared by <code>toggle_publish</code>, and the new Posts are displayed. </p>
<p><em>home.html</em> (AJAX poll)</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"working"</span><span class="token punctuation">)</span>
    <span class="token function-variable function">poll</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        $<span class="token punctuation">.</span><span class="token method function property-access">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token operator">:</span> <span class="token string">'/refresh'</span><span class="token punctuation">,</span>
        dataType<span class="token operator">:</span> <span class="token string">'json'</span><span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">'get'</span><span class="token punctuation">,</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">var</span> latest <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token property-access">latest</span><span class="token punctuation">)</span>
            <span class="token keyword">var</span> latest_local <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"#last"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">attr</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>latest <span class="token operator">></span> latest_local <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token dom variable">location</span><span class="token punctuation">.</span><span class="token method function property-access">reload</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">error</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'The refresh poll was not successful'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    pollInterval <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
</code></pre></div>
<p><em>views.py</em> (the view that the AJAX poll requests; return JSON)</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token keyword">def</span> <span class="token function">refresh</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""
    This is the URL that is polled by the public-facing page.
    It returns a UNIX timestamp of the last time an article was published or unpublished. 
    This timestamp comes from the `LastUpdated`, a table that stores and updates only one row with one datetime column.
    Publishing and unpublishing are the only two actions that clear the cached homepage. 
    When the returned UNIX timestamp is greater than the UNIX timestamp of the most recently updated article,
    The page is refreshed with `location.reload()`.
    """</span>
    
    t<span class="token punctuation">,</span> created <span class="token operator">=</span> LastUpdate<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get_or_create<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> created<span class="token punctuation">:</span>
        t<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>
        t <span class="token operator">=</span> t<span class="token punctuation">.</span>unix_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        t <span class="token operator">=</span> t<span class="token punctuation">.</span>unix_time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    latest <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span>
    <span class="token keyword">return</span> JsonResponse<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'latest'</span><span class="token punctuation">:</span><span class="token builtin">int</span><span class="token punctuation">(</span>latest<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div>
<h4 id="email-admin-through-a-celery-task"><a href="#email-admin-through-a-celery-task" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Email admin through a celery task</h4>
<p>The email feature is functional, but the button returns a JSON response that says "successful" if the message was sent to celery. My plan was to make another AJAX call and then updated the <code>Email Admin</code> link to say <code>Your email was sent.</code> if it the task was sent the messaging service. </p>
<p>For details on how celery can be set up with a Django project, I reference on of my favorite Django blogs, <a href="https://simpleisbetterthancomplex.com/tutorial/2017/08/20/how-to-use-celery-with-django.html" rel="nofollow noopener noreferrer" target="_blank">simpleisbetterthancomplex.com</a>. This article shows how to set up celery in a Django project and my set up almost exactly mirrors this setup, but my celery task simply sends an email.</p>
<h4 id="admin-page"><a href="#admin-page" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Admin Page</h4>
<p>The admin page contains a list of all articles. Each article contains a link to manage publish settings. This calls the <code>toggle_publish</code> page that displays the selected article and contains a button that says <code>Publish</code> or <code>Unpublish</code> depending on the value of the Post's <code>published</code> value. </p>
<h4 id="cache"><a href="#cache" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Cache</h4>
<p>For caching I chose the memcached backend. Other options included using file caching and database caching, but this seemed to be the simplest approach. I used a decorator function to cache the results of the <code>home</code> view. </p>
<p>Here are some additional notes on how I used caching in this project:</p>
<ul>
<li>To cache a page from the <code>home</code> view, I used a decorator: <code>from django.views.decorators.cache import cache_page</code>:</li>
</ul>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token decorator annotation punctuation">@cache_page</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">home</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span>
</code></pre></div>
<ul>
<li>
<p>We pass the argument of <code>None</code> so that the page cache does not expire; we will manually clear the cache when a staff member publishes an article. </p>
</li>
<li>
<p>The first time we access the <code>home</code> view, we will see our print statement, in subsequent requests, the cached page will be used and we will not see the print statement. </p>
</li>
</ul>
<p>In order for caching to work we need to add the following to <code>settings.py</code>:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code>CACHES <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string">'default'</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        <span class="token string">'BACKEND'</span><span class="token punctuation">:</span> <span class="token string">'django.core.cache.backends.memcached.MemcachedCache'</span><span class="token punctuation">,</span>
        <span class="token string">'LOCATION'</span><span class="token punctuation">:</span> <span class="token string">'127.0.0.1:11211'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>Next, we need to install the following packages:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-text"><code>(virtualenv) $ pip install memcache 
# pacman -S memcached
# systemctl start memcached
# systemctl enable memcached
</code></pre></div>
<h5 id="clearing-the-cache"><a href="#clearing-the-cache" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Clearing the cache</h5>
<p>To clear the cache, we can simply do the following in a view: </p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>core<span class="token punctuation">.</span>cache <span class="token keyword">import</span> cache

<span class="token decorator annotation punctuation">@login_required</span>
<span class="token keyword">def</span> <span class="token function">toggle_publish</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span><span class="token builtin">id</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    instance <span class="token operator">=</span> get_object_or_404<span class="token punctuation">(</span>Post<span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token operator">=</span><span class="token builtin">id</span><span class="token punctuation">)</span>

    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method<span class="token operator">==</span><span class="token string">"POST"</span><span class="token punctuation">:</span>
        instance<span class="token punctuation">.</span>published <span class="token operator">=</span> <span class="token keyword">not</span> instance<span class="token punctuation">.</span>published
        instance<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        t <span class="token operator">=</span> LastUpdate<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span>
        t<span class="token punctuation">.</span>updated <span class="token operator">=</span> instance<span class="token punctuation">.</span>updated
        t<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span>

        cache<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'posts:home'</span><span class="token punctuation">)</span>

    context <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'post'</span><span class="token punctuation">:</span>instance<span class="token punctuation">}</span>

    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'posts/publish.html'</span><span class="token punctuation">,</span> context<span class="token punctuation">)</span>
</code></pre></div>
<p><code>cache.clear()</code> clears the cache, and the <code>home</code> view is regenerated from the Queryset and template rather the being served directly from the cache. This newly generated page is then saved to the cache and used on subsequent calls to <code>home</code> until the cache is cleared again. </p>
<h2 id="basic-setup"><a href="#basic-setup" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Basic setup</h2>
<p>Here are the first steps need to set up the project correctly:</p>
<p>First, let's start with creating a virtual environment: </p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-text"><code>$ virtualenv -p python3 virtualenv
</code></pre></div>
<p>Next, let's activate the virtual environment with: </p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-text"><code>$ source virtualenv/bin/activate
</code></pre></div>
<p>Next, let's install <code>django</code> and <code>selenium</code>: </p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-text"><code>(virtualenv) $ pip install django selenium
</code></pre></div>
<p>Next, let's start our app:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-text"><code>(virtualenv) $ django-admin.py startproject news .
</code></pre></div>
<p>The <code>.</code> will start the project in the current environment. Let's take a look at the directory structure: </p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-text"><code>(virtualenv) $ tree -L 2
 $ tree -L 2
.
├── manage.py
├── news
│   ├── __init__.py
│   ├── settings.py
│   ├── urls.py
│   └── wsgi.py
└── virtualenv
    ├── bin
    ├── include
    ├── lib
    ├── pip-selfcheck.json
    └── selenium
</code></pre></div>
<p>At this point, we can start the local server: </p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-text"><code>(virtualenv) $ python manage.py runserver
Performing system checks...

System check identified no issues (0 silenced).

You have 14 unapplied migration(s). Your project may not work properly until you apply the migrations for app(s): admin, auth, contenttypes, sessions.
Run 'python manage.py migrate' to apply them.

February 10, 2018 - 02:16:47
Django version 2.0.2, using settings 'news.settings'
Starting development server at http://127.0.0.1:8000/
Quit the server with CONTROL-C.
</code></pre></div>
<p>Now we should see the new Django 2 startup screen in our browser if we navigate to <a href="">http://127.0.0.1:8000/</a>:</p>
<p><img alt="png" src="/static/news/django2.png"></p>
<h2 id="testing"><a href="#testing" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Testing</h2>
<p>I had a few difficulties setting up selenium testing with this projects. Here the <code>functional_tests.py</code> file that is hopefully configured correctly:</p>
<p><strong>functional_tests.py</strong></p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver
<span class="token keyword">from</span> django<span class="token punctuation">.</span>conf <span class="token keyword">import</span> settings

<span class="token keyword">import</span> os
os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>setdefault<span class="token punctuation">(</span><span class="token string">'DJANGO_SETTINGS_MODULE'</span><span class="token punctuation">,</span> <span class="token string">'news.settings'</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> django<span class="token punctuation">.</span>test <span class="token keyword">import</span> LiveServerTestCase
<span class="token keyword">import</span> unittest
<span class="token keyword">import</span> time
<span class="token keyword">import</span> factory

<span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth <span class="token keyword">import</span> get_user_model
<span class="token keyword">from</span> selenium <span class="token keyword">import</span> webdriver

User <span class="token operator">=</span> get_user_model<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">UserFactory</span><span class="token punctuation">(</span>factory<span class="token punctuation">.</span>DjangoModelFactory<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""This class sets up a staff user that we can use for testing using factory"""</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> User

    email <span class="token operator">=</span> <span class="token string">'brian@djangonews.com'</span>
    username <span class="token operator">=</span> <span class="token string">'brian1'</span>
    password <span class="token operator">=</span> factory<span class="token punctuation">.</span>PostGenerationMethodCall<span class="token punctuation">(</span><span class="token string">'set_password'</span><span class="token punctuation">,</span> <span class="token string">'qwer1234'</span><span class="token punctuation">)</span>

    is_superuser <span class="token operator">=</span> <span class="token boolean">True</span>
    is_staff <span class="token operator">=</span> <span class="token boolean">True</span>
    is_active <span class="token operator">=</span> <span class="token boolean">True</span>

<span class="token keyword">class</span> <span class="token class-name">NewsAppTest</span><span class="token punctuation">(</span>LiveServerTestCase<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Main Tests"""</span>

    <span class="token keyword">def</span> <span class="token function">setUp</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>browser <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>domain <span class="token operator">=</span> <span class="token string">'http://127.0.0.1:8081'</span>
        self<span class="token punctuation">.</span>user <span class="token operator">=</span> UserFactory<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">tearDown</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">test_page_title_is_correct</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>domain<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'Django News'</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>title<span class="token punctuation">)</span>


    <span class="token keyword">def</span> <span class="token function">test_staff_can_create_and_publish_article</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token triple-quoted-string string">"""
        Tests the core functionality of a staff member loging in, creating an article, then publishing that article
        """</span>

        <span class="token comment"># staff logs into admin page</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>domain<span class="token operator">+</span><span class="token string">"/admin"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'id_username'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'brian1'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'id_password'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'qwer1234'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>find_element_by_class_name<span class="token punctuation">(</span><span class="token string">'submit-row'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>

        <span class="token comment"># navigate to homepage</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>domain<span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

        <span class="token comment"># navigate to new article page and write sample article</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'new-article'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        html <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>page_source<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'Write your Django News article here'</span><span class="token punctuation">,</span> html<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'id_title'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'testing with selenium'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'id_content'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>send_keys<span class="token punctuation">(</span><span class="token string">'about testing with selenium'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'id_submit'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        html <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>page_source<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'publish settings'</span><span class="token punctuation">,</span> html<span class="token punctuation">)</span>

        <span class="token comment"># go back to home page and check that the article is not displayed</span>
        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>domain<span class="token punctuation">)</span>
        html <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>page_source<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertNotIn<span class="token punctuation">(</span><span class="token string">'testing with selenium'</span><span class="token punctuation">,</span> html<span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>back<span class="token punctuation">(</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>find_element_by_id<span class="token punctuation">(</span><span class="token string">'toggle-publish'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>click<span class="token punctuation">(</span><span class="token punctuation">)</span>
        html <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>browser<span class="token punctuation">.</span>page_source<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>assertIn<span class="token punctuation">(</span><span class="token string">'testing with selenium'</span><span class="token punctuation">,</span> html<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">test_public_page_reloads_when_article_is_published</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        browser2 <span class="token operator">=</span> webdriver<span class="token punctuation">.</span>Firefox<span class="token punctuation">(</span><span class="token punctuation">)</span>
        browser2<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>domain<span class="token punctuation">)</span>
        html <span class="token operator">=</span> browser2<span class="token punctuation">.</span>page_source
        self<span class="token punctuation">.</span>test_staff_can_create_and_publish_article<span class="token punctuation">(</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
        browser2<span class="token punctuation">.</span>get<span class="token punctuation">(</span>self<span class="token punctuation">.</span>domain<span class="token punctuation">)</span>
        html_after_publish <span class="token operator">=</span> browser2<span class="token punctuation">.</span>page_source
        self<span class="token punctuation">.</span>assertNotEqual<span class="token punctuation">(</span>html<span class="token punctuation">,</span> html_after_publish<span class="token punctuation">)</span>
        browser2<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    unittest<span class="token punctuation">.</span>main<span class="token punctuation">(</span>warnings<span class="token operator">=</span><span class="token string">"ignore"</span><span class="token punctuation">)</span>
</code></pre></div>
<p>I used the package called <code>factory_boy</code> to setup create a user that I could use in my test. This project didn't include a staff registration page, so to test regular staff functionality I used <code>factory</code> to create a dummy user that can login and perform tasks. </p>
<p>For the full repo, please find it on my github account: <a href="https://github.com/briancaffey/django-news-app" rel="nofollow noopener noreferrer" target="_blank">https://github.com/briancaffey/django-news-app</a>.</p></div> <div class="fixed bg-white shadow left-0 bottom-0 rounded-full p-4 m-4 cursor-pointer h-2 w-2" data-v-32244446><span class="text-black" data-v-32244446> 🗣 </span></div> <div class="text-center pb-4 pt-8"><button class="mc-btn rounded py-1 px-2">
        Show Disqus Comments 💬
      </button></div> <!----> <h1></h1></div></article> <div class="mx-auto max-w-6xl p-4 lg:px-16 text-center" data-v-7ecc4f2b><hr class="mt-4" data-v-7ecc4f2b> <div class="mx-auto py-4" data-v-7ecc4f2b><div class="pb-4" data-v-7ecc4f2b>
      Join my mailing list to get updated whenever I publish a new article.
    </div> <div class="mx-auto" data-v-589e4264 data-v-7ecc4f2b><div id="mc_embed_signup" class="mx-auto w-full md:w-1/2" data-v-589e4264><form id="mc-embedded-subscribe-form" action="https://github.us2.list-manage.com/subscribe/post?u=43a795784ca963e25903a0da6&id=9937fe4fc5" method="post" name="mc-embedded-subscribe-form" target="_blank" novalidate class="validate" data-v-589e4264><div id="mc_embed_signup_scroll" class="grid grid-cols-1 sm:grid-cols-2 gap-4 items-center" data-v-589e4264><input id="mce-EMAIL" type="email" name="EMAIL" placeholder="Enter your email address" class="rounded mc text-center" data-v-589e4264> <div aria-hidden="true" style="position:absolute;left:-5000px" data-v-589e4264><input name="b_43a795784ca963e25903a0da6_9937fe4fc5" tabindex="-1" data-v-589e4264></div> <div data-v-589e4264><input id="mc-embedded-subscribe" type="submit" value="Subscribe" name="subscribe" class="mc-btn rounded px-2 py-1 w-full" data-v-589e4264></div></div></form></div></div></div> <hr data-v-7ecc4f2b> <div class="py-4" data-v-7ecc4f2b>Thanks for checking out my site!</div> <div class="pb-4" data-v-7ecc4f2b>© 2020 Brian Caffey</div></div></div></div></div><script defer src="/_nuxt/static/1606696780/2018/02/09/a-sample-django-news-app.html/state.js"></script><script src="/_nuxt/e60f785.js" defer></script><script src="/_nuxt/a3433a8.js" defer></script><script src="/_nuxt/5025c59.js" defer></script><script src="/_nuxt/88085e0.js" defer></script><script src="/_nuxt/e0416f5.js" defer></script>
  </body>
</html>
