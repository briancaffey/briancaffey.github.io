[{"data":1,"prerenderedAt":608},["ShallowReactive",2],{"getting-started-with-twisted":3},{"id":4,"title":5,"body":6,"comments":173,"date":596,"description":40,"draft":597,"extension":598,"external":599,"image":16,"meta":600,"navigation":173,"path":602,"seo":603,"stem":604,"tags":605,"__hash__":607},"blog/2017/12/22/getting-started-with-twisted.md","Getting started with Python's Twisted Framework",{"type":7,"value":8,"toc":592},"minimark",[9,17,25,30,41,44,49,53,56,135,146,150,462,466,588],[10,11,12],"p",{},[13,14],"img",{"alt":15,"src":16},"png","/static/twisted-snakes.png",[10,18,19,20,24],{},"In this article I'm going to be exploring python's twisted framework. I'm working through the ",[21,22,23],"em",{},"Twisted Network Programming Essentials"," book from O'Reilly.",[26,27,29],"h2",{"id":28},"installation","Installation",[31,32,37],"pre",{"className":33,"code":35,"language":36},[34],"language-text"," $ pip install twisted\n","text",[38,39,35],"code",{"__ignoreMap":40},"",[10,42,43],{},"The main idea behind Twisted is that it gives us the parallelism of multithreading programming with the ease of reasoning of single threaded programming.",[10,45,46],{},[13,47],{"alt":15,"src":48},"/static/event-driven.jpg",[26,50,52],{"id":51},"the-reactor","The Reactor",[10,54,55],{},"This is the core of Twisted. Here is a simple explanation of what the reactor does with psuedo-code:",[31,57,61],{"className":58,"code":59,"language":60,"meta":40,"style":40},"language-python shiki shiki-themes github-light github-dark monokai","while True:\n    timeout = timeout_until_next_timed_event()\n    events = wait_for_events(timeout)\n    events += timed_events_until(now())\n    for event in events:\n        event.process()\n","python",[38,62,63,80,92,103,114,129],{"__ignoreMap":40},[64,65,68,72,76],"span",{"class":66,"line":67},"line",1,[64,69,71],{"class":70},"sC2Qs","while",[64,73,75],{"class":74},"s7F3e"," True",[64,77,79],{"class":78},"sMOD_",":\n",[64,81,83,86,89],{"class":66,"line":82},2,[64,84,85],{"class":78},"    timeout ",[64,87,88],{"class":70},"=",[64,90,91],{"class":78}," timeout_until_next_timed_event()\n",[64,93,95,98,100],{"class":66,"line":94},3,[64,96,97],{"class":78},"    events ",[64,99,88],{"class":70},[64,101,102],{"class":78}," wait_for_events(timeout)\n",[64,104,106,108,111],{"class":66,"line":105},4,[64,107,97],{"class":78},[64,109,110],{"class":70},"+=",[64,112,113],{"class":78}," timed_events_until(now())\n",[64,115,117,120,123,126],{"class":66,"line":116},5,[64,118,119],{"class":70},"    for",[64,121,122],{"class":78}," event ",[64,124,125],{"class":70},"in",[64,127,128],{"class":78}," events:\n",[64,130,132],{"class":66,"line":131},6,[64,133,134],{"class":78},"        event.process()\n",[10,136,137,138,141,142,145],{},"Here's a simple echo server/client example that illustrates how the reactor works. It is composed of ",[38,139,140],{},"echoclient.py"," and ",[38,143,144],{},"echoserver.py",":",[10,147,148],{},[21,149,140],{},[31,151,153],{"className":58,"code":152,"language":60,"meta":40,"style":40},"from twisted.internet import reactor, protocol\n\nclass EchoClient(protocol.Protocol):\n    def connectionMade(self):\n        self.transport.write(u\"Hello, world!\".encode('utf-8'))\n\n    def dataReceived(self, data):\n        print(\"Server said:\", data)\n        self.transport.loseConnection()\n\nclass EchoFactory(protocol.ClientFactory):\n    def buildProtocol(self, addr):\n        return EchoClient()\n\n    def clientConnectionFailed(self, connector, reason):\n        print(\"Connection failed.\")\n        reactor.stop()\n\n    def clientConnectionLost(self, connector, reason):\n        print(\"Connection lost.\")\n        reactor.stop()\n\nreactor.connectTCP(\"localhost\", 8000, EchoFactory())\nreactor.run()\n",[38,154,155,169,175,201,218,243,247,267,282,290,295,314,333,342,347,371,384,390,395,417,429,434,439,456],{"__ignoreMap":40},[64,156,157,160,163,166],{"class":66,"line":67},[64,158,159],{"class":70},"from",[64,161,162],{"class":78}," twisted.internet ",[64,164,165],{"class":70},"import",[64,167,168],{"class":78}," reactor, protocol\n",[64,170,171],{"class":66,"line":82},[64,172,174],{"emptyLinePlaceholder":173},true,"\n",[64,176,177,181,185,188,192,195,198],{"class":66,"line":94},[64,178,180],{"class":179},"sq6CD","class",[64,182,184],{"class":183},"sz2Vg"," EchoClient",[64,186,187],{"class":78},"(",[64,189,191],{"class":190},"s30JN","protocol",[64,193,194],{"class":78},".",[64,196,197],{"class":190},"Protocol",[64,199,200],{"class":78},"):\n",[64,202,203,206,210,212,216],{"class":66,"line":105},[64,204,205],{"class":179},"    def",[64,207,209],{"class":208},"srTi1"," connectionMade",[64,211,187],{"class":78},[64,213,215],{"class":214},"so59x","self",[64,217,200],{"class":78},[64,219,220,224,227,230,234,237,240],{"class":66,"line":116},[64,221,223],{"class":222},"sP7S_","        self",[64,225,226],{"class":78},".transport.write(",[64,228,229],{"class":179},"u",[64,231,233],{"class":232},"sstjo","\"Hello, world!\"",[64,235,236],{"class":78},".encode(",[64,238,239],{"class":232},"'utf-8'",[64,241,242],{"class":78},"))\n",[64,244,245],{"class":66,"line":131},[64,246,174],{"emptyLinePlaceholder":173},[64,248,250,252,255,257,259,262,265],{"class":66,"line":249},7,[64,251,205],{"class":179},[64,253,254],{"class":208}," dataReceived",[64,256,187],{"class":78},[64,258,215],{"class":214},[64,260,261],{"class":78},", ",[64,263,264],{"class":214},"data",[64,266,200],{"class":78},[64,268,270,274,276,279],{"class":66,"line":269},8,[64,271,273],{"class":272},"sTrkL","        print",[64,275,187],{"class":78},[64,277,278],{"class":232},"\"Server said:\"",[64,280,281],{"class":78},", data)\n",[64,283,285,287],{"class":66,"line":284},9,[64,286,223],{"class":222},[64,288,289],{"class":78},".transport.loseConnection()\n",[64,291,293],{"class":66,"line":292},10,[64,294,174],{"emptyLinePlaceholder":173},[64,296,298,300,303,305,307,309,312],{"class":66,"line":297},11,[64,299,180],{"class":179},[64,301,302],{"class":183}," EchoFactory",[64,304,187],{"class":78},[64,306,191],{"class":190},[64,308,194],{"class":78},[64,310,311],{"class":190},"ClientFactory",[64,313,200],{"class":78},[64,315,317,319,322,324,326,328,331],{"class":66,"line":316},12,[64,318,205],{"class":179},[64,320,321],{"class":208}," buildProtocol",[64,323,187],{"class":78},[64,325,215],{"class":214},[64,327,261],{"class":78},[64,329,330],{"class":214},"addr",[64,332,200],{"class":78},[64,334,336,339],{"class":66,"line":335},13,[64,337,338],{"class":70},"        return",[64,340,341],{"class":78}," EchoClient()\n",[64,343,345],{"class":66,"line":344},14,[64,346,174],{"emptyLinePlaceholder":173},[64,348,350,352,355,357,359,361,364,366,369],{"class":66,"line":349},15,[64,351,205],{"class":179},[64,353,354],{"class":208}," clientConnectionFailed",[64,356,187],{"class":78},[64,358,215],{"class":214},[64,360,261],{"class":78},[64,362,363],{"class":214},"connector",[64,365,261],{"class":78},[64,367,368],{"class":214},"reason",[64,370,200],{"class":78},[64,372,374,376,378,381],{"class":66,"line":373},16,[64,375,273],{"class":272},[64,377,187],{"class":78},[64,379,380],{"class":232},"\"Connection failed.\"",[64,382,383],{"class":78},")\n",[64,385,387],{"class":66,"line":386},17,[64,388,389],{"class":78},"        reactor.stop()\n",[64,391,393],{"class":66,"line":392},18,[64,394,174],{"emptyLinePlaceholder":173},[64,396,398,400,403,405,407,409,411,413,415],{"class":66,"line":397},19,[64,399,205],{"class":179},[64,401,402],{"class":208}," clientConnectionLost",[64,404,187],{"class":78},[64,406,215],{"class":214},[64,408,261],{"class":78},[64,410,363],{"class":214},[64,412,261],{"class":78},[64,414,368],{"class":214},[64,416,200],{"class":78},[64,418,420,422,424,427],{"class":66,"line":419},20,[64,421,273],{"class":272},[64,423,187],{"class":78},[64,425,426],{"class":232},"\"Connection lost.\"",[64,428,383],{"class":78},[64,430,432],{"class":66,"line":431},21,[64,433,389],{"class":78},[64,435,437],{"class":66,"line":436},22,[64,438,174],{"emptyLinePlaceholder":173},[64,440,442,445,448,450,453],{"class":66,"line":441},23,[64,443,444],{"class":78},"reactor.connectTCP(",[64,446,447],{"class":232},"\"localhost\"",[64,449,261],{"class":78},[64,451,452],{"class":74},"8000",[64,454,455],{"class":78},", EchoFactory())\n",[64,457,459],{"class":66,"line":458},24,[64,460,461],{"class":78},"reactor.run()\n",[10,463,464],{},[21,465,144],{},[31,467,469],{"className":58,"code":468,"language":60,"meta":40,"style":40},"from twisted.internet import protocol, reactor\n\nclass Echo(protocol.Protocol):\n    def dataReceived(self,data):\n        self.transport.write(data)\n\nclass EchoFactory(protocol.Factory):\n    def buildProtocol(self, addr):\n        return Echo()\n\nreactor.listenTCP(8000, EchoFactory())\nreactor.run()\n",[38,470,471,482,486,503,520,527,531,548,564,571,575,584],{"__ignoreMap":40},[64,472,473,475,477,479],{"class":66,"line":67},[64,474,159],{"class":70},[64,476,162],{"class":78},[64,478,165],{"class":70},[64,480,481],{"class":78}," protocol, reactor\n",[64,483,484],{"class":66,"line":82},[64,485,174],{"emptyLinePlaceholder":173},[64,487,488,490,493,495,497,499,501],{"class":66,"line":94},[64,489,180],{"class":179},[64,491,492],{"class":183}," Echo",[64,494,187],{"class":78},[64,496,191],{"class":190},[64,498,194],{"class":78},[64,500,197],{"class":190},[64,502,200],{"class":78},[64,504,505,507,509,511,513,516,518],{"class":66,"line":105},[64,506,205],{"class":179},[64,508,254],{"class":208},[64,510,187],{"class":78},[64,512,215],{"class":214},[64,514,515],{"class":78},",",[64,517,264],{"class":214},[64,519,200],{"class":78},[64,521,522,524],{"class":66,"line":116},[64,523,223],{"class":222},[64,525,526],{"class":78},".transport.write(data)\n",[64,528,529],{"class":66,"line":131},[64,530,174],{"emptyLinePlaceholder":173},[64,532,533,535,537,539,541,543,546],{"class":66,"line":249},[64,534,180],{"class":179},[64,536,302],{"class":183},[64,538,187],{"class":78},[64,540,191],{"class":190},[64,542,194],{"class":78},[64,544,545],{"class":190},"Factory",[64,547,200],{"class":78},[64,549,550,552,554,556,558,560,562],{"class":66,"line":269},[64,551,205],{"class":179},[64,553,321],{"class":208},[64,555,187],{"class":78},[64,557,215],{"class":214},[64,559,261],{"class":78},[64,561,330],{"class":214},[64,563,200],{"class":78},[64,565,566,568],{"class":66,"line":284},[64,567,338],{"class":70},[64,569,570],{"class":78}," Echo()\n",[64,572,573],{"class":66,"line":292},[64,574,174],{"emptyLinePlaceholder":173},[64,576,577,580,582],{"class":66,"line":297},[64,578,579],{"class":78},"reactor.listenTCP(",[64,581,452],{"class":74},[64,583,455],{"class":78},[64,585,586],{"class":66,"line":316},[64,587,461],{"class":78},[589,590,591],"style",{},"html pre.shiki code .sC2Qs, html code.shiki .sC2Qs{--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672}html pre.shiki code .s7F3e, html code.shiki .s7F3e{--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF}html pre.shiki code .sMOD_, html code.shiki .sMOD_{--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html pre.shiki code .sq6CD, html code.shiki .sq6CD{--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic}html pre.shiki code .sz2Vg, html code.shiki .sz2Vg{--shiki-default:#6F42C1;--shiki-default-text-decoration:inherit;--shiki-dark:#B392F0;--shiki-dark-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-text-decoration:underline}html pre.shiki code .s30JN, html code.shiki .s30JN{--shiki-default:#6F42C1;--shiki-default-font-style:inherit;--shiki-default-text-decoration:inherit;--shiki-dark:#B392F0;--shiki-dark-font-style:inherit;--shiki-dark-text-decoration:inherit;--shiki-sepia:#A6E22E;--shiki-sepia-font-style:italic;--shiki-sepia-text-decoration:underline}html pre.shiki code .srTi1, html code.shiki .srTi1{--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E}html pre.shiki code .so59x, html code.shiki .so59x{--shiki-default:#24292E;--shiki-default-font-style:inherit;--shiki-dark:#E1E4E8;--shiki-dark-font-style:inherit;--shiki-sepia:#FD971F;--shiki-sepia-font-style:italic}html pre.shiki code .sP7S_, html code.shiki .sP7S_{--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#FD971F}html pre.shiki code .sstjo, html code.shiki .sstjo{--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74}html pre.shiki code .sTrkL, html code.shiki .sTrkL{--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF}",{"title":40,"searchDepth":82,"depth":82,"links":593},[594,595],{"id":28,"depth":82,"text":29},{"id":51,"depth":82,"text":52},"2017-12-22",false,"md",null,{"layout":601},"post","/2017/12/22/getting-started-with-twisted",{"title":5,"description":40},"2017/12/22/getting-started-with-twisted",[60,606],"twisted","JG_5bk_P-i8CdoImJJNqgaeqoJzjDkvczXhIGhTPUac",1757465219767]