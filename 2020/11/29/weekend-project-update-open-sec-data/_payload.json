[{"data":1,"prerenderedAt":434},["ShallowReactive",2],{"weekend-project-update-open-sec-data":3,"content-query-F52ftM5lAz":257},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"date":10,"image":11,"tags":12,"body":20,"_type":251,"_id":252,"_source":253,"_file":254,"_stem":255,"_extension":256},"/2020/11/29/weekend-project-update-open-sec-data","29",false,"","Weekend project update: Open SEC Data","This project uses Django, DRF and Celery to read public SEC filings from sec.gov, build it into an API which is consumed through a Vue.js application.","2020-11-29T00:00:00.000Z","/static/sec-update.jpg",[13,14,15,16,17,18,19],"django","vue","data","api","gitlab","docker","celery",{"type":21,"children":22,"toc":248},"root",[23,31,71,85,90,176,181],{"type":24,"tag":25,"props":26,"children":27},"element","p",{},[28],{"type":29,"value":30},"text","Here's an early look at a project I have been working on to practice some Django and Vue.js concepts: Open SEC Data.",{"type":24,"tag":32,"props":33,"children":34},"ul",{},[35,49,60],{"type":24,"tag":36,"props":37,"children":38},"li",{},[39,47],{"type":24,"tag":40,"props":41,"children":45},"a",{"href":42,"rel":43},"https://opensecdata.ga",[44],"nofollow",[46],{"type":29,"value":42},{"type":29,"value":48}," (project staging website, deployed to docker swarm cluster running on DigitalOcean)",{"type":24,"tag":36,"props":50,"children":51},{},[52,58],{"type":24,"tag":40,"props":53,"children":56},{"href":54,"rel":55},"https://gitlab.com/briancaffey/sec-filings-app",[44],[57],{"type":29,"value":54},{"type":29,"value":59}," (main repository, requires GitLab account)",{"type":24,"tag":36,"props":61,"children":62},{},[63,69],{"type":24,"tag":40,"props":64,"children":67},{"href":65,"rel":66},"https://github.com/briancaffey/sec-filings-app",[44],[68],{"type":29,"value":65},{"type":29,"value":70}," (mirror, no account required to view)",{"type":24,"tag":25,"props":72,"children":73},{},[74,76,83],{"type":29,"value":75},"This project uses Django, DRF and Celery to read public SEC filings from ",{"type":24,"tag":40,"props":77,"children":80},{"href":78,"rel":79},"https://www.sec.gov/Archives/edgar/full-index/",[44],[81],{"type":29,"value":82},"sec.gov",{"type":29,"value":84},", build it into an API which is consumed through a Vue.js application. I'm currently focused on 13F filings which are required for large US investment funds managing over $100 million USD. There is data dating back to 1993 and it is published quarterly.",{"type":24,"tag":25,"props":86,"children":87},{},[88],{"type":29,"value":89},"Here are some of the things I'm focusing on in this project in no particular order:",{"type":24,"tag":32,"props":91,"children":92},{},[93,98,103,108,113,118,123,145,166,171],{"type":24,"tag":36,"props":94,"children":95},{},[96],{"type":29,"value":97},"Getting better at Django REST Framework. This project has been helping me apply some of the parts of DRF that I have found difficult. I'm currently using ViewSets which feels function-based views inside of class-based views. They are flexible, but I would like to add more abstraction with filtering",{"type":24,"tag":36,"props":99,"children":100},{},[101],{"type":29,"value":102},"Django admin. While this project primarily uses Django as a REST API with Django REST Framework, I have tried to take advantage of the Django admin to build out helpful views that can be used to spot check the data I'm creating. Most of my API is read-only, this makes things pretty simple.",{"type":24,"tag":36,"props":104,"children":105},{},[106],{"type":29,"value":107},"Moderately complex paginated data tables with Vue. I work with lots of paginated table data, and I think there is a better way to do abstract some of the repeated logic that I use (getting and setting current page, rows per page). I'm using Vuex, and I have heard of module factories, but I'm thinking that there will be a better way to do this when Vue 3 officially comes to Quasar Framework (Quasar is a Vue.js framework).",{"type":24,"tag":36,"props":109,"children":110},{},[111],{"type":29,"value":112},"Session authentication with DRF. There are a lot of guides showing how to use JWT and Token Authentication for DRF with Javascript frontends. The DRF recommends using Session Authentication for such use cases as a web-base Javascript client, so I hope I can promote some best practices around how to use Django's built-in session authentication for use with the Django REST Framework using an HttpOnly session cookie. I also understand that all security decisions have trade-offs, and I'm trying to understand what trade-offs come with handling authentication in this way.",{"type":24,"tag":36,"props":114,"children":115},{},[116],{"type":29,"value":117},"Social authentication. I have previously setup social authentication with Google, Facebook and GitHub using Python Social Auth. I think it is a great package, and it adds a lot of flexibility with it's concept of pipelines, but I haven't done much with these yet, so I'm hoping to dig in further and better understand how I can make better use of social authentication in my app. This app uses Linkedin 0Auth2 with a custom user model. Logging in with Linkedin account gives you the ability to request an API Token (Django REST Framework's Token) to access the public API.",{"type":24,"tag":36,"props":119,"children":120},{},[121],{"type":29,"value":122},"Automatic API documentation with OpenAPI. Swagger/OpenAPI seems like nice way to document and API, so I'm hoping to build best practices around how to document a DRF API automatically with OpenAPI and Swagger UI.",{"type":24,"tag":36,"props":124,"children":125},{},[126,128,135,137,143],{"type":29,"value":127},"CI/CD with GitLab and docker swarm. I will admit that I am huge GitLab fan. I love how flexible their CI/CD pipelines are. Being a docker fan as well, I chose to use docker swarm for this project to keep things simple and straightforward. I think one under-appreciate feature of docker is being able to set ",{"type":24,"tag":129,"props":130,"children":132},"code",{"className":131},[],[133],{"type":29,"value":134},"DOCKER_HOST",{"type":29,"value":136}," to an SSH connection, such as ",{"type":24,"tag":129,"props":138,"children":140},{"className":139},[],[141],{"type":29,"value":142},"ssh://root@123.456.789.10",{"type":29,"value":144},". This let's you control the remote docker host without needing to SSH to it first, and it is also how I'm able to deploy and run management commands \"manually\" through the GitLab UI.",{"type":24,"tag":36,"props":146,"children":147},{},[148,150,156,158,164],{"type":29,"value":149},"Productive development environment. To start the project, you only need to run docker-compose up (after copying ",{"type":24,"tag":129,"props":151,"children":153},{"className":152},[],[154],{"type":29,"value":155},".env.template",{"type":29,"value":157}," to ",{"type":24,"tag":129,"props":159,"children":161},{"className":160},[],[162],{"type":29,"value":163},".env",{"type":29,"value":165}," in the root directory for storing sensitive data outside of git such as LinkedIn OAuth2 keys). The development environment is very similar to how this project runs in production with some additional utilities for monitoring and debugging such as pgadmin4, flower (for celery), redis commander (a GUI for viewing redis databases), Django debug toolbar (a must have for any Django project, I believe), runserver_plus with Werkzeug, and others. Also, the backend and frontend hot reload automatically with the help of webpack for Vue and watchdog for Django and Celery.",{"type":24,"tag":36,"props":167,"children":168},{},[169],{"type":29,"value":170},"Automatic TLS certificate generation with Traefik. For a simple project in docker swarm, I'm really happy with how simple it is to request TLS certificates from Let's Encrypt automatically with Traefik. There are no scripts, cron jobs or one-time setup jobs, it just seems to work out of the box if configured correctly.",{"type":24,"tag":36,"props":172,"children":173},{},[174],{"type":29,"value":175},"Testing with pytest. I have only been trying to test most of my API views so far. I really like using factory with pytest, so I use that in most of my tests.",{"type":24,"tag":25,"props":177,"children":178},{},[179],{"type":29,"value":180},"That's all I have for now. I have a long list of questions, things I want to improve, add and experiment with, here are just a few that come to mind:",{"type":24,"tag":32,"props":182,"children":183},{},[184,189,194,208,213,218,223,228],{"type":24,"tag":36,"props":185,"children":186},{},[187],{"type":29,"value":188},"Frontend testing. I don't have any component testing or e2d tests, so this would be good to add eventually. Since I'm using a component library and my app uses these components directly, I'm not exactly sure how much testing I should be doing.",{"type":24,"tag":36,"props":190,"children":191},{},[192],{"type":29,"value":193},"Data verification/validation. There are a lot of site that do provide similar data, WhaleWisdom is the biggest one that I know of. Once I get more data built on the site it would be good to spot check some of the values. There are some nuances to the filing data that I haven't addressed, such as Amendment filings and additions.",{"type":24,"tag":36,"props":195,"children":196},{},[197,199,206],{"type":29,"value":198},"Calculating period changes. One of the features that I'm not sure how best to implement is the ability to sort holdings for a filer in a given period on the percent increase from the last period. One way would be to add these as additional fields to the Holding model and then calculate these values as I process the data in celery. If I process the data from recent periods to later periods, I will have to update these values once the previous period has been processed, so it would be an additional check to do. I'll probably post this question here in more detail later. Here's ",{"type":24,"tag":40,"props":200,"children":203},{"href":201,"rel":202},"https://whalewisdom.com/filer/ubs-ag#tabholdings_tab_link",[44],[204],{"type":29,"value":205},"an example of what this means from WhaleWisdom",{"type":29,"value":207},".",{"type":24,"tag":36,"props":209,"children":210},{},[211],{"type":29,"value":212},"Accessing LinkedIn profile data to populate fields on my CustomUser model.",{"type":24,"tag":36,"props":214,"children":215},{},[216],{"type":29,"value":217},"Scaling? I have a lot more experience with deploying projects to AWS which is built around the ability to scale. I don't know a project on DigitalOcean would be scaled automatically. A single node docker swarm cluster while take some time to process all of the data. I would probably be better of scaling vertically with much bigger droplets and higher celery concurrency.",{"type":24,"tag":36,"props":219,"children":220},{},[221],{"type":29,"value":222},"Docker swarm secrets. I'm currently using environment variables to pass secrets stored in GitLab CI when I build images and deploy to docker swarm. I would like to learn how to properly use swarm secrets and work them into my CI/CD pipeline.",{"type":24,"tag":36,"props":224,"children":225},{},[226],{"type":29,"value":227},"As I mentioned above, I'm also interested in updating this project to Vue3 and to apply some of its new features to this project.",{"type":24,"tag":36,"props":229,"children":230},{},[231,233,239,241,247],{"type":29,"value":232},"Use pipenv, poetry or some other way of pinning secondary python dependencies. Does anyone have a recommendation on how best to do this with docker. I have always thought that docker ",{"type":24,"tag":234,"props":235,"children":236},"em",{},[237],{"type":29,"value":238},"is",{"type":29,"value":240}," the virtual environment, but I realize that some versions of indirect dependencies may change when pip installing without using a lockfile similar to ",{"type":24,"tag":129,"props":242,"children":244},{"className":243},[],[245],{"type":29,"value":246},"package-lock.json",{"type":29,"value":207},{"title":7,"searchDepth":249,"depth":249,"links":250},2,[],"markdown","content:2020:11:29:weekend-project-update-open-sec-data.md","content","2020/11/29/weekend-project-update-open-sec-data.md","2020/11/29/weekend-project-update-open-sec-data","md",{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"date":10,"image":11,"tags":258,"body":259,"_type":251,"_id":252,"_source":253,"_file":254,"_stem":255,"_extension":256},[13,14,15,16,17,18,19],{"type":21,"children":260,"toc":432},[261,265,295,305,309,376,380],{"type":24,"tag":25,"props":262,"children":263},{},[264],{"type":29,"value":30},{"type":24,"tag":32,"props":266,"children":267},{},[268,277,286],{"type":24,"tag":36,"props":269,"children":270},{},[271,276],{"type":24,"tag":40,"props":272,"children":274},{"href":42,"rel":273},[44],[275],{"type":29,"value":42},{"type":29,"value":48},{"type":24,"tag":36,"props":278,"children":279},{},[280,285],{"type":24,"tag":40,"props":281,"children":283},{"href":54,"rel":282},[44],[284],{"type":29,"value":54},{"type":29,"value":59},{"type":24,"tag":36,"props":287,"children":288},{},[289,294],{"type":24,"tag":40,"props":290,"children":292},{"href":65,"rel":291},[44],[293],{"type":29,"value":65},{"type":29,"value":70},{"type":24,"tag":25,"props":296,"children":297},{},[298,299,304],{"type":29,"value":75},{"type":24,"tag":40,"props":300,"children":302},{"href":78,"rel":301},[44],[303],{"type":29,"value":82},{"type":29,"value":84},{"type":24,"tag":25,"props":306,"children":307},{},[308],{"type":29,"value":89},{"type":24,"tag":32,"props":310,"children":311},{},[312,316,320,324,328,332,336,352,368,372],{"type":24,"tag":36,"props":313,"children":314},{},[315],{"type":29,"value":97},{"type":24,"tag":36,"props":317,"children":318},{},[319],{"type":29,"value":102},{"type":24,"tag":36,"props":321,"children":322},{},[323],{"type":29,"value":107},{"type":24,"tag":36,"props":325,"children":326},{},[327],{"type":29,"value":112},{"type":24,"tag":36,"props":329,"children":330},{},[331],{"type":29,"value":117},{"type":24,"tag":36,"props":333,"children":334},{},[335],{"type":29,"value":122},{"type":24,"tag":36,"props":337,"children":338},{},[339,340,345,346,351],{"type":29,"value":127},{"type":24,"tag":129,"props":341,"children":343},{"className":342},[],[344],{"type":29,"value":134},{"type":29,"value":136},{"type":24,"tag":129,"props":347,"children":349},{"className":348},[],[350],{"type":29,"value":142},{"type":29,"value":144},{"type":24,"tag":36,"props":353,"children":354},{},[355,356,361,362,367],{"type":29,"value":149},{"type":24,"tag":129,"props":357,"children":359},{"className":358},[],[360],{"type":29,"value":155},{"type":29,"value":157},{"type":24,"tag":129,"props":363,"children":365},{"className":364},[],[366],{"type":29,"value":163},{"type":29,"value":165},{"type":24,"tag":36,"props":369,"children":370},{},[371],{"type":29,"value":170},{"type":24,"tag":36,"props":373,"children":374},{},[375],{"type":29,"value":175},{"type":24,"tag":25,"props":377,"children":378},{},[379],{"type":29,"value":180},{"type":24,"tag":32,"props":381,"children":382},{},[383,387,391,401,405,409,413,417],{"type":24,"tag":36,"props":384,"children":385},{},[386],{"type":29,"value":188},{"type":24,"tag":36,"props":388,"children":389},{},[390],{"type":29,"value":193},{"type":24,"tag":36,"props":392,"children":393},{},[394,395,400],{"type":29,"value":198},{"type":24,"tag":40,"props":396,"children":398},{"href":201,"rel":397},[44],[399],{"type":29,"value":205},{"type":29,"value":207},{"type":24,"tag":36,"props":402,"children":403},{},[404],{"type":29,"value":212},{"type":24,"tag":36,"props":406,"children":407},{},[408],{"type":29,"value":217},{"type":24,"tag":36,"props":410,"children":411},{},[412],{"type":29,"value":222},{"type":24,"tag":36,"props":414,"children":415},{},[416],{"type":29,"value":227},{"type":24,"tag":36,"props":418,"children":419},{},[420,421,425,426,431],{"type":29,"value":232},{"type":24,"tag":234,"props":422,"children":423},{},[424],{"type":29,"value":238},{"type":29,"value":240},{"type":24,"tag":129,"props":427,"children":429},{"className":428},[],[430],{"type":29,"value":246},{"type":29,"value":207},{"title":7,"searchDepth":249,"depth":249,"links":433},[],1731482163670]