[{"data":1,"prerenderedAt":885},["ShallowReactive",2],{"upgrading-my-static-nuxt-blog-from-nuxt-3-to-nuxt-4":3},{"id":4,"title":5,"body":6,"comments":314,"date":869,"description":870,"draft":871,"extension":872,"external":873,"image":874,"meta":875,"navigation":314,"path":876,"seo":877,"stem":878,"tags":879,"__hash__":884},"blog/2025/07/21/upgrading-my-static-nuxt-blog-from-nuxt-3-to-nuxt-4.md","Upgrading my Blog to Nuxt 4",{"type":7,"value":8,"toc":857},"minimark",[9,21,24,35,38,44,47,53,56,62,68,75,80,86,89,95,98,105,111,117,123,130,136,142,148,154,157,166,171,178,200,204,207,224,228,254,258,274,278,285,334,347,350,352,358,363,366,372,375,381,388,394,400,406,409,418,421,427,434,440,451,457,460,466,472,481,487,494,500,507,514,520,525,531,534,541,544,550,553,558,561,699,705,721,727,733,737,752,758,768,774,788,795,801,807,818,826,829,835,838,844,853],[10,11,12,13,20],"p",{},"This article will share my experience upgrading my Nuxt blog from Nuxt 3 to Nuxt 4. I'm following the official ",[14,15,19],"a",{"href":16,"rel":17},"https://nuxt.com/docs/4.x/getting-started/upgrade",[18],"nofollow","Upgrade Guide"," from Nuxt. It will be mostly unfiltered and I'll try to document things as they happen. Let's go!",[10,22,23],{},"First, I'll do this on a new branch:",[25,26,31],"pre",{"className":27,"code":29,"language":30},[28],"language-text","git branch -b nuxt4-upgrade\n","text",[32,33,29],"code",{"__ignoreMap":34},"",[10,36,37],{},"The first step in the migration guide says to run:",[25,39,42],{"className":40,"code":41,"language":30},[28],"yarn nuxt upgrade\n",[32,43,41],{"__ignoreMap":34},[10,45,46],{},"This gave me an error.",[25,48,51],{"className":49,"code":50,"language":30},[28],"error @nuxt/vite-builder@4.0.0: The engine \"node\" is incompatible with this module. Expected version \"^20.19.0 || >=22.12.0\". Got \"20.18.0\"\nerror Found incompatible module.\ninfo Visit https://yarnpkg.com/en/docs/cli/add for documentation about this command.\n\n ERROR  Command failed: yarn add -D nuxt                                                  3:41:22 PM\n\n  at genericNodeError (node:internal/errors:984:15)\n  at wrappedFn (node:internal/errors:538:14)\n  at checkExecSyncError (node:child_process:891:11)\n  at execSync (node:child_process:963:15)\n  at Object.run (node_modules/nuxi/dist/chunks/upgrade.mjs:99:5)\n  at async runCommand$1 (node_modules/nuxi/dist/shared/nuxi.6aad497e.mjs:1648:16)\n  at async runCommand$1 (node_modules/nuxi/dist/shared/nuxi.6aad497e.mjs:1639:11)\n  at async runMain$1 (node_modules/nuxi/dist/shared/nuxi.6aad497e.mjs:1777:7)\n\n\n\n ERROR  Command failed: yarn add -D nuxt                                                  3:41:22 PM\n\nerror Command failed with exit code 1.\ninfo Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\n",[32,52,50],{"__ignoreMap":34},[10,54,55],{},"First, I need to upgrade node. I use nvm, so this is easy. Let's see what node versions I have installed:",[25,57,60],{"className":58,"code":59,"language":30},[28],"~/git/briancaffey.github.io$ nvm list\n->     v20.18.0\n       v22.15.0\ndefault -> 20 (-> v20.18.0)\niojs -> N/A (default)\nunstable -> N/A (default)\nnode -> stable (-> v22.15.0) (default)\nstable -> 22.15 (-> v22.15.0) (default)\nlts/* -> lts/jod (-> v22.15.0)\nlts/argon -> v4.9.1 (-> N/A)\nlts/boron -> v6.17.1 (-> N/A)\nlts/carbon -> v8.17.0 (-> N/A)\nlts/dubnium -> v10.24.1 (-> N/A)\nlts/erbium -> v12.22.12 (-> N/A)\nlts/fermium -> v14.21.3 (-> N/A)\nlts/gallium -> v16.20.2 (-> N/A)\nlts/hydrogen -> v18.20.8 (-> N/A)\nlts/iron -> v20.19.1 (-> N/A)\nlts/jod -> v22.15.0\n",[32,61,59],{"__ignoreMap":34},[25,63,66],{"className":64,"code":65,"language":30},[28],"~/git/briancaffey.github.io$ nvm install 22.17.1\nDownloading and installing node v22.17.1...\nDownloading https://nodejs.org/dist/v22.17.1/node-v22.17.1-darwin-arm64.tar.xz...\n###################################################################################################################################################################################### 100.0%\nComputing checksum with sha256sum\nChecksums matched!\nNow using node v22.17.1 (npm v10.9.2)\n",[32,67,65],{"__ignoreMap":34},[10,69,70,71,74],{},"OK, great, now let's run that ",[32,72,73],{},"yarn nuxt upgrade"," again:",[25,76,78],{"className":77,"code":41,"language":30},[28],[32,79,41],{"__ignoreMap":34},[25,81,84],{"className":82,"code":83,"language":30},[28],"~/git/briancaffey.github.io$ yarn nuxt upgrade\nyarn run v1.22.22\nerror Command \"nuxt\" not found.\ninfo Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\n",[32,85,83],{"__ignoreMap":34},[10,87,88],{},"Hmm, I'll try adding nuxt again:",[25,90,93],{"className":91,"code":92,"language":30},[28],"yarn add nuxt@^4.0.0\n\n...\n✨  Done in 36.03s.\n",[32,94,92],{"__ignoreMap":34},[10,96,97],{},"OK, great! Now I have Nuxt 4 installed.",[10,99,100,101,104],{},"The next section is about ",[32,102,103],{},"Migrating Using Codemods",". I'll try running this:",[106,107,108],"blockquote",{},[10,109,110],{},"This command will execute all codemods in sequence, with the option to deselect any that you do not wish to run. Each codemod is also listed below alongside its respective change and can be executed independently.",[25,112,115],{"className":113,"code":114,"language":30},[28],"yarn dlx codemod@latest nuxt/4/migration-recipe\n",[32,116,114],{"__ignoreMap":34},[25,118,121],{"className":119,"code":120,"language":30},[28],"~/git/briancaffey.github.io$ yarn dlx codemod@latest nuxt/4/migration-recipe\nyarn run v1.22.22\nerror Command \"dlx\" not found.\ninfo Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\n",[32,122,120],{"__ignoreMap":34},[10,124,125,126,129],{},"OK, I guess I need to add ",[32,127,128],{},"dlx"," with yarn first:",[25,131,134],{"className":132,"code":133,"language":30},[28],"yarn add dlx\n",[32,135,133],{"__ignoreMap":34},[25,137,140],{"className":138,"code":139,"language":30},[28],"success Saved lockfile.\nsuccess Saved 2 new dependencies.\ninfo Direct dependencies\n└─ dlx@0.2.1\ninfo All dependencies\n├─ dlx@0.2.1\n└─ underscore@1.13.7\n✨  Done in 2.52s.\n",[32,141,139],{"__ignoreMap":34},[10,143,144,145,147],{},"But I still got the same error about ",[32,146,128],{},", so I asked cursor:",[25,149,152],{"className":150,"code":151,"language":30},[28],"I'm trying to run this yarn command:\n\nyarn dlx codemod@latest nuxt/4/migration-recipe\n\n\nBut I'm getting an error:\n\nyarn dlx codemod@latest nuxt/4/migration-recipe\nyarn run v1.22.22\nerror Command \"dlx\" not found.\ninfo Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\n\nHow can I fix this?\n",[32,153,151],{"__ignoreMap":34},[155,156],"hr",{},[10,158,159,160,162,163,165],{},"The issue is that you're using Yarn v1.22.22, which doesn't have the ",[32,161,128],{}," command. The ",[32,164,128],{}," command was introduced in Yarn v2+ (Berry). Here are several ways to fix this:",[167,168,170],"h2",{"id":169},"option-1-use-npx-recommended","Option 1: Use npx (Recommended)",[10,172,173,174,177],{},"Since you're using Yarn v1, you can use ",[32,175,176],{},"npx"," instead:",[25,179,183],{"className":180,"code":181,"language":182,"meta":34,"style":34},"language-bash shiki shiki-themes github-light github-dark","npx codemod@latest nuxt/4/migration-recipe\n","bash",[32,184,185],{"__ignoreMap":34},[186,187,190,193,197],"span",{"class":188,"line":189},"line",1,[186,191,176],{"class":192},"sScJk",[186,194,196],{"class":195},"sZZnC"," codemod@latest",[186,198,199],{"class":195}," nuxt/4/migration-recipe\n",[167,201,203],{"id":202},"option-2-use-yarn-create-alternative","Option 2: Use yarn create (Alternative)",[10,205,206],{},"You can try using yarn's create command:",[25,208,210],{"className":180,"code":209,"language":182,"meta":34,"style":34},"yarn create codemod@latest nuxt/4/migration-recipe\n",[32,211,212],{"__ignoreMap":34},[186,213,214,217,220,222],{"class":188,"line":189},[186,215,216],{"class":192},"yarn",[186,218,219],{"class":195}," create",[186,221,196],{"class":195},[186,223,199],{"class":195},[167,225,227],{"id":226},"option-3-install-codemod-globally-first","Option 3: Install codemod globally first",[25,229,231],{"className":180,"code":230,"language":182,"meta":34,"style":34},"yarn global add codemod\ncodemod@latest nuxt/4/migration-recipe\n",[32,232,233,246],{"__ignoreMap":34},[186,234,235,237,240,243],{"class":188,"line":189},[186,236,216],{"class":192},[186,238,239],{"class":195}," global",[186,241,242],{"class":195}," add",[186,244,245],{"class":195}," codemod\n",[186,247,249,252],{"class":188,"line":248},2,[186,250,251],{"class":192},"codemod@latest",[186,253,199],{"class":195},[167,255,257],{"id":256},"option-4-use-the-full-path","Option 4: Use the full path",[25,259,261],{"className":180,"code":260,"language":182,"meta":34,"style":34},"yarn exec codemod@latest nuxt/4/migration-recipe\n",[32,262,263],{"__ignoreMap":34},[186,264,265,267,270,272],{"class":188,"line":189},[186,266,216],{"class":192},[186,268,269],{"class":195}," exec",[186,271,196],{"class":195},[186,273,199],{"class":195},[167,275,277],{"id":276},"option-5-upgrade-to-yarn-v2-optional","Option 5: Upgrade to Yarn v2+ (Optional)",[10,279,280,281,284],{},"If you want to use ",[32,282,283],{},"yarn dlx",", you could upgrade to Yarn v2+:",[25,286,288],{"className":180,"code":287,"language":182,"meta":34,"style":34},"# Enable Yarn v2+ for this project\nyarn set version berry\n\n# Then you can use dlx\nyarn dlx codemod@latest nuxt/4/migration-recipe\n",[32,289,290,296,309,316,322],{"__ignoreMap":34},[186,291,292],{"class":188,"line":189},[186,293,295],{"class":294},"sJ8bj","# Enable Yarn v2+ for this project\n",[186,297,298,300,303,306],{"class":188,"line":248},[186,299,216],{"class":192},[186,301,302],{"class":195}," set",[186,304,305],{"class":195}," version",[186,307,308],{"class":195}," berry\n",[186,310,312],{"class":188,"line":311},3,[186,313,315],{"emptyLinePlaceholder":314},true,"\n",[186,317,319],{"class":188,"line":318},4,[186,320,321],{"class":294},"# Then you can use dlx\n",[186,323,325,327,330,332],{"class":188,"line":324},5,[186,326,216],{"class":192},[186,328,329],{"class":195}," dlx",[186,331,196],{"class":195},[186,333,199],{"class":195},[10,335,336,343,344,346],{},[337,338,339,340,342],"strong",{},"I recommend using Option 1 (",[32,341,176],{},")"," since it's the most straightforward and doesn't require changing your package manager setup. The ",[32,345,176],{}," command is available by default with Node.js and will work perfectly for running the codemod.",[10,348,349],{},"After running the codemod, you can continue with the manual upgrade steps I outlined in the previous plan.",[155,351],{},[10,353,354,355,357],{},"OK, I'll try upgrading yarn later, and for now I'll go with using ",[32,356,176],{},":",[25,359,361],{"className":360,"code":181,"language":30},[28],[32,362,181],{"__ignoreMap":34},[10,364,365],{},"OK, that worked, now I got the list of options to choose from for my Nuxt 4 upgrade:",[25,367,370],{"className":368,"code":369,"language":30},[28],"✔ Successfully downloaded \"nuxt/4/migration-recipe\" from the registry.\n? Press Enter to run the selected codemods in order. You can deselect anything you don’t want. (Press\n\u003Cspace> to select, \u003Ca> to toggle all, \u003Ci> to invert selection, and \u003Center> to proceed)\n❯◉ nuxt/4/absolute-watch-path\n ◉ nuxt/4/default-data-error-value\n ◉ nuxt/4/deprecated-dedupe-value\n ◉ nuxt/4/file-structure\n ◉ nuxt/4/shallow-function-reactivity\n ◉ nuxt/4/template-compilation-changes\n",[32,371,369],{"__ignoreMap":34},[10,373,374],{},"OK! That seems to work! It ran each codemod, for example:",[25,376,379],{"className":377,"code":378,"language":30},[28],"╭──────────────────────────────────────────────────────────────────────────────────────────────────╮\n│                                                                                                  │\n│                                                                                                  │\n│      Codemod: nuxt/4/absolute-watch-path@1.0.3                                                   │\n│      Target: /Users/brian/git/briancaffey.github.io                                              │\n│                                                                                                  │\n│      Using paths provided by codemod settings                                                    │\n│      Included patterns: **/*.js, **/*.jsx, **/*.ts, **/*.tsx, **/*.vue                           │\n│      Patterns excluded by default: **/*.d.ts, **/node_modules/**/*.*, **/.next/**/*.*,           │\n│      **/dist/**/*.*, **/build/**/*.*, **/.git/**/*.*,                                            │\n│      **/.svn/**/*.*, **/.hg/**/*.*, **/.bzr/**/*.*,                                              │\n│      **/_darcs/**/*.*, **/_MTN/**/*.*, **/_FOSSIL_, **/.fslckout,                                │\n│      **/.view/**/*.*                                                                             │\n│      Patterns excluded from gitignore: **/.vscode/**/*.*, **/node_modules, /logs, **/*.log,      │\n│      **/npm-debug.log*, **/yarn-debug.log*, **/yarn-error.log*,                                  │\n│      **/pids, **/*.pid, **/*.seed, **/*.pid.lock, **/lib-cov,                                    │\n│      **/coverage, **/.nyc_output, **/.grunt, **/bower_components,                                │\n│      **/.lock-wscript, **/build/Release, **/node_modules/**/*.*,                                 │\n│      **/jspm_packages/**/*.*, **/typings/**/*.*, **/.npm,                                        │\n│      **/.eslintcache, **/.node_repl_history, **/*.tgz,                                           │\n│      **/.yarn-integrity, **/.env, **/.cache, **/.next, **/.nuxt,                                 │\n│      **/dist, **/.vuepress/dist, **/.serverless, **/.idea,                                       │\n│      **/sw.*, **/.DS_Store, **/*.swp, **/notes, **/.output                                       │\n│                                                                                                  │\n│      Running in 4 threads                                                                        │\n│      File formatting disabled                                                                    │\n│                                                                                                  │\n│                                                                                                  │\n╰──────────────────────────────────────────────────────────────────────────────────────────────────╯\n",[32,380,378],{"__ignoreMap":34},[10,382,383,384,387],{},"The big change at this point is that most of the code was moved to the ",[32,385,386],{},"/app"," directory:",[25,389,392],{"className":390,"code":391,"language":30},[28],"Untracked files:\n  (use \"git add \u003Cfile>...\" to include in what will be committed)\n        app/\n        content/2025/07/21/\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\n",[32,393,391],{"__ignoreMap":34},[10,395,396,397],{},"Is that it? Let's try running ",[32,398,399],{},"yarn dev",[25,401,404],{"className":402,"code":403,"language":30},[28],"yarn dev\n...\n ERROR  Cannot start nuxt:  ENOENT: no such file or directory, open '/Users/brian/git/briancaffey.github.io/app/i18n/en-US.js'                           4:12:36 PM\n",[32,405,403],{"__ignoreMap":34},[10,407,408],{},"OK, we have an error related to i18n. I have struggled with i18n a fair bit when doing major changes to my site.",[10,410,411,412,414,415,417],{},"It looks like Nuxt 4 expects the i18n folder to be under tha new ",[32,413,386],{}," directory, but it is still in the root directory, so let's move that and try running ",[32,416,399],{}," again.",[10,419,420],{},"Cool, no errors:",[25,422,425],{"className":423,"code":424,"language":30},[28],"~/git/briancaffey.github.io$ yarn dev\nyarn run v1.22.22\n$ nuxi dev --host\nNuxt 4.0.0 with Nitro 2.12.0                                              nuxi 4:16:03 PM\n                                                                               4:16:03 PM\n\n              █▀▀▀▀▀▀▀██▀▀▀█▀██▀█▀▀▀▀▀▀▀█\n              █ █▀▀▀█ ██▀▀ ▄▄██▀█ █▀▀▀█ █\n              █ █   █ █ █ ▄▀▄ ▄▄█ █   █ █\n              █ ▀▀▀▀▀ █▀▄ █▀▄▀█ █ ▀▀▀▀▀ █\n              █▀▀███▀▀▀█ ▀█ ▀█▀ ███▀▀████\n              ██ ▄ ▄▀▀▀█▀▄▀▀▀▀ ▄▄▀▀▄ ▄ ▀█\n              █▀█▄▀▀ ▀▀ ▀ ▄▀█▀▄ ▀▀█▄▄██ █\n              █ ▄██ █▀█▀▀▄█▄ ▄ █▀█▀█▀█ ▀█\n              █ █▀█  ▀▄▄█▄ ▀▀▄█ ▀▀▀ █ █▄█\n              █▀▀▀▀▀▀▀█ ▀▄  █ ▄ █▀█ ▀▄█▀█\n              █ █▀▀▀█ █▄ ▀█▄▀▄▀ ▀▀▀ ▀▀███\n              █ █   █ ██▄▀▄ ████▀▄▄█▄▀▄ █\n              █ ▀▀▀▀▀ █ ▀ ▀▄█▀  █ ▄▄▀██ █\n              ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀\n\n  ➜ Local:    http://localhost:3000/\n  ➜ Network:  http://192.168.5.226:3000/ [QR code]\n\nℹ Using default Tailwind CSS file                            nuxt:tailwindcss 4:16:04 PM\n\n[4:16:04 PM]  WARN  Locales en-US, fr-FR, zh-ZH, ru-RU, ja-JP, hi-IN uses deprecated iso property, this will be replaced with language in v9\n\n  ➜ DevTools: press Shift + Option + D in the browser (v2.6.2)                 4:16:04 PM\n\n✔ Vite client built in 45ms                                                   4:16:05 PM\n✔ Vite server built in 30ms                                                   4:16:05 PM\n✔ Nuxt Nitro server built in 1071ms                                     nitro 4:16:07 PM\nℹ Vite client warmed up in 1ms                                                4:16:07 PM\nℹ Vite server warmed up in 63ms                                               4:16:07 PM\n[4:16:25 PM] ℹ ✨ new dependencies optimized: @vue/devtools-core, @vue/devtools-kit, vue-disqus, vue3-apexcharts, pinia, @intlify/shared, is-https, @intlify/core-base\nℹ ✨ optimized dependencies changed. reloading                                4:16:25 PM\n",[32,426,424],{"__ignoreMap":34},[10,428,429,430,433],{},"But I am getting a big ",[32,431,432],{},"500"," error in the browser:",[25,435,438],{"className":436,"code":437,"language":30},[28],"500\norgTransform.apply is not a function\n\nCustomize this page\nat createError (/Users/brian/git/briancaffey.github.io/node_modules/h3/dist/index.mjs:71:15)\nat /Users/brian/git/briancaffey.github.io/node_modules/@nuxt/vite-builder/dist/index.mjs:403:21)\nat async processMessage (/Users/brian/git/briancaffey.github.io/node_modules/@nuxt/vite-builder/dist/index.mjs:386:30)\n",[32,439,437],{"__ignoreMap":34},[10,441,442,443,446,447,450],{},"Searching GitHub's code, I it looks like ",[32,444,445],{},"orgTransform.apply"," comes from ",[32,448,449],{},"rdhainaut/unplugin-vue-i18n · lib/index.mjs",", so this is likely another i18n issue.",[25,452,455],{"className":453,"code":454,"language":30},[28],"\"@nuxtjs/i18n@^8.3.3\":\n  version \"8.5.6\"\n  resolved \"https://registry.yarnpkg.com/@nuxtjs/i18n/-/i18n-8.5.6.tgz#d65b375fba5244d83fc6833a604e2b532a64bef2\"\n  integrity sha512-L+g+LygKNoaS/AXExk7tzS9wSNn9QdP1T9VdTjjEGYftpeFgv2U8AQsY0dQAhgPIbXXhIAkNYxTk4YcINj9CfA==\n  dependencies:\n    \"@intlify/h3\" \"^0.5.0\"\n    \"@intlify/shared\" \"^9.14.1\"\n    \"@intlify/unplugin-vue-i18n\" \"^3.0.1\"\n",[32,456,454],{"__ignoreMap":34},[10,458,459],{},"Let's make sure that I'm on the latest version of Nuxt's i18n:",[25,461,464],{"className":462,"code":463,"language":30},[28],"npx nuxi module add i18n\n",[32,465,463],{"__ignoreMap":34},[25,467,470],{"className":468,"code":469,"language":30},[28],"yarn add @nuxtjs/i18n@^10.0.0\n",[32,471,469],{"__ignoreMap":34},[10,473,474,475,478,479,357],{},"After upgrading ",[32,476,477],{},"@nuxtjs/i18n"," to v10.0.0 I got another i18n error when running ",[32,480,399],{},[25,482,485],{"className":483,"code":484,"language":30},[28],"[4:26:12 PM]  ERROR  Cannot start nuxt:  ENOENT: no such file or directory, open '/Users/brian/git/briancaffey.github.io/i18n/locales/i18n/en-US.js'\n\n    at readFileSync (node:fs:441:20)\n    at getLocaleType (node_modules/@nuxtjs/i18n/dist/module.mjs:143:34)\n    at resolveLocales (node_modules/@nuxtjs/i18n/dist/module.mjs:128:20)\n    at resolveLocaleInfo (node_modules/@nuxtjs/i18n/dist/module.mjs:1511:20)\n    at async node_modules/@nuxtjs/i18n/dist/module.mjs:1926:7\n    at async initNuxt (node_modules/nuxt/dist/index.mjs:5613:3)\n    at async NuxtDevServer._load (node_modules/@nuxt/cli/dist/chunks/index.mjs:211:5)\n    at async NuxtDevServer.load (node_modules/@nuxt/cli/dist/chunks/index.mjs:139:7)\n    at async NuxtDevServer.init (node_modules/@nuxt/cli/dist/chunks/index.mjs:130:5)\n    at async initialize (node_modules/@nuxt/cli/dist/chunks/index.mjs:426:3)\n",[32,486,484],{"__ignoreMap":34},[10,488,489,490,493],{},"OK! So I rarranged my ",[32,491,492],{},"i18n"," folder to match watch it was looking for:",[25,495,498],{"className":496,"code":497,"language":30},[28],"~/git/briancaffey.github.io$ tree i18n -L 3\ni18n\n├── i18n.config.js\n└── locales\n    └── i18n\n        ├── en-US.js\n        ├── fr-FR.js\n        ├── hi-IN.js\n        ├── jp-JP.js\n        ├── ru-RU.js\n        └── zh-ZH.js\n",[32,499,497],{"__ignoreMap":34},[10,501,502,503,506],{},"Now I have my language files duplicated, however. But at least I'm able to visit my site in the browser! And I can see in the NuxtDevTools window that I am using ",[32,504,505],{},"v4.0.0","!",[10,508,509],{},[510,511],"img",{"alt":512,"src":513},"NuxtDevTools","/static/nuxt4/nuxt-dev-tools.png",[25,515,518],{"className":516,"code":517,"language":30},[28],"  ➜ Local:    http://localhost:3000/\n  ➜ Network:  http://192.168.5.226:3000/ [QR code]\n\nℹ Using default Tailwind CSS file                                                    nuxt:tailwindcss 4:31:24 PM\n  ➜ DevTools: press Shift + Option + D in the browser (v2.6.2)                                         4:31:24 PM\n\nℹ Re-optimizing dependencies because lockfile has changed                                             4:31:25 PM\n✔ Vite client built in 61ms                                                                           4:31:25 PM\n✔ Vite server built in 42ms                                                                           4:31:26 PM\n✔ Nuxt Nitro server built in 1422ms                                                             nitro 4:31:27 PM\nℹ Vite client warmed up in 1ms                                                                        4:31:27 PM\nℹ Vite server warmed up in 164ms                                                                      4:31:27 PM\n[4:31:38 PM]  WARN  [@nuxtjs/mdc] Language \"Dockerfile\" is not loaded to the Shiki highlighter, fallback to plain text. Add the language to \"mdc.highlight.langs\" to fix this.\n[4:31:38 PM]  WARN  [@nuxtjs/mdc] Language \"Dockerfile\" is not loaded to the Shiki highlighter, fallback to plain text. Add the language to \"mdc.highlight.langs\" to fix this.\n[4:31:38 PM]  WARN  [@nuxtjs/mdc] Language \"vue\" is not loaded to the Shiki highlighter, fallback to plain text. Add the language to \"mdc.highlight.langs\" to fix this.\n[4:31:48 PM] ℹ ✨ new dependencies optimized: @vue/devtools-core, @vue/devtools-kit, vue-disqus, vue3-apexcharts, pinia\nℹ ✨ optimized dependencies changed. reloading                                                        4:31:48 PM\nℹ ✨ new dependencies optimized: @vueuse/components                                                   4:31:50 PM\nℹ ✨ optimized dependencies changed. reloading                                                        4:31:50 PM\n",[32,519,517],{"__ignoreMap":34},[10,521,522,523,357],{},"I went through each of my project dependencies and updated them to the latest versions. After doing this and resolving some small issues, I got the following when running ",[32,524,399],{},[25,526,529],{"className":527,"code":528,"language":30},[28],"[@nuxt/content 7:10:17 PM]  WARN  No content configuration found, falling back to default collection. In order to have full control over your collections, create the config file in project root. See: https://content.nuxt.com/docs/getting-started/installation\n\nℹ Using default Tailwind CSS file                                                                 nuxt:tailwindcss 7:10:17 PM\n  ➜ DevTools: press Shift + Option + D in the browser (v2.6.2)                                                      7:10:17 PM\n\n\n ERROR  Nuxt Content requires better-sqlite3 module to operate.                                       @nuxt/content 7:10:18 PM\n\n                                                                                                                    7:10:18 PM\n                                                                                                                    7:10:18 PM\n❯ Do you want to install better-sqlite3 package?\n● Yes / ○ No\n",[32,530,528],{"__ignoreMap":34},[10,532,533],{},"After installing this I got another error!",[10,535,536,537],{},"Upgrading from Nuxt Content v2 to v3 introduced some breaking changes, so I had to work through those. ",[14,538,539],{"href":539,"rel":540},"https://content.nuxt.com/docs/getting-started/migration",[18],[10,542,543],{},"This is one of the errors I got after upgrading Nuxt Content from v2 to v3.",[25,545,548],{"className":546,"code":547,"language":30},[28]," ERROR  [request error] [unhandled] [GET] http://localhost:3000/blog/1                                                                                                                      7:14:09 PM\n\n\nℹ Error: Cannot read properties of undefined (reading 'length')\n\n ⁃ at _sfc_ssrRender (app/pages/blog/[number].vue:78:62)\n\n   37 ┃\n   38 ┃  const { data: paginatedItems } = await useAsyncData(route.path, () =>\n   39 ┃    queryCollection(\"/\")\n   40 ┃      .where({ draft: { $ne: true } })\n   41 ┃      .sort({'date': -1})\n   42 ┃      .limit(10)\n   43 ┃      .skip(9 * (pageNo - 1))\n   44 ┃      .find()\n   45 ┃  )\n   46 ┃  \u003C/script>\n   47 ┃\n",[32,549,547],{"__ignoreMap":34},[10,551,552],{},"The API changed and it uses a SQL-like query language. The migration docs mentioned this:",[106,554,555],{},[10,556,557],{},"The new API is backed by SQL and content queries happens within a specific collection.",[10,559,560],{},"Now the above query is written more like this with the new version of Nuxt Content:",[25,562,566],{"className":563,"code":564,"language":565,"meta":34,"style":34},"language-js shiki shiki-themes github-light github-dark","const { data: paginatedItems } = await useAsyncData(route.path, () =>\n  queryCollection(\"blog\")\n    .order(\"date\", \"DESC\")\n    .limit(10)\n    .skip(9 * (pageNo - 1))\n    .all()\n)\n","js",[32,567,568,607,621,642,656,683,694],{"__ignoreMap":34},[186,569,570,574,578,582,585,589,592,595,598,601,604],{"class":188,"line":189},[186,571,573],{"class":572},"szBVR","const",[186,575,577],{"class":576},"sVt8B"," { ",[186,579,581],{"class":580},"s4XuR","data",[186,583,584],{"class":576},": ",[186,586,588],{"class":587},"sj4cs","paginatedItems",[186,590,591],{"class":576}," } ",[186,593,594],{"class":572},"=",[186,596,597],{"class":572}," await",[186,599,600],{"class":192}," useAsyncData",[186,602,603],{"class":576},"(route.path, () ",[186,605,606],{"class":572},"=>\n",[186,608,609,612,615,618],{"class":188,"line":248},[186,610,611],{"class":192},"  queryCollection",[186,613,614],{"class":576},"(",[186,616,617],{"class":195},"\"blog\"",[186,619,620],{"class":576},")\n",[186,622,623,626,629,631,634,637,640],{"class":188,"line":311},[186,624,625],{"class":576},"    .",[186,627,628],{"class":192},"order",[186,630,614],{"class":576},[186,632,633],{"class":195},"\"date\"",[186,635,636],{"class":576},", ",[186,638,639],{"class":195},"\"DESC\"",[186,641,620],{"class":576},[186,643,644,646,649,651,654],{"class":188,"line":318},[186,645,625],{"class":576},[186,647,648],{"class":192},"limit",[186,650,614],{"class":576},[186,652,653],{"class":587},"10",[186,655,620],{"class":576},[186,657,658,660,663,665,668,671,674,677,680],{"class":188,"line":324},[186,659,625],{"class":576},[186,661,662],{"class":192},"skip",[186,664,614],{"class":576},[186,666,667],{"class":587},"9",[186,669,670],{"class":572}," *",[186,672,673],{"class":576}," (pageNo ",[186,675,676],{"class":572},"-",[186,678,679],{"class":587}," 1",[186,681,682],{"class":576},"))\n",[186,684,686,688,691],{"class":188,"line":685},6,[186,687,625],{"class":576},[186,689,690],{"class":192},"all",[186,692,693],{"class":576},"()\n",[186,695,697],{"class":188,"line":696},7,[186,698,620],{"class":576},[167,700,702],{"id":701},"yarn-generate",[32,703,704],{},"yarn generate",[10,706,707,708,710,711,713,714,717,718,720],{},"After fixing the Nuxt Content query syntax for Nuxt Content v3, I tried running ",[32,709,704],{}," to build my static site. This can often uncover issues that you won't see when just running ",[32,712,399],{},". Right away I found an issue with my Pinia Store. It couldn't find the file for my store. The codemod migration tool did not move my ",[32,715,716],{},"store"," folder into the ",[32,719,386],{}," directory, so I had to do that manually.",[10,722,723,724,726],{},"OK! After fixing the Pinia Store issues I was able to run ",[32,725,704],{}," successfully!",[25,728,731],{"className":729,"code":730,"language":30},[28],"ℹ Prerendered 785 routes in 93.991 seconds\n✔ Generated public .output/public\n✔ You can preview this build using npx serve .output/public\n✔ You can now deploy .output/public to any static hosting!\n✨  Done in 105.98s.\n",[32,732,730],{"__ignoreMap":34},[167,734,736],{"id":735},"cicd","CI/CD",[10,738,739,740,743,744,747,748,751],{},"To deploy my blog to ",[32,741,742],{},"briancaffey.github.io"," I just have to push my working changes to the ",[32,745,746],{},"master"," branch of my GitHub repository. GitHub Actions builds the site and pushes the build assets to GitHub Pages for me. To avoid any issues I need to make sure I'm using the correct version of ",[32,749,750],{},"node",".",[25,753,756],{"className":754,"code":755,"language":30},[28],"- name: Setup Node\n  uses: actions/setup-node@v4\n  with:\n    node-version: \"20\"\n",[32,757,755],{"__ignoreMap":34},[10,759,760,761,764,765],{},"I updated ",[32,762,763],{},"\"20\""," to ",[32,766,767],{},"\"22.17.1\"",[167,769,771],{"id":770},"datacontentcontentssqlite",[32,772,773],{},".data/content/contents.sqlite",[10,775,776,777,764,780,783,784,342],{},"Something else I noticed is this new sqlite file. This is just for debugging, so we can add ",[32,778,779],{},".data",[32,781,782],{},".gitignore"," (",[14,785,786],{"href":786,"rel":787},"https://content.nuxt.com/docs/advanced/tools#locate-your-sqlite-database",[18],[167,789,791,794],{"id":790},"yarn-lint-error",[32,792,793],{},"yarn lint"," error",[10,796,797,798,800],{},"I forgot to see if the code would properly lint, so on pushing to the master branch I got a failed deployment pipeline. Running ",[32,799,793],{}," from my Mac I get the same error:",[25,802,805],{"className":803,"code":804,"language":30},[28],"~/git/briancaffey.github.io$ yarn lint\nyarn run v1.22.22\n$ eslint .\n\nOops! Something went wrong! :(\n\nESLint: 9.31.0\n\nTypeError [ERR_INVALID_MODULE_SPECIFIER]: Invalid module \".nuxt/eslint.config.mjs\" is not a valid package name imported from /Users/brian/git/briancaffey.github.io/eslint.config.mjs\n    at parsePackageName (node:internal/modules/package_json_reader:211:11)\n    at Object.getPackageJSONURL (node:internal/modules/package_json_reader:222:53)\n    at packageResolve (node:internal/modules/esm/resolve:768:81)\n    at moduleResolve (node:internal/modules/esm/resolve:854:18)\n    at defaultResolve (node:internal/modules/esm/resolve:984:11)\n    at ModuleLoader.defaultResolve (node:internal/modules/esm/loader:780:12)\n    at #cachedDefaultResolve (node:internal/modules/esm/loader:704:25)\n    at ModuleLoader.resolve (node:internal/modules/esm/loader:687:38)\n    at ModuleLoader.getModuleJobForImport (node:internal/modules/esm/loader:305:38)\n    at ModuleJob._link (node:internal/modules/esm/module_job:175:49)\nerror Command failed with exit code 2.\ninfo Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.\n",[32,806,804],{"__ignoreMap":34},[10,808,809,810,813,814,817],{},"The error seems to be related to the file ",[32,811,812],{},"eslint.config.mjs",". I'm not familiar with what ",[32,815,816],{},".mjs"," files are, so I asked cursor:",[106,819,820,823],{},[10,821,822],{},"What are .mjs files?",[10,824,825],{},".mjs stands for \"Module JavaScript\" and is a file extension that explicitly tells Node.js to treat the file as an ES module, regardless of your project's configuration.",[10,827,828],{},"I was able to fix the error by making a small change to the input line that was throwing the error:",[25,830,833],{"className":831,"code":832,"language":30},[28],"import withNuxt from '.nuxt/eslint.config.mjs'\n",[32,834,832],{"__ignoreMap":34},[10,836,837],{},"changed to",[25,839,842],{"className":840,"code":841,"language":30},[28],"import withNuxt from './.nuxt/eslint.config.mjs'\n",[32,843,841],{"__ignoreMap":34},[10,845,846,847,849,850,852],{},"Now running ",[32,848,793],{}," gave me small error in one of my components. Fixing that resulted in a successful ",[32,851,793],{},"! OK, it should work this time!",[854,855,856],"style",{},"html pre.shiki code .sScJk, html code.shiki .sScJk{--shiki-default:#6F42C1;--shiki-dark:#B392F0}html pre.shiki code .sZZnC, html code.shiki .sZZnC{--shiki-default:#032F62;--shiki-dark:#9ECBFF}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html pre.shiki code .sJ8bj, html code.shiki .sJ8bj{--shiki-default:#6A737D;--shiki-dark:#6A737D}html pre.shiki code .szBVR, html code.shiki .szBVR{--shiki-default:#D73A49;--shiki-dark:#F97583}html pre.shiki code .sVt8B, html code.shiki .sVt8B{--shiki-default:#24292E;--shiki-dark:#E1E4E8}html pre.shiki code .s4XuR, html code.shiki .s4XuR{--shiki-default:#E36209;--shiki-dark:#FFAB70}html pre.shiki code .sj4cs, html code.shiki .sj4cs{--shiki-default:#005CC5;--shiki-dark:#79B8FF}",{"title":34,"searchDepth":248,"depth":248,"links":858},[859,860,861,862,863,864,865,866,867],{"id":169,"depth":248,"text":170},{"id":202,"depth":248,"text":203},{"id":226,"depth":248,"text":227},{"id":256,"depth":248,"text":257},{"id":276,"depth":248,"text":277},{"id":701,"depth":248,"text":704},{"id":735,"depth":248,"text":736},{"id":770,"depth":248,"text":773},{"id":790,"depth":248,"text":868},"yarn lint error","2025-07-21","This article details my process of upgrading my static GitHub Pages Blog from Nuxt 3 to Nuxt 4, and an upgrade of the headless CMS that powers my site, Nuxt Content, from v2 to v3",false,"md",null,"/static/nuxt4/nuxt4.png",{},"/2025/07/21/upgrading-my-static-nuxt-blog-from-nuxt-3-to-nuxt-4",{"title":5,"description":870},"2025/07/21/upgrading-my-static-nuxt-blog-from-nuxt-3-to-nuxt-4",[880,881,882,883],"nuxt","vue","blogging","cms","QjWGr_nCs32DuBRXFBVhsJkA3SQG9NFz-dzeNpy1YEk",1753130126954]